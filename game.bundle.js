(self.webpackChunkgame_core=self.webpackChunkgame_core||[]).push([[757],{556:function(){HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,e,n){for(var i=atob(this.toDataURL(e,n).split(",")[1]),a=i.length,r=a>>2,s=new Uint8Array(a),o=new Uint32Array(s.buffer,0,r),h=0,c=0;h<r;h++)o[h]=i.charCodeAt(c++)|i.charCodeAt(c++)<<8|i.charCodeAt(c++)<<16|i.charCodeAt(c++)<<24;for(var l=3&a;l--;)s[c]=i.charCodeAt(c++);t(new Blob([s],{type:e||"image/png"}))}})},444:function(t,e,n){"use strict";n.r(e),n.d(e,{FacebookTournament:function(){return u}});var i=n(8),a=n(144),r=n.n(a),s=n(6),o=n.n(s),h=n(47),c=n(254),l=n(111),u=function(){function t(){}var e=t.prototype;return e.createAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.tournament.createAsync(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.shareAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.tournament.shareAsync(e);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.joinAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.tournament.joinAsync(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.postScoreAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.tournament.postScoreAsync(e);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getTournamentsAsync=function(){var t=(0,i.default)(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.tournament.getTournamentsAsync();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t}(),d=function(){function t(t){var e=this;this.facebook=void 0,this.isCalledSubscribeBot=!1,this.isCalledCreateShortcut=!1,this.requestTournamentAsync=function(){var t=(0,i.default)(o().mark((function t(n){var i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.facebook.getTournamentAsync();case 3:return t.next=5,e.facebook.tournament.shareAsync({score:n});case 5:t.next=12;break;case 7:return t.prev=7,t.t0=t.catch(0),i=GameSDK.player.getName(),t.next=12,e.facebook.tournament.createAsync({initialScore:n,config:{tournamentTitle:i+"'s Tournament"}});case 12:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),this.facebook=t}var e=t.prototype;return e.switchAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 2:return t.next=4,GameSDK.context.switchAsync(e);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.chooseAsync=function(){var t=(0,i.default)(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 3:return t.next=5,GameSDK.context.chooseAsync({filters:["INCLUDE_EXISTING_CHALLENGES"],minSize:2,maxSize:2});case 5:case 15:return t.abrupt("return",GameSDK.context.getID());case 8:if(t.prev=8,t.t0=t.catch(0),!(t.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(t.t0,"code"))){t.next=16;break}t.t1=t.t0.code,t.next="USER_INPUT"===t.t1?14:"SAME_CONTEXT"===t.t1?15:16;break;case 14:return t.abrupt("return",!1);case 16:return t.abrupt("return",null);case 17:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}}(),e.createAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 3:return t.next=5,GameSDK.context.createAsync(""+e);case 5:case 15:return t.abrupt("return",GameSDK.context.getID());case 8:if(t.prev=8,t.t0=t.catch(0),!(t.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(t.t0,"code"))){t.next=16;break}t.t1=t.t0.code,t.next="USER_INPUT"===t.t1?14:"SAME_CONTEXT"===t.t1?15:16;break;case 14:return t.abrupt("return",!1);case 16:return t.abrupt("return",null);case 17:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}(),e.getPlayerToken=function(){var t=(0,i.default)(o().mark((function t(){var e;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.player.getSignedPlayerInfoAsync();case 2:return e=t.sent,t.abrupt("return",e.getSignature());case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),e.getContextPlayers=function(){var t=(0,i.default)(o().mark((function t(e){var n,i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,GameSDK.context.getPlayersAsync();case 3:return n=t.sent,i=[],n.forEach((function(t){var n=t.getID();if(n!==e){var a=t.getName();if(a){var r=t.getPhoto();i.push(new c.default(n,a,r).toObject())}}})),t.abrupt("return",GameCore.Utils.Array.unique(i));case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",[]);case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}(),e.shareAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.shareAsync(e);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.sendMessage=function(){var t=(0,i.default)(o().mark((function t(e){var n,i,a,r,s,h;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.data,i=e.image,a=e.template,r=e.cta,s=e.text,h={data:n,image:i,action:"CUSTOM",template:a,cta:r,text:s,strategy:"IMMEDIATE",notification:"PUSH"},t.next=4,GameSDK.updateAsync(h);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.inviteAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.inviteAsync(e);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.postSessionScoreAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.postSessionScoreAsync(e);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getRewardedVideoAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.getRewardedVideoAsync(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getInterstitialAdAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.getInterstitialAdAsync(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getContextID=function(){return GameSDK.context.getID()},e.attemptToAddShortcut=function(){var t=(0,i.default)(o().mark((function t(){var e,n,i,a,s,c;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isCalledCreateShortcut){t.next=2;break}return t.abrupt("return",!1);case 2:if(t.prev=2,"ANDROID"!==GameSDK.getPlatform()){t.next=6;break}return t.abrupt("return",!1);case 6:return t.next=8,GameSDK.player.getDataAsync(["lastCallCreateShortcut"]);case 8:if(n=t.sent,!(i=n.lastCallCreateShortcut)||!(0,l.checkIsToday)(+i)){t.next=12;break}return t.abrupt("return",!1);case 12:if(a=Date.now(),GameSDK.player.setDataAsync({lastCallCreateShortcut:a}),r()(e=GameSDK.getSupportedAPIs()).call(e,"canCreateShortcutAsync")){t.next=17;break}return t.abrupt("return",!1);case 17:return t.next=19,GameSDK.canCreateShortcutAsync();case 19:if(!t.sent){t.next=37;break}return s=h.AnalyticsEvents.SHORTCUT_CREATE,c=h.AnalyticsEvents.SHORTCUT_CREATE_POPUP,this.isCalledCreateShortcut=!0,window.game.analytics.event(c),t.prev=24,t.next=27,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 27:return t.next=29,GameSDK.createShortcutAsync();case 29:return window.game.analytics.event(s,{success:!0}),t.abrupt("return",!0);case 33:return t.prev=33,t.t0=t.catch(24),window.game.analytics.event(s,{success:!1}),t.abrupt("return",!1);case 37:return t.abrupt("return",!1);case 40:return t.prev=40,t.t1=t.catch(2),t.abrupt("return",!1);case 43:case"end":return t.stop()}}),t,this,[[2,40],[24,33]])})));return function(){return t.apply(this,arguments)}}(),e.attemptToSubscribeBot=function(){var t=(0,i.default)(o().mark((function t(){var e,n,i,a,s,c;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isCalledSubscribeBot){t.next=2;break}return t.abrupt("return",!1);case 2:if(t.prev=2,r()(e=GameSDK.getSupportedAPIs()).call(e,"player.canSubscribeBotAsync")){t.next=6;break}return t.abrupt("return",!1);case 6:return t.next=8,GameSDK.player.canSubscribeBotAsync();case 8:if(!t.sent){t.next=34;break}return t.next=12,GameSDK.player.getDataAsync(["lastCallSubscribeBot"]);case 12:if(n=t.sent,!(i=n.lastCallSubscribeBot)||!(0,l.checkIsToday)(+i)){t.next=16;break}return t.abrupt("return",!1);case 16:return a=Date.now(),GameSDK.player.setDataAsync({lastCallSubscribeBot:a}),s=h.AnalyticsEvents.BOT_SUBSCRIBE,c=h.AnalyticsEvents.BOT_SUBSCRIBE_POPUP,this.isCalledSubscribeBot=!0,window.game.analytics.event(c),t.prev=21,t.next=24,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 24:return t.next=26,GameSDK.player.subscribeBotAsync();case 26:return window.game.analytics.event(s,{success:!0}),t.abrupt("return",!0);case 30:return t.prev=30,t.t0=t.catch(21),window.game.analytics.event(s,{success:!1}),t.abrupt("return",!1);case 34:return t.abrupt("return",!1);case 37:return t.prev=37,t.t1=t.catch(2),t.abrupt("return",!1);case 40:case"end":return t.stop()}}),t,this,[[2,37],[21,30]])})));return function(){return t.apply(this,arguments)}}(),e.matchPlayerAsync=function(){var t=(0,i.default)(o().mark((function t(e,n,i){var a;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r()(a=GameSDK.getSupportedAPIs()).call(a,"checkCanPlayerMatchAsync")){t.next=4;break}return t.abrupt("return",!1);case 4:return t.next=6,GameSDK.checkCanPlayerMatchAsync();case 6:if(t.sent){t.next=9;break}return t.abrupt("return",!1);case 9:return t.next=11,GameSDK.matchPlayerAsync(e,n,i);case 11:return t.abrupt("return",!0);case 14:return t.prev=14,t.t0=t.catch(0),t.abrupt("return",!1);case 17:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e,n,i){return t.apply(this,arguments)}}(),e.setLoadingProgress=function(t){GameSDK.setLoadingProgress(t)},e.getLocale=function(){return GameSDK.getLocale()||"en"},e.injectTournament=function(){var t=(0,i.default)(o().mark((function t(){var e;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!GameCore.Configs.Tournament.UseMock){t.next=8;break}return t.next=4,n.e(357).then(n.bind(n,569));case 4:e=t.sent.default,this.facebook.tournament=new e,t.next=9;break;case 8:this.facebook.tournament=new u;case 9:this.facebook.getTournamentAsync=this.getTournamentAsync,this.facebook.requestTournamentAsync=this.requestTournamentAsync;case 11:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),e.getTournamentAsync=function(){var t=(0,i.default)(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.getTournamentAsync();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t}();e.default=d},47:function(t,e,n){"use strict";n.r(e),n.d(e,{AnalyticsEvents:function(){return i}});var i={BUTTON_CLICK:"button_click",SCREEN_OPEN:"screen_open",LOAD_START:"load_start",LOAD_COMPLETE:"load_complete",APP_READY:"app_ready",TUTORIAL_BEGIN:"tutorial_begin",TUTORIAL_STEP:"tutorial_step",TUTORIAL_COMPLETE:"tutorial_complete",MATCH_START:"match_start",MATCH_RESCUE:"match_rescue",MATCH_END:"match_end",LEVEL_START:"level_start",LEVEL_RESCUE:"level_rescue",LEVEL_END:"level_end",SHARE:"share",MESSAGE:"message",INVITE:"invite",SHORTCUT_CREATE:"shortcut_create",SHORTCUT_CREATE_POPUP:"shortcut_create_popup",BOT_SUBSCRIBE:"bot_subscribe",BOT_SUBSCRIBE_POPUP:"bot_subscribe_popup",AD_SHOW:"ad_show",AD_SHOW_FAILED:"ad_show_failed",NEW_USER:"new_user",AD_IMPRESSION:"ad_impression",JOIN_GROUP:"join_group",DAILY_CHALLENGE_BEGIN:"daily_challenge_begin",DAILY_CHALLENGE_FAIL:"daily_challenge_fail",DAILY_CHALLENGE_END:"daily_challenge_end",TOURNAMENT_SHARE:"tournament_share",TOURNAMENT_CREATE:"tournament_create",TOURNAMENT_POST_SCORE:"tournament_post_score"}},62:function(t,e,n){"use strict";n.r(e);var i=n(121),a=function(){function t(t,e){if(this.scene=void 0,this.config=void 0,this.isStarted=void 0,this.tween=void 0,!(e.targets.length<1)){this.buildConfig(t,e);var n=this.config.targets[0].scene;n&&(this.scene=n,this.isStarted=!1,this.tween=n.tweens.create(this.config))}}var e=t.prototype;return e.buildConfig=function(t,e){this.config=(0,i.merge)(t,e)},e.play=function(){this.tween&&(this.isStarted&&this.tween.hasStarted?this.restart():(this.tween.play(),this.isStarted=!0))},e.restart=function(){var t;null==(t=this.tween)||t.restart()},e.stop=function(){var t;null==(t=this.tween)||t.stop()},e.remove=function(){var t;null==(t=this.tween)||t.remove()},e.next=function(t){return this.tween?(this.tween.off(Phaser.Tweens.Events.TWEEN_COMPLETE,t),this.tween.once(Phaser.Tweens.Events.TWEEN_COMPLETE,t),this.tween):null},t}();e.default=a},464:function(t,e,n){"use strict";n.r(e);var i=n(4),a=n(0),r=n(62),s={targets:[],repeat:-1,yoyo:!0,duration:33,ease:Phaser.Math.Easing.Sine.InOut,props:{x:5}},o=function(t){function e(e){var n,a,r;return(r=t.call(this,s,e)||this).posX=void 0,r.handleSwitchPosition=function(){var t;r.posX=-r.posX,null==(t=r.tween)||t.updateTo("x",-r.posX)},null!=(n=r.config)&&n.props?(r.posX=r.config.props.x,null==(a=r.tween)||a.on(Phaser.Tweens.Events.TWEEN_REPEAT,r.handleSwitchPosition),r):(0,i.default)(r)}return(0,a.default)(e,t),e}(r.default);e.default=o},458:function(t,e,n){"use strict";n.r(e);var i=n(0),a=n(62),r={targets:[],duration:400,ease:n(255).default,props:{scale:"-=0.1"}},s=function(t){function e(e){return t.call(this,r,e)||this}return(0,i.default)(e,t),e}(a.default);e.default=s},482:function(t,e,n){"use strict";n.r(e);var i=n(0),a=n(62),r={targets:[],duration:400,ease:n(255).default,props:{scale:"+=0.1"}},s=function(t){function e(e){return t.call(this,r,e)||this}return(0,i.default)(e,t),e}(a.default);e.default=s},255:function(t,e,n){"use strict";n.r(e);var i=n(328),a=n.n(i)()(.48,1.57,.6,.83);e.default=a},10:function(t,e,n){"use strict";n.r(e);var i=n(112),a=n(4),r=n(0),s=n(47),o=n(458),h=n(36),c=n(24),l=n(28),u=function(t){function e(e,n,i,r,s,l){var u;return void 0===l&&(l=!1),(u=t.call(this,e)||this).useSound=!0,u.isClicked=!1,u.scaleUp=-1,u.scaleDown=-1,u.button=void 0,u.upAnimation=void 0,u.downAnimation=void 0,u.isUsePixelPerfect=!1,u.hitArea=void 0,u.hitZone=void 0,u.scaleDownPress=void 0,u.parentName=void 0,u.handelObjectDestroy=function(){u.scene&&u.scene.events.off(Phaser.Scenes.Events.SLEEP,u.handleSceneSleep)},u.handleSceneSleep=function(){u.scene&&u.scene.tweens.killTweensOf((0,a.default)(u))},u.handlePointerDown=function(){var t,e;u.isClicked||null!=(t=u.upAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(u.isClicked=!0,u.runDownAnimation())},u.handleOnClick=function(t){return function(){var e,n,i,a;u.isClicked&&(null!=(e=u.upAnimation)&&null!=(n=e.tween)&&n.isPlaying()||(u.isClicked=!1,u.runUpAnimation(),null==(i=u.upAnimation)||null==(a=i.tween)||a.once(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){u.logButtonEvent(),u.addDebugData(),u.processCallback(t)}))))}},u.handlePointerOut=function(){var t,e;u.isClicked&&(null!=(t=u.upAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(u.isClicked=!1,u.runUpAnimation()))},u.runDownAnimation=function(){var t;-1===u.scaleDown&&(u.scaleUp=u.scale,u.scaleDown=u.scaleDownPress),u.useSound&&u.scene.audio.playSound(c.default.BUTTON_CLICK),null==(t=u.downAnimation)||t.remove(),u.downAnimation=new o.default({targets:[(0,a.default)(u)],duration:150,props:{scale:u.scaleDown},onUpdate:function(){u.hitZone.scale=1/u.scale}}),u.downAnimation.play()},u.runUpAnimation=function(){var t;-1!==u.scaleUp&&(null==(t=u.upAnimation)||t.remove(),u.upAnimation=new o.default({targets:[(0,a.default)(u)],duration:150,props:{scale:u.scaleUp},onUpdate:function(){u.hitZone.scale=1/u.scale}}),u.upAnimation.play())},u.isUsePixelPerfect=l,u.setDepth(h.default.BUTTON),u.createButton(n,i,r,s),u.updateSize(),u.listenEvents(),u.scene.add.existing((0,a.default)(u)),u}(0,r.default)(e,t);var n=e.prototype;return n.listenEvents=function(){this.scene.events.on(Phaser.Scenes.Events.SLEEP,this.handleSceneSleep),this.once(Phaser.GameObjects.Events.DESTROY,this.handelObjectDestroy)},n.processCallback=function(t){var e,n,i;null==(e=this.upAnimation)||e.stop(),null==(n=this.downAnimation)||n.stop(),null==(i=this.scene)||i.tweens.killTweensOf(this),-1!==this.scaleUp&&this.setScale(this.scaleUp),t()},n.setDisabled=function(t){var e,n;t?(this.setAlpha(.5),null==(e=this.hitArea)||e.disableInteractive()):(this.setAlpha(1),null==(n=this.hitArea)||n.setInteractive())},n.createButton=function(t,e,n,i){this.button=this.scene.add.image(0,0,t,e),n&&i&&this.button.setWorldSize(n,i),this.scaleDownPress=this.scale-.1;var a=this.button,r=a.displayWidth,s=a.displayHeight;this.hitZone=this.scene.make.zone({displayWidth:r,displayHeight:s}),this.add([this.button,this.hitZone])},n.updateSize=function(){var t=this.button,e=t.width,n=t.height,i=e/100*10,a=n/100*10,r=i<10?i:10,s=a<10?a:10;this.setSize(e+r,n+s),this.hitZone.setSize(e+r,n+s)},n.addDebugData=function(){var t=this.getParentName(),e=this.name;(0,l.addBreadcrumbSentry)("ui-click",t+":"+e)},n.logButtonEvent=function(){var t=this.getParentName(),e=this.name;this.scene.analytics.event(s.AnalyticsEvents.BUTTON_CLICK,{button_name:e,screen_name:t})},n.getParentName=function(){if(this.parentName)return this.parentName;for(var t=this.parentContainer;t;){if(t instanceof GameCore.Screen){var e=t;return this.parentName=e.getScreenName(),this.parentName}t=t.parentContainer}return this.parentName=this.scene.getSceneName(),this.parentName},(0,i.default)(e,[{key:"onClick",set:function(t){this.isUsePixelPerfect?(this.hitArea=this.button,this.hitArea.setInteractive({useHandCursor:!0,pixelPerfect:!0})):(this.hitArea=this.hitZone,this.updateSize(),this.hitArea.setInteractive({useHandCursor:!0})),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handlePointerDown),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleOnClick(t)),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handlePointerOut)}},{key:"isUsePixelPerFect",get:function(){return this.isUsePixelPerfect}}]),e}(Phaser.GameObjects.Container);e.default=u},465:function(t,e,n){"use strict";n.r(e);var i=n(11),a=n(112),r=n(4),s=n(0),o=n(43),h=n.n(o),c=n(246),l=n.n(c),u=n(85),d=n.n(u),p=n(30),f=n.n(p),g=n(38),m=n.n(g),v=n(110),y=n.n(v),S=n(97),A=n.n(S),E=n(146),x=n.n(E),b=n(36),T=n(441);function w(t,e){var n="undefined"!==typeof A()&&x()(t)||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){var n;if(!t)return;if("string"===typeof t)return C(t,e);var i=m()(n=Object.prototype.toString.call(t)).call(n,8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return y()(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return C(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function C(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var M=function(t){function e(e,n){var a,s;(s=t.call(this,e)||this).config=void 0,s.isEnable=void 0,s.maxHeight=void 0,s.isScrolling=void 0,s.boundTop=void 0,s.boundBottom=void 0,s.maskGraphics=void 0,s.objects=void 0,s._value=0,s.velocity=0,s.isScrollingSmooth=void 0,s.lastScrollY=void 0,s.isScrollingBack=void 0,s.scrollingBackTo=void 0,s.lastScrollYCount=0,s.hitArea=void 0,s.onScrollEvents=[],s.update=function(t,e){s.isScrollingSmooth&&s.velocity&&s.scrollingSmooth(e),s.isScrollingBack&&s.scrollingBack(e)},s.checkReachBound=function(){return s.isReachTop()||s.isReachBottom()},s.onMouseScroll=(0,T.debounce)((function(t,e,n){if(s.isEnable){var i;if(s.isScrolling=!0,s.checkReachBound())return s.lastScrollY=h()(i=s.lastScrollY).call(i,(function(){return 0})),void(s.isScrolling=!1);s.stopScrollingBack(),s.startScrollSmooth(-n*s.scrollSmooth/15)}}),100,{isImmediate:!0,maxWait:100}),s.onTouchScroll=function(t){if(s.isEnable){s.velocity&&s.stopScrollSmooth(),s.stopScrollingBack(),s.isScrolling=!0;var e=s.scene.game.world.getZoomRatio(),n=t.position,i=t.prevPosition,a=(n.y-i.y)/e,r=s.height*s.maxScrollOver,o=1;if(s.lastScrollY[++s.lastScrollYCount%s.lastScrollY.length]=a,s.isReachTop()&&a>=0){var h=(r-(s.value-s.marginTop))/r;o=Math.min(o,h)}if(s.isReachBottom()&&a<=0){var c=(r-(-s.maxHeight-s.value))/r;o=Math.min(o,c)}var l=a*o,u=s.maxScrollOver*s.height;s.value+l>s.marginTop+u?s.value=s.marginTop+u:s.value+l<-s.maxHeight-u?s.value=-s.maxHeight-u:s.value+=l,s.callOnScrollEvents(s.value,l)}},s.onTouchDown=function(){s.isEnable&&(s.velocity&&s.stopScrollSmooth(),s.stopScrollingBack())},s.onTouchEnd=function(){var t,e;if(s.isReachTop()&&(s.startScrollingBack(s.marginTop),s.stopScrollSmooth()),s.isReachBottom()&&(s.startScrollingBack(-s.maxHeight),s.stopScrollSmooth()),s.isScrolling){var n=l()(t=s.lastScrollY).call(t,(function(t,e){return t+e}))/s.lastScrollY.length;s.startScrollSmooth(n*s.scrollSmooth),s.lastScrollY=h()(e=s.lastScrollY).call(e,(function(){return 0}))}},s.config=(0,i.default)({marginTop:0,marginBottom:0,acceleration:1400,maxScrollOver:.15,scrollSmooth:40,scrollingBackRate:5,useMask:!0},n);var o=n.width,c=n.height;return s.isEnable=!1,s.maxHeight=0,s.lastScrollY=d()(a=new Array(3)).call(a,0),s.setSize(o,c),s.createGroup(),s.createInput(),s.createEvents(),s.scene.add.existing((0,r.default)(s)),s}(0,s.default)(e,t);var n=e.prototype;return n.onScroll=function(t){this.onScrollEvents.push(t)},n.gotoTop=function(){this.value=this.config.marginTop},n.reset=function(){this.maxHeight=0,this.isScrolling=!1,this.isScrollingBack=!1,this.isScrollingSmooth=!1,this.gotoTop(),this.setEnable(!1)},n.createDebug=function(){this.drawDebugBox(16711680,.8)},n.setEnable=function(t){this.isEnable=t,t?this.setInteractive({draggable:!0,useHandCursor:!0}):this.disableInteractive()},n.addItem=function(t){this.addAt(t),this.objects.add(t);var e=t.y+t.height+this.marginBottom-this.height/2;this.maxHeight=Math.max(this.maxHeight,e,0),this.updateObjectVisible()},n.addItems=function(t){var e=this;this.addAt(t),this.objects.addMultiple(t);var n=h()(t).call(t,(function(t){return t.y+t.height+e.marginBottom-e.height/2}));this.maxHeight=Math.max(this.maxHeight,Math.max.apply(Math,n),0),this.updateObjectVisible()},n.clearItem=function(){this.objects.clear(!0,!0),this.reset()},n.getChildren=function(){var t;return f()(t=this.objects.getChildren()).call(t,(function(t){return t.active}))},n.createBound=function(t,e,n,i){this.boundTop=this.scene.make.image({key:t,frame:e}),this.boundBottom=this.scene.make.image({key:t,frame:e}),i&&(this.boundTop.setTint(i),this.boundBottom.setTint(i)),this.boundTop.setAlpha(0,0,0,0),this.boundBottom.setAlpha(0,0,0,0),this.boundTop.setDepth(b.default.PRIORITY),this.boundBottom.setDepth(b.default.PRIORITY);var a=this.width,r=n,s=this.getWorldPosition(),o=s.x,h=s.y;this.boundTop.setDisplaySize(a,r),this.boundBottom.setDisplaySize(a,r),this.boundTop.setY(-this.displayHeight/2+r/2+h-this.y-1),this.boundBottom.setY(this.displayHeight/2-r/2+h-this.y+1),this.boundTop.setX(o-this.x),this.boundBottom.setX(o-this.x),this.add([this.boundTop,this.boundBottom])},n.createMask=function(){var t;null==(t=this.maskGraphics)||t.destroy(),this.maskGraphics=this.scene.make.graphics({fillStyle:{color:255,alpha:1},visible:!0}),this.maskGraphics.setName("MaskGraphics");var e=this.width,n=this.height;this.maskGraphics.fillRoundedRect(0-e/2,0-n/2,e,n,0),this.config.useMask&&this.setMask(this.maskGraphics.createGeometryMask()),this.scene.events.off(Phaser.Scenes.Events.UPDATE,this.updateMask,this),this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.updateMask,this)},n.updateMask=function(){var t=this.getWorldPosition(),e=t.x,n=t.y;this.maskGraphics.setPosition(e,n)},n.createGroup=function(){this.objects=this.scene.make.group({})},n.updateObject=function(t){this.objects.incY(t),this.updateObjectVisible()},n.updateObjectVisible=function(){for(var t=this.objects.getChildren(),e=0;e<t.length;e++){var n=t[e];n.y+n.height<-this.height/2||n.y-n.height>this.height/2?n.setVisible(!1):n.setVisible(!0)}},n.createInput=function(){this.setInteractive({draggable:!0,useHandCursor:!0}),this.on(Phaser.Input.Events.POINTER_WHEEL,this.onMouseScroll),this.on(Phaser.Input.Events.GAMEOBJECT_DRAG,this.onTouchScroll),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.onTouchDown),this.scene.input.on(Phaser.Input.Events.POINTER_UP,this.onTouchEnd,this)},n.createEvents=function(){this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.update)},n.callOnScrollEvents=function(t,e){for(var n,i=w(this.onScrollEvents);!(n=i()).done;){(0,n.value)(this,t,e)}},n.scrollingBack=function(t){var e=(this.scrollingBackTo-this.value)*t*this.scrollingBackRate/1e3;this.value+=e,Math.abs(this.scrollingBackTo-this.value)<.5&&(this.value=this.scrollingBackTo,this.stopScrollingBack()),this.callOnScrollEvents(this.value,e)},n.startScrollingBack=function(t){this.isScrollingBack=!0,this.scrollingBackTo=t},n.stopScrollingBack=function(){this.isScrollingBack=!1},n.scrollingSmooth=function(t){var e=this.velocity*t/1e3;this.value+=e;var n=Math.abs(this.velocity)/this.velocity;this.velocity-=n*this.acceleration*t/1e3,Math.abs(this.velocity)<this.acceleration*t/1e3&&this.stopScrollSmooth(),this.isReachTop()&&(this.startScrollingBack(this.marginTop),this.stopScrollSmooth()),this.isReachBottom()&&(this.startScrollingBack(-this.maxHeight),this.stopScrollSmooth()),this.callOnScrollEvents(this.value,e)},n.startScrollSmooth=function(t){this.isScrollingSmooth=!0,t&&(t*this.velocity>0?this.velocity+=t:this.velocity=t)},n.stopScrollSmooth=function(){this.isScrollingSmooth=!1,this.isScrolling=!1,this.velocity=0},n.isReachTop=function(){return this.value>this.marginTop},n.isReachBottom=function(){return-this.value>this.maxHeight},(0,a.default)(e,[{key:"marginTop",get:function(){return this.config.marginTop}},{key:"marginBottom",get:function(){return this.config.marginBottom}},{key:"acceleration",get:function(){return this.config.acceleration}},{key:"maxScrollOver",get:function(){return this.config.maxScrollOver}},{key:"scrollSmooth",get:function(){return this.config.scrollSmooth}},{key:"scrollingBackRate",get:function(){return this.config.scrollingBackRate}},{key:"value",get:function(){return this._value},set:function(t){var e=t-this._value;this._value=t,this.updateObject(e)}}]),e}(Phaser.GameObjects.Container);e.default=M},71:function(t,e,n){"use strict";n.r(e);var i=n(1).default.EFFECTS,a=i.KEY,r=i.FRAME,s={CONFETTI_HEXAGON:{KEY:"confetti-hexagon-animation",TEXTURE:a,PREFIX:r.FX_CONFETTI_HEXAGON,FRAME_RATE:8,END:5,ZERO_PAD:0},CONFETTI_STAR_X:{KEY:"confetti-star-x",TEXTURE:a,PREFIX:r.ANIMATION_STAR_X,FRAME_RATE:4,END:4,ZERO_PAD:0},CONFETTI_STAR_Y:{KEY:"confetti-star-y",TEXTURE:a,PREFIX:r.ANIMATION_STAR_Y,FRAME_RATE:4,END:4,ZERO_PAD:0},RIBBON_A:{KEY:"animation-ribbon-a",TEXTURE:a,PREFIX:r.PREFIX_ANIMATION_RIBBON_CONFETTI_A,FRAME_RATE:16,END:3,ZERO_PAD:0},RIBBON_B:{KEY:"animation-ribbon-b",TEXTURE:a,PREFIX:r.PREFIX_ANIMATION_RIBBON_CONFETTI_B,FRAME_RATE:16,END:4,ZERO_PAD:0},RIBBON_C:{KEY:"animation-ribbon-c",TEXTURE:a,PREFIX:r.PREFIX_ANIMATION_RIBBON_CONFETTI_C,FRAME_RATE:16,END:4,ZERO_PAD:0},RIBBON_D:{KEY:"animation-ribbon-d",TEXTURE:a,PREFIX:r.PREFIX_ANIMATION_RIBBON_CONFETTI_D,FRAME_RATE:16,END:4,ZERO_PAD:0}};e.default=s},36:function(t,e,n){"use strict";n.r(e);e.default={BACKGROUND:1,FIREWORKS:5,ITEM:10,LOGO:15,BUTTON:20,TILE:25,TEXT:30,ENCOURAGING:31,EFFECT:32,MESSAGE:33,POPUP:999,PRIORITY:80,DEBUG:90,DICE:99,PIECE:99,ON_TOP:1e4}},247:function(t,e,n){"use strict";n.r(e);e.default={min:18,max:60}},13:function(t,e,n){"use strict";n.r(e);e.default={PRIMARY:{KEY:"font-main",TEXTURE:"./assets/fonts/primary.png",DATA:"./assets/fonts/primary.xml"},PRIMARY_LIGHT:{KEY:"font-main-light",TEXTURE:"./assets/fonts/primary-light.png",DATA:"./assets/fonts/primary-light.xml"},NUMBER_LIGHT:{KEY:"number-light",TEXTURE:"./assets/fonts/number-light.png",DATA:"./assets/fonts/number-light.xml"},NUMBER_DARK:{KEY:"number-dark",TEXTURE:"./assets/fonts/number-dark.png",DATA:"./assets/fonts/number-dark.xml"},FONT_FAMILY:'-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif',FONT_FAMILY_ARIAL:"Arial"}},122:function(t,e,n){"use strict";n.r(e);var i={AVATAR:{KEY:"avatar",FILE:"./assets/images/others/avatar.png",CONFIG:{}},ICON_EARTH:{KEY:"icon-earth",FILE:"./assets/images/others/icon-earth.png",CONFIG:{}},BACKGROUND:{KEY:"background",FILE:"./assets/images/"+(0,n(445).getImageScale)()+"x/bg.jpg",CONFIG:{}}};e.default=i},1:function(t,e,n){"use strict";n.r(e);var i=n(11),a=(0,n(445).getImageScale)(),r={TUTORIAL:{KEY:"tutorial-resources",TEXTURE:"./assets/textures/"+a+"x/tutorial-resources.png",JSON:"./assets/textures/"+a+"x/tutorial-resources.json",FRAME:{HAND:"hand",BLANK:"blank",BUTTON_BROWN:"brown"}},DEFAULT:{KEY:"default-resources",TEXTURE:"./assets/textures/"+a+"x/default-resources.png",JSON:"./assets/textures/"+a+"x/default-resources.json",URL:"./assets/textures/"+a+"x/",FRAME:{BLANK:"blank",LOGO:"logo",TEXT_LOADING:"loading",BORDER_BOTTOM_PANEL:"border-bottom-panel",BOTTOM_PANEL:"bottom-panel",BOTTOM_LINE:"bottom-line",GLARE:"glare",TITLE_YOUR_SCORE:"title-your-score",BG_YOUR_SCORE:"bg-your-score",LEAF:"leaf",BEST_SCORE_FRAME:"best-score-frame",BEST_SCORE_FRAME_LONG:"best-score-frame-long",FOOTER:"footer",SCORE_PANEL:"score-panel",SCORE_PANEL_DARK:"score-panel-dark",BG_PROGRESS_CIRCLE:"bg-progress-circle",BG_TEXT_TARGET_PANEL:"text-target-panel",WOOD_PANEL:"wood-panel",BORDER_DAILY:"border-daily",BG_STREAK:"bg-streak",BG_COMBO:"bg-combo",LEVEL_PLAYED:"bg/level-played",LEVEL_PLAYING:"bg/level-playing",LEVEL_LOCKED:"bg/level-locked",BG_DARK:"bg/bg-dark",BG_TOP:"bg/bg-top",BG_MIDDLE:"bg/bg-middle",BG_BOTTOM:"bg/bg-bottom",PRELOADER:"preloader/dual-ring",LEADERBOARD_TAB_ON:"leaderboards/tab-on",LEADERBOARD_TAB_OFF:"leaderboards/tab-off",LEADERBOARD_BG_TOP:"leaderboards/bg-top",LEADERBOARD_BG_MIDDLE:"leaderboards/bg-middle",LEADERBOARD_BG_BOTTOM:"leaderboards/bg-bottom",LEADERBOARD_BG_ITEM:"leaderboards/bg-item",LEADERBOARD_BORDER_LEFT:"leaderboards/border-left",LEADERBOARD_BORDER_RIGHT:"leaderboards/border-right",PREFIX_LEADERBOARD_BG_ITEM:"leaderboards/bg-item-",PREFIX_LEADERBOARD_BG_ITEM_0:"leaderboards/bg-item-0",AVATAR_BORDER:"avatar/border",AVATAR_BORDER_BIG:"avatar/border-big",AVATAR_BORDER_CHALLENGE:"avatar/border-challenge",AVATAR_BACKGROUND:"avatar/background",POPUP_TOP:"popup/top",POPUP_TOP_DARK:"popup/top-dark",POPUP_MID:"popup/middle",POPUP_BOTTOM:"popup/bottom",POPUP_CONTENT_BACKGROUND:"popup/background",POPUP_SCORE_PANEL:"popup/score-panel",ICON_ADS:"icons/flat-ad",ICON_CUP_GOLD:"icons/cup-gold",ICON_CUP_SILVER:"icons/cup-silver",ICON_CUP_COPPER:"icons/cup-bronze",ICON_SOUND:"icons/sound",ICON_VIBRATE:"icons/vibrate",ICON_MUSIC:"icons/music",ICON_RANK:"icons/rank",ICON_PLAY:"icons/play",ICON_I_PLAY:"icons/i-play",ICON_PLAY_GREEN:"icons/play-green",ICON_SHARE:"icons/share",ICON_INVITE:"icons/invite",ICON_FLAG:"icons/milestone",ICON_BROWN_JOURNEY:"icons/brown-journey",ICON_WHITE_JOURNEY:"icons/white-journey",ICON_SWORD:"icons/sword",ICON_SWORD_BLUE:"icons/sword-blue",ICON_SETTING:"icons/setting",ICON_REPLAY:"icons/replay",ICON_RETRY:"icons/retry",ICON_HOME:"icons/home",ICON_BACK:"icons/back",ICON_BATTLE:"icons/battle",ICON_CUP:"icons/cup",ICON_SHARE_BLUE:"icons/share-blue",ICON_CROWN:"icons/crown",ICON_CROWN_BIG:"icons/crown-big",ICON_CLOCK:"icons/clock",ICON_DAILY:"icons/icon-daily",ICON_JOURNEY:"icons/icon-journey",ICON_JOURNEY_2:"icon-journey",ICON_DOT_RED:"icons/dot",ICON_STAR:"icons/star",ICON_PLUS:"icons/plus",ICON_CHECK:"icons/check",BUTTON_CLOSE:"buttons/close",BUTTON_RED:"buttons/red",BUTTON_BLUE:"buttons/blue",BUTTON_BLUE_SMALL:"buttons/blue-small",BUTTON_BLUE_MEDIUM:"buttons/blue-medium",BUTTON_GREEN:"buttons/green",BUTTON_GREEN_BIG:"buttons/green-big",BUTTON_DARK_BLUE:"buttons/dark-blue",BUTTON_DARK_BLUE_BIG:"buttons/dark-blue-big",BUTTON_BROWN:"buttons/brown",BUTTON_GREEN_LARGE:"buttons/green-large",BUTTON_PLAY:"buttons/play",BUTTON_RANDOM:"buttons/random",BUTTON_CHALLENGE_LIGHT:"buttons/challenge_light",BUTTON_SHARE_DARK:"buttons/share",BUTTON_MINOR:"buttons/minor",BUTTON_CIRCLE:"buttons/circle-button",BUTTON_TOGGLE_OFF:"buttons/toggle-off",BUTTON_TOGGLE_ON:"buttons/toggle-on",BUTTON_DARK_BLUE_SMALL:"buttons/dark-blue-small",BUTTON_DOT_BLUE:"buttons/dot-blue",BUTTON_DOT_GREEN:"buttons/dot-green",DAILY_BORDER:"daily-challenge/border",DAILY_BACKGROUND:"daily-challenge/bg",DAILY_TITLE_PANEL:"daily-challenge/title-panel",DAILY_BORDER_TOP:"daily-challenge/top-panel",DAILY_BORDER_MIDDLE:"daily-challenge/middle-panel",DAILY_BORDER_BOTTOM:"daily-challenge/bottom-panel",DAILY_BG_ITEM_LIGHT:"daily-challenge/bg-item-light",DAILY_BG_ITEM_DARK:"daily-challenge/bg-item-dark",DAILY_BG_TIME:"daily-challenge/time-panel",NO_THANK_TEXT:"texts/no-thank",TEXT_SECOND_CHANGE:"texts/second-chance",TEXT_VS:"texts/vs",TEXT_LOSE:"texts/lose",TEXT_WIN:"texts/win",TEXT_DRAW:"texts/draw",TEXT_CONTINUE:"texts/continue",TEXT_LEADER_BOARD:"texts/leader-board",TEXT_WORLD:"texts/world",TEXT_WORLD_DISABLE:"texts/world-disable",TEXT_FRIENDS:"texts/friends",TEXT_FRIENDS_DISABLE:"texts/friends-disable",TEXT_PLAY_WITH:"texts/play-with",TEXT_PLAY_WITH_BLUE:"texts/play-with-blue",TEXT_JOURNEY:"texts/text-journey",TEXT_SETTING:"texts/setting",TEXT_OFF:"texts/off",TEXT_ON:"texts/on",TEXT_REPLAY:"texts/replay",TEXT_YOUR_SCORE:"texts/your-score",TEXT_WAITING_OPPONENT:"texts/waiting-for-opponent",TEXT_SINGLE:"texts/play-single",TEXT_RETRY:"texts/text-retry",TEXT_LEVEL_FAIL:"texts/level-failed",TEXT_CONGRATULATION:"texts/congratulations",TEXT_NEXT_LEVEL:"texts/text-next-level",TEXT_SHARE_BLUE:"texts/text-share",TEXT_CLOSE_BLUE:"texts/text-close",TEXT_PLAY:"texts/play",TEXT_MISSION:"texts/mission",TEXT_NEXT_MILESTONE:"texts/next-milestone",TEXT_FIRST_MILESTONE:"texts/first-milestone",TEXT_COLLECT:"texts/collect",TEXT_YES:"texts/yes",TEXT_NO:"texts/no",TEXT_TUTORIAL:"texts/text-tutorial",TEXT_DAILY_CHALLENGE:"texts/daily-challenge",TEXT_RESULT:"texts/result",TEXT_RANKING:"texts/text-ranking",TEXT_NEW_BEST:"texts/new-best",TEXT_INVITE_FRIENDS:"texts/invite-friends",TEXT_KEEP_PLAYING:"texts/keep-playing",TEXT_OUT_OF_LIVE:"texts/out-of-live",TEXT_REFILL_LIVES:"texts/refill-lives",LIVES_HEART:"lives/heart",LIVES_TIME_BLOCK:"lives/time-block",LIVES_TIME_BLOCK_2:"lives/time-block-2"}},EFFECTS:{KEY:"effects-resources",PATH:"./assets/textures/"+a+"x/effects-resources.png",JSON:"./assets/textures/"+a+"x/effects-resources.json",FRAME:{BLANK:"blank",GLOW_CIRCLE:"glow-circle",GLARE_CROSS:"glare-cross",DUST:"dust",DUST_YELLOW:"dust-yellow",FX_STAR:"star",FX_STAR_YELLOW:"star-yellow",FX_CONFETTI_SMALL_1:"confetti/small-1",FX_CONFETTI_SMALL_2:"confetti/small-2",FX_CONFETTI_SMALL_3:"confetti/small-3",FX_CONFETTI_SMALL_4:"confetti/small-4",FX_CONFETTI_HEXAGON:"confetti/hexagon-",FX_CONFETTI_RIBBON:"ribbon",TEXT_COOL:"text/text_cool",TEXT_EXCELLENT:"text/text_excellent",TEXT_GOOD:"text/text_good",FX_COMET:"comet",FX_SPARK:"spark",FX_CIRCLE:"circle",FX_CIRCLE_LIGHT:"circle-light",FX_GLOW_LIGHT:"glow-light",FX_GLOW_SMALL:"glow-small",FX_STAR_WHITE:"star-white",FX_FIREWORKS_SMALL:"fireworks/small",FX_FIREWORKS_BIG_0:"fireworks/big-explosive-0",FX_FIREWORKS_BIG_1:"fireworks/big-explosive-1",FX_FIREWORKS_SOAR_LINE:"fireworks/soar-line",FX_FIREWORKS_SOAR_CIRCLE:"fireworks/soar-circle",PREFIX_ANIMATION_RIBBON_CONFETTI_A:"ribbon/falling-confetti/confetti-a/confetti-a-",PREFIX_ANIMATION_RIBBON_CONFETTI_B:"ribbon/falling-confetti/confetti-b/confetti-b-",PREFIX_ANIMATION_RIBBON_CONFETTI_C:"ribbon/falling-confetti/confetti-c/confetti-c-",PREFIX_ANIMATION_RIBBON_CONFETTI_D:"ribbon/falling-confetti/confetti-d/confetti-d-",ANIMATION_STAR_X:"star-x/star-",ANIMATION_STAR_Y:"star-y/star-"}},ANIMATION_SCENE:{KEY:"effects-resources",PATH:"./assets/textures/"+a+"x/",JSON:"./assets/textures/"+a+"x/animation-scene-resources.json",FRAME:{BLANK:"blank",COIN:"coins/coin",COIN_SMALL:"coins/coin-small",COIN_SMALL_GREY:"coins/coin-small-grey",FX_SPARK_YELLOW:"yellow-spark",FX_CONFETTI_RIBBON:"ribbon/ribbon"}},GAMEPLAY:{KEY:"gameplay-resources",TEXTURE:"./assets/textures/"+a+"x/gameplay-resources.png",JSON:"./assets/textures/"+a+"x/gameplay-resources.json",FRAME:{BLANK:"blank",BG_SCORE:"bg-score",BG_MAIN_SCORE:"bg-main-score",BOARD:"board",VIOLET_GLOW:"violet-glow",MASK:"mask",FLAG:"flag",DUST:"dust",CUP_GLARE:"cup-glare",HAND:"hand",AVATAR_BORDER:"avatars/border",AVATAR_BACKGROUND:"avatars/background",ICON_SETTING:"icons/setting",ICON_CUP:"icons/cup",ICON_CHECK:"icons/check",ICON_STAR:"icons/star",ICON_STAR_1:"icons/star-1",ICON_HOME:"icons/home",ICON_ADD_FRIEND:"icons/add-friends",ICON_BATTLE:"icons/battle",TEXT_NEXT_LEVEL:"text/next-level",BUTTON_WOOD_SMALL:"buttons/wood-small",BUTTON_SKIP:"buttons/button-skip",PROGRESS_BG_LEFT:"progress/bg-left",PROGRESS_BG_MID:"progress/bg-mid",PROGRESS_BG_RIGHT:"progress/bg-right",PROGRESS_BAR_LEFT:"progress/bar-left",PROGRESS_BAR_MID:"progress/bar-mid",PROGRESS_BAR_RIGHT:"progress/bar-right",PROGRESS_BAR_RIGHT_WHITE:"progress/bar-right-white"}},GAMEPLAY_32:{KEY:"gameplay-32-resources",TEXTURE:"./assets/textures/"+a+"x/gameplay-32-resources.png",JSON:"./assets/textures/"+a+"x/gameplay-32-resources.json",FRAME:{GEM:"gem/gem",GEM_LIGHT:"gem/gem_light",GEM_SILVER:"gem/gem_silver",GEM_TRANSPARENT:"gem/gem_transparent",GEM_WHITE:"gem/gem_white",GEM_GLARE:"gem/gem_glare",GEM_HIGHT_LIGHT:"gem/gem_highlight",GEM_DIAMOND_10:"gem/diamond/diamond-10",GEM_DIAMOND_11:"gem/diamond/diamond-11",GEM_DIAMOND_12:"gem/diamond/diamond-12",GEM_DIAMOND_13:"gem/diamond/diamond-13",GEM_DIAMOND_14:"gem/diamond/diamond-14",GEM_DIAMOND_15:"gem/diamond/diamond-15",GEM_DIAMOND_10_LIGHT:"gem/diamond/diamond-10_light",GEM_DIAMOND_11_LIGHT:"gem/diamond/diamond-11_light",GEM_DIAMOND_12_LIGHT:"gem/diamond/diamond-12_light",GEM_DIAMOND_13_LIGHT:"gem/diamond/diamond-13_light",GEM_DIAMOND_14_LIGHT:"gem/diamond/diamond-14_light",GEM_DIAMOND_15_LIGHT:"gem/diamond/diamond-15_light",GEM_RUBY_20:"gem/ruby/ruby-20",GEM_SAPPHIRE_30:"gem/sapphire/sapphire-30",BLOCK_GRADIENT_PREFIX:"gem/block_gradient/block_color"}},DEMO_SPINE:{KEY:"demo-spine",jsonPATH:"./assets/spines/demo/demo.json",atlasPATH:"./assets/spines/demo/demo.atlas"}};GameCore.Utils.Valid.isDebugger()&&(r.EFFECTS.FRAME=(0,i.default)({},r.ANIMATION_SCENE.FRAME,r.EFFECTS.FRAME)),e.default=r},35:function(t,e,n){"use strict";n.r(e),n.d(e,{SceneKeys:function(){return s},SceneEvents:function(){return o},SceneDepth:function(){return i}});var i,a=n(97),r=n.n(a),s={BOOT_SCENE:"BOOT_SCENE",LOAD_SCENE:"LOAD_SCENE",GAME_SCENE:"GAME_SCENE",GLOBAL_SCENE:"GLOBAL_SCENE",DASHBOARD_SCENE:"DASHBOARD_SCENE",GAME_OVER_SCENE:"GAME_OVER_SCENE",LEADERBOARD_SCENE:"LEADERBOARD_SCENE",JOURNEY_SCENE:"JOURNEY_SCENE",LEVEL_SCENE:"LEVEL_SCENE",TEST_SCENE:"TEST_SCENE",ANIMATIONS_SCENE:"ANIMATIONS_SCENE"},o={SWITCH:r()("SWITCH"),LAUNCH:r()("LAUNCH"),RUN:r()("RUN")};!function(t){t[t.SCENE=0]="SCENE",t[t.POPUP=1]="POPUP"}(i||(i={}))},24:function(t,e,n){"use strict";n.r(e);e.default={BUTTON_CLICK:"button_click",CONGRATULATION:"congratulation",DAILY_REWARD:"daily_reward",GAME_OVER_SCENE:"game_over_scene",GAME_OVER:"game_over",POPUP_OFF:"popup_off",POPUP_SHOW:"popup_show",SCORE_COUNT:"score_count",PIECE_PICK:"piece_pick",PIECE_DROP:"piece_drop",PIECE_INVALID_MOVE:"piece_invalid_move",BOARD_GAME_OVER:"board_end",RESCUE_TIME:"rescue_timer",EAT_BLOCK:"eat_block",GOOD:"good",COOL:"cool",EXCELLENT:"excellent",SCORE_REACHED:"reach_score",TARGET_REACHED:"reach_goal",WAIT_OPPONENT:"wait_opponent",WIN:"win",LOSE:"lose",DRAW:"draw",FIREWORKS_BIG:"fireworks_big",FIREWORKS_SOAR:"fireworks_soar",FIREWORKS_SMALL:"fireworks_small"}},471:function(t,e,n){"use strict";n.r(e);var i=n(4),a=n(0),r=n(1),s=n(121),o=r.default.EFFECTS,h=o.KEY,c=o.FRAME,l=function(t){function e(e,n){var a;return(a=t.call(this,e,h,c.BLANK)||this).config=void 0,a.emitter=void 0,a.config=n||{},a.scene.add.existing((0,i.default)(a)),a}(0,a.default)(e,t);var n=e.prototype;return n.createEmitters=function(){var t=c.FX_CONFETTI_SMALL_1,e=c.FX_CONFETTI_SMALL_2,n=c.FX_CONFETTI_SMALL_3,i=c.FX_CONFETTI_SMALL_4,a=1/this.scene.world.getPixelRatio(),r={on:!1,particleBringToTop:!0,frame:[t,e,n,i],tint:[14223402,1021804,5420529,16702052],timeScale:1,frequency:300,maxParticles:120,gravityY:-10,speedX:{min:-100,max:100},speedY:{min:80,max:250},alpha:{start:1,end:.8},rotate:{start:0,end:1080},scale:{min:.8*a,max:2*a},angle:{min:20,max:160},lifespan:{min:8e3,max:12e3}},o=(0,s.merge)(r,this.config);this.emitter=this.createEmitter(o)},n.run=function(t,e,n){this.stop(),this.emitter.setQuantity(t),this.emitter.setPosition(e,n),this.emitter.start()},n.explode=function(t,e,n){this.emitter||this.createEmitters(),this.emitter.explode(t,e,n)},n.stop=function(){var t,e,n;null==(t=this.emitter)||t.killAll(),null==(e=this.emitter)||e.stop(),null==(n=this.emitter)||n.remove(),this.createEmitters()},e}(Phaser.GameObjects.Particles.ParticleEmitterManager);e.default=l},469:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return ut}});var i=n(11),a=n(4),r=n(0),s=n(1),o=n(71),h=o.default.RIBBON_A,c=h.KEY,l=h.TEXTURE,u=h.FRAME_RATE,d=h.END,p=h.PREFIX,f=h.ZERO_PAD,g=function(t){function e(e){var n={repeat:-1,frameRate:u,frames:e.generateFrameNames(l,{prefix:p,end:d,zeroPad:f,start:1}),yoyo:!0,showOnStart:!0};return t.call(this,e,c,n)||this}return(0,r.default)(e,t),e}(Phaser.Animations.Animation),m=o.default.RIBBON_B,v=m.KEY,y=m.TEXTURE,S=m.FRAME_RATE,A=m.END,E=m.PREFIX,x=m.ZERO_PAD,b=function(t){function e(e){var n={repeat:-1,frameRate:S,frames:e.generateFrameNames(y,{prefix:E,end:A,zeroPad:x,start:1}),yoyo:!0,showOnStart:!0};return t.call(this,e,v,n)||this}return(0,r.default)(e,t),e}(Phaser.Animations.Animation),T=o.default.RIBBON_C,w=T.KEY,C=T.TEXTURE,M=T.FRAME_RATE,I=T.END,P=T.PREFIX,k=T.ZERO_PAD,R=function(t){function e(e){var n={repeat:-1,frameRate:M,frames:e.generateFrameNames(C,{prefix:P,end:I,zeroPad:k,start:1}),yoyo:!0,showOnStart:!0};return t.call(this,e,w,n)||this}return(0,r.default)(e,t),e}(Phaser.Animations.Animation),O=o.default.RIBBON_D,_=O.KEY,D=O.TEXTURE,L=O.FRAME_RATE,B=O.END,F=O.PREFIX,N=O.ZERO_PAD,G=function(t){function e(e){var n={repeat:-1,frameRate:L,frames:e.generateFrameNames(D,{prefix:F,end:B,zeroPad:N,start:1}),yoyo:!0,showOnStart:!0};return t.call(this,e,_,n)||this}return(0,r.default)(e,t),e}(Phaser.Animations.Animation),U=o.default.CONFETTI_STAR_X,V=U.KEY,Y=U.TEXTURE,z=U.FRAME_RATE,H=U.END,W=U.PREFIX,X=U.ZERO_PAD,K=function(t){function e(e){var n={repeat:-1,frameRate:z,frames:e.generateFrameNames(Y,{prefix:W,end:H,zeroPad:X,start:1}),yoyo:!0,showOnStart:!0};return t.call(this,e,V,n)||this}return(0,r.default)(e,t),e}(Phaser.Animations.Animation),j=o.default.CONFETTI_STAR_Y,q=j.KEY,Z=j.TEXTURE,J=j.FRAME_RATE,Q=j.END,$=j.PREFIX,tt=j.ZERO_PAD,et=function(t){function e(e){var n={repeat:-1,frameRate:J,frames:e.generateFrameNames(Z,{prefix:$,end:Q,zeroPad:tt,start:1}),showOnStart:!0};return t.call(this,e,q,n)||this}return(0,r.default)(e,t),e}(Phaser.Animations.Animation),nt=n(43),it=n.n(nt),at=n(85),rt=n.n(at),st=function(t){function e(e){var n,i,a;(a=t.call(this,e)||this).scene=void 0,a.ribbon=void 0,a.graphics=void 0,a.colorUse=void 0,a.lastChange=void 0,a.currentFrame=void 0,a.isYoyo=void 0,a.isGravityChanged=void 0,a.points=void 0,a.scene=e.manager.scene;var r=a.emitter.manager,s=r.x,o=r.y;return a.points=it()(n=rt()(i=new Array(10)).call(i,null)).call(n,(function(){return{x:a.x+s,y:a.y+o}})),a.isYoyo=!1,a.isGravityChanged=!1,a.lastChange=0,a.currentFrame=-1,a.createGraphics(),a.randomRibbonUsedWhenFall(),a}(0,r.default)(e,t);var n=e.prototype;return n.randomRibbonUsedWhenFall=function(){switch(Phaser.Math.Between(0,3)){default:this.ribbon=this.scene.anims.get(o.default.RIBBON_A.KEY);break;case 1:this.ribbon=this.scene.anims.get(o.default.RIBBON_B.KEY);break;case 2:this.ribbon=this.scene.anims.get(o.default.RIBBON_C.KEY);break;case 3:this.ribbon=this.scene.anims.get(o.default.RIBBON_D.KEY)}},n.setRibbonPosition=function(t,e){var n;it()(n=this.points).call(n,(function(n){n.x=t,n.y=e}))},n.createGraphics=function(){var t=[8443204,2928867,12013036,16376097,15285798];this.colorUse=t[Phaser.Math.Between(0,t.length-1)],this.graphics=this.scene.add.graphics({lineStyle:{width:3,color:this.colorUse}});var e=this.emitter.manager,n=e.x,i=e.y,a=e.depth;this.graphics.setDepth(a),this.graphics.setPosition(n,i)},n.update=function(e,n,i){var a=t.prototype.update.call(this,e,n,i);return this.updateFrames(e),this.updatePoints(),this.updateGraphics(),this.updateGravity(),this.updateVelocity(),this.updateColor(),a},n.updateFrames=function(t){this.lastChange+=t,this.lastChange>=this.ribbon.msPerFrame&&(this.isYoyo?this.currentFrame--:this.currentFrame++,this.currentFrame<0&&(this.isYoyo=!1,this.currentFrame=1),this.currentFrame>=this.ribbon.frames.length&&(this.isYoyo=!0,this.currentFrame-=1),this.frame=this.ribbon.frames[this.currentFrame].frame,this.lastChange-=this.ribbon.msPerFrame)},n.updatePoints=function(){this.graphics.visible&&(this.points.shift(),this.points.push({x:this.x,y:this.y}))},n.updateGraphics=function(){this.graphics.visible&&(this.graphics.clear(),this.graphics.strokePoints(this.points))},n.updateGravity=function(){this.lifeCurrent>this.life-2e3||this.isGravityChanged||(this.isGravityChanged=!0,this.graphics.destroy(),this.emitter.setVisible(!0),this.emitter.setGravityY(45))},n.updateVelocity=function(){this.graphics.visible&&(this.lifeCurrent>this.life-1800?this.velocityX+=Phaser.Math.Between(-12,12):this.velocityX>0?this.velocityX+=Phaser.Math.Between(-10,6):this.velocityX+=Phaser.Math.Between(-6,10))},n.updateColor=function(){this.graphics.visible||(this.tint=this.colorUse)},e}(Phaser.GameObjects.Particles.Particle),ot=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.isYoyo=void 0,n.isGravityChanged=void 0,n.lastChange=void 0,n.currentFrame=void 0,n.star=void 0,n.starX=void 0,n.starY=void 0,n.isYoyo=!1,n.isGravityChanged=!1,n.lastChange=0,n.currentFrame=-1,n.scene=e.manager.scene,n.starX=n.scene.anims.get(o.default.CONFETTI_STAR_X.KEY),n.starY=n.scene.anims.get(o.default.CONFETTI_STAR_Y.KEY),n.star=n.starX,n}(0,r.default)(e,t);var n=e.prototype;return n.update=function(e,n,i){var a=t.prototype.update.call(this,e,n,i);return this.updateGravity(),this.updateVelocity(),this.updateFrameRate(),this.updateFrames(e),a},n.updateGravity=function(){this.lifeCurrent>this.life-2e3||this.isGravityChanged||(this.isGravityChanged=!0,this.emitter.setGravityY(15),this.emitter.setSpeedX(0))},n.updateVelocity=function(){this.lifeCurrent>this.life-2e3||(this.velocityX>0?this.velocityX+=Phaser.Math.Between(-6,3):this.velocityX+=Phaser.Math.Between(-3,6))},n.updateFrames=function(t){if(this.lastChange+=t,this.lastChange>=this.star.msPerFrame){var e=Phaser.Math.RND.between(0,1);this.star=e>0?this.starX:this.starY,this.isYoyo?this.currentFrame--:this.currentFrame++,this.currentFrame<0&&(this.isYoyo=!1,this.currentFrame=1,this.emitter.setAlpha(1)),this.currentFrame>=this.star.frames.length&&(this.isYoyo=!0,this.currentFrame-=1,this.emitter.setAlpha(.8)),this.frame=this.star.frames[this.currentFrame].frame,this.lastChange-=this.star.msPerFrame}},n.updateFrameRate=function(){this.lifeCurrent<this.life-2e3?this.star.msPerFrame=150:this.star.msPerFrame=Phaser.Math.RND.between(300,600)},e}(Phaser.GameObjects.Particles.Particle),ht=s.default.EFFECTS,ct=ht.KEY,lt=ht.FRAME,ut=function(t){function e(e){var n;return(n=t.call(this,e,ct,lt.BLANK)||this).emitterConfetti=void 0,n.emitterRibbons=void 0,n.ribbonConfig=void 0,n.confettiConfig=void 0,n.width=void 0,n.height=void 0,n.emitterRibbons=[],n.emitterConfetti=[],n.createConfigs(),n.createAnimations(),n.scene.add.existing((0,a.default)(n)),n}(0,r.default)(e,t);var n=e.prototype;return n.createConfigs=function(){var t=1/this.scene.world.getPixelRatio();this.ribbonConfig={on:!1,visible:!1,timeScale:1.5,frame:lt.BLANK,particleBringToTop:!0,speedY:{min:-480,max:-560},gravityY:290,lifespan:{min:4e3,max:6e3},rotate:{start:0,end:1800,random:!0},scale:{min:.6*t,max:t},particleClass:st},this.confettiConfig={on:!1,delay:200,timeScale:2,tint:[8443204,2928867,12013036,16376097,15285798],particleBringToTop:!0,frame:lt.PREFIX_ANIMATION_RIBBON_CONFETTI_A+"1",speedY:{min:-460,max:-580},gravityY:280,lifespan:{min:5e3,max:8e3},rotate:{start:0,end:1080},scale:{min:.6*t,max:t},particleClass:ot}},n.createAnimations=function(){if(!this.scene.anims.get(o.default.CONFETTI_STAR_X.KEY)){var t=new K(this.scene.anims);this.scene.anims.add(o.default.CONFETTI_STAR_X.KEY,t)}if(!this.scene.anims.get(o.default.CONFETTI_STAR_Y.KEY)){var e=new et(this.scene.anims);this.scene.anims.add(o.default.CONFETTI_STAR_Y.KEY,e)}if(!this.scene.anims.get(o.default.RIBBON_A.KEY)){var n=new g(this.scene.anims);this.scene.anims.add(o.default.RIBBON_A.KEY,n)}if(!this.scene.anims.get(o.default.RIBBON_B.KEY)){var i=new b(this.scene.anims);this.scene.anims.add(o.default.RIBBON_B.KEY,i)}if(!this.scene.anims.get(o.default.RIBBON_C.KEY)){var a=new R(this.scene.anims);this.scene.anims.add(o.default.RIBBON_C.KEY,a)}if(!this.scene.anims.get(o.default.RIBBON_D.KEY)){var r=new G(this.scene.anims);this.scene.anims.add(o.default.RIBBON_D.KEY,r)}},n.run=function(t,e,n,i){this.setPosition(t,e),this.width=n,this.height=i,this.createEmitters(),this.emitterConfetti.forEach((function(t){t.emitParticle(25)})),this.emitterRibbons.forEach((function(t){t.emitParticle(20)}))},n.stop=function(){this.emitterConfetti.forEach((function(t){t.killAll()})),this.emitterRibbons.forEach((function(t){t.killAll()})),this.kill()},n.createEmitters=function(){this.emitterRibbons=[],this.emitterConfetti=[],this.createConfettiLeftEmitter(),this.createConfettiRightEmitter(),this.createRibbonLeftEmitter(),this.createRibbonRightEmitter()},n.createConfettiLeftEmitter=function(){var t=(0,i.default)({},this.confettiConfig,{speedX:{min:5,max:90}}),e=this.createEmitter(t);this.emitterConfetti.push(e)},n.createConfettiRightEmitter=function(){var t=this.width,e=(0,i.default)({},this.confettiConfig,{x:t,speedX:{min:-5,max:-90}}),n=this.createEmitter(e);this.emitterConfetti.push(n)},n.createRibbonLeftEmitter=function(){var t=(0,i.default)({},this.ribbonConfig,{speedX:{min:20,max:80},emitCallback:function(t){t.setRibbonPosition(0,0)}}),e=this.createEmitter(t);this.emitterRibbons.push(e)},n.createRibbonRightEmitter=function(){var t=this.width,e=(0,i.default)({},this.ribbonConfig,{x:t,speedX:{min:-20,max:-80},emitCallback:function(e){e.setRibbonPosition(t,0)}}),n=this.createEmitter(e);this.emitterRibbons.push(n)},e}(Phaser.GameObjects.Particles.ParticleEmitterManager)},470:function(t,e,n){"use strict";n.r(e);var i=n(4),a=n(0),r=n(1).default.EFFECTS,s=r.KEY,o=r.FRAME,h=function(t){function e(e){var n;return(n=t.call(this,e,s,o.FX_STAR_YELLOW)||this).emitZone=void 0,n.emitter=void 0,n.createEmitZone(),n.scene.add.existing((0,i.default)(n)),n}(0,a.default)(e,t);var n=e.prototype;return n.createEmitZone=function(){this.emitZone=new Phaser.Geom.Rectangle},n.createEmitters=function(){var t=1/this.scene.world.getPixelRatio();this.emitter=this.createEmitter({on:!1,frame:o.FX_STAR_YELLOW,emitZone:{source:this.emitZone,type:"random"},timeScale:1,frequency:500,alpha:{start:1,end:0,ease:Phaser.Math.Easing.Expo.Out},scale:{start:1*t,end:0,ease:Phaser.Math.Easing.Expo.Out},lifespan:{min:800,max:1500}})},n.run=function(t,e,n,i,a){this.stop(),this.reset(),this.emitZone.setSize(i,a),this.emitZone.setPosition(e-i/2,n-a/2),this.emitter.setQuantity(t),this.emitter.start()},n.stop=function(){var t,e;null==(t=this.emitter)||t.killAll(),null==(e=this.emitter)||e.stop()},n.reset=function(){this.createEmitters()},e}(Phaser.GameObjects.Particles.ParticleEmitterManager);e.default=h},147:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return l}});var i=n(0),a=n(30),r=n.n(a),s=n(47),o=function(t){function e(e,n,i){var a;return(a=t.call(this,e,0,0,n,i)||this).setOrigin(0,0),a}return(0,i.default)(e,t),e}(Phaser.GameObjects.Zone),h=n(247),c=n(35),l=function(t){function e(){var e;return(e=t.call(this,{visible:!1})||this).unsubscribeList=void 0,e.gameZone=void 0,e.background=void 0,e.handleOpenScene=function(){e.logPageviewOnOpen(),e.logEventOpen(),e.scaleGame()},e.removeStateChange=function(){e.unsubscribeList.forEach((function(t){return t()}))},e}(0,i.default)(e,t);var n=e.prototype;return n.create=function(){var t=this;this.events.on("wake",this.handleOpenScene),this.events.on("resume",this.handleOpenScene),this.events.on("create",this.handleOpenScene),this.createGameZone();var e=GameCore.Configs.Game;this.events.on(Phaser.Scenes.Events.UPDATE,(function(){e.AutoDropFps&&t.autoUpdateFPS()}))},n.scaleGame=function(){var t=this.getCamera("main"),e=this.world.getZoomRatio(),n=this.world.getWorldSize(),i=n.width,a=n.height;t.setZoom(e),t.centerOn(i/2,a/2)},n.createGameZone=function(){var t=this.world.getWorldSize(),e=t.width,n=t.height;this.gameZone=new o(this,e,n)},n.autoUpdateFPS=function(){this.allowUpdateFPS()&&(this.tweenPlaying()||this.particlePlaying()?this.game.updateFps(h.default.max):this.game.updateFps(h.default.min))},n.allowUpdateFPS=function(){return this.scene.key===c.SceneKeys.GAME_SCENE||this.scene.key===c.SceneKeys.JOURNEY_SCENE},n.tweenPlaying=function(){for(var t=this.tweens.getAllTweens(),e=0;e<t.length;e++)if(t[e].isPlaying())return!0;return!1},n.particlePlaying=function(){var t=this.getAllParticles();if(!t)return!0;var e=!1;return t.forEach((function(t){t.emitters.list.forEach((function(t){t.alive&&t.alive.length>0&&(e=!0)}))})),e},n.getAllParticles=function(){if(this.input.enabled&&this.scene.isActive()&&!this.scene.isPaused()){var t=this.children.list;return!t||t.length<=0?[]:r()(t).call(t,(function(t){return"ParticleEmitterManager"===t.type}))}},n.getCamera=function(t){return"main"===t?this.cameras.main:this.cameras.getCamera(t)},n.createMask=function(t){void 0===t&&(t=1),this.getCamera("main").setBackgroundColor("rgba(0, 0, 0, "+t+")")},n.fontSize=function(t){return t/2.4},n.createBackground=function(t,e,n,i){try{this.background?(this.background.setTexture(t),e&&this.background.setFrame(e)):this.background=this.make.image({key:t,frame:e}),this.background.setName(t);var a=this.gameZone,r=a.displayWidth,s=a.displayHeight;this.background.setDisplaySize(r,s),GameCore.Utils.Valid.isNumber(n)&&this.background.setAlpha(n),GameCore.Utils.Valid.isNumber(i)&&this.background.setTint(i),Phaser.Display.Align.In.Center(this.background,this.gameZone)}catch(o){}},n.handleStateChange=function(t){var e=this;this.unsubscribeList=[],t.forEach((function(t){var n=t.selector,i=t.callback,a=e.storage.watch(n,i);e.unsubscribeList.push(a)})),this.events.once("sleep",this.removeStateChange),this.events.once("destroy",this.removeStateChange),this.events.once("shutdown",this.removeStateChange)},n.logPageviewOnOpen=function(){this.analytics.pageview(this.scene.key)},n.logEventOpen=function(){this.analytics.event(s.AnalyticsEvents.SCREEN_OPEN,{screen_name:this.getSceneName()})},n.getSceneName=function(){return GameCore.Utils.String.toUpperCamelCase(this.scene.key.toLowerCase())},e}(Phaser.Scene)},531:function(t,e,n){"use strict";n.r(e);n(301);var i=n(110),a=n.n(i),r=n(38),s=n.n(r),o=function(t,e){return void 0===e&&(e=1),a()({length:Math.ceil(t.length/e)},(function(n,i){return s()(t).call(t,i*e,i*e+e)}))},h=n(30),c=n.n(h),l=n(144),u=n.n(l),d=function(t,e){return c()(t).call(t,(function(t){return!u()(e).call(e,t)}))},p=function(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),i=[t[n],t[e]];t[e]=i[0],t[n]=i[1]}},f=n(32),g=n.n(f),m=function(t,e,n){return g()(n).call(n,t)===e&&null!==t&&void 0!==t},v=function(t){return c()(t).call(t,m)},y={chunk:o,difference:d,shuffle:p,unique:v},S=n(85),A=n.n(S),E=n(253),x=n.n(E),b=x()((function(t,e){if("string"===typeof t){var n=e[t.toLowerCase()];if("string"===typeof n)return n}return"?"})),T=x()((function(t){for(var e=null,n=[],i=/:([A-Z0-9?]+)/gm;null!==(e=i.exec(t));)n.push(e[1]);return n})),w=x()((function(t){for(var e=null,n=[],i=/([0-9]+[A-Z?]{1}|[A-Z?]{1})/gm;null!==(e=i.exec(t));){var a=e[0];if(a.length>=2){var r,o=a.length,h=s()(a).call(a,0,o-1),c=a[o-1],l=A()(r=new Array(+h)).call(r,c);n.push.apply(n,l)}else n.push(a)}return n})),C=function(t,e){var n=t,i=GameCore.Utils.Object.invert(e),a={},r=0,s=0;return T(n).forEach((function(t){r=0,s++,a[s]||(a[s]={}),w(t).forEach((function(t){r++,a[s][r]=b(t,i)}))})),a},M=x()((function(t,e){var n=e[t];return"string"===typeof n?""+n.toUpperCase():"?"})),I=function t(e,n,i){void 0===i&&(i=!1);var a="";if(!GameCore.Utils.Valid.isObject(e))return a;var r="",o=1;for(var h in e)if(GameCore.Utils.Object.hasOwn(e,h)){var c=e[h];if(GameCore.Utils.Valid.isObject(c))a+=":"+t(c,n,!0);else if(GameCore.Utils.Valid.isString(c)){var l=M(c,n);l===r?(o++,a=s()(a).call(a,0,-2)):o=1,a+=""+o+l,r=l}}return a=a.replace(/1([A-Z])/g,"$1")},P=function(t){try{return atob(t)}catch(e){return""}},k={decodeMap:C,encodeMap:I,hashToString:P,stringToHash:function(t){try{return btoa(t)}catch(e){return""}}},R=function(t){try{return JSON.parse(t)}catch(e){return null}},O=n(96),_=n.n(O),D=function(t){try{return _()(t,null,0)}catch(e){return""}},L=function(t){return R(D(t))},B={clone:L,decode:R,encode:D},F=function(t){var e="object"===typeof t||"function"===typeof t,n=Array.isArray(t);return null!==t&&e&&!n},N=function(t){return void 0===t||null===t},G=function t(e){if(!F(e))return e;for(var n in e){N(e[n])&&delete e[n];var i=e[n];F(i)&&(e[n]=t(i))}return e},U=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},V=n(29),Y=n.n(V),z=function(t){var e={};return Y()(t).forEach((function(n){if(U(t,n)){var i=t[n];"string"===typeof i&&(e[i]=n)}})),e},H=function(t,e){if(!Array.isArray(t))return{};var n={};return t.forEach((function(t){if(U(t,e)){var i=t[e];"string"===typeof i&&(n[i]=t)}})),n},W={clear:G,hasOwn:U,invert:z,keyBy:H},X=function(t){return t?t[0].toUpperCase()+s()(t).call(t,1):t},K=function(t){var e=0;if(0==t.length)return e;for(var n=0;n<t.length;n++){e=(e<<5)-e+t.charCodeAt(n),e&=e}return e},j=n(246),q=n.n(j),Z=function(t){var e;return q()(e=Y()(t)).call(e,(function(e,n){var i=t[n];return void 0!==i&&e.push(n+"="+i),e}),[]).join("&")},J=function(t){void 0===t&&(t="0x");for(var e=t,n=0;n<6;n++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e},Q=function(t,e){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789*#%&!",i="",a=t;void 0!=e&&(a-=e.length,i+=e);for(var r=0;r<a;r++){var s=Math.floor(Math.random()*n.length);i+=n.charAt(s)}return i},$=function(t){return t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[\u0111\u0110]/g,(function(t){return"\u0111"===t?"d":"D"}))},tt=n(26),et=n.n(tt),nt=n(324),it=n.n(nt),at=function(t,e){var n,i=t.split(" "),a=(i.length<=1?et()(n=[]).call(n,i):[i[0],i.pop()]).join(" "),r=it()(a).call(a," ")||0,s=r>=0?r:e;return(a.length>e?a.substring(0,s):a).substring(0,e)},rt=n(343),st=n.n(rt),ot=function(t){void 0===t&&(t=16);var e=function(e){return Math.floor(e).toString(t)};return e(Date.now()/1e3)+st()(" ").call(" ",t).replace(/./g,(function(){return e(Math.random()*t)}))},ht={capitalize:X,hashCode:K,params:Z,toCamelCase:function(t){var e=t.replace(/[-_\s.]+(.)?/g,(function(t,e){return e?e.toUpperCase():""}));return e.substr(0,1).toLowerCase()+e.substr(1)},toUpperCamelCase:function(t){var e=t.replace(/[-_\s.]+(.)?/g,(function(t,e){return e?e.toUpperCase():""}));return e.substr(0,1).toUpperCase()+e.substr(1)},randomColor:J,random:Q,removeDiacritics:$,getShortName:at,generateObjectId:ot},ct=function(t){return"boolean"===typeof t},lt=function(){return false},ut=function(t){return"function"===typeof t},dt=function(t){return"number"===typeof t},pt=function(t){var e;return g()(e=["string","number","symbol"]).call(e,typeof t)>-1},ft=function(t){return"string"===typeof t},gt=n(46),mt=n.n(gt),vt=function(t,e,n){var i=n||{},a=i.timeout,r=void 0===a?1e3:a,s=i.checkInterval,o=void 0===s?100:s;return new(mt())((function(n){var i=setInterval((function(){("function"===typeof t?t():t)===("function"===typeof e?e():e)&&(clearInterval(i),n(!0))}),o);r>0&&setTimeout((function(){clearInterval(i),n(!1)}),r)}))},yt=function(t){var e=t.scene,n=t.key,i=t.newKey,a=e.textures.get(n).getSourceImage();if(!a)return!1;var r=Math.min(a.width,a.height);i||e.textures.removeKey(n);var s=e.textures.createCanvas(i||n,r,r),o=s.context;return o.beginPath(),o.arc(r/2,r/2,r/2,0,2*Math.PI,!1),o.clip(),s.draw((a.width-r)/2,(a.height-r)/2,a),!0},St=function(t){var e=t.scene,n=t.key,i=t.newKey,a=t.radius,r=t.width,s=t.height,o=e.textures.get(n).getSourceImage();if(!o)return!1;r||(r=o.width),s||(s=o.height),i||e.textures.removeKey(n);var h=e.textures.createCanvas(i||n,r,s),c=h.context,l=Math.min(r,s)/100*a/2;return c.beginPath(),c.moveTo(0+l,0),c.lineTo(0+r-l,0),c.quadraticCurveTo(0+r,0,0+r,0+l),c.lineTo(0+r,0+s-l),c.quadraticCurveTo(0+r,0+s,0+r-l,0+s),c.lineTo(0+l,0+s),c.quadraticCurveTo(0,0+s,0,0+s-l),c.lineTo(0,0+l),c.quadraticCurveTo(0,0,0+l,0),c.closePath(),c.clip(),h.draw(0,0,o),!0},At=function(t){if(g()(t).call(t,".")<0)return t;for(var e=t.length-1;e>=0;e--){if("."==t[e])return t.substring(0,e);if("0"!=t[e])return t.substring(0,e+1)}return t},Et=function(t,e){var n=e||{},i=n.fractionalDigits,a=void 0===i?0:i,r=n.startAbbreviate,s=void 0===r?1e3:r,o=n.abbreviateStep,h=void 0===o?3:o,c=n.maxLength,l=void 0===c?-1:c,u=n.removeLastZero,d=void 0===u||u,p=n.suffixes,f=void 0===p?["","k","m","b","t","q"]:p,g=-1===l?99999999:l;if(t>=s){var m=Math.floor(t/Math.pow(10,h)),v=Math.floor((m.toString().length-1)/h)+1,y=(t/Math.pow(Math.pow(10,h),v)).toFixed(a),S=g-f[v].length,A=y.substring(0,S);return(d?At(A):A)+f[v]}var E=t.toFixed(a),x=g-f[0].length,b=E.substring(0,x);return d?At(b):b+f[0]},xt=function(t,e,n){void 0===n&&(n="0");for(var i=t.toString(),a=0;a<e-i.length;a++)i=n+i;return i},bt=function(t,e,n){void 0===n&&(n="0");for(var i=t.toString(),a=0;a<e-i.length;a++)i+=n;return i},Tt={Array:y,Hash:k,Json:B,Object:W,String:ht,Valid:{isBoolean:ct,isDebugger:lt,isFunction:ut,isNumber:dt,isObject:F,isPropertyKey:pt,isString:ft,isValueChangeAsync:vt},Image:{drawCircle:yt,drawBorder:St},Number:{toAbbreviatedString:Et,padStart:xt,padEnd:bt},Device:{isDesktop:function(){var t=navigator.userAgent;return/Windows|Mac OS/i.test(t)},isMobile:function(){var t=navigator.userAgent;return/Android|iP[ao]d|iPhone/i.test(t)},isAndroid:function(){return"ANDROID"===FBInstant.getPlatform()},isIOS:function(){return"IOS"===FBInstant.getPlatform()},isMobileWeb:function(){return"MOBILE_WEB"===FBInstant.getPlatform()},pixelRatio:function(){return Math.round(window.devicePixelRatio)||1}}},wt=n(11),Ct=n(121),Mt={AppId:"1012305065987428",ApiHost:"https://fbig-singleplay-apps.citigo.site",OtherHost:"https://fbig-leaderboards.citigo.site",PlayerDataStoreUsingApi:!1,LeadersBoard:{LeaderboardId:"61a0bde67c386b3ef39de708",UseMock:!1,Limit:10},Ads:{Enabled:!0,Mockup:{Enable:!1},InterstitialAdOptions:{showWhenStartGame:!1,secondsFirstTime:0,secondsBetweenAds:60},BannerAdOptions:[]},Match:{MaxRescueCount:0}},It={ENV:"production",LeadersBoard:{Prefix:"leaderboards"},Debugger:{ShowConsole:!1,ShowInspector:!1,ShowMonitoring:!1},Statistics:{Enable:!1,ShowFPSInGame:!1,ShowMemoryInGame:!1},ParticleEditor:{Enable:!1}},Pt={ENV:"development",AppId:"405221927720733",ApiHost:"https://fbig-singleplay-apps-dev.sunstudio.io",OtherHost:"https://leaderboards-dev.sunstudio.io",PlayerDataStoreUsingApi:!0,PlayerMock:{id:"",signature:""},OpponentMock:{id:"",signature:""},MatchMockFailRate:5,Gameplay:{StartLevel:1,StartScore:0,StartDiamonds:0,DefaultDiamondsForNewUser:300,LevelDifficultRate:{FromUnder30:1.07,FromUnder35:1.05,FromUnder45:1.05,FromUnder200:1.1},StartAdAtLevel:2,GiftTime:10800,AwardDiamonds:100,FreeItems:!1,DelayStart:2e3,DelayLevelUp:1800,DelayFinishGame:500,EnableVibrate:!0,VibrateValue:[0,0,119,199,279,359,439],Progress:{BonusScore:5e3,Milestone:3},MaxGemInPiece:2,RatePieceContainGem:10},Tutorial:{ForceUseTutorial:!1,NumberOfTutorial:{FirstMove:3,TargetScore:1,CurrentScore:1,ColorfulGem:1,ItemPaint:1,ItemHammer:1,ItemShuffle:1}},PlayerDataStore:"playerData",Game:{ForcePixelRatio:0,AutoDropFps:!1},Debugger:{ShowInspector:!0,ShowMonitoring:!0,ShowConsole:!1,Expanded:!0,AutoRefresh:!0,InspectorAutoUpdate:!0,Opacity:.8},Statistics:{Enable:!1,DisplayMode:0,FPS:!0,MS:!0,MB:!0,Opacity:.8,ShowFPSInGame:!0,ShowMemoryInGame:!1},ParticleEditor:{Enable:!1,Opacity:.8,Expanded:!0},Match:{MaxRescueCount:1,RescueGamePopupTimeout:10,DelayNoThank:1e3,ContinueSingleMatchEnabled:!1,SingleMatchStore:"singleMatch",JourneyMatchStore:"journeyMatch",LivesStore:"lives",LocalSingleMatchDefault:{_id:"12345678890",status:"open",playerId:"",score:0,level:1,startedAt:0,updateAt:0,finishAt:0,data:{}},Levels:[100,500,1e3,1500,2e3,3e3,4e3,5e3,6e3,7500,9e3,11500,13e3,15e3,17e3,19e3,21e3,23e3,25e3,1e5],PieceRandoms:{maxPiece:200,measureError:.5}},DailyRewards:{MaxDays:6,MockTime:0,CheckInterrupt:!0},DailyTasks:{Duration:86400},Tournament:{UseMock:!1,ForcePlay:!1,UseLeaderboard:!1,TournamentContextIds:[]},LeadersBoard:{Name:null,UseMock:!1,Prefix:"leaderboards",LeaderboardId:"61811128f28777ad0ed05787",Limit:50},LanguageSupport:{en:"en"},EnableEffectSceneTransition:!0,DefaultTheme:"default",ThemeSupport:{default:"default"},Ads:{Enabled:!0,InterstitialPlacementId:"",VideoRewardsPlacementId:"",BannerPlacementId:"",BannerReloadPeriod:60,Mockup:{Enable:!1,ErrorRate:5,GiphyApiKey:""},InterstitialAdOptions:{showWhenStartGame:!1,secondsFirstTime:90,secondsBetweenAds:180},BannerAdOptions:[]},Network:{MaximumRequest:6,Timeout:15e3,Retries:3},Analytics:{GameAnalytics:{key:"",secret:"",consoleLog:!1},GoogleAnalytics:{consoleLog:!1},FacebookAnalytics:{prefix:"fba",consoleLog:!1}},MagnetItem:{key:"magnet-item",scoreForOnePercent:4,maxMagnetPerMatch:5},Board:{cols:9,rows:9},Sentry:{errorCodes:{accepted:[],ignored:["USER_INPUT","NETWORK_FAILURE"]},errorMessages:{accepted:[],ignored:["Load image failed"]}},DailyChallenge:{Prefix:"leaderboards",LeaderBoardId:"61e00146f28777ad0e328f2c"},Lives:{bonusDurationMins:5,bonusLife:1,livesCapacity:10},Performance:{Enable:!1,trackingSceneKeys:["DASHBOARD_SCENE","GAME_SCENE"],minQuality:1,maxQuality:2,fpsThreshold:48,checkInterval:2e3,qualityAdjustStep:.1,autoUpgradeQuality:!0,onlyUpdateWhenSwitchScene:!0}};Pt=(0,Ct.merge)((0,wt.default)({},Pt),It);var kt=Pt=(0,Ct.merge)((0,wt.default)({},Pt),Mt),Rt=function(t){return function(e){try{var n=window.game,i=e.module;if(n.scene.getScenes(!0)[0].scene.key!==t)return;var a=i.default;n.scene.remove(t),n.scene.add(t,a,!0),n.scene.bringToTop(n.globalScene)}catch(s){var r;null==(r=void 0)||r.invalidate()}}},Ot=n(537),_t=n.n(Ot),Dt=n(539),Lt=n.n(Dt),Bt=n(541),Ft=n.n(Bt),Nt=n(441),Gt=!1,Ut=function t(e,n,i){n.forEach((function(n){if(n.name){var a=null;if(a=i?i.getByName(n.name):e.children.getByName(n.name)){if("Container"===n.type){var r=a,s=n.getAll();if(t(e,s,r),!r.hotContainer)return}var o=_t()(n),h=["_events","_sysEvents","input","localTransform","list","displayList"],l=c()(o).call(o,(function(t){if("string"!==typeof t)return!1;if(g()(h).call(h,t)>=0)return!1;if(!a)return!1;var e=Lt()(n,t);return!(e instanceof Function)&&(!(e instanceof Phaser.Scene)&&(!(e instanceof Phaser.GameObjects.Group)&&(!(e instanceof Phaser.GameObjects.GameObject)&&e===Lt()(a,t))))}));l.length<1||l.forEach((function(t){if(a){var e=Lt()(n,t);Lt()(a,t),Ft()(a,t,e)}}))}}}))},Vt=function(t,e){return void 0===e&&(e=Gt),function(n){try{var i=window.game,a=n.module,r=i.scene.getScenes(!0)[0];if(r.scene.key!==t)return;Gt=e;var s=a.default,o=t+"-draft";i.scene.remove(o);var h=i.scene.add(o,s);r=i.scene.getScene(t),h.events.once(Phaser.Scenes.Events.RENDER,(0,Nt.debounce)((function(){var t=h.children.getAll();Ut(r,t),i.scene.remove(o)})),50),i.scene.run(o),i.scene.bringToTop(r),i.scene.bringToTop(i.globalScene)}catch(c){}}},Yt={Configs:kt,Utils:Tt,LiveUpdate:{Scene:Rt,SceneObjects:Vt}};window.GameCore=Yt;var zt=Yt,Ht=n(28),Wt=n(325),Xt=n(8),Kt=n(0),jt=n(6),qt=n.n(jt),Zt=n(444),Jt=function(){function t(t){this.game=void 0,this.game=t}var e=t.prototype;return e.addKillRevive=function(){var t=this;[Phaser.GameObjects.Container,Phaser.GameObjects.Group,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText,Phaser.GameObjects.Particles.ParticleEmitter,Phaser.GameObjects.Particles.ParticleEmitterManager].forEach((function(e){e.prototype.kill=t.kill,e.prototype.revive=t.revive}))},e.addSetWorldSize=function(){var t=this;[Phaser.GameObjects.Image,Phaser.GameObjects.Sprite].forEach((function(e){e.prototype.setWorldSize=t.setWorldSize}))},e.addSetWorldSizeForContainer=function(){var t=this;[Phaser.GameObjects.Container].forEach((function(e){e.prototype.setWorldSize=t.setWorldSizeForContainer}))},e.addGetWorldPosition=function(){var t=this;[Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText].forEach((function(e){e.prototype.getWorldPosition=t.getWorldPosition}))},e.addDrawDebugBox=function(){var t=this;[Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText,Phaser.GameObjects.Zone].forEach((function(e){e.prototype.drawDebugBox=t.drawDebugBox}))},e.addHighQuality=function(){var t=this;[Phaser.GameObjects.Text].forEach((function(e){e.prototype.setHighQuality=t.setHighQuality}))},e.kill=function(){this.setActive(!1),this.setVisible(!1)},e.revive=function(){this.setActive(!0),this.setVisible(!0)},e.setWorldSize=function(t,e){this.setSize(t,e),this.setDisplaySize(t,e)},e.setWorldSizeForContainer=function(t,e,n){void 0===n&&(n=2),this.setSize(t*n,e*n),this.setDisplaySize(t,e)},e.getWorldPosition=function(){var t=this.getWorldTransformMatrix().decomposeMatrix();return{x:t.translateX,y:t.translateY}},e.drawDebugBox=function(t,e){var n=this.x,i=this.y,a=this.width,r=this.height,s=this.depth,o=this.originX,h=this.originY,c=this.scene.add.rectangle(n,i,a,r,t,e);c.setName("Debug Box"),c.setDepth(s);var l=GameCore.Utils.Valid.isNumber;return l(o)&&l(h)&&c.setOrigin(o,h),c},e.setHighQuality=function(){return this.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer?this.setResolution(2*this.scene.game.world.getZoomRatio()):this},t}(),Qt=Jt,$t=GameCore.Configs.Ads.Mockup.GiphyApiKey,te=function(){function t(){}return t.loadBannerAdAsync=function(t,e){var n=this;return new(mt())((function(i,a){window.yaContextCb=window.yaContextCb||[];var r=document.getElementById("yandexAdContextScript");r||((r=document.createElement("script")).src="https://yandex.ru/ads/system/context.js",r.async=!0,document.head.appendChild(r));var s="yandex_rtb_wrapper_"+t,o="yandex_rtb_"+t,h=document.getElementById(s);if(!h){(h=document.createElement("div")).id=s,document.body.appendChild(h),h.style.display="block",h.style.position="fixed",h.style.zIndex="10000";var c=document.createElement("div");c.id=o,c.classList.add("yandex-adaptive"),c.style.display="block",h.appendChild(c)}n.setBannerAdSize(t,e||{}),n.getAdContentAsync().then((function(t){var e=document.getElementById("mock-banner-ads");e||((e=document.createElement("img")).id="mock-banner-ads",e.style.cssText="height: 100%; width: 100%; background-color: white; position: absolute;",h.childNodes[0].appendChild(e)),e.src=t,i()})).catch(a)}))},t.setBannerAdSize=function(t,e){var n=e||{},i=n.bannerHeight,a=void 0===i?50:i,r=n.bannerWidth,s=void 0===r?320:r,o="yandex_rtb_wrapper_"+t,h="yandex_rtb_"+t,c=document.getElementById(o),l=document.getElementById(h);if(c&&l){var u=document.body,d=(u.clientHeight,u.clientWidth);c.style.top="",c.style.bottom="0px",c.style.left=(d-s)/2+"px",c.style.margin="auto",c.style.height=a+"px",c.style.width=s+"px",l.style.height=a+"px",l.style.width=s+"px"}},t.hideBannerAdAsync=function(){return new(mt())((function(t){document.querySelectorAll('div[id^="yandex_rtb_wrapper_"]').forEach((function(t){var e=t;e.style.bottom="",e.style.top="-"+e.style.height})),t()}))},t.getAdContentAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n,i,a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="https://api.giphy.com/v1/gifs/random?api_key="+$t+"&rate=pg",t.next=3,fetch(n,{method:"GET"});case 3:return i=t.sent,t.next=6,i.json();case 6:if(a=t.sent,GameCore.Utils.Valid.isObject(a)){t.next=9;break}return t.abrupt("return","");case 9:return t.abrupt("return",null===(e=a.data)||void 0===e?void 0:e.images.downsized.url);case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t}();te.bannerAdOptions={};var ee,ne={LOADED:"loaded",DISPLAYED:"displayed"};!function(t){t.IDLE="idle",t.LOADING="loading",t.FILLED="filled",t.SHOWING="showing"}(ee||(ee={}));var ie,ae=ee;!function(t){t.REWARDED="rewarded",t.INTERSTITIAL="interstitial"}(ie||(ie={}));var re=ie,se=n(42),oe=function(t){function e(e,n){var i;return(i=t.call(this,n)||this).code=void 0,i.code=e,i.message=n,i}return(0,Kt.default)(e,t),e}((0,se.default)(Error)),he=oe,ce=function(t){this.type=void 0,this.status=void 0,this.type=t,this.status=ae.IDLE};GameCore.Ads={Types:re,Status:ae,Events:ne,AdError:he,AdInstance:ce};var le=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).events=void 0,n.enabled=void 0,n.config=void 0,n.lastAdShownTime=void 0,n.intervalBannerAd=void 0,n.interstitial=void 0,n.rewardedVideo=void 0,n.reloadBannerAdIntervals=void 0,n.bannerAdSizeOptions=void 0,n.showingBannerAd={},n.updateSizeBannerAd=function(){try{var t=n.config.bannerAdOptions,e=n.getCorrectBannerAdSizeOption(n.bannerAdSizeOptions);t.forEach((function(t){n.showingBannerAd[t.placementId]&&(GameCore.Configs.Ads.Mockup.Enable?te.setBannerAdSize(t.placementId,e):GameSDK.setBannerAdSize(t.placementId,e))}))}catch(i){}},n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.events=new Phaser.Events.EventEmitter,this.lastAdShownTime=0,this.addEventUpdateSizeBannerAd()},n.configure=function(t,e){this.enabled=e.enabled,this.config=e,this.setAdInstance(t)},n.setAdInstance=function(t){var e=this.config,n=e.interstitialPID,i=e.rewardedVideoPID;this.interstitial=new t(re.INTERSTITIAL,n),this.rewardedVideo=new t(re.REWARDED,i)},n.preloadInterstitialAdAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.preloadAdAsync(re.INTERSTITIAL);case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.showInterstitialAdAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.canbeShowInterstitialAd()){t.next=2;break}throw new he("INTERSTITIAL_AD_CAN_NOT_SHOW","Can't show interstitial ad");case 2:return t.next=4,this.showAdAsync(re.INTERSTITIAL);case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.preloadRewardedVideoAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.preloadAdAsync(re.REWARDED);case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.showRewardedVideoAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.showAdAsync(re.REWARDED);case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.preloadAdAsync=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.enabled){t.next=2;break}throw new he("ADS_NOT_ENABLED","Ads is't enabled");case 2:if(null!==(n=this.getAdInstanceByType(e))){t.next=5;break}throw new he("AD_INSTANCE_NOT_INITIALTED","The instance ads not yet initiated");case 5:return t.next=7,n.loadAsync();case 7:this.events.emit(ne.LOADED,e);case 8:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.showAdAsync=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.enabled){t.next=2;break}throw new he("ADS_NOT_ENABLED","Ads is't enabled");case 2:if(null!==(n=this.getAdInstanceByType(e))){t.next=5;break}throw new he("AD_INSTANCE_NOT_INITIALTED","The instance ads not yet initiated");case 5:return this.lastAdShownTime=window.performance.now()/1e3,t.next=8,n.showAsync();case 8:this.events.emit(ne.DISPLAYED,e);case 9:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.getAdStatus=function(t){var e=this.getAdInstanceByType(t);return e?e.getStatus():null},n.getAdInstanceByType=function(t){switch(t){case re.INTERSTITIAL:return this.interstitial;case re.REWARDED:return this.rewardedVideo;default:return null}},n.canbeShowInterstitialAd=function(){return this.canbeShowInterstitialAdByTime()},n.canbeShowInterstitialAdByTime=function(){var t=window.performance.now()/1e3,e=this.config.interstitialAdOptions,n=e.secondsFirstTime,i=e.secondsBetweenAds,a=t-this.lastAdShownTime;return this.lastAdShownTime>0?a>i:a>n},n.showBannerAdAsync=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,r=this;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.reloadBannerAdIntervals=this.reloadBannerAdIntervals||{},n=this.config.bannerAdOptions,i=GameSDK.getPlatform(),a="WEB"==i,window.addEventListener,n.forEach((function(t){var n=t.platform;if("ALL"==n||"DESKTOP"==n&&a||"MOBILE"==n&&!a){r.bannerAdSizeOptions=e||{};var i=t.placementId,s=t.secondsReload;if(i&&""!=i){if(s>0){if(r.reloadBannerAdIntervals[i])return;return r.loadBannerAdAsync(i),void(r.reloadBannerAdIntervals[i]=setInterval((function(){r.loadBannerAdAsync(i)}),1e3*s))}r.loadBannerAdAsync(i)}}})),t.abrupt("return");case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.getCorrectBannerAdSizeOption=function(t){var e=this.game.canvas.offsetWidth,n=t||{},i=n.bannerWidth,a=void 0===i?0:i,r=n.bannerHeight,s=void 0===r?0:r;if(this.game.world){var o=this.game.world,h=o.getZoomRatio(),c=o.getPixelRatio();a=a?o.getPhysicPixels(a,h/c):e,s=s?o.getPhysicPixels(s,h/c):50}return{bannerWidth:a,bannerHeight:s}},n.loadBannerAdAsync=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=GameCore.Configs.Ads,i=this.getCorrectBannerAdSizeOption(this.bannerAdSizeOptions),!n.Mockup.Enable){t.next=8;break}return t.next=6,te.loadBannerAdAsync(e,i);case 6:t.next=10;break;case 8:return t.next=10,GameSDK.loadBannerAdAsync(e,i);case 10:this.showingBannerAd[e]=!0,t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0);case 16:case"end":return t.stop()}}),t,this,[[0,13]])})));return function(e){return t.apply(this,arguments)}}(),n.addEventUpdateSizeBannerAd=function(){window.addEventListener("resize",this.updateSizeBannerAd)},n.hideBannerAdAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){var e=this;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.config.bannerAdOptions.forEach((function(t){var n=t.placementId,i=e.reloadBannerAdIntervals[n];i&&(clearInterval(i),e.reloadBannerAdIntervals[n]=null),e.showingBannerAd[n]=!1})),t.prev=2,!GameCore.Configs.Ads.Mockup.Enable){t.next=9;break}return t.next=7,te.hideBannerAdAsync();case 7:t.next=11;break;case 9:return t.next=11,GameSDK.hideBannerAdAsync();case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(2);case 16:case"end":return t.stop()}}),t,this,[[2,13]])})));return function(){return t.apply(this,arguments)}}(),n.getBannerHeight=function(){var t=this.getCorrectBannerAdSizeOption(this.bannerAdSizeOptions);if(this.game.world){var e=this.game.world,n=e.getZoomRatio(),i=e.getPixelRatio();return this.game.world.getPhysicPixels(t.bannerHeight,i/n)}return 50},e}(Phaser.Plugins.BasePlugin),ue=le,de=function(){function t(t,e,n){this.name=void 0,this.color=void 0,this.selfLog=void 0,this.options=void 0,this.name=t,this.color=n||"#FFF",this.options=e,this.selfLog=!0}var e=t.prototype;return e.event=function(t,e,n){this.processEvent(t,e,n),this.selfLog},e.pageview=function(t){var e=this.getPageByKey(t);this.processPageView(e),this.selfLog},e.setTrafficSource=function(t){this.processTrafficSource(t),this.selfLog},e.levelStart=function(t,e,n){this.processLevelStart(t,e,n),this.selfLog},e.levelFail=function(t,e,n){this.processLevelFail(t,e,n),this.selfLog},e.levelRescue=function(t,e,n){this.processLevelRescue(t,e,n),this.selfLog},e.levelComplete=function(t,e,n){this.processLevelComplete(t,e,n),this.selfLog},e.showInterstitialAd=function(t){this.processShowInterstitialAd(t),this.selfLog},e.showRewardedVideoAd=function(t){this.processShowRewardedVideoAd(t),this.selfLog},e.receiveReward=function(t){this.processReceiveReward(t),this.selfLog},e.showAdFail=function(t,e,n){this.processShowAdFail(t,e,n),this.selfLog},e.getPageByKey=function(t){var e=t.replace(/_/g,"-");return e=e.toLowerCase()},e.processLevelStart=function(t,e,n){},e.processLevelFail=function(t,e,n){},e.processLevelRescue=function(t,e,n){},e.processLevelComplete=function(t,e,n){},e.processShowInterstitialAd=function(t){},e.processShowRewardedVideoAd=function(t){},e.processReceiveReward=function(t){},e.processShowAdFail=function(t,e,n){},t}();GameCore.Analytics={BaseAnalytics:de};var pe=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).analytics=void 0,n.pageview=function(t){n.isActive()&&n.analytics.forEach((function(e){e.pageview(t)}))},n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.analytics=[]},n.add=function(t){this.analytics.push(t)},n.setTrafficSource=function(t){this.isActive()&&this.analytics.forEach((function(e){e.setTrafficSource(t)}))},n.event=function(t,e,n){this.isActive()&&this.analytics.forEach((function(i){i.event(t,e,n)}))},n.levelStart=function(t,e,n){this.isActive()&&this.analytics.forEach((function(i){i.levelStart(t,e,n)}))},n.levelRescue=function(t,e,n){this.isActive()&&this.analytics.forEach((function(i){i.levelRescue(t,e,n)}))},n.levelFail=function(t,e,n){this.isActive()&&this.analytics.forEach((function(i){i.levelFail(t,e,n)}))},n.levelComplete=function(t,e,n){this.isActive()&&this.analytics.forEach((function(i){i.levelComplete(t,e,n)}))},n.showInterstitialAd=function(t){this.isActive()&&this.analytics.forEach((function(e){e.showInterstitialAd(t)}))},n.showRewardedVideoAd=function(t){this.isActive()&&this.analytics.forEach((function(e){e.showRewardedVideoAd(t)}))},n.receiveReward=function(t){this.isActive()&&this.analytics.forEach((function(e){e.receiveReward(t)}))},n.showAdFail=function(t,e,n){this.isActive()&&this.analytics.forEach((function(i){i.showAdFail(t,e,n)}))},n.isActive=function(){return this.analytics.length>=1},e}(Phaser.Plugins.BasePlugin),fe=pe,ge=function(){function t(t,e,n){var i=this;this.name=void 0,this.game=void 0,this.isSprite=void 0,this.audio=void 0,this.markers=void 0,this.volume=void 0,this.isMusicEnabled=function(){return!!i.game.player.getPlayerSetting("music")},this.isSoundEnabled=function(){return!!i.game.player.getPlayerSetting("sound")},this.name=e,this.game=t,this.markers={},this.isSprite=n,this.isSprite||(this.audio=this.game.sound.add(this.name))}var e=t.prototype;return e.play=function(t,e){var n,i,a,r=(0,wt.default)({volume:this.volume},e||{});if(r.volume!==this.volume&&(r.volume*=this.volume),!this.isSprite)return(null==(i=this.audio)?void 0:i.seek)>0?void this.audio.resume():void(null==(a=this.audio)||a.play(t,r));this.createMaker(t),null==(n=this.markers[t])||n.play(t,r)},e.pause=function(t){var e,n;this.isSprite?null==(e=this.markers[t])||e.pause():null==(n=this.audio)||n.pause()},e.stop=function(t){var e,n;this.isSprite?null==(e=this.markers[t])||e.stop():null==(n=this.audio)||n.stop()},e.setVolume=function(t){this.volume=t},e.createMaker=function(t){if(!this.markers[t])try{this.markers[t]=this.game.sound.addAudioSprite(this.name)}catch(e){}},t}(),me=ge,ve=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).soundManager=void 0,n.musicManager=void 0,n.isMuteAll=void 0,n.initMusic=function(t){n.musicManager=new me(n.game,t,!1),n.setMusicVolume(n.isMuteAll?0:1)},n.initSound=function(t){n.soundManager=new me(n.game,t,!0),n.setSoundVolume(n.isMuteAll?0:1)},n}(0,Kt.default)(e,t);var n=e.prototype;return n.playSound=function(t,e){try{if(!this.soundManager||this.isMuteAll)return;if(!this.soundManager.isSoundEnabled())return;this.soundManager.play(t,e)}catch(n){}},n.stopSound=function(t){try{this.soundManager.stop(t)}catch(e){}},n.playMusic=function(t){void 0===t&&(t={});try{if(!this.musicManager||this.isMuteAll)return;if(!this.musicManager.isMusicEnabled())return;this.musicManager.play("",(0,wt.default)({loop:!0,volume:.2},t))}catch(e){}},n.pauseMusic=function(){try{if(!this.musicManager)return;this.musicManager.pause("")}catch(t){}},n.stopMusic=function(){try{if(!this.musicManager)return;this.musicManager.stop("")}catch(t){}},n.setSoundVolume=function(t){try{if(!this.soundManager)return;this.soundManager.setVolume(t)}catch(e){}},n.setMusicVolume=function(t){try{if(!this.musicManager)return;this.musicManager.setVolume(t)}catch(e){}},n.muteAll=function(){this.isMuteAll=!0,this.setMusicVolume(0),this.setSoundVolume(0)},n.unmuteAll=function(t){void 0===t&&(t=1),this.isMuteAll=!1,this.setMusicVolume(t),this.setSoundVolume(t)},e}(Phaser.Plugins.BasePlugin),ye=ve,Se=n(112),Ae="AUTH_TOKEN_REQUEST",Ee="AUTH_TOKEN_RECEIVED",xe=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).payload=void 0,i.name="RequestTokenFail",i.message=e||"Request token fail",i.payload=n||{},i}return(0,Kt.default)(e,t),e}((0,se.default)(Error)),be=n(60),Te=(0,be.createSelector)([function(t){return t.auth.token}],(function(t){return t})),we=(0,be.createSelector)([function(t){return t.auth.isRequesting}],(function(t){return t})),Ce=function(t){return{type:Ee,payload:{token:t}}},Me=function(t){function e(){return t.apply(this,arguments)||this}(0,Kt.default)(e,t);var n=e.prototype;return n.requestToken=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.game.storage,t.next=3,e.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,r,s;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,i=window.game.facebook,a=n(),r=Te(a),!we(a)&&""===r){t.next=7;break}return t.abrupt("return");case 7:return e({type:Ae,payload:{}}),t.next=10,i.getPlayerToken();case 10:s=t.sent,e(Ce(s)),t.next=25;break;case 14:if(t.prev=14,t.t0=t.catch(0),!(t.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(t.t0,"code"))){t.next=19;break}if("PENDING_REQUEST"!==t.t0.code){t.next=19;break}return t.abrupt("return");case 19:if(e(Ce("")),!(t.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(t.t0,"message"))){t.next=24;break}if("string"!==typeof t.t0.message){t.next=24;break}return(0,Ht.sendException)(new Error(t.t0.message)),t.abrupt("return");case 24:(0,Ht.sendException)(new xe);case 25:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e,n){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.getToken=function(){return Te(this.state)},(0,Se.default)(e,[{key:"state",get:function(){return this.game.storage.getState()}}]),e}(Phaser.Plugins.BasePlugin),Ie=Me,Pe=function(t,e){void 0===e&&(e=1);var n=new Image;n.onload=function(){var t,n;t=this.width*e,n=this.height*e,Math.floor(n/2),Math.floor(t/2)},n.src=t},ke=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).width=void 0,n.height=void 0,n.renderOptions=void 0,n.canvas=void 0,n}(0,Kt.default)(e,t);var n=e.prototype;return n.preload=function(t){var e=this,n=Y()(t);n.length<1||(n.forEach((function(n){e.scene.load.image(n,t[n])})),this.scene.load.start())},n.capture=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.width,i=e.height,a=e.renderOptions,this.width=n,this.height=i,this.renderOptions=a,this.createCanvas(),t.next=8,this.loadImages();case 8:return this.drawObjects(),t.abrupt("return",this.snapshotFrame());case 10:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.createCanvas=function(){this.canvas||(this.canvas=this.game.textures.createCanvas("FrameCaptureCanvas")),this.canvas.clear(),this.canvas.setSize(this.width,this.height)},n.loadImages=function(){var t=this;return new(mt())((function(e,n){for(var i in t.renderOptions){var a=t.renderOptions[i],r=a.name,s=a.image;if(s)t.scene.textures.get(r).key!==r&&t.scene.load.image(r,s)}t.scene.load.on(Phaser.Loader.Events.COMPLETE,e),t.scene.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,(function(){var t=new Error("Load image failed");n(t)})),t.scene.load.start()}))},n.drawObjects=function(){for(var t in this.renderOptions){var e=this.renderOptions[t];switch(e.type){case"text":this.drawText(e);break;case"image":this.drawImage(e)}}},n.drawText=function(t){var e=this.canvas.context,n=t.x,i=t.y,a=t.font,r=t.text,s=t.fillStyle,o=t.lineWidth,h=t.textAlign;e.font=a+' nunito,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif',e.fillStyle=s||"#ffffff",o&&(e.lineWidth=o),h&&(e.textAlign=h),e.fillText(r,n,i)},n.drawImage=function(t){var e=this.canvas.context,n=t.x,i=t.y,a=t.name,r=t.frame,s=t.width,o=t.height,h=t.fallbackWithImage,c=this.scene.textures.get(a),l=c.getSourceImage(r);"__MISSING"===c.key&&h&&(l=(c=this.scene.textures.get(h)).getSourceImage()),e.drawImage(l,n,i,s,o)},n.snapshotFrame=function(){var t=this.canvas.getCanvas().toDataURL("image/jpeg",.85);return GameCore.Utils.Valid.isDebugger()&&Pe(t),t},e}(Phaser.Plugins.ScenePlugin),Re=ke,Oe={sound:!0,music:!0,vibrate:!0,language:"en",theme:GameCore.Configs.DefaultTheme},_e=n(43),De=n.n(_e),Le=function(t){try{var e=localStorage.getItem(t);return null===e?null:GameCore.Utils.Json.decode(e)}catch(n){return null}},Be=function(t,e){try{var n=Le(t),i={};GameCore.Utils.Valid.isObject(n)&&(i=n);var a=GameCore.Utils.Json.clone(e);if(!GameCore.Utils.Valid.isObject(a))return!1;var r=GameCore.Utils.Object.clear(a),s=(0,Ct.merge)(i,r),o=GameCore.Utils.Json.encode(s);return localStorage.setItem(t,o),!0}catch(h){return!1}},Fe=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="BadRequest",i.message=e||"This request is bad",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,se.default)(Error)),Ne=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="RequestTimeout",i.message=e||"This request is timeout",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,se.default)(Error)),Ge=n(111),Ue=GameCore.Configs,Ve=Ue.AppId,Ye=Ue.Network,ze=function(t){if(!t.ok)throw new Fe(null,{response:t})},He=function(){var t=window.game.auth.getToken();return{token:t,timeout:Ye.Timeout,headers:{Authorization:"Bearer "+t,"Content-Type":"application/json"}}},We=function(t,e,n,i){return(0,Xt.default)(qt().mark((function a(){var r,s,o,h,c;return qt().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,r=t+"/apps/"+Ve+"/"+e,s=new AbortController,n.signal=s.signal,o=setTimeout((function(){s.abort()}),n.timeout),GameCore.Utils.Valid.isObject(i)&&(n.body=_()(i)),a.next=8,fetch(r,n);case 8:return h=a.sent,clearTimeout(o),ze(h),a.next=13,h.json();case 13:if(a.t0=a.sent,a.t0){a.next=16;break}a.t0={};case 16:return c=a.t0,a.abrupt("return",c);case 20:if(a.prev=20,a.t1=a.catch(0),!(a.t1 instanceof Fe)){a.next=24;break}return a.abrupt("return",null);case 24:if(!(a.t1 instanceof Object&&GameCore.Utils.Object.hasOwn(a.t1,"name"))){a.next=27;break}if("AbortError"!==a.t1.name){a.next=27;break}throw new Ne(null);case 27:throw a.t1;case 28:case"end":return a.stop()}}),a,null,[[0,20]])})))},Xe=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.abrupt("return",e());case 4:if(t.prev=4,t.t0=t.catch(0),!(t.t0 instanceof Ne&&n>0)){t.next=18;break}return t.prev=7,t.next=10,(0,Ge.sleepAsync)(600);case 10:return t.next=12,Xe(e,n-1);case 12:return t.abrupt("return",t.sent);case 15:return t.prev=15,t.t1=t.catch(7),t.abrupt("return",{});case 18:if(!(t.t0 instanceof Ne)){t.next=20;break}return t.abrupt("return",{});case 20:return t.abrupt("return",{});case 22:case"end":return t.stop()}}),t,null,[[0,4],[7,15]])})));return function(e,n){return t.apply(this,arguments)}}(),Ke=function(){var t=(0,Xt.default)(qt().mark((function t(e,n,i,a){var r,s;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===n&&(n={}),void 0===a&&(a=Ye.Retries),t.prev=2,r=(0,wt.default)({},He(),n,{method:"GET"}),s=We(i,e,r),t.next=7,Xe(s,a);case 7:return t.abrupt("return",t.sent);case 10:return t.prev=10,t.t0=t.catch(2),t.abrupt("return",{});case 14:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e,n,i,a){return t.apply(this,arguments)}}(),je=function(){var t=(0,Xt.default)(qt().mark((function t(e,n,i,a,r){var s,o;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===i&&(i={}),void 0===r&&(r=Ye.Retries),t.prev=2,s=(0,wt.default)({},He(),i,{method:"POST"}),o=We(a,e,s,n),t.next=7,Xe(o,r);case 7:return t.abrupt("return",t.sent);case 10:return t.prev=10,t.t0=t.catch(2),t.abrupt("return",{});case 14:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e,n,i,a,r){return t.apply(this,arguments)}}(),qe={score:0,settings:(0,wt.default)({},Oe),userGuideDisplays:0,customFields:{diamond:300,lastReceiveGift:0}},Ze=GameCore.Configs,Je=Ze.ApiHost,Qe=Ze.PlayerDataStoreUsingApi,$e=function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Qe){t.next=2;break}return t.abrupt("return",tn(e));case 2:return t.abrupt("return",en(e));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),tn=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=GameCore.Utils.String.params(e),t.next=3,Ke("players?"+n,{},Je);case 3:return i=t.sent,t.abrupt("return",(null==i?void 0:i.data)||[]);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),en=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,r,s;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.player.setDataAsync(e);case 2:return i=et()(n=Y()(qe)).call(n,Y()(e)),a=c()(i).call(i,(function(t,e){return g()(i).call(i,t)===e})),t.next=6,GameSDK.player.getDataAsync(a);case 6:return r=t.sent,t.next=9,GameSDK.player.getStatsAsync();case 9:return s=t.sent,t.abrupt("return",(0,wt.default)({},r,s));case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),nn=function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Qe){t.next=2;break}return t.abrupt("return",an(e));case 2:return t.abrupt("return",rn());case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),an=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,je("players/"+e+"/user-guide-displays/inc",{},{},Je);case 2:return n=t.sent,t.abrupt("return",(null==n?void 0:n.data)||{});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),rn=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.player.incrementStatsAsync({userGuideDisplays:1});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),sn="PLAYER_RECEIVED",on="PLAYER_DATA_UPDATE",hn="PLAYER_SCORE_UPDATE",cn="PLAYER_SETTING_UPDATE",ln="PLAYER_CONNECTED_PLAYERS_UPDATE",un=n(254),dn=Oe.sound,pn=Oe.music,fn=Oe.vibrate,gn=Oe.language,mn=Oe.theme,vn=function(){function t(t){this.sound=void 0,this.music=void 0,this.vibrate=void 0,this.language=void 0,this.theme=void 0;var e=t||{},n=e.sound,i=e.music,a=e.vibrate,r=e.language,s=e.theme;this.sound=GameCore.Utils.Valid.isBoolean(n)?n:dn,this.music=GameCore.Utils.Valid.isBoolean(i)?i:pn,this.vibrate=GameCore.Utils.Valid.isBoolean(a)?a:fn,this.language=GameCore.Utils.Valid.isString(r)?r:gn,this.theme=GameCore.Utils.Valid.isString(s)?s:mn}return t.prototype.toObject=function(){return{sound:this.sound,music:this.music,vibrate:this.vibrate,language:this.language,theme:this.theme}},t}(),yn=vn,Sn=qe.userGuideDisplays,An=qe.customFields,En=qe.settings,xn=function(){function t(t){this.data=void 0;var e=t.settings,n=t.score,i=t.customFields,a=t.userGuideDisplays,r=GameCore.Utils.Valid.isNumber(n)&&n>0?n:0,s=GameCore.Utils.Valid.isNumber(a)?a:Sn,o=GameCore.Utils.Valid.isObject(i)?i:An,h=En;GameCore.Utils.Valid.isObject(e)&&(h=new yn(e).toObject()),this.data={score:r,userGuideDisplays:s,settings:h,customFields:o}}return t.prototype.toObject=function(){return this.data},t}(),bn=xn,Tn=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).payload=void 0,i.name="PlayerDataNameNotSupport",i.message=e||"The name of player data is not supported",i.payload=n||{},i}return(0,Kt.default)(e,t),e}((0,se.default)(Error)),wn=(0,be.createSelector)([function(t){return t.player}],(function(t){return t})),Cn=(0,be.createSelector)([wn],(function(t){return t.playerId})),Mn=(0,be.createSelector)([function(t){return t.player.data}],(function(t){return t})),In=(0,be.createSelector)([Mn],(function(t){return t.settings})),Pn=(0,be.createSelector)([function(t){return t.player.connectedPlayers}],(function(t){return t})),kn=(0,be.createSelector)([Pn,function(t,e){return e.limit},function(t,e){return e.offset}],(function(t,e,n){if("number"!==typeof e)return[];if("number"!==typeof n)return[];var i=Y()(t);return s()(i).call(i,n,e+n)||[]})),Rn=(0,be.createSelector)([Mn],(function(t){return t.score})),On=(0,be.createSelector)([Mn],(function(t){return t.customFields})),_n=((0,be.createSelector)([On],(function(t){return null==t?void 0:t.diamond})),GameCore.Configs),Dn=_n.AppId,Ln=_n.LanguageSupport,Bn=_n.ThemeSupport,Fn=_n.PlayerDataStore,Nn=function(t){return{type:ln,payload:{connectedPlayers:t}}},Gn=function(t,e){return function(n,i){try{var a,r=i(),s=In(r);n({type:cn,payload:{name:t,value:e}});var o={settings:(0,wt.default)({},s,(a={},a[t]=e,a))};Be(Fn,o),$e(o)}catch(h){(0,Ht.sendException)(h)}}},Un=function(t,e){return function(){var n=(0,Xt.default)(qt().mark((function n(i,a){var r,s,o,h;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,s={customFields:(r={},r[t]=e,r)},n.next=4,i(Yn(s));case 4:o=a(),h=Mn(o),$e(h),n.next=14;break;case 9:if(n.prev=9,n.t0=n.catch(0),!(n.t0 instanceof Tn)){n.next=13;break}return n.abrupt("return");case 13:(0,Ht.sendException)(n.t0);case 14:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(t,e){return n.apply(this,arguments)}}()},Vn=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n,i){var a,r,s;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={customFields:t},e.next=4,n(Yn(a));case 4:r=i(),s=Mn(r),$e(s),e.next=14;break;case 9:if(e.prev=9,e.t0=e.catch(0),!(e.t0 instanceof Tn)){e.next=13;break}return e.abrupt("return");case 13:(0,Ht.sendException)(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}()},Yn=function(t){return function(e){try{e({type:on,payload:{data:t}}),Be(Fn,t)}catch(n){(0,Ht.sendException)(n)}}},zn=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n,i){var a,r;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n({type:hn,payload:{score:t}});case 3:$e({score:t}),a=i(),r=Mn(a),Be(Fn,r),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),(0,Ht.sendException)(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}()},Hn=function(t){function e(){return t.apply(this,arguments)||this}(0,Kt.default)(e,t);var n=e.prototype;return n.incUserGuideDisplays=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.game.storage,t.next=3,e.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game.facebook,e(Yn({userGuideDisplays:1})),a=n(),r=Cn(a),t.next=7,nn(r);case 7:i.data.set("userGuideDisplays",1),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e,n){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.receiveData=function(t,e){this.game.storage.dispatch(function(t,e){return function(n){var i=t.playerId,a=t.name,r=t.photo,s=t.locale;n({type:sn,payload:{playerId:i,name:a,photo:r,locale:s,data:e||{}}})}}(t,e))},n.updateData=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.game.storage,t.next=3,e.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,r,s,o,h,c,l,u,d,p,f,g,m,v,y,S,A,E,x,b,T;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=n(),a=wn(i),r=a.playerId,s=a.name,o=a.photo,h=a.locale,t.next=6,$e({appId:Dn,playerId:r,name:s,photo:o,locale:h});case 6:if(c=t.sent,GameCore.Utils.Valid.isObject(c)){t.next=9;break}return t.abrupt("return");case 9:if(c.playerId===r){t.next=11;break}return t.abrupt("return");case 11:l=In(i),u=l.theme,d=l.sound,p=l.music,f=l.vibrate,g=l.language,m=new bn(c).toObject(),v=m.settings,y=v.theme,S=v.music,A=v.sound,E=v.vibrate,x=v.language,b=g in Ln,T=u in Bn,g===x&&b||(m.settings.language=x),!0===S&&p!==S&&(m.settings.music=S),!0===A&&d!==A&&(m.settings.sound=A),!0===E&&f!==E&&(m.settings.vibrate=E),u===y&&T||(m.settings.theme=y),e(Yn(m)),!0===m.settings.music&&window.game.audio.playMusic(),t.next=29;break;case 26:t.prev=26,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 29:case"end":return t.stop()}}),t,null,[[0,26]])})));return function(e,n){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.setScore=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.game.storage,t.next=3,n.dispatch(zn(e));case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.setSetting=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.game.storage,t.next=3,i.dispatch(Gn(e,n));case 3:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),n.setCustomData=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.game.storage,t.next=3,i.dispatch(Un(e,n));case 3:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),n.updateCustomFields=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.game.storage,t.next=3,n.dispatch(Vn(e));case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.requestConnectedPlayers=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.game.storage,t.next=3,e.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,r,s;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game.facebook,t.next=4,new(mt())((function(t,e){i.once("players",(function(e){t(e)})),i.once("playersfail",(function(){return e([])})),i.getPlayers()}));case 4:if(a=t.sent,r=function(t){return!!t},s=c()(n=De()(a).call(a,(function(t){var e=t.getID(),n=t.getName(),i=t.getPhoto();return e&&n&&i?new un.default(e,n,i).toObject():null}))).call(n,r),!(s.length<1)){t.next=9;break}return t.abrupt("return");case 9:e(Nn(s)),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.updateConnectedPlayers=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.game.storage,t.next=3,n.dispatch(Nn(e));case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.getPlayer=function(){return wn(this.state)},n.getPlayerId=function(){return this.getPlayer().playerId},n.getPlayerData=function(){return this.getPlayer().data},n.getPlayerSetting=function(t){var e=this.getPlayerSettings();return"string"!==typeof t?null:GameCore.Utils.Object.hasOwn(e,t)?e[t]:GameCore.Utils.Object.hasOwn(Oe,t)?Oe[t]:null},n.getPlayerSettings=function(){return this.getPlayerData().settings},n.getPlayerIsNew=function(){return this.getPlayer().isUserNew},n.getCoins=function(){var t=this.getCustomData("coin");return GameCore.Utils.Valid.isNumber(t)?t:0},n.getDiamond=function(){var t=this.getCustomData("diamond");return GameCore.Utils.Valid.isNumber(t)?t:0},n.getBestScore=function(){return Rn(this.state)},n.getCustomData=function(t){var e=On(this.state);return GameCore.Utils.Valid.isObject(e)&&GameCore.Utils.Object.hasOwn(e,t)?e[t]:null},n.getConnectedPlayers=function(){return Pn(this.state)},n.getConnectedPlayerIds=function(t,e){return kn(this.state,{limit:t,offset:e})},(0,Se.default)(e,[{key:"state",get:function(){return this.game.storage.getState()}}]),e}(Phaser.Plugins.BasePlugin),Wn=Hn,Xn=GameCore.Configs.ApiHost,Kn=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=GameCore.Utils.String.params(e),t.next=3,Ke("players?"+n,{},Xn);case 3:return i=t.sent,t.abrupt("return",(null==i?void 0:i.data)||[]);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),jn="PROFILES_DATA_UPDATE",qn=(0,be.createSelector)([function(t){return t.profile.data}],(function(t){return t})),Zn=(0,be.createSelector)([function(t){return t.profile.profileIds}],(function(t){return t})),Jn=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n,i){var a,r,s,o;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=i(),r=Zn(a),!((s=GameCore.Utils.Array.difference(t,r)).length<1)){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,Kn({playerIds:s});case 8:o=e.sent,n({type:jn,payload:{data:o}}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),(0,Ht.sendException)(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,n){return e.apply(this,arguments)}}()},Qn=function(t){function e(){return t.apply(this,arguments)||this}(0,Kt.default)(e,t);var n=e.prototype;return n.requestProfiles=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.game.storage,t.next=3,n.dispatch(Jn(e));case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.getProfiles=function(){return qn(this.state)},(0,Se.default)(e,[{key:"state",get:function(){return this.game.storage.getState()}}]),e}(Phaser.Plugins.BasePlugin),$n=Qn,ti=function(t){function e(){return t.apply(this,arguments)||this}return(0,Kt.default)(e,t),e.prototype.emit=function(e,n){return t.prototype.emit.call(this,e,n)},e}(Phaser.Events.EventEmitter),ei=ti,ni=n(47),ii=function(t){function e(e,n,i,a){var r;(r=t.call(this,e)||this).zone=void 0,r.background=void 0,r.setName(n),r.setVisible(!1);var s=r.scene.world.getWorldSize(),o=s.width,h=s.height;return r.setSize(i||o,a||h),r.addZone(),r.addBackground(),r}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(t){GameCore.Utils.Valid.isObject(t)&&(this.setDataEnabled(),this.setData(t)),this.setBlockInputOutsideEnabled(!0),this.scene.screen.bringToTop(this.name),this.visible||(this.setVisible(!0),this.logPageviewOnOpen(),this.logEventOpen())},n.close=function(){this.setBlockInputOutsideEnabled(!1),this.visible&&(this.setVisible(!1),this.logPageviewOnClose())},n.setBlockInputOutsideEnabled=function(t){this.scene.input.setTopOnly(t)},n.addZone=function(){this.zone=this.scene.add.zone(0,0,this.width,this.height),this.zone.setInteractive({}),this.add(this.zone)},n.addBackground=function(){var t="screen-background";if(!this.scene.textures.exists(t)){var e=this.width+2,n=this.height+2,i=this.scene.add.graphics();i.fillStyle(0,1),i.fillRect(0,0,e,n),i.generateTexture(t,e,n),i.destroy()}this.background=this.scene.add.image(0,0,t),this.background.setInteractive(),this.add(this.background)},n.logPageviewOnOpen=function(){this.scene.analytics.pageview(this.name)},n.logPageviewOnClose=function(){this.scene.analytics.pageview(this.scene.scene.key)},n.logEventOpen=function(){this.scene.analytics.event(ni.AnalyticsEvents.SCREEN_OPEN,{screen_name:this.getScreenName()})},n.getScreenName=function(){return GameCore.Utils.String.toUpperCamelCase(this.name.toLowerCase())},e}(Phaser.GameObjects.Container),ai=ii,ri={OPEN:"open",CLOSE:"close",CREATED:"created"};GameCore.Screen=ai,GameCore.Screens={Events:ri};var si=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).events=void 0,n}(0,Kt.default)(e,t);var n=e.prototype;return n.boot=function(){this.events=new ei,this.registryScreenFactory()},n.get=function(t){var e=this.scene.children.getByName(t);return null===e?null:e},n.add=function(t,e,n,i){var a=this.get(t);return a||(a=this.scene.add.screen(t,e,n,i),this.events.emit(GameCore.Screens.Events.CREATED,a),a)},n.open=function(t,e){var n=this.get(t);return!!n&&(n.open(e),n.emit(GameCore.Screens.Events.OPEN,n),this.events.emit(GameCore.Screens.Events.OPEN,n),!0)},n.close=function(t){var e=this.get(t);return!!e&&(e.close(),e.emit(GameCore.Screens.Events.CLOSE,e),this.events.emit(GameCore.Screens.Events.CLOSE,e),!0)},n.bringToTop=function(t){var e=this.scene.children.getByName(t);e&&this.scene.children.bringToTop(e)},n.registryScreenFactory=function(){Phaser.GameObjects.GameObjectFactory.register("screen",this.createScreen)},n.createScreen=function(t,e,n,i){var a=new e(this.scene,t,n,i);return Phaser.Display.Align.In.Center(a,this.scene.gameZone),this.existing(a),a},e}(Phaser.Plugins.ScenePlugin),oi=si,hi=n(448),ci=n.n(hi),li=n(326),ui=n(545),di="CONTEXT_RECEIVED",pi="CONTEXT_PROCESSED",fi="CONTEXT_GAME_MODE_DETECTED",gi="MESSAGES_SENT_UPDATE",mi="MESSAGES_SENT_REMOVE",vi="SCENE_KEY_UPDATE",yi=n(50),Si={currentSceneKey:"",prevSceneKey:""};(0,yi.enableES5)();var Ai,Ei,xi,bi,Ti,wi,Ci,Mi,Ii,Pi,ki,Ri={processed:!1,contextId:"",contextType:"SOLO",entryPointData:{},currentGameMode:""},Oi=Ri,_i={data:{}},Di={token:"",isRequesting:!1},Li=(Ai={},Ai.auth=function(t,e){return void 0===t&&(t=Di),(0,yi.default)(t,(function(t){var n=e.payload;if(n){var i=n.token;switch(e.type){case Ae:t.isRequesting=!0;break;case Ee:t.token=i,t.isRequesting=!1}}}))},Ai),Bi={playerId:"",name:"",photo:"",locale:"",connectedPlayers:{},data:{score:0,settings:Oe,userGuideDisplays:0,customFields:{}},isUserNew:!0},Fi=(Ei={},Ei.player=function(t,e){return void 0===t&&(t=Bi),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.name,r=i.value,s=i.data,o=void 0===s?{}:s,h=i.score,c=i.connectedPlayers,l=void 0===c?[]:c;switch(e.type){case sn:var u=i.playerId,d=i.name,p=i.photo,f=i.locale,g=i.data;if(n.playerId=u,n.name=d,n.photo=p,n.locale=f,GameCore.Utils.Valid.isObject(g)){var m=g;n.data=(0,Ct.merge)(t.data,m)}g.userGuideDisplays>0&&(n.isUserNew=!1);break;case hn:n.data.score=h;break;case cn:if(!GameCore.Utils.Object.hasOwn(n.data.settings,a))break;n.data.settings[a]=r;break;case on:n.data=(0,Ct.merge)(t.data,o),o.userGuideDisplays>0&&(n.isUserNew=!1);break;case ln:if(l.length<=0)break;var v=GameCore.Utils.Object.keyBy(l,"playerId");n.connectedPlayers=(0,Ct.merge)(t.connectedPlayers,v)}}}))},Ei),Ni=n(546),Gi=n.n(Ni),Ui={data:{},profileIds:[]},Vi=(xi={},xi.profile=function(t,e){return void 0===t&&(t=Ui),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.data,r=void 0===a?[]:a;if(e.type===jn){var s,o,h=GameCore.Utils.Object.keyBy(r,"playerId"),c=Y()(h);n.data=(0,Ct.merge)((0,wt.default)({},t.data),h),n.profileIds=et()(s=[]).call(s,new(Gi())(et()(o=[]).call(o,t.profileIds,c)))}}}))},xi),Yi="MATCH_GAMEPLAY_INITIALIZE",zi="MATCH_GAMEPLAY_START",Hi="MATCH_GAMEPLAY_FINISH",Wi="MATCH_GAMEPLAY_UPDATE",Xi="MATCH_GAMEPLAY_RESCUE",Ki="MATCH_GAMEPLAY_RESET_RESCUE",ji="MATCH_GAMEPLAY_SHOW_MINI_JOURNEY",qi="MATCH_STATS_DATA_CLEAR",Zi="MATCH_STATS_DATA_UPDATE",Ji="MATCH_STATS_CURRENT_UPDATE",Qi="MATCH_SINGLE_CREATE_REQUEST",$i="MATCH_SINGLE_DETAIL_REQUEST",ta="MATCH_SINGLE_MOVE_UPDATED",ea="MATCH_SINGLE_DATA_RECEIVED",na="MATCH_SINGLE_DATA_CLEAR",ia="MATCH_JOURNEY_CREATE_REQUEST",aa="MATCH_JOURNEY_DATA_CLEAR",ra="MATCH_JOURNEY_MOVE_UPDATED",sa="MATCH_JOURNEY_DATA_RECEIVED",oa="MATCH_JOURNEY_DAILY_CHALLENGE_START",ha="MATCH_JOURNEY_DAILY_CHALLENGE_COMPLETED",ca="MATCH_JOURNEY_SCORE_RECEIVED",la="MATCH_CHALLENGE_JOIN_REQUEST",ua="MATCH_CHALLENGE_CREATE_REQUEST",da="MATCH_CHALLENGE_FINISH_REQUEST",pa="MATCH_CHALLENGE_CONTINUE_REQUEST",fa="MATCH_CHALLENGE_DATA_RECEIVED",ga="MATCH_CHALLENGE_DATA_CLEAR",ma="MATCH_GROUP_CREATE_REQUEST",va="MATCH_GROUP_FINISH_REQUEST",ya="MATCH_ONLINE_CREATE_REQUEST",Sa="MATCH_ONLINE_DATA_RECEIVED",Aa="MATCH_ONLINE_STATS_UPDATE",Ea="MATCH_ONLINE_FINISH_REQUEST",xa="MATCH_ONLINE_DATA_CLEAR",ba="open",Ta="active",wa="finished",Ca={mode:"",status:ba,rescued:0,startAt:0,finishAt:0,showMiniJourney:null},Ma={single:{_id:"",data:{fen:""},playerId:"",status:ba},group:{status:ba,opponentInfo:{playerId:"",name:"",photo:""}},challenge:{_id:"",status:ba,whitePlayerId:"",blackPlayerId:"",opponentInfo:{playerId:"",name:"",photo:""}},online:{_id:"",status:ba,players:{}},journey:{_id:"",data:{fen:""},playerId:"",status:ba,challengeMode:!1},updateAt:0,isRequesting:!1},Ia={current:{updateAt:0},data:{updateAt:0},isRequesting:!1},Pa=(bi={},bi.match=(0,li.combineReducers)({gameplay:function(t,e){return void 0===t&&(t=Ca),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.mode,r=i.status,s=i.stateShowMiniJourney,o=i.rescued;switch(e.type){case Yi:n.status=ba,n.mode=Ca.mode,n.rescued=Ca.rescued,n.startAt=Ca.startAt,n.finishAt=Ca.finishAt,n.opponentInfo=Ca.opponentInfo;break;case zi:n.mode=a,n.status=Ta,n.rescued=o,n.startAt=Date.now();break;case Wi:n.mode="string"===typeof a?a:t.mode,n.status=r||t.status;break;case Hi:n.status=wa,n.finishAt=Date.now();break;case Xi:n.rescued+=1;break;case ji:n.showMiniJourney=s;break;case Ki:n.rescued=0}}}))},match:function(t,e){return void 0===t&&(t=Ma),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.match,r=i.opponentInfo,s=i.players,o=i.score;switch(e.type){case Qi:case $i:case la:case da:case ya:case ia:n.isRequesting=!0;break;case ta:n.single=(0,wt.default)({},t.single,a),n.updateAt=Date.now();break;case ra:n.journey=(0,wt.default)({},t.journey,a),n.updateAt=Date.now();break;case oa:n.journey.challengeMode=!0;break;case ha:n.journey.challengeMode=!1;break;case ea:n.isRequesting=!1,n.single=a||Ma.single;break;case sa:n.isRequesting=!1,n.journey=a||Ma.journey;break;case ca:n.journey.score=o;break;case na:n.isRequesting=!1,n.single=Ma.single;break;case aa:n.isRequesting=!1,n.journey=Ma.journey;break;case ua:case pa:n.isRequesting=!0,n.challenge.opponentInfo=r;break;case fa:n.isRequesting=!1,n.challenge=(0,wt.default)({},a||Ma.challenge),n.challenge.opponentInfo=t.challenge.opponentInfo;break;case ga:n.isRequesting=!1,n.challenge=Ma.challenge;break;case ma:n.group.status=Ta,r&&(n.group.opponentInfo=r);break;case va:n.group.status=wa;break;case xa:n.online.status=Ma.online.status,n.online.players=Ma.online.players;break;case Sa:n.online.status=Ta,n.online.players=s;break;case Ea:n.online.status=wa}}}))},stats:function(t,e){return void 0===t&&(t=Ia),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.playerId,r=i.stats,s=i.match,o=i.current,h=i.players,c=i.leaders;switch(e.type){case qi:delete n.data[a],n.current=Ia.current;break;case"MATCH_STATS_CONTEXT_REQUEST":n.data=Ia.data,n.isRequesting=!0;break;case"MATCH_STATS_CONTEXT_RECEIVED":n.data=r,n.isRequesting=!1;break;case Zi:n.data[a]=r;break;case Ji:n.current=(0,Ct.merge)((0,wt.default)({},t.current),r);break;case Sa:Y()(h).forEach((function(t){n.data[t]={score:0}}));break;case Aa:c.forEach((function(t){var e=t.playerId,i=t.score,a=t.rank;n.data[e]={score:i,rank:a}}));break;case fa:var l=s||{},u=l.blackPlayerId,d=l.blackPlayerScore,p=l.whitePlayerId,f=l.whitePlayerScore,g=l.whitePlayerLevel,m=l.blackPlayerLevel;if(!u||!p)break;o&&(n.current=o),n.data[u]={score:d,level:m},n.data[p]={score:f,level:g}}}}))}}),bi),ka="TOURNAMENT_ACTIVE",Ra="TOURNAMENT_REQUEST",Oa="TOURNAMENT_RECEIVED",_a={active:!1,tournamentId:null,bestSessionScore:0,isRequesting:!1},Da=(Ti={},Ti.tournament=function(t,e){return void 0===t&&(t=_a),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.score,r=void 0===a?0:a,s=i.tournamentId;switch(e.type){case ka:n.active=!0,n.tournamentId=s;break;case Ra:n.isRequesting=!0;break;case Oa:n.isRequesting=!1,r>t.bestSessionScore&&(n.bestSessionScore=r)}}}))},Ti),La=n(327),Ba=n.n(La),Fa=n(143),Na=n.n(Fa),Ga="LEADERBOARD_DATA_REQUEST",Ua="LEADERBOARD_DATA_UPDATE",Va="LEADERBOARD_DATA_CLEAR",Ya={leaderboardId:"",type:"",limit:0,offset:0,leaders:{},isRequesting:!1},za=(wi={},wi.leaderboards=function(t,e){return void 0===t&&(t=Ya),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.leaderboardId,r=i.type,s=i.limit,o=i.offset,h=i.leaders;switch(e.type){case Ga:t.type!==r&&0===o&&(n.leaders=Ya.leaders),n.isRequesting=!0,n.leaderboardId=a,n.type=r,n.limit=s,n.offset=o;break;case Ua:if(n.isRequesting=!1,t.type!==r)break;var c=GameCore.Utils.Json.clone((0,wt.default)({},t.leaders,h)),l=Ba()(c),u=De()(l).call(l,(function(t){return t.name&&t.photo||(t.name="Unknown",t.photo=""),t}));Na()(u).call(u,(function(t,e){return+e.score-+t.score})),u.forEach((function(e,i){e.rank=i+1,t.leaders[e.playerId]||(n.leaders[e.playerId]=e)}));break;case Va:n.isRequesting=!1,n.type=Ya.type,n.limit=Ya.limit,n.offset=Ya.offset,n.leaders=Ya.leaders,n.leaderboardId=Ya.leaderboardId}}}))},wi),Ha="MISSIONS_DATA_REQUEST",Wa="MISSIONS_DATA_RECEIVE",Xa="MISSION_START",Ka="MISSION_UPDATE",ja="MISSION_COMPLETED",qa={mission:null,missions:null,isRequesting:!1},Za=(Ci={},Ci.missions=function(t,e){return void 0===t&&(t=qa),(0,yi.default)(t,(function(n){var i,a,r=e.payload;if(r){var s=r.name,o=r.type,h=r.value,c=r.missions;switch(e.type){case Ha:n.isRequesting=!0;break;case Wa:if(n.isRequesting=!1,c.length<1)return;n.missions={},c.forEach((function(t){n.missions[t.name]=t}));break;case Xa:if(null===t.missions)break;var l=t.missions[s];n.mission={name:s,process:{},require:l.require,reward:l.reward},Y()(l.require).forEach((function(t){n.mission.process[t]=0}));break;case Ka:if((null==(i=t.mission)?void 0:i.name)!==s)break;n.mission.process[o]+=h;break;case ja:if((null==(a=t.mission)?void 0:a.name)!==s)break;n.mission=null}}}))},Ci),Ja="DAILY_TASKS_DATA_REQUEST",Qa="DAILY_TASKS_DATA_RECEIVE",$a="DAILY_TASKS_PROCESS_UPDATE",tr="DAILY_TASK_VALUE_ADD",er="DAILY_TASK_REWARDED",nr="DAILY_TASKS_SEEN",ir="DAILY_TASK_FINISHED",ar={tasks:[],process:[],isRequesting:!1,isNotice:!1},rr=(Mi={},Mi.dailyTasks=function(t,e){return void 0===t&&(t=ar),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.id,r=i.type,s=i.value,o=i.tasks,h=i.process;switch(e.type){case Ja:n.isRequesting=!0;break;case Qa:n.isRequesting=!1,n.tasks=o;break;case $a:n.process=h;break;case tr:if(!t.process[a])break;n.process[a][r]+=s;break;case er:if(!t.process[a])break;n.process[a].rewarded=!0;break;case nr:n.isNotice=!1;break;case ir:n.isNotice=!0}}}))},Mi),sr={rewards:[],isRequesting:!1},or=(Ii={},Ii.dailyRewards=function(t,e){return void 0===t&&(t=sr),(0,yi.default)(t,(function(t){var n=e.payload;if(n){var i=n.rewards;switch(e.type){case"DAILY_REWARDS_REQUEST":t.isRequesting=!0;break;case"DAILY_REWARDS_RECEIVE":t.isRequesting=!1,t.rewards=i}}}))},Ii),hr="DAILY_CHALLENGE_REQUEST",cr="DAILY_CHALLENGE_UPDATE",lr="DAILY_CHALLENGE_TIME_PLAY_UPDATE",ur={leaders:{},isRequesting:!1,time:0},dr=(Pi={},Pi.dailyChallenge=function(t,e){return void 0===t&&(t=ur),(0,yi.default)(t,(function(t){var n=e.payload;if(n){var i=n.leaders,a=n.time;switch(e.type){case hr:t.isRequesting=!0;break;case cr:t.isRequesting=!1,t.leaders=i;break;case lr:t.time=a}}}))},Pi),pr="LIVES_REQUEST",fr="LIVES_UPDATED",gr="LIVES_RESET",mr="LIVES_COUNT_DOWN_START",vr={isRequesting:!1,lives:0,lastBonusLifeTime:0,countDownStartAt:0},yr=(ki={},ki.lives=function(t,e){return void 0===t&&(t=vr),(0,yi.default)(t,(function(t){var n=e.payload;if(n){var i=n.data;switch(e.type){case pr:t.isRequesting=!0;break;case fr:t.isRequesting=!1,t.lives=i.lives,t.lastBonusLifeTime=i.lastBonusLifeTime;break;case gr:t.isRequesting=!1,t.lives=vr.lives,t.lastBonusLifeTime=vr.lastBonusLifeTime,t.countDownStartAt=0;break;case mr:t.countDownStartAt=(new Date).getTime()}}}))},ki),Sr=(0,li.combineReducers)((0,wt.default)({scene:function(t,e){return void 0===t&&(t=Si),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.sceneKey;if(e.type===vi)n.currentSceneKey=a,n.prevSceneKey=t.currentSceneKey}}))},context:function(t,e){return void 0===t&&(t=Ri),(0,yi.default)(t,(function(t){var n=e.payload;if(n){var i=n.gameMode,a=n.contextId,r=n.contextType,s=n.entryPointData;switch(e.type){case di:t.contextId=a,t.contextType=r,t.entryPointData=s;break;case pi:t.contextId=a,t.contextType=r,t.processed=!0;break;case fi:t.currentGameMode=i}}}))},messages:function(t,e){return void 0===t&&(t=_i),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.opponentId;if("string"===typeof a)switch(e.type){case gi:t.data[a]?n.data[a].sent=!0:n.data[a]={sent:!0};break;case mi:t.data[a]?n.data[a].sent=!1:n.data[a]={sent:!1}}}}))}},Li,Fi,Vi,Pa,Da,za,Za,rr,or,dr,yr)),Ar=Sr,Er=window,xr=(Er.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__,li.compose),br=function(t){var e=xr((0,li.applyMiddleware)(ui.default));return(0,li.createStore)(Ar,t,e)},Tr=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).store=void 0,n.initiator=void 0,n.dispatch=function(t){return n.store.dispatch(t)},n.getState=function(){return n.store.getState()},n.subscribe=function(t){return n.store.subscribe(t)},n.watch=function(t,e){var i=ci()((function(){var e=n.getState();return t(e)}));return n.subscribe(i((function(t){e(t)})))},n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.store=br({})},n.setInitiator=function(t){this.initiator=t},n.syncStore=function(){this.initiator.initContext(),this.initiator.initPlayer()},e}(Phaser.Plugins.BasePlugin),wr=Tr,Cr=n(549),Mr=n.n(Cr),Ir=function(t){function e(e,n){var i;return(i=t.call(this,e,{type:"webfont",key:n.type})||this).payload=void 0,i.payload=n,i}(0,Kt.default)(e,t);var n=e.prototype;return n.load=function(){var t;switch(this.payload.type){case"google":t=this.getGoogleFontConfig(this.payload);break;case"local":t=this.getLocalFontConfig(this.payload)}Mr().load(t)},n.getGoogleFontConfig=function(t){var e=this,n=t.character,i=t.fontName,a=t.fontWeight;return{google:{families:[i+":"+(void 0===a?400:a)],text:n},active:function(){e.loader.nextFile(e,!0)},timeout:15e3}},n.getLocalFontConfig=function(t){var e=this,n=t.fontName,i=t.fontType,a=document.createElement("style");document.head.appendChild(a);var r=a.sheet;if(r){var s='@font-face { font-family: "'+n+'"; src: url("assets/fonts/'+n+("opentype"===i?".otf":".ttf")+'") format("'+i+'"); }';r.insertRule(s,0)}return{custom:{families:[n]},active:function(){e.loader.nextFile(e,!0)},timeout:15e3}},e}(Phaser.Loader.File),Pr=Ir,kr=function(t){function e(){return t.apply(this,arguments)||this}return(0,Kt.default)(e,t),e.prototype.addFont=function(t){var e=new Pr(this.scene.load,t);this.scene.load.addFile(e)},e}(Phaser.Plugins.ScenePlugin),Rr=kr,Or=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).ratio=void 0,n.width=void 0,n.height=void 0,n.worldWidth=void 0,n.worldHeight=void 0,n.worldRatio=void 0,n.forcePixelRatio=void 0,n}(0,Kt.default)(e,t);var n=e.prototype;return n.configure=function(t){var e=t.width,n=t.height,i=t.ratio;this.ratio=i,this.width=e,this.height=n,this.initWorldSize(),this.addEventResize()},n.resize=function(t){var e=this;t&&t>0&&(this.forcePixelRatio=t);var n=this.getCanvasSizeFixedRatio(this.worldRatio),i=n.width,a=n.height;this.resizeCanvas(i,a),this.game.scene.scenes.forEach((function(t){var n=t.cameras.main;if(n){var i=e.getZoomRatio(),a=e.getWorldSize(),r=a.width,s=a.height;n.setZoom(i),n.centerOn(r/2,s/2)}}))},n.resizeCanvas=function(t,e){this.game.canvas.width=t,this.game.canvas.height=e,this.game.scale.resize(t,e)},n.getWorldSize=function(){return{width:this.worldWidth,height:this.worldHeight}},n.initWorldSize=function(){this.worldWidth=this.width,this.worldHeight=this.height,this.isScreenSmallerRatio(this.ratio)&&(this.worldHeight=this.width/this.getScreenRatio()),this.worldRatio=this.worldWidth/this.worldHeight},n.getZoomRatio=function(){var t=this.getWorldSize().width;return this.getCanvasSizeFixedRatio(this.worldRatio).width/t},n.getPixelRatio=function(){if(this.forcePixelRatio>0)return this.forcePixelRatio;if(GameCore.Utils.Device.isDesktop())return 2;var t=GameCore.Utils.Device.pixelRatio();return t>2&&(t=2),t},n.getPhysicPixels=function(t,e){return t*e},n.getCanvasSizeFixedRatio=function(t){var e=this.getPixelRatio(),n=this.getScreenWidth()*e,i=this.getScreenHeight()*e;return this.isScreenSmallerRatio(t)?i=n/t:n=i*t,{width:n,height:i}},n.getScreenRatio=function(){return this.getScreenWidth()/this.getScreenHeight()},n.getScreenHeight=function(){var t=document,e=t.body,n=t.documentElement,i=e.clientHeight,a=n.clientHeight;return Math.max(a,i)||0},n.getScreenWidth=function(){var t=document,e=t.body,n=t.documentElement,i=e.clientWidth,a=n.clientWidth;return Math.max(a,i)||0},n.isScreenSmallerRatio=function(t){return this.getScreenWidth()/this.getScreenHeight()<=t},n.addEventResize=function(){var t=this;window.addEventListener("resize",(function(){t.resize()}))},e}(Phaser.Plugins.BasePlugin),_r=Or,Dr=function(){function t(t,e,n){this.contextId=void 0,this.contextType=void 0,this.entryPointData=void 0,this.contextId=t||Oi.contextId,this.contextType=e||Oi.contextType,this.entryPointData=n||Oi.entryPointData}return t.prototype.toObject=function(){return{contextId:this.contextId,contextType:this.contextType,entryPointData:this.entryPointData}},t}(),Lr=Dr,Br=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidPlayerId",i.message=e||"The playerId is not valid",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,se.default)(Error)),Fr=Br,Nr="share_invite",Gr="journey_invite",Ur="tournament",Vr="challenge_friend_match",Yr="matching_group_match",zr=n(122),Hr=new un.default("10","Your Friend",zr.default.AVATAR.FILE).toObject(),Wr="single",Xr="challenge-friends",Kr="matching-group",jr="tournaments",qr="online",Zr="journey",Jr=(0,be.createSelector)([function(t){return t.context}],(function(t){return t})),Qr=((0,be.createSelector)([function(t){return t.context.contextId}],(function(t){return t})),(0,be.createSelector)([function(t){return t.context.contextType}],(function(t){return t})),(0,be.createSelector)([function(t){return t.context.processed}],(function(t){return t})),(0,be.createSelector)([function(t){return t.context.currentGameMode}],(function(t){return t}))),$r=function(t,e){return{type:pi,payload:{contextId:t,contextType:e}}},ts=function(t){return function(e){e({type:fi,payload:{gameMode:t}}),(0,Ht.addBreadcrumbSentry)("game-mode",t)}},es=GameCore.Configs.PlayerDataStore,ns=function(t){var e=this;this.game=void 0,this.initContext=function(){var t=window.GameSDK.context.getID(),n=window.GameSDK.context.getType(),i=window.GameSDK.getEntryPointData(),a=new Lr(t,n,i).toObject(),r=a.contextId,s=a.contextType,o=a.entryPointData;e.game.storage.dispatch(function(t,e,n){return{type:di,payload:{contextId:t,contextType:e,entryPointData:n}}}(r,s,o))},this.initPlayer=function(){var t=e.getPlayerInfo(),n=e.getPlayerDataLocal();e.game.player.receiveData(t,n)},this.getPlayerInfo=function(){try{var t=window.GameSDK.player.getID(),e=window.GameSDK.player.getName(),n=window.GameSDK.player.getPhoto(),i=window.GameSDK.getLocale();if(!GameCore.Utils.Valid.isString(t))throw new Fr(null,{playerId:t});return GameCore.Utils.Valid.isString(e)||(e="You"),new un.default(t,e,n,i).toObject()}catch(a){return new un.default("123","You").toObject()}},this.getPlayerDataLocal=function(){try{var t=Le(es);return GameCore.Utils.Valid.isObject(t)?new bn(t).toObject():null}catch(e){return null}},this.game=t},is=n(35),as=[ni.AnalyticsEvents.BUTTON_CLICK,ni.AnalyticsEvents.SCREEN_OPEN],rs=function(t){function e(e,n){var i;(i=t.call(this,"FacebookAnalytics",{prefix:n},"#0F52BA")||this).game=void 0,i.game=e;var a=(GameCore.Configs.Analytics.FacebookAnalytics||{}).consoleLog;return i.selfLog=!!a,i}(0,Kt.default)(e,t);var n=e.prototype;return n.processTrafficSource=function(t){},n.processEvent=function(t,e,n){if(!(g()(as).call(as,t)>=0)){var i=this.getEventName(t);this.game.facebook.log(i,n,e)}},n.processPageView=function(t){},n.processLevelStart=function(t,e,n){this.processEvent(ni.AnalyticsEvents.LEVEL_START,{level:t,score:e,level_name:n})},n.processLevelRescue=function(t,e,n){this.processEvent(ni.AnalyticsEvents.LEVEL_RESCUE,{level:t,score:e,level_name:n})},n.processLevelFail=function(t,e,n){this.processEvent(ni.AnalyticsEvents.LEVEL_END,{level:t,score:e,level_name:n,success:!1})},n.processLevelComplete=function(t,e,n){this.processEvent(ni.AnalyticsEvents.LEVEL_END,{level:t,score:e,level_name:n,success:!0})},n.processShowInterstitialAd=function(t){this.processEvent(ni.AnalyticsEvents.AD_SHOW,{ad_type:"interstitial",screen_name:""+t})},n.processShowRewardedVideoAd=function(t){this.processEvent(ni.AnalyticsEvents.AD_SHOW,{ad_type:"rewarded_video",screen_name:""+t})},n.processShowAdFail=function(t,e){var n=t===GameCore.Ads.Types.REWARDED?"rewarded_video":"interstitial";this.processEvent(ni.AnalyticsEvents.AD_SHOW_FAILED,{ad_type:n,screen_name:""+e})},n.getEventName=function(t){return this.options.prefix+"_"+t},e}(GameCore.Analytics.BaseAnalytics),ss=rs,os=[ni.AnalyticsEvents.SCREEN_OPEN],hs=(function(t){function e(e,n){var i;(i=t.call(this,"GoogleAnalytics",(0,wt.default)({},n),"#E35335")||this).game=void 0,i.trackingId=void 0,i.currentPath="/";var a=n.trackingId;i.game=e;var r=(GameCore.Configs.Analytics.GoogleAnalytics||{}).consoleLog;return i.selfLog=!!r,i.trackingId=a,i}(0,Kt.default)(e,t);var n=e.prototype;n.processTrafficSource=function(t){},n.processEvent=function(t,e,n){if(!(g()(os).call(os,t)>=0)){var i=this.formatEventName(t),a=e?(0,wt.default)({},e):{};a=n?(0,wt.default)({},a,{value:n}):a,a=(0,wt.default)({},a,{page_path:this.currentPath,send_to:"GA"}),gtag("event",i,a)}},n.processLevelStart=function(t,e,n){this.processEvent(ni.AnalyticsEvents.LEVEL_START,{level:t,score:e,level_name:n})},n.processLevelRescue=function(t,e,n){this.processEvent(ni.AnalyticsEvents.LEVEL_RESCUE,{level:t,score:e,level_name:n})},n.processLevelFail=function(t,e,n){this.processEvent(ni.AnalyticsEvents.LEVEL_END,{level:t,score:e,level_name:n,success:!1})},n.processLevelComplete=function(t,e,n){this.processEvent(ni.AnalyticsEvents.LEVEL_END,{level:t,score:e,level_name:n,success:!0})},n.processShowInterstitialAd=function(t){this.processEvent(ni.AnalyticsEvents.AD_SHOW,{ad_type:"interstitial",screen_name:""+t}),this.processEvent(ni.AnalyticsEvents.AD_IMPRESSION,{ad_format:"Interstitial"})},n.processShowRewardedVideoAd=function(t){this.processEvent(ni.AnalyticsEvents.AD_SHOW,{ad_type:"rewarded_video",screen_name:""+t}),this.processEvent(ni.AnalyticsEvents.AD_IMPRESSION,{ad_format:"Rewarded"})},n.processShowAdFail=function(t,e){var n=t===GameCore.Ads.Types.REWARDED?"rewarded_video":"interstitial";this.processEvent(ni.AnalyticsEvents.AD_SHOW_FAILED,{ad_type:n,screen_name:""+e})},n.processPageView=function(t){var e=this.getGameplayMode(),n="/"+e+"/"+t;this.currentPath=n,document.title=this.formatPageTitle(e,t),gtag("event","page_view",{page_path:this.currentPath,send_to:["GA",this.trackingId]})},n.getGameplayMode=function(){var t=this.game.storage.getState();return Qr(t)},n.formatEventName=function(t){return t.toLowerCase().replace(/:/g,"_")},n.formatPageTitle=function(t,e){return this.toUpperCamelCaseWithSpace(t)+"::"+this.toUpperCamelCaseWithSpace(e)},n.toUpperCamelCaseWithSpace=function(t){var e=t.replace(/[-_\s.]+(.)?/g,(function(t,e){return e?" "+e.toUpperCase():""}));return e.substr(0,1).toUpperCase()+e.substr(1)}}(GameCore.Analytics.BaseAnalytics),function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).startGame=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.auth.requestToken();case 3:n.storage.syncStore(),n.configureSentry(),n.detectGameMode(),n.initAnalytics(),n.analytics.event(ni.AnalyticsEvents.LOAD_START),n.setTrafficSourceAnalytics(),n.scene.launch(is.SceneKeys.GLOBAL_SCENE),n.scene.start(is.SceneKeys.LOAD_SCENE),n.analytics.pageview(is.SceneKeys.LOAD_SCENE),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 17:return t.prev=17,n.facebook.progressLoading.finishLoadingProgressFbBootScene(),n.scene.sleep(is.SceneKeys.BOOT_SCENE),t.finish(17);case 21:case"end":return t.stop()}}),t,null,[[0,14,17,21]])}))),n}(0,Kt.default)(e,t);var n=e.prototype;return n.create=function(){this.facebook.progressLoading.loadingProgressFbBootScene(),this.startGame()},n.configureSentry=function(){var t=this.player.getPlayer();(0,Ht.setSentryUser)({id:t.playerId,username:t.name})},n.detectGameMode=function(){this.storage.dispatch((function(t,e){var n,i=e(),a=Jr(i),r=window.game.player.getPlayerId(),s=a.contextId,o=a.entryPointData||{},h=o.type,c=o.matchId,l=o.playerId,d=o.opponentId,p=void 0===d?Hr.playerId:d,f=o.tournamentContextId,g=r===l,m=p===Hr.playerId||u()(n=[p,l]).call(n,r),v=Wr;!s||void 0!==h&&h!==Ur||(v=jr),h===Ur&&f&&(v=jr),s&&h===Nr&&!g&&(v=Xr),c&&s&&m&&h===Vr&&(v=Xr),s&&h===Yr&&(v=Kr),t(ts(v))}))},n.initAnalytics=function(){var t=GameCore.Configs.Analytics;if(GameCore.Utils.Valid.isObject(t.FacebookAnalytics)){var e=t.FacebookAnalytics.prefix;this.analytics.add(new ss(this.game,e))}},n.setTrafficSourceAnalytics=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.getPlayerFirstVisitEntryPoint();case 3:e=t.sent,this.analytics.setTrafficSource(e),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 10:case"end":return t.stop()}}),t,this,[[0,7]])})));return function(){return t.apply(this,arguments)}}(),n.getPlayerFirstVisitEntryPoint=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.player.getDataAsync(["entry_point"]);case 2:if(e=t.sent,n=e.entry_point?e.entry_point:null){t.next=9;break}return t.next=7,GameSDK.getEntryPointAsync();case 7:n=t.sent,GameSDK.player.setDataAsync({entry_point:n}).catch();case 9:return t.abrupt("return",n);case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),e}(Phaser.Scene)),cs=hs,ls=n(4),us=n(109),ds=n.n(us),ps=n(145),fs=n.n(ps),gs=n(1),ms="ALERT_SCREEN",vs="NOTIFY_SCREEN",ys="RESCUE_SCREEN",Ss="SETTINGS_SCREEN",As="BEST_SCORE_SCREEN",Es="RESULT_SCREEN",xs="GAME_OVER_SCREEN",bs="TUTORIAL_PLAY_SCREEN",Ts="LEADER_BOARD_SCREEN",ws="MINI_JOURNEY_SCREEN",Cs="DAILY_CHALLENGE_SCREEN",Ms="YOUR_SCORE_SCREEN",Is="LEVEL_SCREEN",Ps="MISSION_SCORE_COMPLETE_SCREEN",ks="MISSION_COLLECTION_COMPLETE_SCREEN",Rs="MISSION_FAIL_SCREEN",Os="COLLISION_COMPLETED_SCREEN",_s="NO_SPACE_LEFT_SCREEN",Ds="SCORE_REACHED_SCREEN",Ls="NEXT_TARGET_SCORE_SCREEN",Bs="COLLECTION_ITEMS_SCREEN",Fs="TARGET_SCORE_SCREEN",Ns="CLAIM_HEART_SCREEN",Gs=300,Us=999,Vs=n(24),Ys=n(10),zs=n(36),Hs=n(13),Ws={STATUS:{READY:"ready",RUNNING:"running",STOPPED:"stopped"}},Xs={STATUS:{READY:"ready",RUNNING:"running",STOPPED:"stopped"}},Ks=Xs.STATUS,js=function(){function t(t){this.state=void 0,this.scene=void 0,this.scene=t}var e=t.prototype;return e.init=function(){this.setState(Ks.READY)},e.start=function(){this.isRunning()||this.setState(Ks.RUNNING)},e.stop=function(){this.isRunning()&&this.setState(Ks.STOPPED)},e.setState=function(t){this.state=t},e.isReady=function(){return this.state===Ks.READY},e.isRunning=function(){return this.state===Ks.RUNNING},e.isStopped=function(){return this.state===Ks.STOPPED},t}(),qs=js,Zs=n(62),Js={targets:[],duration:600,ease:Phaser.Math.Easing.Quadratic.Out,props:{alpha:{start:1,from:1,to:0}}},Qs=function(t){function e(e){return t.call(this,Js,e)||this}return(0,Kt.default)(e,t),e}(Zs.default),$s=Qs,to=n(255),eo={targets:[],duration:300,ease:to.default,props:{scale:{from:1.2,to:1}}},no=function(t){function e(e){return t.call(this,eo,e)||this}return(0,Kt.default)(e,t),e}(Zs.default),io=no,ao={targets:[],duration:600,ease:Phaser.Math.Easing.Back.Out,props:{y:{from:250,to:0},scale:{from:.9,to:1},alpha:{start:0,from:0,to:1}}},ro=function(t){function e(e){return t.call(this,ao,e)||this}return(0,Kt.default)(e,t),e}(Zs.default),so=ro,oo=gs.default.DEFAULT,ho=oo.KEY,co=oo.FRAME,lo=function(t){function e(e,n,i,a,r,s){var o;return(o=t.call(this,e,n,i)||this).top=void 0,o.mid=void 0,o.bottom=void 0,o.payload=void 0,o.payload=s,o.setSize(a,r),o.setDepth(zs.default.POPUP),o.createPopup(),o.scene.add.existing((0,ls.default)(o)),o}(0,Kt.default)(e,t);var n=e.prototype;return n.createPopup=function(){this.createPopupImages(),this.updatePopupSize(),this.alignPopupImages()},n.createPopupImages=function(){this.top=this.scene.add.image(0,0,ho,co.POPUP_TOP),this.mid=this.scene.add.image(0,0,ho,co.POPUP_MID),this.bottom=this.scene.add.image(0,0,ho,co.POPUP_BOTTOM),this.add([this.top,this.mid,this.bottom])},n.updatePopupSize=function(){var t,e=(null==(t=this.payload)?void 0:t.forceHeightTop)||this.width*this.top.height/this.top.width;this.top.setWorldSize(this.width,e),this.bottom.setWorldSize(this.width,this.width*this.bottom.height/this.bottom.width),this.mid.setWorldSize(this.width,this.height-this.top.displayHeight-this.bottom.displayHeight)},n.alignPopupImages=function(){Phaser.Display.Align.In.Center(this.top,this,0,-this.mid.displayHeight/2-this.top.displayHeight/2),Phaser.Display.Align.In.Center(this.mid,this),Phaser.Display.Align.In.Center(this.bottom,this,0,this.mid.displayHeight/2+this.bottom.displayHeight/2)},n.setFrameTop=function(t,e,n){e||(e=this.top.displayWidth),n||(n=this.top.displayHeight),this.top.setFrame(t),this.top.setWorldSize(e,n)},(0,Se.default)(e,[{key:"onClose",set:function(t){this.setInteractive({useHandCursor:!0}),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,t)}}]),e}(Phaser.GameObjects.Container),uo=lo,po=gs.default.DEFAULT,fo=po.KEY,go=po.FRAME,mo=function(t){function e(e,n,i,a){var r;return(r=t.call(this,e,n,i,a)||this).popup=void 0,r.contents=void 0,r.buttonPlay=void 0,r.messageText=void 0,r.popupShowUpAnimation=void 0,r.contentShowUpAnimation=void 0,r.popupFadeOutAnimation=void 0,r.onPlay=void 0,r.open=function(e){t.prototype.open.call((0,ls.default)(r),e),r.setVisible(!0);var n=r.getData(["onPlay"])[0];r.onPlay=n,r.runOpenAnimation()},r.handlePlay=function(){r.onPlay&&r.onPlay(),r.close()},r.setVisible(!1),r.setDepth(Gs),r.createPopup(),r.createPopupContent(),r.background.setAlpha(.5),r}(0,Kt.default)(e,t);var n=e.prototype;return n.runAnim=function(){this.messageText.setScale(0).setAlpha(0)},n.createPopup=function(){this.popup=new uo(this.scene,0,0,325,260),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createPopupContent=function(){this.createMessage(),this.createButtonPlay(),this.contents=this.scene.make.group({}),this.contents.addMultiple([this.messageText,this.buttonPlay])},n.createButtonPlay=function(){this.buttonPlay=new Ys.default(this.scene,fo,go.BUTTON_GREEN_LARGE,170,55),this.buttonPlay.setName("Play");var t=this.scene.make.bitmapText({font:Hs.default.PRIMARY.KEY,size:this.scene.fontSize(60),text:"\u0418\u0413\u0420\u0410\u0422\u042c",origin:{x:.5,y:.5}});this.buttonPlay.add(t),Phaser.Display.Align.In.Center(t,this.buttonPlay),this.popup.add(this.buttonPlay),Phaser.Display.Align.In.Center(this.buttonPlay,this.popup,0,50),this.buttonPlay.onClick=this.handlePlay},n.createMessage=function(){this.messageText=this.scene.make.bitmapText({font:Hs.default.PRIMARY.KEY,size:this.scene.fontSize(40),origin:{x:.5,y:.5},text:"The game will end when there s no\nmore space for your given blocks."}),this.messageText.align=1,this.popup.add(this.messageText),Phaser.Display.Align.In.Center(this.messageText,this.popup,0,-45),this.messageText.setScale(0).setAlpha(0)},n.runPopupExitsAnimation=function(t,e){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new $s({targets:[this.popup],delay:t,duration:e,props:{y:250,scale:0},onComplete:function(){i.popup.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.runOpenAnimation=function(){this.scene.audio.playSound(Vs.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runPopupContentEntrancesAnimation(200,300)},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup,i=n.y,a=n.scale;this.popupShowUpAnimation=new so({targets:[this.popup],delay:t,duration:e,props:{y:{from:350,to:i},alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:a}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){this.contentShowUpAnimation||(this.contentShowUpAnimation=new io({targets:this.contents.getChildren(),duration:e,delay:this.scene.tweens.stagger(80,{start:t}),props:{alpha:{start:0,from:0,to:1}}})),this.contentShowUpAnimation.play()},e}(GameCore.Screen),vo=mo,yo=[{minCol:0,minRow:0,cols:4,rows:4},{minCol:4,minRow:0,cols:4,rows:4},{minCol:0,minRow:4,cols:4,rows:4},{minCol:4,minRow:4,cols:4,rows:4}],So=[{minCol:0,minRow:0,cols:5,rows:5},{minCol:3,minRow:0,cols:5,rows:5},{minCol:0,minRow:3,cols:5,rows:5},{minCol:3,minRow:3,cols:5,rows:5}],Ao=[{minCol:0,minRow:0,cols:6,rows:6},{minCol:3,minRow:0,cols:6,rows:6},{minCol:0,minRow:3,cols:6,rows:6},{minCol:3,minRow:3,cols:6,rows:6}],Eo="vertical",xo="horizontal",bo="left",To="right",wo="top",Co="bottom",Mo="vertical_left",Io="vertical_right",Po="horizontal_left",ko="horizontal_right",Ro="gem/gem",Oo="gem/gem",_o="gem/gem",Do="gem/gem",Lo="gem/gem",Bo="gem/gem",Fo="gem/gem",No="gem/gem",Go="gem/gem",Uo=[{level:1,frames:[],width:480,height:189},{level:2,frames:[gs.default.EFFECTS.FRAME.TEXT_COOL],width:480,height:189},{level:3,frames:[gs.default.EFFECTS.FRAME.TEXT_GOOD],width:579,height:189},{level:4,frames:[gs.default.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189},{level:5,frames:[gs.default.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189},{level:6,frames:[gs.default.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189}],Vo=[{level:1,scale:.5,speed:.5,quantity:.5},{level:2,scale:.6,speed:.6,quantity:.6},{level:3,scale:.7,speed:.7,quantity:.7},{level:4,scale:.8,speed:.8,quantity:.8},{level:5,scale:.9,speed:.9,quantity:.9},{level:6,scale:1,speed:1,quantity:1}],Yo="l",zo="l_1",Ho="l_3",Wo="line_2",Xo="line_3",Ko="line_4",jo="line_5",qo="square_1",Zo="square_2",Jo="square_3",Qo="trapezoid",$o="triangle",th="t_piece",eh="plus_piece",nh="cross_piece_2",ih="cross_piece_3",ah="cross_piece_4",rh="cross_piece_5",sh="u_piece",oh=[Yo,zo,Ho,Wo,Xo,Ko,jo,qo,Zo,Jo,$o,Qo,th,eh,nh,ih,ah,sh],hh=[{type:Yo,rate:2},{type:zo,rate:8},{type:Ho,rate:6},{type:Wo,rate:9},{type:Xo,rate:9},{type:Ko,rate:8},{type:jo,rate:8},{type:qo,rate:9},{type:Zo,rate:8},{type:$o,rate:2},{type:Qo,rate:2},{type:th,rate:1},{type:eh,rate:1},{type:nh,rate:2},{type:ih,rate:1},{type:ah,rate:1},{type:sh,rate:1}],ch=[[1,0],[1,0],[1,1]],lh=[[0,1],[0,1],[1,1]],uh=[[1,0],[1,1]],dh=[[1,0,0],[1,0,0],[1,1,1]],ph=[[1,1,1],[1,0,0]],fh=[[1,1,1],[0,0,1]],gh=[[1,1],[1,0]],mh=[[1,1,1],[1,0,0],[1,0,0]],vh=[[1,1],[0,1],[0,1]],yh=[[1,1],[1,0],[1,0]],Sh=[[1,1],[0,1]],Ah=[[1,1,1],[0,0,1],[0,0,1]],Eh=[[0,0,1],[1,1,1]],xh=[[1,0,0],[1,1,1]],bh=[[0,1],[1,1]],Th=[[0,0,1],[0,0,1],[1,1,1]],wh=[[1],[1]],Ch=[[1,1]],Mh=[[1],[1],[1]],Ih=[[1,1,1]],Ph=[[1],[1],[1],[1]],kh=[[1,1,1,1]],Rh=[[1],[1],[1],[1],[1]],Oh=[[1,1,1,1,1]],_h=[[1]],Dh=[[1,1],[1,1]],Lh=[[1,1,1],[1,1,1],[1,1,1]],Bh=[[1,0],[1,1],[0,1]],Fh=[[0,1],[1,1],[1,0]],Nh=[[1,1,0],[0,1,1]],Gh=[[0,1,1],[1,1,0]],Uh=[[0,1],[1,1],[0,1]],Vh=[[1,0],[1,1],[1,0]],Yh=[[0,1,0],[1,1,1]],zh=[[1,1,1],[0,1,0]],Hh=[[0,0,1],[1,1,1],[0,0,1]],Wh=[[1,0,0],[1,1,1],[1,0,0]],Xh=[[0,1,0],[0,1,0],[1,1,1]],Kh=[[1,1,1],[0,1,0],[0,1,0]],jh=[[0,1,0],[1,1,1],[0,1,0]],qh=[[1,0],[0,1]],Zh=[[0,1],[1,0]],Jh=[[1,0,0],[0,1,0],[0,0,1]],Qh=[[0,0,1],[0,1,0],[1,0,0]],$h=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],tc=[[0,0,0,1],[0,0,1,0],[0,1,0,0],[1,0,0,0]],ec=[[1,0,0,0,0],[0,1,0,0,0],[0,0,1,0,0],[0,0,0,1,0],[0,0,0,0,1]],nc=[[0,0,0,0,1],[0,0,0,1,0],[0,0,1,0,0],[0,1,0,0,0],[1,0,0,0,0]],ic=[[1,1],[0,1],[1,1]],ac=[[1,0],[1,1],[1,0]],rc=[[1,0,1],[1,1,1]],sc=[[1,1,1],[1,0,1]],oc=function(){function t(t){this.scene=void 0,this.manager=void 0,this.tweenHand=void 0,this.dataInit={fen:"4bb3/4bb3/4bb3/3bb4/bbbb2bbb/bbbb1bbbb/4bb3/4bb3/4bb3 l tz-vr,b",piece:qo,position:{x:4,y:3}},this.scene=t.scene,this.manager=t}var e=t.prototype;return e.start=function(){this.initBoardData(),this.handleHighlight(),this.createTweenHand()},e.initBoardData=function(){this.manager.handleGuidePlayStep(this.dataInit.fen)},e.createTweenHand=function(){var t=this.scene.gameZone,e=t.width,n=t.height;this.manager.handFrame.setVisible(!0),this.manager.handFrame.setPosition(e/2-120,n-50);var i=n/2+176+30,a=i+(n-85-i)/2;this.tweenHand=this.scene.add.tween({repeatDelay:500,targets:this.manager.handFrame,repeat:-1,x:{from:e/2-80,to:e/2+30},y:{from:a,to:n/2},duration:1500,ease:Phaser.Math.Easing.Sine.InOut})},e.handleHighlight=function(){for(var t=[{x:5,y:3},{x:5,y:4},{x:4,y:4},{x:4,y:5}],e=0;e<t.length;e++){var n=t[e],i=n.x,a=n.y;this.scene.main.board.dataBoard[a][i].cell.setFrame(gs.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0).stopAnimShaking()}},e.dragStart=function(){this.tweenHand.stop(),this.manager.handFrame.setVisible(!1)},e.invalidMove=function(){this.manager.handFrame.setVisible(!0),this.tweenHand.play(),this.handleHighlight()},e.nextLevel=function(){this.tweenHand.stop().remove()},t}(),hc=oc,cc=function(){function t(t){this.scene=void 0,this.manager=void 0,this.tweenHand=void 0,this.dataInit={fen:"x/x/x/x/bbbb1ryry/x/x/x/x l s1,b",piece:qo,position:{x:4,y:4}},this.scene=t.scene,this.manager=t}var e=t.prototype;return e.start=function(){this.initBoardData(),this.handleHighlight(),this.createTweenHand()},e.initBoardData=function(){this.manager.handleGuidePlayStep(this.dataInit.fen)},e.createTweenHand=function(){var t=this.scene.gameZone,e=t.width,n=t.height,i=n/2+176+30,a=i+(n-85-i)/2;this.manager.handFrame.setVisible(!0),this.manager.handFrame.setPosition(e/2-120,n-50),this.tweenHand=this.scene.add.tween({repeatDelay:500,targets:this.manager.handFrame,repeat:-1,x:{from:e/2-80,to:e/2+15},y:{from:a,to:n/2},duration:1500,ease:Phaser.Math.Easing.Sine.InOut})},e.handleHighlight=function(){for(var t=this.dataInit.position,e=t.x,n=t.y,i=0;i<1;i++)for(var a=0;a<1;a++)this.scene.main.board.dataBoard[n+i][e+a].cell.setFrame(gs.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0).stopAnimShaking()},e.dragStart=function(){this.tweenHand.stop(),this.manager.handFrame.setVisible(!1)},e.invalidMove=function(){this.manager.handFrame.setVisible(!0),this.tweenHand.play(),this.handleHighlight()},e.nextLevel=function(){this.tweenHand.stop().remove()},t}(),lc=cc,uc=function(){function t(t){this.scene=void 0,this.manager=void 0,this.tweenHand=void 0,this.dataInit={fen:"x/x/x/4bb3/4bb3/5b3/x/x/x l l-dt,b",piece:qo,position:{x:3,y:3}},this.scene=t.scene,this.manager=t}var e=t.prototype;return e.start=function(){this.initBoardData(),this.handleHighlight(),this.createTweenHand()},e.initBoardData=function(){this.manager.handleGuidePlayStep(this.dataInit.fen)},e.createTweenHand=function(){var t=this.scene.gameZone,e=t.width,n=t.height;this.manager.handFrame.setVisible(!0),this.manager.handFrame.setPosition(e/2-120,n-50);var i=n/2+176+30,a=i+(n-85-i)/2;this.tweenHand=this.scene.add.tween({repeatDelay:500,targets:this.manager.handFrame,repeat:-1,x:{from:e/2-80,to:e/2-20},y:{from:a,to:n/2},duration:1500,ease:Phaser.Math.Easing.Sine.InOut})},e.handleHighlight=function(){for(var t=this.dataInit.position,e=t.x,n=t.y,i=0;i<3;i++)for(var a=0;a<1;a++)this.scene.main.board.dataBoard[n+i][e+a].cell.setFrame(gs.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0).stopAnimShaking();this.scene.main.board.dataBoard[5][4].cell.setFrame(gs.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0).stopAnimShaking()},e.dragStart=function(){this.tweenHand.stop(),this.manager.handFrame.setVisible(!1)},e.invalidMove=function(){this.manager.handFrame.setVisible(!0),this.tweenHand.play(),this.handleHighlight()},e.nextLevel=function(){this.tweenHand.stop().remove()},t}(),dc=uc,pc=function(){function t(t){this.scene=void 0,this.manager=void 0,this.tweenHand=void 0,this.dataInit={fen:"2r/2r/2r/2r/x/x/x/2r/2r l e3-v,r",piece:Xo,position:{x:2,y:4}},this.scene=t.scene,this.manager=t}var e=t.prototype;return e.start=function(){this.initBoardData(),this.handleHighlight(),this.createTweenHand()},e.initBoardData=function(){this.manager.handleGuidePlayStep(this.dataInit.fen)},e.createTweenHand=function(){var t=this.scene.gameZone,e=t.width,n=t.height;this.manager.handFrame.setVisible(!0),this.manager.handFrame.setPosition(e/2-120,n-50);var i=n/2+176+30,a=i+(n-85-i)/2;this.tweenHand=this.scene.add.tween({repeatDelay:500,targets:this.manager.handFrame,repeat:-1,x:{from:e/2-80,to:e/2-60},y:{from:a,to:n/2+30},duration:1500,ease:Phaser.Math.Easing.Sine.InOut})},e.handleHighlight=function(){for(var t=this.dataInit.position,e=t.x,n=t.y,i=0;i<3;i++)for(var a=0;a<1;a++)this.scene.main.board.dataBoard[n+i][e+a].cell.setFrame(gs.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0).stopAnimShaking()},e.dragStart=function(){this.tweenHand.stop(),this.manager.handFrame.setVisible(!1)},e.invalidMove=function(){this.manager.handFrame.setVisible(!0),this.tweenHand.play(),this.handleHighlight()},e.nextLevel=function(){this.tweenHand.stop().remove()},t}(),fc=pc,gc=Ws.STATUS,mc=gs.default.GAMEPLAY,vc=mc.KEY,yc=mc.FRAME,Sc=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.currentLevel=1,n.tutorialId=void 0,n.inputType=void 0,n.handFrame=void 0,n.background=void 0,n.headerContainer=void 0,n.maskGraphics=void 0,n.textTutorial=void 0,n.skipButton=void 0,n.stepOne=void 0,n.stepTwo=void 0,n.stepThree=void 0,n.stepFour=void 0,n.showTutorialWhenStart=function(){switch(n.scene.analytics.event(ni.AnalyticsEvents.TUTORIAL_STEP,{tutorial_step:n.currentLevel}),n.currentLevel){case 1:n.stepOne.start(),n.setTextTutorial("\u0420\u0430\u0437\u043c\u0435\u0441\u0442\u0438\u0442\u0435 \u0431\u043b\u043e\u043a\u0438 \u0432 \u0433\u043e\u0440\u0438\u0437\u043e\u043d\u0442\u0430\u043b\u044c\u043d\u0443\u044e\n\u043b\u0438\u043d\u0438\u044e \u0438 \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u0442\u0435, \u0447\u0442\u043e \u043f\u0440\u043e\u0438\u0437\u043e\u0439\u0434\u0435\u0442!");break;case 2:n.stepTwo.start(),n.setTextTutorial("\u0422\u0435\u043f\u0435\u0440\u044c \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u0442\u0435, \u0447\u0442\u043e \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442,\n\u043a\u043e\u0433\u0434\u0430 \u0432\u044b \u043f\u043e\u0441\u0442\u0440\u043e\u0438\u0442\u0435 \u0432\u0435\u0440\u0442\u0438\u043a\u0430\u043b\u044c\u043d\u0443\u044e \u043b\u0438\u043d\u0438\u044e.");break;case 3:n.stepThree.start(),n.setTextTutorial("\u0422\u0430\u043a\u0436\u0435 \u043c\u043e\u0436\u043d\u043e \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u043a\u0432\u0430\u0434\u0440\u0430\u0442 3\xd73.\n\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435!");break;case 4:n.stepFour.start(),n.setTextTutorial("\u0421\u0442\u0440\u043e\u0439\u0442\u0435 \u043b\u0438\u043d\u0438\u0438 \u0438 \u043a\u0432\u0430\u0434\u0440\u0430\u0442\u044b,\n\u0447\u0442\u043e\u0431\u044b \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u044c \u043a\u043e\u043c\u0431\u043e-\u043e\u0447\u043a\u0438!");break;default:n.handleCompleteTutorial()}},n.nextTutorial=function(){switch(n.currentLevel){case 1:n.stepOne.nextLevel();break;case 2:n.stepTwo.nextLevel();break;case 3:n.stepThree.nextLevel();break;case 4:n.stepFour.nextLevel()}n.currentLevel++,n.showTutorialWhenStart()},n.validTargetPosition=function(t){var e={x:0,y:0};switch(n.currentLevel){case 1:e=n.stepOne.dataInit.position;break;case 2:e=n.stepTwo.dataInit.position;break;case 3:e=n.stepThree.dataInit.position;break;case 4:e=n.stepFour.dataInit.position}return e.x===t.x&&e.y===t.y},n.scene=e,n.createHand(),n.createTutorialPlayScreen(),n.createHeader(),n.createSkipButton(),n.initTutorialStep(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createTutorialPlayScreen=function(){this.scene.screen.add(bs,vo)},n.createHeader=function(){this.headerContainer=this.scene.add.container(),this.headerContainer.setVisible(!1);var t=this.scene.gameZone.width,e=this.scene.make.image({key:vc,frame:yc.BLANK});e.setTint(0),e.setAlpha(.5),e.setWorldSize(t,100),this.headerContainer.add(e),Phaser.Display.Align.In.Center(e,this.headerContainer),this.textTutorial=this.scene.make.text({style:{fontFamily:Hs.default.FONT_FAMILY_ARIAL,fontSize:this.scene.fontSize(40)+"px",fontStyle:"700",align:"center"}}),this.textTutorial.setHighQuality(),this.textTutorial.setTint(16442297),this.headerContainer.add(this.textTutorial),Phaser.Display.Align.In.TopCenter(this.headerContainer,this.scene.gameZone,0,-50)},n.createSkipButton=function(){this.skipButton=new Ys.default(this.scene,vc,yc.BUTTON_SKIP,60,35.5),this.headerContainer.add(this.skipButton),this.skipButton.onClick=this.handleSkip.bind(this),Phaser.Display.Align.In.BottomRight(this.skipButton,this.headerContainer,-5,-5)},n.handleSkip=function(){this.scene.game.globalScene.screen.open(ms,{message:"\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435\n\u043f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435?",onHandleYes:this.handleCompleteTutorial.bind(this)})},n.initTutorialStep=function(){this.stepOne=new lc(this),this.stepTwo=new fc(this),this.stepThree=new dc(this),this.stepFour=new hc(this)},n.start=function(){this.isRunning()||(this.scene.analytics.pageview("tutorial-screen"),this.setState(gc.RUNNING),this.headerContainer.setVisible(!0),this.showTutorialWhenStart())},n.setTextTutorial=function(t){var e=this,n=t.split(""),i="";this.scene.time.addEvent({repeat:n.length,delay:10,callback:function(){var t=n.shift()||"";i+=t,e.textTutorial.setText(i),Phaser.Display.Align.In.Center(e.textTutorial,e.headerContainer,-e.scene.gameZone.width/2,-60)}})},n.stop=function(){this.isRunning()&&(this.scene.tweens.killTweensOf([this.background]),this.background.setVisible(!1),this.maskGraphics.setVisible(!1),this.setState(gc.STOPPED))},n.handleCompleteTutorial=function(){this.scene.analytics.pageview("game-scene"),this.scene.analytics.event(ni.AnalyticsEvents.TUTORIAL_COMPLETE),this.setState(gc.STOPPED),this.scene.main.praise.tweenShowScoreText.stop().remove(),this.scene.startGame(),this.handFrame.setVisible(!1),this.headerContainer.setVisible(!1)},n.createHand=function(){this.handFrame=this.scene.make.image({key:vc,frame:yc.HAND,origin:{x:.5,y:.5}}),this.handFrame.setVisible(!1).setDepth(zs.default.ON_TOP),this.handFrame.setWorldSize(64,55)},n.isValidForTutorial=function(){return this.scene.game.player.getPlayerIsNew()},n.dragStart=function(){switch(this.currentLevel){case 1:this.stepOne.dragStart();break;case 2:this.stepTwo.dragStart();break;case 3:this.stepThree.dragStart();break;case 4:this.stepFour.dragStart()}},n.skipTutorial=function(){this.isRunning()&&(this.handFrame.setVisible(!1),this.setState(gc.STOPPED))},n.invalidMove=function(){switch(this.currentLevel){case 1:this.stepOne.invalidMove();break;case 2:this.stepTwo.invalidMove();break;case 3:this.stepThree.invalidMove();break;case 4:this.stepFour.invalidMove()}},n.handleGuidePlayStep=function(t){try{this.scene.main.board.clearBoard(),this.scene.footer.pieces.clearPieces();var e=null,n=null;if(t){var i=this.scene.main.board.getBoardByFen(t);e=this.scene.handleDynamicFenSize(i),n=this.scene.footer.pieces.getPiecesByFen(t)}this.scene.main.board.startGame(e),this.scene.footer.pieces.showAvailablePieces(n)}catch(a){}},e}(qs),Ac=Sc,Ec={START_GAME:"start-game",REPLAY:"replay",RESCUE:"rescue",RECEIVE_DIAMONDS:"receive-diamonds",GAME_OVER:"game-over"},xc={targets:[],duration:600,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{start:0,from:0,to:1}}},bc=function(t){function e(e){return t.call(this,xc,e)||this}return(0,Kt.default)(e,t),e}(Zs.default),Tc=bc,wc=n(97),Cc=n.n(wc),Mc=n(146),Ic=n.n(Mc),Pc=function(t){return t.leaderboards},kc=((0,be.createSelector)([function(t){return Pc(t).leaderboardId}],(function(t){return t})),(0,be.createSelector)([function(t){return Pc(t).limit}],(function(t){return t})),(0,be.createSelector)([function(t){return Pc(t).offset}],(function(t){return t})),(0,be.createSelector)([function(t){return Pc(t).leaders}],(function(t){return t}))),Rc=((0,be.createSelector)([function(t){return Pc(t).type}],(function(t){return t})),(0,be.createSelector)([function(t){return Pc(t).isRequesting}],(function(t){return t}))),Oc="global",_c="friend",Dc=GameCore.Configs,Lc=Dc.ApiHost,Bc=Dc.OtherHost,Fc=Dc.LeadersBoard,Nc=Fc.LeaderboardId,Gc=Fc.Prefix+"/"+Nc+"/leaders",Uc=Fc.Prefix+"/"+Nc+"/players",Vc=Fc.Name,Yc=function(t){var e="";return Fc.LeaderboardId?(t===Oc?e=Gc:t===_c&&(e=Uc),e):e},zc=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,r,s,o;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=De()(e).call(e,(function(t){return t.playerId})),a=GameCore.Utils.Object.keyBy(e,"playerId"),r=GameCore.Utils.String.params({playerIds:i}),t.next=5,Ke("players?"+r,{},Lc);case 5:return s=t.sent,o=De()(n=s.data).call(n,(function(t){var e=a[t.playerId];return(0,wt.default)({},t,{score:e.score,rank:e.rank,getScore:function(){return e.score},getFormattedScore:function(){return""},getTimestamp:function(){return(new Date).valueOf()},getRank:function(){return e.rank},getExtraData:function(){return e.extraData},getPlayer:function(){return{getName:function(){return t.name},getPhoto:function(){return t.photo},getID:function(){return t.playerId}}}})})),t.abrupt("return",o);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Hc=function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e&&(e={}),null==Nc){t.next=3;break}return t.abrupt("return",Wc(e));case 3:return t.abrupt("return",Xc(e));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Wc=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,r,s;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e&&(e={}),n=[],i=Yc(Oc)){t.next=5;break}return t.abrupt("return",n);case 5:return a=GameCore.Utils.String.params(e),t.next=8,Ke(i+"?"+a,{},Bc);case 8:if(r=t.sent,!((s=(null==r?void 0:r.data)||[]).length<1)){t.next=12;break}return t.abrupt("return",n);case 12:return n=s,t.abrupt("return",zc(n));case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Xc=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,r,s;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===e&&(e={}),i=(n=e).limit,a=n.offset,t.next=4,window.GameSDK.getLeaderboardAsync(Vc);case 4:return r=t.sent,t.next=7,r.getEntriesAsync(i,a);case 7:return s=t.sent,t.abrupt("return",s);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Kc=function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e&&(e={}),null==Nc){t.next=3;break}return t.abrupt("return",jc(e));case 3:return t.abrupt("return",qc(e));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),jc=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,r,s;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e&&(e={}),n=[],i=Yc(_c)){t.next=5;break}return t.abrupt("return",n);case 5:return a=GameCore.Utils.String.params(e),t.next=8,Ke(i+"?"+a,{},Bc);case 8:if(r=t.sent,!((s=(null==r?void 0:r.data)||[]).length<1)){t.next=12;break}return t.abrupt("return",n);case 12:return n=s,t.abrupt("return",zc(n));case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),qc=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,r,s;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===e&&(e={}),i=(n=e).limit,a=n.offset,t.next=4,window.GameSDK.getLeaderboardAsync(Vc);case 4:return r=t.sent,t.next=7,r.getConnectedPlayerEntriesAsync(i,a);case 7:return s=t.sent,t.abrupt("return",s);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Zc=function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==Nc){t.next=2;break}return t.abrupt("return",Jc(e));case 2:return t.abrupt("return",Qc());case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Jc=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,r,s;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=null,e){t.next=3;break}return t.abrupt("return",n);case 3:if(i=Yc(_c)){t.next=6;break}return t.abrupt("return",n);case 6:return a=GameCore.Utils.String.params({playerIds:e}),t.next=9,Ke(i+"?"+a,{},Bc);case 9:if(r=t.sent,!((s=(null==r?void 0:r.data)||[]).length<1)){t.next=13;break}return t.abrupt("return",n);case 13:return n=zc(s)[0],t.abrupt("return",n);case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Qc=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,window.GameSDK.getLeaderboardAsync(Vc);case 2:return e=t.sent,t.next=5,e.getPlayerEntryAsync();case 5:return n=t.sent,t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),$c=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==Nc){t.next=2;break}return t.abrupt("return",tl(e,n));case 2:return t.abrupt("return",el(n));case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),tl=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,je("players/"+e+"/leaderboard",{score:n},{},Lc);case 2:return i=t.sent,t.abrupt("return",(null==i?void 0:i.data)||{});case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),el=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,window.GameSDK.getLeaderboardAsync(Vc);case 2:return n=t.sent,t.next=5,n.setScoreAsync(e);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();function nl(t,e){var n="undefined"!==typeof Cc()&&Ic()(t)||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){var n;if(!t)return;if("string"===typeof t)return il(t,e);var i=s()(n=Object.prototype.toString.call(t)).call(n,8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return a()(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return il(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function il(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}for(var al=GameCore.Configs.LeadersBoard,rl=function(t,e,n,i){return void 0===n&&(n=al.LeaderBoardLimit),void 0===i&&(i=0),function(){var a=(0,Xt.default)(qt().mark((function a(r,s){var o,h,l,u,d,p,f,g,m,v,y,S,E,x,b,T,w,C,M;return qt().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,o=window.game,h=o.player,o.profile,s(),l=h.getPlayerId(),r({type:Ga,payload:{leaderboardId:t,type:e,limit:n,offset:i}}),!al.UseMock){a.next=11;break}return a.next=8,(0,Ge.sleepAsync)(1e3);case 8:return p=De()(u=A()(d=new Array(n)).call(d,null)).call(u,(function(t,e){var n=(e+1)*(i+1);return{playerId:"0"+n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.png",rank:n,score:Math.floor(1e5/n)}})),r(sl(p,e)),a.abrupt("return");case 11:if(f=[],e!==Oc){a.next=18;break}return a.next=15,Hc({limit:n,offset:i});case 15:f=a.sent,a.next=26;break;case 18:if(e!==_c){a.next=26;break}return(g=h.getConnectedPlayerIds(n,i)).push(l),m=GameCore.Utils.Array.unique(g),a.next=24,Kc({playerIds:m,limit:m.length});case 24:f=a.sent,m.forEach((function(t){var e=c()(f).call(f,(function(e){return e.playerId===t}));e&&0!==e.length||f.push({playerId:t,score:0})}));case 26:for(v={},y=nl(f);!(S=y()).done;)E=S.value,x=E.playerId,b=E.score,T=E.rank,w=E.getPlayer(),C=w.getPhoto(),M=w.getName(),v[x]={playerId:x,name:M,photo:C,score:b,rank:T};r(sl(v,e)),a.next=35;break;case 31:a.prev=31,a.t0=a.catch(0),r(sl([],e)),(0,Ht.sendException)(a.t0);case 35:case"end":return a.stop()}}),a,null,[[0,31]])})));return function(t,e){return a.apply(this,arguments)}}()},sl=function(t,e){return{type:Ua,payload:{leaders:t,type:e}}},ol=function(){return{type:Va,payload:{}}},hl={targets:[],props:{alpha:{duration:500,value:{start:0,from:0,to:1},ease:Phaser.Math.Easing.Cubic.Out},scale:{duration:1e3,value:{start:.8,from:.8,to:1},ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]}}},cl=function(t){function e(e){return t.call(this,hl,e)||this}return(0,Kt.default)(e,t),e}(Zs.default),ll=cl,ul={targets:[],props:{alpha:{start:0,to:1,duration:500,ease:Phaser.Math.Easing.Cubic.Out},scale:{start:.8,to:1,duration:1e3,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]},y:{start:0,to:0,duration:500,ease:Phaser.Math.Easing.Back.Out}},delay:0},dl=function(t){function e(e){return t.call(this,ul,e)||this}return(0,Kt.default)(e,t),e}(Zs.default),pl=dl,fl={targets:[],duration:600,ease:Phaser.Math.Easing.Linear,props:{angle:{from:0,to:360}}},gl=function(t){function e(e){return t.call(this,fl,e)||this}return(0,Kt.default)(e,t),e}(Zs.default),ml=gl,vl=gs.default.DEFAULT,yl=vl.KEY,Sl=vl.FRAME,Al=function(t){function e(e){var n;return(n=t.call(this,e,0,0,yl,Sl.PRELOADER)||this).anim=void 0,n.runAnimation(),n.setWorldSize(80,80),n.scene.add.existing((0,ls.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.runAnimation=function(){var t;null==(t=this.anim)||t.remove(),this.anim=new ml({targets:[this],repeat:-1,duration:1200}),this.anim.play()},n.setVisible=function(e){return t.prototype.setVisible.call(this,e),e?this.runAnimation():this.anim.stop(),this},e}(Phaser.GameObjects.Image),El=Al,xl=function(t){function e(e,n){var i;(i=t.call(this,e)||this).payload=void 0,i.loading=void 0,i.photo=void 0,i.avtFrame=void 0,i.background=void 0,i.loadPhotoTimer=void 0,i.handleLoadPhotoAfterDelay=function(t,e){return function(){var n=i.scene.textures.get(t);n&&n.key===t?i.handleLoadComplete(t):(i.scene.load.once("filecomplete-image-"+t,i.handleLoadComplete),i.scene.load.image(t,e),i.scene.load.start())}},i.handleLoadComplete=function(t){if(i.scene){var e=i.payload,n=e.id,a=e.radius,r=void 0===a?0:a;if(n&&n===t){var s=n+"_bordered_"+r,o=r>0?s:n,h=i.scene.textures.get(o);if(h&&h.key===o)i.setPhoto(h.key);else if(0!=r&&r<100){if(!GameCore.Utils.Image.drawBorder({scene:i.scene,key:n,newKey:s,radius:r}))return void i.showLoading(!1);i.setPhoto(s)}else if(100==r){if(!GameCore.Utils.Image.drawCircle({scene:i.scene,key:n,newKey:s}))return void i.showLoading(!1);i.setPhoto(s)}else i.setPhoto(n)}}},i.handleLoadPhotoFailed=function(t){t.key===i.payload.id&&i.setDefaultAvatar(t.key)},i.scene.add.existing((0,ls.default)(i)),i.payload=n,i.setSize(n.width,n.height),i.createBackground(),i.createLoading(),i.createPhoto(),i.createFrame();var a=i.payload,r=a.id,s=a.url,o=a.radius;return r&&s&&i.loadPhoto(r,s,o),i.addDefaultListeners(),i}(0,Kt.default)(e,t);var n=e.prototype;return n.setFrame=function(t){this.avtFrame.setFrame(t),this.avtFrame.setVisible(!0)},n.setBackground=function(t){this.background.setFrame(t)},n.loadPhoto=function(t,e,n){var i;if(void 0===n&&(n=0),this.payload.id=t,this.payload.url=e,this.payload.radius=n,null==(i=this.loadPhotoTimer)||i.remove(),t&&e){var a=this.scene.textures.get(t);if(a&&a.key===t)this.handleLoadComplete(t);else{this.showLoading(!0);var r=this.payload.loadDelay||0;this.loadPhotoTimer=this.scene.time.delayedCall(r,this.handleLoadPhotoAfterDelay(t,e))}}else this.setPhoto(zr.default.AVATAR.KEY)},n.addDefaultListeners=function(){var t=this;this.scene.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,this.handleLoadPhotoFailed),this.on(Phaser.GameObjects.Events.DESTROY,(function(){var e;null==(e=t.loadPhotoTimer)||e.remove(),t.scene.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR,t.handleLoadPhotoFailed)}))},n.setDefaultAvatar=function(t){this.loadPhoto(t,zr.default.AVATAR.FILE,this.payload.radius)},n.createBackground=function(){var t=this.payload,e=t.key,n=t.background,i=t.borderWidth,a=void 0===i?0:i;this.background=this.scene.make.image({key:e,frame:n}),this.background.setWorldSize(this.width-a,this.height-a),this.add(this.background)},n.createLoading=function(){this.loading=new El(this.scene),this.loading.setWorldSize(.75*this.width,.75*this.height),this.loading.setVisible(!1),this.add(this.loading)},n.createPhoto=function(){this.photo=this.scene.make.image({x:0,y:0,origin:{x:.5,y:.5},visible:!1}),this.add(this.photo)},n.createFrame=function(){var t=this.payload,e=t.key,n=t.frame,i=t.width,a=t.height;n?(this.avtFrame=this.scene.make.image({key:e,frame:n}),this.avtFrame.setWorldSize(i,a)):this.avtFrame=this.scene.make.image({x:0,y:0,origin:{x:.5,y:.5},visible:!1}),this.add(this.avtFrame)},n.showLoading=function(t){this.photo.setVisible(!t),this.loading.setVisible(t)},n.setPhoto=function(t){this.showLoading(!1),this.photo.setTexture(t),this.photo.setFrame(0);var e=this.payload,n=e.width,i=e.height,a=Math.min(n,i)-(this.payload.borderWidth||8);this.photo.setWorldSize(a,a),Phaser.Display.Align.In.Center(this.photo,this.background)},e}(Phaser.GameObjects.Container),bl=xl,Tl=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidContextId",i.message=e||"This contextId is not valid",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,se.default)(Error)),wl=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="NewScoreIsBad",i.message=e||"The new score is bad",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,se.default)(Error)),Cl=function(t){return t.match},Ml=(0,be.createSelector)([function(t){return Cl(t).gameplay.mode}],(function(t){return t})),Il=((0,be.createSelector)([function(t){return Cl(t).gameplay.status}],(function(t){return t})),(0,be.createSelector)([function(t){return Cl(t).gameplay.rescued}],(function(t){return t}))),Pl=(0,be.createSelector)([function(t){return Cl(t).gameplay.startAt}],(function(t){return t})),kl=(0,be.createSelector)([function(t){return Cl(t).gameplay.finishAt}],(function(t){return t})),Rl=(0,be.createSelector)([function(t){return Cl(t).gameplay.showMiniJourney}],(function(t){return t})),Ol=GameCore.Configs,_l=Ol.AppId,Dl=Ol.OtherHost,Ll=Ol.LeadersBoard,Bl=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n={appId:_l,resetScore:0,numberOfLeaders:15,timezone:"utc+0",sortOrder:"desc",statistics:"max",resettable:"manually",description:"no description"},!Ll.UseMock){t.next=5;break}return t.next=4,(0,Ge.sleepAsync)(1e3);case 4:return t.abrupt("return",(0,wt.default)({},n,e,{_id:Ll.LeaderboardId,type:"app_leaderboard",description:"mockup_leaderboard",createdAt:new Date(Date.now()).toISOString(),updatedAt:new Date(Date.now()).toISOString()}));case 5:return"leaderboards",t.next=8,je("leaderboards",(0,wt.default)({},n,e),{},Dl);case 8:return i=t.sent,t.abrupt("return",(null==i?void 0:i.data)||{});case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Fl=(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,r,s,o,h,c,l,u,d,p,f;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===n&&(n={}),i=[],!Ll.UseMock){t.next=7;break}return t.next=5,(0,Ge.sleepAsync)(1e3);case 5:return o=(s=n).limit,h=void 0===o?10:o,c=s.offset,l=void 0===c?0:c,t.abrupt("return",De()(a=A()(r=new Array(h)).call(r,null)).call(a,(function(t,e){var n=(e+1)*(l+1);return{playerId:"player-0"+n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.jpg",rank:n,score:Math.floor(1e5/n+1e4*Math.random())}})));case 7:return u=GameCore.Utils.String.params(n),d="leaderboards/"+e+"/leaders",t.next=11,Ke(d+"?"+u,{},Dl);case 11:if((p=t.sent)&&(null==p||!p.error)){t.next=14;break}throw new Error((null==p?void 0:p.error)||"Leaderboard not found");case 14:if(!((f=(null==p?void 0:p.data)||[]).length<1)){t.next=17;break}return t.abrupt("return",i);case 17:return i=f,t.abrupt("return",i);case 19:case"end":return t.stop()}}),t)})))}(),function(){var t=(0,Xt.default)(qt().mark((function t(e,n,i){var a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,je("leaderboards/"+e+"/players/"+n,{score:i},{},Dl);case 2:return a=t.sent,t.abrupt("return",(null==a?void 0:a.data)||{});case 4:case"end":return t.stop()}}),t)})));return function(e,n,i){return t.apply(this,arguments)}}()),Nl=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="CurrentTournamentScoreIsNotBest",i.message=e||"The new score is not best",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,se.default)(Error)),Gl=GameCore.Configs.Tournament.UseLeaderboard,Ul=function(t){return{type:ka,payload:{tournamentId:t}}},Vl=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n){var i,a,r,s,o,h,c,l,u;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=window.game.facebook,a=t.playerId,r=t.playerName,s=t.score,o=t.autoStartGame,h=r+"'s Tournament",c=GameCore.Utils.String.generateObjectId(),e.next=7,i.tournament.createAsync({initialScore:s,config:{title:h,tournamentTitle:h},data:{playerId:a,playerName:r,leaderboardId:c}});case 7:return l=e.sent,u=l.getID(),o&&(n(Ul(u)),n(zd())),e.next=12,Bl({_id:c,createdBy:a,name:u,description:h,expireTime:6048e5});case 12:if(e.sent._id!==c){e.next=16;break}return e.next=16,Fl(c,a,s);case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),(0,Ht.sendException)(e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(t){return e.apply(this,arguments)}}()},Yl=function(t){return(0,Xt.default)(qt().mark((function e(){var n,i,a,r,s;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.game.facebook,i=t.playerId,a=t.playerName,r=t.leaderboardId,s=t.score,r&&Fl(r,i,s),e.next=5,n.tournament.shareAsync({score:s,data:{type:Ur,playerId:i,playerName:a}});case 5:Fl(r,i,s);case 6:case"end":return e.stop()}}),e)})))},zl=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=window.game.facebook,t.next=4,e.getTournamentAsync();case 4:return n=t.sent,i=JSON.parse(n.getPayload()||"{}"),t.abrupt("return",i.leaderboardId);case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",null);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(){return t.apply(this,arguments)}}(),Hl=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=window.game.facebook,t.next=4,e.getTournamentAsync();case 4:return t.abrupt("return",t.sent);case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}(),Wl=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n,i){var a,r,s,o,h,c,l,d,p,f,g,m,v,y;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null,r=window.game,s=r.player,o=r.facebook,h=r.analytics,e.prev=2,l=i(),d=Ml(l),u()(c=[Wr,jr]).call(c,d)){e.next=7;break}return e.abrupt("return");case 7:return n({type:Ra,payload:{}}),p=s.getPlayer(),f=p.playerId,g=p.name,e.next=11,Hl();case 11:if(!e.sent){e.next=23;break}if(a=ni.AnalyticsEvents.TOURNAMENT_SHARE,!Gl){e.next=21;break}return e.next=17,zl();case 17:return m=e.sent,v={playerId:f,playerName:g,score:t,leaderboardId:m},e.next=21,n(Yl(v));case 21:e.next=28;break;case 23:if(a=ni.AnalyticsEvents.TOURNAMENT_CREATE,!Gl){e.next=28;break}return y={playerId:f,playerName:g,score:t,autoStartGame:!1},e.next=28,n(Vl(y));case 28:if(h.event(a,{success:!0}),!1!==Gl){e.next=32;break}return e.next=32,o.requestTournamentAsync(t);case 32:n(Xl(t)),e.next=40;break;case 35:if(e.prev=35,e.t0=e.catch(2),!(e.t0 instanceof Nl)){e.next=39;break}return e.abrupt("return");case 39:a&&h.event(a,{success:!1});case 40:case"end":return e.stop()}}),e,null,[[2,35]])})));return function(t,n){return e.apply(this,arguments)}}()},Xl=function(t){return{type:Oa,payload:{score:t}}},Kl=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidOpponentId",i.message=e||"This opponentId is not valid",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,se.default)(Error)),jl=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="WideFrameRenderFail",i.message=e||"Wide frame render fail",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,se.default)(Error)),ql={PASS_LEVELS:{ID:"pass-levels",EVENTS:{PASS_LEVEL:"pass-level"}},COLLECT_DIAMONDS:{ID:"collect-diamonds",EVENTS:{COLLECT_DIAMONDS:"collect-diamonds"}},INVITE_FRIENDS:{ID:"invite-friends",EVENTS:{INVITED_FRIEND:"INVITED_FRIEND"}},REACH_SCORE:{ID:"reach-score",EVENTS:{ADD_SCORE:"add-score"}},EVENTS:{TASKS_RESET:"tasks-reset",NOTICE_UPDATE:"notice-update"}},Zl=function(t,e){return e.playerId},Jl=((0,be.createSelector)([function(t){return Cl(t).match.isRequesting}],(function(t){return t})),(0,be.createSelector)([function(t){return Cl(t).match.single}],(function(t){return t}))),Ql=(0,be.createSelector)([function(t){return Cl(t).match.single._id}],(function(t){return t})),$l=(0,be.createSelector)([function(t){return Cl(t).match.single.score}],(function(t){return t||0})),tu=((0,be.createSelector)([function(t){return Cl(t).match.single.level}],(function(t){return t||0})),(0,be.createSelector)([function(t){var e;return null==(e=Cl(t).match.single.data)?void 0:e.diamond}],(function(t){return t||0})),(0,be.createSelector)([function(t){var e;return null==(e=Cl(t).match.single.data)?void 0:e.fen}],(function(t){return t||null})),(0,be.createSelector)([function(t){return Cl(t).match.single.status}],(function(t){return t})),(0,be.createSelector)([function(t){return Cl(t).match.single.playerId}],(function(t){return t})),(0,be.createSelector)([function(t){return Cl(t).match.challenge}],(function(t){return t}))),eu=(0,be.createSelector)([function(t){return Cl(t).match.challenge._id}],(function(t){return t})),nu=(0,be.createSelector)([function(t){return Cl(t).match.challenge.status}],(function(t){return t})),iu=(0,be.createSelector)([function(t){return Cl(t).match.challenge.opponentInfo}],(function(t){return t})),au=((0,be.createSelector)([function(t){return Cl(t).match.challenge.whitePlayerId}],(function(t){return t})),(0,be.createSelector)([function(t){return Cl(t).match.challenge.blackPlayerId}],(function(t){return t})),(0,be.createSelector)([tu,Zl],(function(t,e){var n=t.whitePlayerId,i=t.blackPlayerId;return n!==e&&i===e?n:i!==e&&n===e?i:""})),(0,be.createSelector)([tu,Zl],(function(t,e){var n=t.whitePlayerId,i=t.blackPlayerId;return n===e?n:i===e?i:Hr.playerId}))),ru=(0,be.createSelector)([tu,Zl],(function(t,e){var n=t.whitePlayerId,i=t.blackPlayerId,a=t.whitePlayerFinish,r=t.blackPlayerFinish;return e&&n===e?a:!(!e||i!==e)&&r})),su=(0,be.createSelector)([tu,function(t,e){return e.opponentId}],(function(t,e){var n=t.whitePlayerId,i=t.blackPlayerId,a=t.whitePlayerFinish,r=t.blackPlayerFinish;return e&&n===e?a:!(!e||i!==e)&&r})),ou=(0,be.createSelector)([function(t){return Cl(t).match.group.opponentInfo}],(function(t){return t})),hu=((0,be.createSelector)([function(t){return Cl(t).match.online.players}],(function(t){return t})),(0,be.createSelector)([function(t){return Cl(t).match.journey}],(function(t){return t}))),cu=(0,be.createSelector)([function(t){return Cl(t).match.journey._id}],(function(t){return t})),lu=(0,be.createSelector)([function(t){return Cl(t).match.journey.level}],(function(t){return t})),uu=(0,be.createSelector)([function(t){return Cl(t).match.journey.challengeMode}],(function(t){return t})),du=(0,be.createSelector)([function(t){return Cl(t).match.journey.score}],(function(t){return t})),pu=(0,be.createSelector)([function(t){return Cl(t).stats.data}],(function(t){return t})),fu=(0,be.createSelector)([function(t){return Cl(t).stats.current}],(function(t){return t})),gu=((0,be.createSelector)([function(t){return Cl(t).stats.isRequesting}],(function(t){return t})),(0,be.createSelector)([function(t){return t.messages.data}],(function(t){return t}))),mu=(0,be.createSelector)([gu,function(t,e){return e.opponentId}],(function(t,e){return!!GameCore.Utils.Valid.isString(e)&&(!!GameCore.Utils.Object.hasOwn(t,e)&&t[e].sent)})),vu=n(463),yu=new(n.n(vu)()),Su=n(356),Au=n.n(Su),Eu=function(t){if("string"!==typeof t||!t)throw new jl(null,{imageShare:t})},xu=function(){return(0,Xt.default)(qt().mark((function t(){var e,n,i,a,r,s,o,h,c,l,u;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=window.game,n=e.player,i=e.analytics,a=e.facebook,r=e.globalScene,s=e.lang,t.prev=1,r.screen.open(vs,{message:s.Text.LOADING,loading:!0}),t.next=5,bu();case 5:return o=t.sent,Eu(o),h=n.getPlayer(),c=h.playerId,l=h.name,u=h.photo,t.next=10,a.shareAsync({text:s.Text.SHARE_BEST_SCORE,intent:"SHARE",image:o||"",data:{playerId:c,playerName:l,playerPhoto:u,type:Nr}});case 10:i.event(ni.AnalyticsEvents.SHARE,{share_content_type:"BestScore",success:!0}),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(1),i.event(ni.AnalyticsEvents.SHARE,{share_content_type:"BestScore",success:!1}),(0,Ht.sendException)(t.t0);case 17:return t.prev=17,r.screen.close(vs),t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[1,13,17,20]])})))},bu=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n,i,a,r,s,o,h,c,l;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=window.game,n=e.player,i=e.globalScene,a=n.getPlayer(),r=a.playerId,s=a.photo,o=a.data,h=(o||{}).score,c=wu({playerId:r,playerPhoto:s,playerScore:h})){t.next=7;break}return t.abrupt("return");case 7:return l={name:"share-best-score",width:952,height:492,renderOptions:c},t.next=10,i.frameCapture.capture(l);case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Tu=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,r,s,o,h,c,l,u,d,p;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=window.game,i=n.player,a=n.globalScene,r=fu(e),s=pu(e),o=i.getPlayer(),h=o.playerId,c=o.photo,l=s[h]||{},u=l.score,r.bestScore>u&&(u=r.bestScore),d=wu({playerId:h,playerPhoto:c,playerScore:u})){t.next=10;break}return t.abrupt("return");case 10:return p={name:"share-current-score",width:952,height:492,renderOptions:d},t.next=13,a.frameCapture.capture(p);case 13:return t.abrupt("return",t.sent);case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),wu=function(t){var e=t.playerId,n=void 0===e?"10":e,i=t.playerPhoto,a=void 0===i?"":i,r=t.playerScore,s=void 0===r?0:r;return"string"!==typeof n||"string"!==typeof a||"number"!==typeof s?null:{avatar:{name:""+n,type:"image",x:635,y:122,image:a,width:210,height:210,fallbackWithImage:zr.default.AVATAR.KEY},wideFrame:{name:"wide-frame-message-win",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-message-win.png",width:952,height:492},playerScoreShadow:{type:"text",x:740,y:437,font:"600 70px",fillStyle:"#c4683f",text:""+s,textAlign:"center"},playerScore:{type:"text",x:740,y:437,font:"600 70px",fillStyle:"#f2a62e",text:""+s,textAlign:"center"}}},Cu=(function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n,i,a,r,s,o,h,c,l,u,d,p,f,g,m,v,y,S,A;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=window.game,n=e.player,i=e.profile,a=e.globalScene,r=n.getPlayer(),s=r.playerId,o=r.name,h=r.photo,(c=n.getConnectedPlayerIds(99,0)).push(s),l=[],t.next=7,Kc({playerIds:GameCore.Utils.Array.unique(c),limit:c.length});case 7:u=t.sent,d=GameCore.Utils.Object.keyBy(u,"playerId"),p={playerId:s,name:o,photo:h,score:0},GameCore.Utils.Object.hasOwn(d,s)&&(p=d[s]),l.push(p),t.t0=Au()(qt()).call(qt(),d);case 14:if((t.t1=t.t0()).done){t.next=27;break}if(f=t.t1.value,!GameCore.Utils.Object.hasOwn(d,f)){t.next=25;break}if(g=d[f],3!==l.length){t.next=20;break}return t.abrupt("break",27);case 20:if(g.playerId!==s){t.next=22;break}return t.abrupt("continue",14);case 22:if(!(Number(g.score)>Number(p.score))){t.next=24;break}return t.abrupt("continue",14);case 24:l.push(g);case 25:t.next=14;break;case 27:return m=GameCore.Utils.Array.unique(c),t.next=30,i.requestProfiles(m);case 30:if(v=i.getProfiles(),l.forEach((function(t,e){var n=t.playerId;if(GameCore.Utils.Object.hasOwn(v,n)){var i=v[n],a=i.name,r=i.photo;l[e].name=a,l[e].photo=r}})),l.length<3)for(y=0;y<=3-l.length;)l.push({playerId:"bot"+y,name:"???",score:0,photo:"./assets/images/others/avatar.png"}),y++;if(S=Cu({playerId:s,playerName:o,playerPhoto:h,listLeaders:l})){t.next=37;break}return t.abrupt("return");case 37:return A={name:"share-leaderboard",width:1500,height:2e3,renderOptions:S},t.next=40,a.frameCapture.capture(A);case 40:return t.abrupt("return",t.sent);case 41:case"end":return t.stop()}}),t)})))}(),function(t){var e=t.playerId,n=void 0===e?"10":e,i=t.playerPhoto,a=void 0===i?"":i,r=t.listLeaders,s=void 0===r?[]:r;if(!Array.isArray(s))return null;if("string"!==typeof n)return null;if("string"!==typeof a)return null;var o={avatar:{name:""+n,type:"image",x:490,y:250,image:a,width:525,height:525,fallbackWithImage:zr.default.AVATAR.KEY}};return s.forEach((function(t,e){var n=t.playerId,i=t.photo;o["photo_"+n]={name:""+n,type:"image",x:475,y:1215+385*e,image:i,width:150,height:150,fallbackWithImage:zr.default.AVATAR.KEY}})),o.wideFrame={name:"wide-frame-share",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-share.png",width:1500,height:2e3},s.forEach((function(t,e){var n=t.playerId,i=t.name,a=t.score;o["name_"+n]={type:"text",x:690,y:1312+193*e,font:"600 60px",text:i,fillStyle:"#b18151"},o["score_"+n]={type:"text",x:1070,y:1312+193*e,font:"600 55px",text:a,fillStyle:"#b18151"}})),o}),Mu=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,r,s,o,h,c,l,u,d,p,f,g,m,v,y,S;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=window.game,i=n.player,a=n.globalScene,r=pu(e),s=i.getPlayer(),o=s.photo,h=s.playerId,c=iu(e),l=c.playerId,u=c.photo,d=ru(e,{playerId:h}),p=su(e,{opponentId:l}),f=r[h]||{},g=f.score,m=r[l]||{},v=m.score,y=Pu({playerId:h,playerPhoto:o,playerScore:g,opponentId:l,opponentPhoto:u,opponentScore:v,isPlayerFinished:d,isOpponentFinished:p})){t.next=12;break}return t.abrupt("return");case 12:return S={name:"share-game-result",width:952,height:492,renderOptions:y},t.next=15,a.frameCapture.capture(S);case 15:return t.abrupt("return",t.sent);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Iu=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,r,s,o,h,c,l,u,d,p,f,g,m;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=window.game,i=n.player,a=n.globalScene,r=pu(e),s=i.getPlayer(),o=s.photo,h=s.playerId,c=ou(e),l=c.playerId,u=c.photo,d=c.score,p=r[h]||{},f=p.score,g=Pu({playerId:h,playerPhoto:o,playerScore:f,opponentId:l,opponentPhoto:u,opponentScore:d})){t.next=9;break}return t.abrupt("return");case 9:return m={name:"share-group-match-result",width:952,height:492,renderOptions:g},t.next=12,a.frameCapture.capture(m);case 12:return t.abrupt("return",t.sent);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Pu=function(t){var e=t.playerId,n=void 0===e?"10":e,i=t.playerPhoto,a=void 0===i?"":i,r=t.playerScore,s=void 0===r?0:r,o=t.opponentId,h=void 0===o?"20":o,c=t.opponentPhoto,l=void 0===c?"":c,u=t.opponentScore,d=void 0===u?0:u,p=t.isPlayerFinished,f=t.isOpponentFinished;if("string"!==typeof n)return null;if("string"!==typeof a)return null;if("number"!==typeof s)return null;if("string"!==typeof h)return null;if("string"!==typeof l)return null;if("number"!==typeof d)return null;if("boolean"!==typeof p)return null;if("boolean"!==typeof f)return null;var g=s===d,m=s>d,v=p||f,y=p&&f,S={leftPhoto:{name:""+n,type:"image",x:55,y:162,image:a,width:200,height:200,fallbackWithImage:zr.default.AVATAR.KEY},rightPhoto:{name:""+h,type:"image",x:702,y:162,image:l,width:200,height:200,fallbackWithImage:zr.default.AVATAR.KEY},wideFrame:{name:"wide-frame-game-result",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-game-result.png",width:952,height:492}};return v&&(S.leftScoreShadow={type:"text",x:148,y:443,font:"600 70px",fillStyle:"#c4683f",text:p?""+s:"???",textAlign:"center"},S.leftScore={type:"text",x:148,y:443,font:"600 70px",fillStyle:"#f2a62e",text:p?""+s:"???",textAlign:"center"},S.rightScoreShadow={type:"text",x:795,y:443,font:"600 70px",fillStyle:"#c4683f",text:f?""+d:"???",textAlign:"center"},S.rightScore={type:"text",x:795,y:443,font:"600 70px",fillStyle:"#f2a62e",text:f?""+d:"???",textAlign:"center"}),!g&&y&&(m?S.leftCrown={name:"crown-icon",type:"image",x:12,y:122,image:"./assets/images/others/crown-icon.png",width:106,height:78}:S.rightCrown={name:"crown-icon",type:"image",x:665,y:122,image:"./assets/images/others/crown-icon.png",width:106,height:78}),S},ku=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,r,s,o,h,c,l,u;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=window.game,i=n.player,a=n.analytics,r=n.facebook,s=n.globalScene,t.prev=1,s.screen.open(vs,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",loading:!0}),t.next=5,Ru();case 5:return o=t.sent,Eu(o),h=i.getPlayer(),c=h.playerId,l=h.name,u=h.photo,t.next=10,r.shareAsync({text:"Great! I have a score!",intent:"SHARE",image:o||"",data:{playerId:c,playerName:l,playerPhoto:u,type:Nr}});case 10:a.event(ni.AnalyticsEvents.SHARE,{share_content_type:"Score",success:!0}),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(1),a.event(ni.AnalyticsEvents.SHARE,{share_content_type:"Score",success:!1}),(0,Ht.sendException)(t.t0);case 17:return t.prev=17,s.screen.close(vs),t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[1,13,17,20]])})));return function(e){return t.apply(this,arguments)}}()},Ru=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n,i,a,r,s,o,h,c;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=window.game,n=e.player,i=e.globalScene,a=n.getPlayer(),r=a.playerId,s=a.photo,o=n.getBestScore(),h=Ou({playerId:r,playerPhoto:s,playerScore:o})){t.next=7;break}return t.abrupt("return");case 7:return c={name:"share-score",width:952,height:492,renderOptions:h},t.next=10,i.frameCapture.capture(c);case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Ou=function(t){var e=t.playerId,n=void 0===e?"10":e,i=t.playerPhoto,a=void 0===i?"":i,r=t.playerScore,s=void 0===r?0:r;return"string"!==typeof n||"string"!==typeof a||"number"!==typeof s?null:{avatar:{name:""+n,type:"image",x:635,y:122,image:a,width:210,height:210,fallbackWithImage:zr.default.AVATAR.KEY},wideFrame:{name:"wide-frame-message-win",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-message-win.png",width:952,height:492},playerScoreShadow:{type:"text",x:740,y:437,font:"600 70px",fillStyle:"#c4683f",text:""+s,textAlign:"center"},playerScore:{type:"text",x:740,y:437,font:"600 70px",fillStyle:"#f2a62e",text:""+s,textAlign:"center"}}},_u=function(t){var e=t.contextId;if(""===e||"string"!==typeof e)throw new Tl(null,{contextId:e})},Du=function(t){var e=t.opponentId,n=t.contextId;if(""===e||"string"!==typeof e)throw new Kl(null,{opponentId:e});if(""===n||"string"!==typeof n)throw new Tl(null,{contextId:n})},Lu=function(t){if(null===t.imageShare)throw new jl},Bu=function(t,e){return void 0===e&&(e=!0),function(n,i){var a,r=i(),s=gu(r);if(e){var o;if(null!=(o=s[t])&&o.sent)return;n(Fu(t))}null!=(a=s[t])&&a.sent&&n(Nu(t))}},Fu=function(t){return{type:gi,payload:{opponentId:t}}},Nu=function(t){return{type:mi,payload:{opponentId:t}}},Gu=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,i=window.game.facebook,Du({opponentId:e,contextId:n}),(a=window.game.facebook.getContextID())!==n||""===n){t.next=6;break}return t.abrupt("return",a);case 6:if("10"!==e||""===n){t.next=8;break}return t.abrupt("return",n);case 8:if(!n){t.next=12;break}return t.next=11,i.switchAsync(n);case 11:return t.abrupt("return",window.game.facebook.getContextID());case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 17:return t.abrupt("return","");case 18:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e,n){return t.apply(this,arguments)}}(),Uu=function(t,e){return function(){var n=(0,Xt.default)(qt().mark((function n(i,a){var r,s,o,h,c,l,u,d,p,f,g,m,v;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=window.game,s=r.player,o=r.analytics,h=r.facebook,n.prev=1,c=e.matchId,l=e.contextId,n.next=5,Gu(t,l);case 5:return u=n.sent,_u({contextId:u}),d=a(),n.next=10,Mu(d);case 10:return p=n.sent,Lu({imageShare:p}),f=s.getPlayer(),g=f.name,m=f.playerId,v=window.game.lang.getText({key:"MESSAGE_INVITE",variables:[g]}),n.next=16,h.sendMessage({cta:"Play",text:v,image:p||"",template:"challenge",data:{type:Vr,matchId:c,playerId:m,opponentId:t,status:Ta}});case 16:i(Bu(t)),o.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"Invite",success:!0}),yu.emit(ql.INVITE_FRIENDS.EVENTS.INVITED_FRIEND,{type:"friend",value:1,opponentId:t}),n.next=25;break;case 21:n.prev=21,n.t0=n.catch(1),o.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"Invite",success:!1}),(0,Ht.sendException)(n.t0);case 25:case"end":return n.stop()}}),n,null,[[1,21]])})));return function(t,e){return n.apply(this,arguments)}}()},Vu=function(t,e){return function(){var n=(0,Xt.default)(qt().mark((function n(i,a){var r,s,o,h,c,l,u,d,p,f,g,m,v;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=window.game,s=r.player,o=r.analytics,h=r.facebook,n.prev=1,c=e.matchId,l=e.contextId,n.next=5,Gu(t,l);case 5:return u=n.sent,_u({contextId:u}),d=a(),n.next=10,Mu(d);case 10:return p=n.sent,Lu({imageShare:p}),f=s.getPlayer(),g=f.name,m=f.playerId,v=window.game.lang.getText({key:"MESSAGE_FINISH_MATCH",variables:[g]}),n.next=16,h.sendMessage({cta:"See result",text:v,image:p||"",template:"finished",data:{type:Vr,matchId:c,playerId:m,opponentId:t,status:wa}});case 16:i(Bu(t)),o.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"FinishMatch",success:!0}),n.next=24;break;case 20:n.prev=20,n.t0=n.catch(1),o.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"FinishMatch",success:!1}),(0,Ht.sendException)(n.t0);case 24:case"end":return n.stop()}}),n,null,[[1,20]])})));return function(t,e){return n.apply(this,arguments)}}()},Yu=function(t,e){return function(){var n=(0,Xt.default)(qt().mark((function n(i,a){var r,s,o,h,c,l,u,d,p,f,g,m,v,y,S,A,E;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=window.game,s=r.player,o=r.analytics,h=r.facebook,n.prev=1,c=e.matchId,l=e.contextId,n.next=5,Gu(t,l);case 5:return u=n.sent,_u({contextId:u}),d=a(),n.next=10,Mu(d);case 10:return p=n.sent,Lu({imageShare:p}),f=s.getPlayer(),g=f.name,m=f.playerId,v=pu(d),y=v[m]||{},S=y.score,A=void 0===S?0:S,E=window.game.lang.getText({key:"MESSAGE_BEST_SCORE",variables:[g,A]}),n.next=18,h.sendMessage({cta:"See result",text:E,image:p||"",template:"pass_score",data:{type:Vr,matchId:c,playerId:m,opponentId:t,status:wa}});case 18:i(Bu(t)),o.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"BestScore",success:!0}),n.next=26;break;case 22:n.prev=22,n.t0=n.catch(1),o.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"BestScore",success:!1}),(0,Ht.sendException)(n.t0);case 26:case"end":return n.stop()}}),n,null,[[1,22]])})));return function(t,e){return n.apply(this,arguments)}}()},zu=function(t,e){return function(){var n=(0,Xt.default)(qt().mark((function n(i,a){var r,s,o,h,c,l,u,d,p,f,g,m,v,y;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=window.game,s=r.player,o=r.analytics,h=r.facebook,n.prev=1,c=e.matchId,l=e.contextId,u=e.score,n.next=5,Gu(t,l);case 5:return d=n.sent,_u({contextId:d}),p=a(),n.next=10,Mu(p);case 10:return f=n.sent,Lu({imageShare:f}),g=s.getPlayer(),m=g.name,v=g.playerId,y=window.game.lang.getText({key:"MESSAGE_FINISH_TURN",variables:[m,u]}),n.next=16,h.sendMessage({cta:"Play",text:y,image:f||"",template:"play_turn",data:{type:Vr,matchId:c,playerId:v,opponentId:t,status:Ta}});case 16:i(Bu(t)),o.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"FinishTurn",success:!0}),n.next=26;break;case 20:if(n.prev=20,n.t0=n.catch(1),o.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"FinishTurn",success:!1}),!(n.t0 instanceof Tl)){n.next=25;break}return n.abrupt("return");case 25:(0,Ht.sendException)(n.t0);case 26:case"end":return n.stop()}}),n,null,[[1,20]])})));return function(t,e){return n.apply(this,arguments)}}()},Hu=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,r,s,o,h,c,l,u,d;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game,a=i.player,r=i.facebook,s=a.getPlayer(),o=s.playerId,h=s.name,c=s.photo,l=fu(n),u=l.score,d={type:Yr,playerId:o,playerName:h,playerPhoto:c,playerScore:u},t.next=7,r.sendMessage({cta:{default:"Play",localizations:{en_US:"Play",vi_VN:"Ch\u01a1i"}},text:{default:h+" beats your high score. Their score: "+u+".",localizations:{en_US:h+" beats your high score. Their score: "+u+".",vi_VN:h+" v\u1eeba v\u01b0\u1ee3t \u0111i\u1ec3m s\u1ed1 cao nh\u1ea5t c\u1ee7a b\u1ea1n! Ch\u01a1i l\u1ea7n n\u1eefa ch\u1ee9?"}},image:e||"",template:"play_turn",data:d});case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,n){return t.apply(this,arguments)}}(),Wu=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,r,s,o,h,c,l,u,d;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=window.game,a=i.player,r=i.facebook,t.prev=1,s=a.getPlayer(),o=s.playerId,h=s.name,c=s.photo,l=fu(n),u=l.score,d={type:Yr,playerId:o,playerName:h,playerPhoto:c,playerScore:u},t.next=7,r.sendMessage({cta:{default:"Play",localizations:{en_US:"Play",vi_VN:"Ch\u01a1i ngay"}},text:{default:h+" got "+u+" scores. So easy! Can you?",localizations:{en_US:h+" got "+u+" scores. So easy! Can you?",vi_VN:h+" \u0111\xe3 \u0111\u1ea1t "+u+" \u0111i\u1ec3m! Qu\xe1 d\u1ec5 lu\xf4n. Ch\u01a1i l\u1ea1i n\xe0o!"}},image:e||"",template:"play_turn",data:d});case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),(0,Ht.sendException)(t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e,n){return t.apply(this,arguments)}}(),Xu=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidMatchId",i.message=e||"Invalid match id",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,se.default)(Error)),Ku=(GameCore.Utils.Valid.isDebugger(),[{key:"level-0",mapJson:"./assets/json/levels/level-0.json"}]),ju=1;ju<=100;ju++)Ku.push({key:"level-"+ju,mapJson:"./assets/json/levels/level-"+ju+".json"});var qu=Ku,Zu=GameCore.Configs.ApiHost,Ju=(function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"single-matches",t.next=3,je("single-matches",e,{},Zu);case 3:return n=t.sent,t.abrupt("return",(null==n?void 0:n.data)||{});case 5:case"end":return t.stop()}}),t)})))}(),function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"single-matches/active",t.next=3,Ke("single-matches/active",{},Zu);case 3:return e=t.sent,t.abrupt("return",(null==e?void 0:e.data)||{});case 5:case"end":return t.stop()}}),t)})))}(),function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i="single-matches/"+e+"/move",t.next=3,je(i,n,{},Zu);case 3:return a=t.sent,t.abrupt("return",(null==a?void 0:a.data)||{});case 5:case"end":return t.stop()}}),t)})))}(),function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="single-matches/"+e+"/finish",t.next=3,je(n,{},{},Zu);case 3:return i=t.sent,t.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return t.stop()}}),t)})))}(),function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"matches",t.next=3,je("matches",{opponentPlayerId:e},{},Zu);case 3:return n=t.sent,t.abrupt("return",(null==n?void 0:n.data)||{});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),Qu=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="matches/"+e+"/join",t.next=3,je(n,{},{},Zu);case 3:return i=t.sent,t.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),$u=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="matches/"+e,t.next=3,Ke(n,{},Zu);case 3:return i=t.sent,t.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),td=function(){var t=(0,Xt.default)(qt().mark((function t(e,n,i,a){var r,s;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="matches/"+e+"/finish",t.next=3,je(r,{matchId:e,score:n,level:i,extraData:a},{},Zu);case 3:return s=t.sent,t.abrupt("return",(null==s?void 0:s.data)||{});case 5:case"end":return t.stop()}}),t)})));return function(e,n,i,a){return t.apply(this,arguments)}}(),ed=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidMatchStatus",i.message=e||"The match status is not valid",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,se.default)(Error)),nd=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidOpponentId",i.message=e||"Invalid opponent id",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,se.default)(Error)),id=nd,ad=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidBlackPlayerId",i.message=e||"Invalid black player id",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,se.default)(Error)),rd=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidRequestedMatchId",i.message=e||"The matchId in match data not matched with requested matchId",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,se.default)(Error)),sd=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidScore",i.message=e||"The score is not valid",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,se.default)(Error)),od=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidWhitePlayerId",i.message=e||"Invalid white player id",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,se.default)(Error)),hd=function(t){var e=t.matchId,n=t.score;if(""===e||"string"!==typeof e)throw new Xu(null,{matchId:e});if("number"!==typeof n)throw new sd(null,{score:n})},cd=function(t){var e=t.matchId,n=t.currentMatchId;if(""===e||"string"!==typeof e)throw new Xu(null,{matchId:e});if(""===n||"string"!==typeof n)throw new Xu(null,{currentMatchId:n});if(e!==n)throw new rd(null,{matchId:e,currentMatchId:n})},ld=function(t){var e=t.matchId,n=t.currentMatchId;if(""===e||"string"!==typeof e)throw new Xu(null,{matchId:e});if(""===n||"string"!==typeof n)throw new Xu(null,{currentMatchId:n});if(e!==n)throw new rd(null,{matchId:e,currentMatchId:n})},ud=function(t){var e=t.playerId,n=t.match,i=n._id,a=n.playerId,r=n.status;if(""===i||"string"!==typeof i)throw new Xu(null,{matchId:i});if("finished"===r||"string"!==typeof r)throw new ed("This match is finished",{status:r});if(a!==e)throw new Fr(null,{playerId:a,currentPlayerId:e})},dd=function(t){var e=t.opponentId;if(""===e||"string"!==typeof e)throw new id(null,{opponentId:e})},pd=function(t){var e=t.matchId;if(""===e||"string"!==typeof e)throw new Xu(null,{matchId:e})},fd=function(t){var e=t.match,n=e._id,i=e.whitePlayerId,a=e.blackPlayerId;if(""===n||"string"!==typeof n)throw new Xu(null,{matchId:n});if(""===i||"string"!==typeof i)throw new od(null,{whitePlayerId:i});if(""===a||"string"!==typeof a)throw new ad(null,{blackPlayerId:a})},gd=GameCore.Configs.Match,md=function(t){try{return GameCore.Utils.Hash.stringToHash(_()(t))}catch(e){return""}},vd=function(t){try{return JSON.parse(GameCore.Utils.Hash.hashToString(t))}catch(e){return""}},yd=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,r,s,o;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,n=window.game,i=n.player,a=n.globalScene,r=n.lang,a.screen.open(vs,{message:r.Text.LOADING,loading:!0}),e({type:Qi,payload:{}}),s=i.getPlayerId(),o=(0,wt.default)({},gd.LocalSingleMatchDefault,{status:"active",playerId:s,startedAt:Date.now(),rescued:0}),ud({playerId:s,match:o}),e(Ed(o)),Be(gd.SingleMatchStore,o),t.next=19;break;case 11:if(t.prev=11,t.t0=t.catch(0),e(Ed(null)),!(t.t0 instanceof Xu)){t.next=16;break}return t.abrupt("return");case 16:if(!(t.t0 instanceof ed)){t.next=18;break}return t.abrupt("return");case 18:(0,Ht.sendException)(t.t0);case 19:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}()},Sd=function(t,e){return function(n,i){try{hd((0,wt.default)({matchId:t},e));var a=i(),r=cu(a);cd({matchId:t,currentMatchId:r}),n({type:ra,payload:{match:e}});var s=e.data;e.data=md(s),e.challengeMode=!1;var o=window.game.player;Be(gd.JourneyMatchStore+"-"+o.getPlayerId(),e)}catch(h){if(h instanceof Xu)return;(0,Ht.sendException)(h)}}},Ad=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n,i){var a,r,s,o,h,c,l,u;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,a=window.game.player,pd({matchId:t}),r=i(),s=Ql(r),o=a.getPlayerId(),ld({matchId:t,currentMatchId:s}),n({type:"MATCH_SINGLE_FINISH_REQUEST",payload:{matchId:t}}),h=Jl(r),ud({playerId:o,match:h}),c=(0,wt.default)({},gd.LocalSingleMatchDefault,h,{_id:t,status:"finished",playerId:o,finishAt:Date.now()}),n(Ed(c)),l=c.data,(u=(0,wt.default)({},c)).data=md(l),Be(gd.SingleMatchStore,u),e.next=26;break;case 18:if(e.prev=18,e.t0=e.catch(0),n(Ed(null)),!(e.t0 instanceof Xu)){e.next=23;break}return e.abrupt("return");case 23:if(!(e.t0 instanceof ed)){e.next=25;break}return e.abrupt("return");case 25:(0,Ht.sendException)(e.t0);case 26:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(t,n){return e.apply(this,arguments)}}()},Ed=function(t){return{type:ea,payload:{match:t}}},xd=function(t){return{type:sa,payload:{match:t}}},bd=function(){return{type:na,payload:{}}},Td=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n){var i,a,r,s,o,h;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=window.game,a=i.profile,r=i.globalScene,s=i.lang,r.screen.open(vs,{message:s.Text.LOADING,loading:!0}),o=t.playerId,dd({opponentId:o}),n({type:ua,payload:{opponentInfo:t}}),e.next=8,Ju(o);case 8:return h=e.sent,fd({match:h}),e.next=12,a.requestProfiles([o]);case 12:n(Id(h)),e.next=23;break;case 15:if(e.prev=15,e.t0=e.catch(0),n(Id(null)),!(e.t0 instanceof Xu)){e.next=20;break}return e.abrupt("return");case 20:if(!(e.t0 instanceof id)){e.next=22;break}return e.abrupt("return");case 22:(0,Ht.sendException)(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}()},wd=function(t,e){return void 0===e&&(e=!0),function(){var n=(0,Xt.default)(qt().mark((function n(i){var a,r,s,o,h,c,l,u,d,p;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a=window.game,r=a.player,s=a.profile,o=a.globalScene,e&&o.screen.open(vs,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",loading:!0}),pd({matchId:t}),i({type:la,payload:{matchId:t}}),n.next=7,Qu(t);case 7:if(h=n.sent,fd({match:h}),c=h.status,l=h.whitePlayerId,u=h.blackPlayerId,c!==Ta){n.next=16;break}return d=r.getPlayerId(),p=d===l?u:l,n.next=16,s.requestProfiles([p]);case 16:i(Id(h)),n.next=25;break;case 19:if(n.prev=19,n.t0=n.catch(0),i(Id(null)),!(n.t0 instanceof Xu)){n.next=24;break}return n.abrupt("return");case 24:(0,Ht.sendException)(n.t0);case 25:case"end":return n.stop()}}),n,null,[[0,19]])})));return function(t){return n.apply(this,arguments)}}()},Cd=function(t,e){return function(){var n=(0,Xt.default)(qt().mark((function n(i){var a,r,s,o,h,c,l,u,d;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a=window.game,r=a.player,a.globalScene.screen.open(vs,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",loading:!0}),pd({matchId:t}),i({type:pa,payload:{matchId:t,opponentInfo:e}}),n.next=7,$u(t);case 7:s=n.sent,fd({match:s}),o=s.whitePlayerId,h=s.whitePlayerScore,c=s.blackPlayerScore,l=r.getPlayerId(),u=r.getPlayerData(),d=u.score,i(Id(s,{score:l===o?h:c,bestScore:d})),n.next=23;break;case 17:if(n.prev=17,n.t0=n.catch(0),i(Id(null)),!(n.t0 instanceof Xu)){n.next=22;break}return n.abrupt("return");case 22:(0,Ht.sendException)(n.t0);case 23:case"end":return n.stop()}}),n,null,[[0,17]])})));return function(t){return n.apply(this,arguments)}}()},Md=function(t,e,n){return function(){var i=(0,Xt.default)(qt().mark((function i(a){var r,s,o,h,c;return qt().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,r=window.game,s=r.globalScene,o=r.lang,s.screen.open(vs,{message:o.Text.LOADING,loading:!0}),pd({matchId:t}),a({type:da,payload:{matchId:t,score:e,extraData:n}}),h=n.level,i.next=8,td(t,e,h,n);case 8:return c=i.sent,fd({match:c}),i.next=12,a(Id(c));case 12:i.next=20;break;case 14:if(i.prev=14,i.t0=i.catch(0),a(Id(null)),!(i.t0 instanceof Xu)){i.next=19;break}return i.abrupt("return");case 19:(0,Ht.sendException)(i.t0);case 20:case"end":return i.stop()}}),i,null,[[0,14]])})));return function(t){return i.apply(this,arguments)}}()},Id=function(t,e,n){return void 0===n&&(n=null),{type:fa,payload:{match:t,opponentInfo:e,current:n}}},Pd=function(t){return{type:ma,payload:{opponentInfo:t}}},kd=function(t,e){return{type:Sa,payload:{matchId:t,players:e}}},Rd=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,r,s,o,h,c,l,u;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=window.game.player,i=n.getPlayer(),a=i.playerId,t.prev=2,e({type:$i,payload:{}}),t.next=6,window.FBInstant.player.getDataAsync(["level"]);case 6:r=t.sent,s=r.level,o=Le(gd.JourneyMatchStore+"-"+a)||{},h=o.data,c=o.level,o.data=vd(h),s!==c&&(o.data={}),(l=s||1)>qu.length-1&&(l=qu.length-1),u=(0,wt.default)({},o,{level:l,playerId:a}),e({type:ra,payload:{match:u}}),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(2);case 21:case"end":return t.stop()}}),t,null,[[2,18]])})));return function(e){return t.apply(this,arguments)}}()},Od=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e({type:ha,payload:{}});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},_d=function(t){return{type:qi,payload:{playerId:t}}},Dd=function(t,e){return{type:Zi,payload:{playerId:t,stats:e}}},Ld=function(t){return{type:Ji,payload:{stats:t}}},Bd=GameCore.Configs.Match,Fd=[],Nd=function(t){var e=t.contextId;if(""===e||"string"!==typeof e)throw new Tl(null,{contextId:e})},Gd=null,Ud=function(t){clearTimeout(Gd),Gd=setTimeout((function(){window.game.globalScene.screen.close(vs)}),t)},Vd=function(){return{type:Yi,payload:{}}},Yd=function(t){return{type:ji,payload:{stateShowMiniJourney:t}}},zd=function(){return function(t){try{t(bd()),t($d(jr))}catch(e){(0,Ht.sendException)(e)}}},Hd=function(){return function(t){try{t(bd()),t($d(Wr))}catch(e){(0,Ht.sendException)(e)}}},Wd=function(){return function(t){try{t(tp())}catch(e){(0,Ht.sendException)(e)}}},Xd=function(t,e){return void 0===t&&(t="10"),void 0===e&&(e=!1),function(n){try{n(Kd("reset",t,e))}catch(i){(0,Ht.sendException)(i)}}},Kd=function(t,e,n){return void 0===e&&(e="10"),void 0===n&&(n=!1),function(){var i=(0,Xt.default)(qt().mark((function i(a){var r,s,o,h,c,l,u,d,p,f,g,m,v,y,S,A,E;return qt().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,r=window.game,s=r.player,o=r.facebook,h=r.globalScene,r.lang,h.screen.open(vs,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",loading:!0}),c=t,l=o.contextType,e||(u=GameCore.Configs.PlayerIdMock,d=GameCore.Configs.PlayerIdMock2,e=s.getPlayerId()===u?d:u),t){i.next=15;break}return i.next=9,o.chooseAsync();case 9:if(!1!==(c=i.sent)){i.next=13;break}return n&&h.events.emit(is.SceneEvents.SWITCH,is.SceneKeys.DASHBOARD_SCENE),i.abrupt("return");case 13:i.next=25;break;case 15:if(!e||e===Hr.playerId){i.next=23;break}return i.next=18,o.createAsync(e);case 18:if(!1!==(c=i.sent)){i.next=22;break}return n&&h.events.emit(is.SceneEvents.SWITCH,is.SceneKeys.DASHBOARD_SCENE),i.abrupt("return");case 22:c||"reset"===t||(c=t);case 23:l=o.contextType,a($r(c,l));case 25:return Nd({contextId:c}),p=s.getPlayerId(),f=s.getConnectedPlayers(),i.next=30,o.getContextPlayers(p);case 30:return g=i.sent,e!==(m=Hr).playerId&&f[e]?m=f[e]:1===g.length&&(m=g[0]),a(_d()),y=(v=m).playerId,S=v.name,A=v.photo,E={playerId:y,name:S,photo:A},i.next=38,a($d(Xr,E));case 38:a($r(c,l)),yu.emit(Ec.START_GAME),i.next=51;break;case 42:if(i.prev=42,i.t0=i.catch(0),!(i.t0 instanceof Tl)){i.next=46;break}return i.abrupt("return");case 46:if("USER_INPUT"!==(null==i.t0?void 0:i.t0.code)){i.next=48;break}return i.abrupt("return");case 48:if("INVALID_OPERATION"!==(null==i.t0?void 0:i.t0.code)){i.next=50;break}return i.abrupt("return");case 50:(0,Ht.sendException)(i.t0);case 51:return i.prev=51,Ud(1e3),i.finish(51);case 54:case"end":return i.stop()}}),i,null,[[0,42,51,54]])})));return function(t){return i.apply(this,arguments)}}()},jd=function(t){var e=window.game.player.getConnectedPlayerIds(20,0);if(!t||0===t.length)return e;for(var n=[],i=0;i<e.length;i++)u()(t).call(t,e[i])||n.push(e[i]);return n},qd=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,r,s,o,h,c,l,u,d,p,f,g,m,v,y;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=window.game,i=n.player,a=n.facebook,r=n.globalScene,s=n.lang,r.screen.open(vs,{message:s.Text.LOADING,loading:!0}),o=jd(Fd),h="",c="",l=a.contextType,o.length>0&&(u=Phaser.Math.RND.between(0,o.length-1),h=o[u],Fd.push(h)),!h||"string"!==typeof h){t.next=13;break}return t.next=12,a.createAsync(h);case 12:c=t.sent;case 13:return Nd({contextId:c}),d=i.getPlayerId(),t.next=17,a.getContextPlayers(d);case 17:return p=t.sent,f=Hr,h||1!==p.length||(f=p[0]||Hr),e(_d()),m=(g=f).name,v=g.photo,y={playerId:h,name:m,photo:v},t.next=25,e($d(Xr,y));case 25:e($r(c,l)),t.next=35;break;case 28:if(t.prev=28,t.t0=t.catch(0),!(t.t0 instanceof Tl)){t.next=34;break}return e(np({mode:Wr,status:ba})),e(Hd()),t.abrupt("return");case 34:(0,Ht.sendException)(t.t0);case 35:return t.prev=35,Ud(1e3),t.finish(35);case 38:case"end":return t.stop()}}),t,null,[[0,28,35,38]])})));return function(e){return t.apply(this,arguments)}}()},Zd=function(t){return void 0===t&&(t=null),function(){var e=(0,Xt.default)(qt().mark((function e(n){var i,a,r,s,o,h;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=window.game,a=i.facebook,r=i.globalScene,s=i.analytics,o=i.lang,r.screen.open(vs,{message:o.Text.LOADING,loading:!0}),h=a.getContextID(),Nd({contextId:h}),s.event(ni.AnalyticsEvents.JOIN_GROUP,{group_id:h}),e.next=8,n($d(Kr,t));case 8:e.next=17;break;case 10:if(e.prev=10,e.t0=e.catch(0),!(e.t0 instanceof Tl)){e.next=14;break}return e.abrupt("return");case 14:if("INVALID_OPERATION"!==(null==e.t0?void 0:e.t0.code)){e.next=16;break}return e.abrupt("return");case 16:(0,Ht.sendException)(e.t0);case 17:return e.prev=17,Ud(1e3),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[0,10,17,20]])})));return function(t){return e.apply(this,arguments)}}()},Jd=function(t,e){return function(){var n=(0,Xt.default)(qt().mark((function n(i,a){var r,s,o,h,c,l,u,d,p,f,g,m,v,y,S;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,r=window.game,s=r.player,o=r.profile,h=r.facebook,(c=r.globalScene).screen.open(vs,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",loading:!0}),l=a(),u=s.getPlayerId(l),!((d=s.getConnectedPlayers(l)).length>0)||d[e]){n.next=9;break}return c.events.emit(is.SceneEvents.SWITCH,is.SceneKeys.DASHBOARD_SCENE),n.abrupt("return");case 9:return p=Hr,n.next=12,h.getContextPlayers(u);case 12:if(f=n.sent,e===u||e===p.playerId||!d[e]){n.next=17;break}p=d[e],n.next=25;break;case 17:if(1!==f.length){n.next=21;break}p=f[0],n.next=25;break;case 21:return n.next=23,o.requestProfiles([e]);case 23:(g=o.getProfiles())[e]&&(p=g[e]);case 25:return n.next=27,i(Cd(t,p));case 27:if(l=a(),au(l,{playerId:u})!==Hr.playerId){n.next=32;break}return n.next=32,i(wd(t));case 32:if(l=a(),au(l,{playerId:u})===u||!d[e]){n.next=37;break}return i(Xd(e,!0)),n.abrupt("return");case 37:if(eu(l)===t){n.next=41;break}return c.events.emit(is.SceneEvents.SWITCH,is.SceneKeys.DASHBOARD_SCENE),n.abrupt("return");case 41:if(m=nu(l),v=ru(l,{playerId:u}),i(np({mode:Xr,status:m})),y=h.getContextID(),S=h.contextType,i($r(y,S)),!v){n.next=52;break}return n.next=50,s.requestConnectedPlayers();case 50:return c.events.emit(is.SceneEvents.SWITCH,is.SceneKeys.GAME_OVER_SCENE),n.abrupt("return");case 52:c.events.emit(is.SceneEvents.SWITCH,is.SceneKeys.GAME_SCENE),n.next=58;break;case 55:n.prev=55,n.t0=n.catch(0),(0,Ht.sendException)(n.t0);case 58:return n.prev=58,Ud(1e3),n.finish(58);case 61:case"end":return n.stop()}}),n,null,[[0,55,58,61]])})));return function(t,e){return n.apply(this,arguments)}}()},Qd=function(t){return function(e){try{var n=window.game.player,i=n.getPlayerId();$c(i,t).catch((function(t){(0,Ht.sendException)(new Error(t))}));var a=n.getPlayerData(),r=a.score,s=void 0===r?0:r,o=a.level;s<t&&n.setScore(t);var h={score:t,level:o};e(Dd(i,h)),e(Ld(h))}catch(c){if(c instanceof wl)return;(0,Ht.sendException)(c)}}},$d=function(t,e){return void 0===e&&(e=null),function(){var n=(0,Xt.default)(qt().mark((function n(i,a){var r,s,o,h,c,l,d,p,f,g,m,v,y,S,E,x,b,T,w,C,M,I;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,s=window.game,o=s.player,h=s.analytics,c=s.facebook,l=s.globalScene,d=c.getContextID(),p=0,f=a(),h.event(ni.AnalyticsEvents.MATCH_START,{game_mode:GameCore.Utils.String.toUpperCamelCase(t),level:1,level_name:"level_1"}),i(Vd()),!u()(r=[Wr,jr]).call(r,t)){n.next=16;break}return n.next=10,i((function(t){try{var e=window.game.player;t({type:$i,payload:{}});var n=e.getPlayerId(),i=Le(gd.SingleMatchStore)||{},a=i.data;i.data=vd(a),ud({playerId:n,match:i}),t(Ed(i))}catch(r){if(t(Ed(null)),r instanceof Xu)return;if(r instanceof Fr)return;if(r instanceof ed)return;(0,Ht.sendException)(r)}}));case 10:if(f=a(),Ql(f)){n.next=15;break}return n.next=15,i(yd());case 15:p=$l(f);case 16:if(t===Kr&&i(Pd(e)),t!==Xr){n.next=26;break}return n.next=20,i(Td(e));case 20:f=a(),g=eu(f),m=iu(f),v=m.playerId,d||(d=window.game.facebook.getContextID()),y=mu(f,{opponentId:v}),d&&v&&!y&&i(Uu(v,{contextId:d,matchId:g}));case 26:t===qr&&i(function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,r,s,o,h,c;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=window.game.player,r=a.getPlayer(),s=r.playerId,o=r.name,h=r.photo,e({type:ya,payload:{playerId:s}}),c={},De()(n=A()(i=new Array(20)).call(i,null)).call(n,(function(t,e){var n="0"+(e+1);c[n]={playerId:n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.png"}})),c[s]={playerId:s,name:o,photo:h},e(kd("mock",c));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),f=a(),S=o.getPlayerData(f),E=S.score,x=void 0===E?0:E,b=Jl(f),T=b.rescued,w=void 0===T?0:T,i(Ld({score:p,bestScore:x})),i({type:zi,payload:{mode:t,contextId:d,rescued:w}}),i(ts(t)),l.events.emit(is.SceneEvents.SWITCH,is.SceneKeys.GAME_SCENE),n.next=44;break;case 37:if(n.prev=37,n.t0=n.catch(0),!(n.t0 instanceof Xu)){n.next=43;break}return C=window.game,M=C.globalScene,I=C.lang,M.screen.open(vs,{message:I.Text.NO_REWARDS+"\n"+I.Text.CANCELLED_AD,duration:2500,loading:!1}),n.abrupt("return");case 43:(0,Ht.sendException)(n.t0);case 44:return n.prev=44,Ud(0),n.finish(44);case 47:case"end":return n.stop()}}),n,null,[[0,37,44,47]])})));return function(t,e){return n.apply(this,arguments)}}()},tp=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,r,s,o,h,c;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,i=window.game,a=i.analytics,r=i.facebook,s=i.globalScene,o=r.getContextID(),h=n(),c=lu(h)||1,a.event(ni.AnalyticsEvents.MATCH_START,{game_mode:GameCore.Utils.String.toUpperCamelCase(Zr),level:c}),e(Vd()),h=n(),cu(h)){t.next=12;break}return t.next=12,e(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,r,s,o,h,c;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,i=window.game,a=i.player,i.globalScene.screen.open(vs,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",loading:!0}),e({type:ia,payload:{}}),r=n(),s=lu(r)||1,o=uu(r),h=a.getPlayerId(),c=(0,wt.default)({},gd.LocalSingleMatchDefault,{level:s,status:"active",playerId:h,challengeMode:o,startedAt:Date.now(),updateAt:Date.now()}),ud({playerId:h,match:c}),e(xd(c)),Be(gd.JourneyMatchStore+"-"+h,c),t.next=22;break;case 14:if(t.prev=14,t.t0=t.catch(0),e(xd(null)),!(t.t0 instanceof Xu)){t.next=19;break}return t.abrupt("return");case 19:if(!(t.t0 instanceof ed)){t.next=21;break}return t.abrupt("return");case 21:(0,Ht.sendException)(t.t0);case 22:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e,n){return t.apply(this,arguments)}}());case 12:e({type:zi,payload:{mode:Zr,contextId:o}}),s.events.emit(is.SceneEvents.SWITCH,is.SceneKeys.JOURNEY_SCENE),t.next=23;break;case 16:if(t.prev=16,t.t0=t.catch(0),!(t.t0 instanceof Xu)){t.next=22;break}return window.game.globalScene.screen.open(vs,{message:"Sorry!, you can now\ncreate this match!",duration:2500,loading:!1}),t.abrupt("return");case 22:(0,Ht.sendException)(t.t0);case 23:return t.prev=23,Ud(0),t.finish(23);case 26:case"end":return t.stop()}}),t,null,[[0,16,23,26]])})));return function(e,n){return t.apply(this,arguments)}}()},ep=function(t,e){return function(){var n=(0,Xt.default)(qt().mark((function n(i,a){var r,s,o,h,c,l,d,p,f,g;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s=window.game.player,o=e.score,h=void 0===o?0:o,c=e.level,l=void 0===c?0:c,d=a(),!u()(r=[Wr,jr]).call(r,t)){n.next=7;break}return p=Ql(d),n.next=7,i(Ad(p));case 7:if(t===Kr&&(i({type:va,payload:{}}),f=s.getPlayerId(),i(Dd(f,e))),t!==Xr){n.next=12;break}return g=eu(d),n.next=12,i(Md(g,h,{level:l}));case 12:i({type:Hi,payload:{mode:t}}),yu.emit(Ec.GAME_OVER);case 14:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}()},np=function(t){return function(e){var n=t.mode,i=t.status;e({type:Wi,payload:{mode:n,status:i}}),(0,Ht.addBreadcrumbSentry)("game-mode",n)}},ip=function(){return function(t,e){var n=e(),i=fu(n).level,a=void 0===i?0:i,r=Ml(n);window.game.analytics.event(ni.AnalyticsEvents.MATCH_RESCUE,{game_mode:GameCore.Utils.String.toUpperCamelCase(r),level:a,level_name:"level_"+a}),t({type:Xi,payload:{}})}},ap=gs.default.DEFAULT,rp=ap.KEY,sp=ap.FRAME,op=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).buttonPlay=void 0,i.buttonShare=void 0,i.avatar=void 0,i.rankIcon=void 0,i.rankText=void 0,i.username=void 0,i.score=void 0,i.scoreText=void 0,i.background=void 0,i.showPopUp=void 0,i.showItems=void 0,i.payload=void 0,i.handleChallengeFriend=function(){var t=i.payload.playerId;i.scene.storage.dispatch(Xd(t))},i.handleShare=function(){i.scene.storage.dispatch(ku())},i.createBackground(),i.updateSize(),i.createAvatar(),i.createRank(),i.createUsername(),i.createScore(),i.createButtonShare(),i.createButtonPlay(),n&&i.updateInfo(n),i.scene.add.existing((0,ls.default)(i)),i}(0,Kt.default)(e,t);var n=e.prototype;return n.updateInfo=function(t){this.payload=(0,wt.default)({scoreRight:!0,isHighlight:!1,useChallenge:!1,backgroundFrame:"",rank:-1},t),this.updateBackground(),this.updateAvatar(),this.updateRank(),this.updateUsername(),this.updateScore(),this.updateButton(),this.alignScoreAndButton()},n.createBackground=function(){this.background=this.scene.make.image({key:rp,frame:sp.LEADERBOARD_BG_ITEM}),this.background.setWorldSize(312,60),this.background.setVisible(!1),this.add(this.background)},n.updateBackground=function(){this.payload.backgroundFrame?(this.background.setVisible(!0),this.background.setFrame(this.payload.backgroundFrame||sp.LEADERBOARD_BG_ITEM),this.background.setWorldSize(312,60)):this.background.setVisible(!1)},n.updateSize=function(){var t=this.background,e=t.width,n=t.height;this.setSize(e,n)},n.createAvatar=function(){this.avatar=new bl(this.scene,{key:rp,frame:sp.AVATAR_BORDER,background:sp.AVATAR_BACKGROUND,width:40,height:40,radius:30,borderWidth:5}),this.add(this.avatar),Phaser.Display.Align.In.LeftCenter(this.avatar,this,-40)},n.updateAvatar=function(){var t=this.payload,e=t.playerId,n=t.photo;this.avatar.loadPhoto(e,n)},n.createRank=function(){this.createRankIcon(1),this.createRankText(1)},n.updateRank=function(){var t=this.payload.rank;if(t<0)return this.rankIcon.setVisible(!1),this.rankText.setVisible(!0),void this.rankText.setText("99+");this.updateRankIcon(t),this.updateRankText(t)},n.getRankIconFrame=function(t){var e=sp.ICON_CUP_GOLD;switch(t){case 1:e=sp.ICON_CUP_GOLD;break;case 2:e=sp.ICON_CUP_SILVER;break;case 3:e=sp.ICON_CUP_COPPER}return e},n.createRankIcon=function(t){var e=this.getRankIconFrame(t);this.rankIcon=this.scene.make.image({key:rp,frame:e}),this.rankIcon.setWorldSize(28,24),this.add(this.rankIcon),Phaser.Display.Align.In.LeftCenter(this.rankIcon,this.background,-6)},n.updateRankIcon=function(t){if(t>3)this.rankIcon.setVisible(!1);else{this.rankIcon.setVisible(!0);var e=this.getRankIconFrame(t);this.rankIcon.setWorldSize(28,24),this.rankIcon.setFrame(e)}},n.createRankText=function(t){this.rankText=this.scene.make.bitmapText({font:Hs.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(32),text:""+t,origin:{x:.5,y:.5}}),this.add(this.rankText),Phaser.Display.Align.In.Center(this.rankText,this.rankIcon,0,1)},n.updateRankText=function(t){t<=3?this.rankText.setVisible(!1):(this.rankText.setVisible(!0),this.rankText.setText(""+t),this.rankText.setFont(Hs.default.NUMBER_DARK.KEY))},n.updateRankUndefined=function(){this.rankIcon.setVisible(!1),this.rankText.setVisible(!0),this.rankText.setText("?"),this.payload.isHighlight?this.rankText.setFont(Hs.default.NUMBER_LIGHT.KEY):this.rankText.setFont(Hs.default.NUMBER_DARK.KEY)},n.getShortName=function(t){var e=t.substring(0,7);return e.split(" ")[0]||e},n.createUsername=function(){this.username=this.scene.make.text({text:this.getShortName("FRIEND NAME"),style:{fontFamily:Hs.default.FONT_FAMILY_ARIAL,fontSize:this.scene.fontSize(40)+"px",fontStyle:"700"}}),this.username.setTint(7485207),this.username.setHighQuality(),Phaser.Display.Align.In.Center(this.username,this.avatar,65,.5),this.add(this.username)},n.updateUsername=function(){var t=this.payload.name;this.username.setText(this.getShortName(t)),this.username.setTint(7551258)},n.createScore=function(){this.score=this.scene.add.container(),this.scoreText=this.scene.make.text({text:"132500",style:{fontFamily:Hs.default.FONT_FAMILY_ARIAL,fontSize:this.scene.fontSize(36)+"px",fontStyle:"500"}}),this.scoreText.setOrigin(.5),this.score.add([this.scoreText]),this.add(this.score),Phaser.Display.Align.In.Center(this.score,this.avatar,160,0)},n.updateScore=function(){var t=this.payload.score;this.scoreText.setText(t),this.scoreText.setTint(7551258)},n.createButtonPlay=function(){this.buttonPlay=new Ys.default(this.scene,rp,sp.BUTTON_CHALLENGE_LIGHT,54,36),this.buttonPlay.setName("ChallengeFriend"),Phaser.Display.Align.In.RightCenter(this.buttonPlay,this,-18,2),this.buttonPlay.onClick=this.handleChallengeFriend,this.add(this.buttonPlay)},n.createButtonShare=function(){this.buttonShare=new Ys.default(this.scene,rp,sp.BUTTON_SHARE_DARK,54,36),this.buttonShare.setName("Share"),Phaser.Display.Align.In.RightCenter(this.buttonShare,this,-18,2),this.buttonShare.onClick=this.handleShare,this.add(this.buttonShare)},n.updateButton=function(){var t=this.payload,e=t.isHighlight;if(!t.useChallenge)return this.buttonShare.setVisible(!1),void this.buttonPlay.setVisible(!1);e?(this.buttonShare.setVisible(!0),this.buttonPlay.setVisible(!1)):(this.buttonShare.setVisible(!1),this.buttonPlay.setVisible(!0))},n.alignScoreAndButton=function(){this.payload.useChallenge?Phaser.Display.Align.In.Center(this.score,this.avatar,150,0):Phaser.Display.Align.In.Center(this.score,this.avatar,200,0)},n.runShowPopUpAnimation=function(t,e){this.scene.tweens.killTweensOf(this),this.showPopUp=new pl({targets:[this],delay:t,duration:e,props:{y:{start:this.y+70,to:this.y}}}),this.showPopUp.play()},n.runShowItemAnimation=function(t,e){var n=this.getAll();this.scene.tweens.killTweensOf(n),this.showItems=new ll({targets:n,duration:e,delay:this.scene.tweens.stagger(50,{start:t+50}),props:{scale:{duration:1e3,getStart:function(t){return.8*t.scale},getEnd:function(t){return t.scale},ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]}}}),this.showItems.play()},n.runShowUpAnimation=function(t,e){void 0===t&&(t=0),void 0===e&&(e=300);var n=100*t;this.runShowPopUpAnimation(n,e),this.runShowItemAnimation(n,e)},n.setFrameBackground=function(t){this.background.setFrame(t)},n.setUserNameLight=function(){this.username.setTint(16640200)},n.setRankLight=function(){this.rankText.setFont(Hs.default.NUMBER_LIGHT.KEY)},n.setScoreLight=function(){this.scoreText.setTint(16640200)},e}(Phaser.GameObjects.Container),hp=op,cp=gs.default.DEFAULT.FRAME,lp=function(t){function e(e){var n;return(n=t.call(this,e)||this).myScoreBlock=void 0,n.scene=e,n.setName("FooterBar"),n.createMyScoreBlock(),n.scene.add.existing((0,ls.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createMyScoreBlock=function(){this.myScoreBlock=new hp(this.scene),this.myScoreBlock.setFrameBackground(cp.LEADERBOARD_BG_ITEM),this.myScoreBlock.setVisible(!1),this.add(this.myScoreBlock),Phaser.Display.Align.In.Center(this.myScoreBlock,this)},n.updateMyScoreBlock=function(t){this.myScoreBlock.setVisible(!0),this.myScoreBlock.updateInfo(t),this.myScoreBlock.setRankLight(),this.myScoreBlock.setScoreLight(),this.myScoreBlock.setUserNameLight(),this.myScoreBlock.runShowUpAnimation(0,1e3)},e}(Phaser.GameObjects.Container),up=lp,dp=n(464),pp=n(465),fp=(function(t){function e(e){var n;return(n=t.call(this,e,"UpdateAbleObject")||this).updateInfo=void 0,n}(0,Kt.default)(e,t)}(Phaser.GameObjects.GameObject),function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).classType=void 0,i.listConfigs=void 0,i.padding=void 0,i.startObjectIndex=void 0,i.endObjectIndex=void 0,i.listObjects=void 0,i.classType=n.classType,i.listConfigs=n.listConfigs,i.padding=n.padding?n.padding:0,i.objects.classType=i.classType,i.updateConfig(i.listConfigs),i}(0,Kt.default)(e,t);var n=e.prototype;return n.reset=function(){t.prototype.reset.call(this),this.killAndHideAll()},n.getChildren=function(){var t;return c()(t=this.listObjects).call(t,(function(t){return void 0!=t&&t.active}))},n.updateConfig=function(t){var e;this.reset(),this.listConfigs=t,this.listObjects=A()(e=new Array(t.length)).call(e,void 0),this.addObjectIndex(0,0);var n=this.getEndObjectIndex();this.addObjectIndex(1,n),this.startObjectIndex=this.getStartObjectIndex(),this.endObjectIndex=this.getEndObjectIndex(),this.updateMaxHeight(),this.value=this.marginTop},n.killAndHideAll=function(){var t,e=this;this.listObjects instanceof Array&&De()(t=this.listObjects).call(t,(function(t){void 0!==t&&e.objects.killAndHide(t)}))},n.setItemPosition=function(t,e){var n=t.height;t.setPosition(0,n/2+(n+this.padding)*e-this.height/2)},n.updateMaxHeight=function(){return this.maxHeight=Math.max(this.listConfigs.length*(this.objHeight+this.padding)-this.padding+this.marginBottom-this.height,0)},n.updateObject=function(t){this.objects.incY(t);var e=this.getStartObjectIndex(),n=this.getEndObjectIndex();e!=this.startObjectIndex&&(e>this.startObjectIndex?this.killObjectIndex(this.startObjectIndex,e-1):this.addObjectIndex(e,this.startObjectIndex-1),this.startObjectIndex=e),n!=this.endObjectIndex&&(n<this.endObjectIndex?this.killObjectIndex(n+1,this.endObjectIndex):this.addObjectIndex(this.endObjectIndex+1,n),this.endObjectIndex=n)},n.killObjectIndex=function(t,e){for(var n=t;n<=e;n++){var i=this.listObjects[n];i&&(this.objects.killAndHide(i),this.listObjects[n]=void 0)}},n.addObjectIndex=function(t,e){for(var n=t;n<=e;n++){var i=this.padding,a=this.listConfigs;if(n>=a.length)return;var r=this.objects.getFirstDead(!0),s=r.height,o=s/2+(s+i)*n+this.value-this.height/2;r.updateInfo(a[n]),r.setPosition(0,o),r.setActive(!0),r.setVisible(!0),this.addAt(r),this.listObjects[n]=r}},n.getStartObjectIndex=function(){var t=this.objHeight,e=this.padding;return Math.max(Math.floor((0-this.value)/(t+e)),0)},n.getEndObjectIndex=function(){var t=this.objHeight,e=this.padding,n=this.listConfigs,i=t+e;return Math.min(Math.floor((this.height-this.value)/i),n.length)},(0,Se.default)(e,[{key:"objHeight",get:function(){var t=this.objects.getChildren();return 0==t.length?this.maxHeight=0:t[0].height}}]),e}(pp.default));function gp(t,e){var n="undefined"!==typeof Cc()&&Ic()(t)||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){var n;if(!t)return;if("string"===typeof t)return mp(t,e);var i=s()(n=Object.prototype.toString.call(t)).call(n,8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return a()(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return mp(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function mp(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}for(var vp=gs.default.DEFAULT.FRAME,yp=function(t){function e(e,n,i){var a;(a=t.call(this,e)||this).currentPlayerId=void 0,a.scroller=void 0;var r=a.scene.player;return a.currentPlayerId=r.getPlayerId(),a.createReuseScroller(n,i),a.scene.add.existing((0,ls.default)(a)),a}(0,Kt.default)(e,t);var n=e.prototype;return n.createReuseScroller=function(t,e){this.scroller=new fp(this.scene,{classType:hp,listConfigs:[],width:t,height:e,padding:0,marginTop:0,marginBottom:0}),this.scene.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer&&this.scroller.createBound(gs.default.DEFAULT.KEY,gs.default.DEFAULT.FRAME.BLANK,40,16643027),this.scroller.createMask(),this.scroller.setPosition(0,0),this.add(this.scroller)},n.updateData=function(t,e){var n=Ba()(t)||[];if(!(n.length<1)){for(var i,a=[],r=0,s=gp(Na()(n).call(n,(function(t,e){return+e.score-+t.score})));!(i=s()).done;){var o=i.value,h=o.playerId,c=o.photo,l=o.score,u=o.name,d=o.rank;if(h){this.currentPlayerId;var p={playerId:h,photo:c,name:u,rank:d,score:l,scoreRight:e===Oc,useChallenge:e===_c,isHighlight:!1,backgroundFrame:""+vp.PREFIX_LEADERBOARD_BG_ITEM+r};a.push(p),++r>=2&&(r=0)}}this.scroller.updateConfig(a),this.showLeaders()}},n.removeLeaders=function(){this.scroller.updateConfig([])},n.getLeaders=function(){return this.scroller.getChildren()},n.showLeaders=function(){var t=this,e=this.getLeaders();if(!(e.length<1)){for(var n=Math.min(e.length,6),i=0;i<n;i++){var a=e[i];a&&(a.setVisible(!0),a.runShowUpAnimation(i,300))}var r=300+100*n+250;this.scene.time.delayedCall(r,(function(){t.scroller.setEnable(!0)}))}},e}(Phaser.GameObjects.Container),Sp=yp,Ap=gs.default.DEFAULT,Ep=Ap.KEY,xp=Ap.FRAME,bp=function(t){function e(e){var n;return(n=t.call(this,e)||this).leaders=void 0,n.loading=void 0,n.message=void 0,n.messageAnimation=void 0,n.setSize(310,430),n.createLoading(),n.createMessage(),n.createContents(),n.createAnimation(),n.scene.add.existing((0,ls.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.showLoading=function(t){this.loading.setVisible(t),this.showMessage(!1)},n.showMessage=function(t,e){this.message.setVisible(t),e&&(this.message.setText(e),this.messageAnimation.play())},n.createLoading=function(){this.loading=new El(this.scene),this.loading.setVisible(!1),this.add(this.loading)},n.createMessage=function(){this.message=this.scene.make.bitmapText({font:Hs.default.PRIMARY.KEY,size:this.scene.fontSize(40),origin:{x:.5,y:.5}}),this.message.setTint(10317116),this.add(this.message),Phaser.Display.Align.In.Center(this.message,this)},n.createContents=function(){this.createLeaders(),this.createContentBackground()},n.createLeaders=function(){this.leaders=new Sp(this.scene,310,337),this.add(this.leaders),Phaser.Display.Align.In.Center(this.leaders,this,0,-11)},n.createContentBackground=function(){var t=this.scene.make.container({}),e=this.scene.make.image({key:Ep,frame:xp.LEADERBOARD_BG_BOTTOM});e.setFlipY(!0),e.setWorldSize(315,22);var n=this.scene.make.image({key:Ep,frame:xp.LEADERBOARD_BG_MIDDLE});n.setWorldSize(315,300);var i=this.scene.make.image({key:Ep,frame:xp.LEADERBOARD_BG_BOTTOM});i.setWorldSize(315,22),t.add(e),t.add(n),t.add(i),Phaser.Display.Align.In.Center(n,t),Phaser.Display.Align.In.Center(e,n,0,-n.displayHeight/2-e.displayHeight/2),Phaser.Display.Align.In.Center(i,n,0,n.displayHeight/2+i.displayHeight/2),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-10)},n.createAnimation=function(){this.messageAnimation=new dp.default({targets:[this.message],duration:60,repeat:2})},e}(Phaser.GameObjects.Container),Tp=bp,wp=GameCore.Configs.LeadersBoard,Cp=gs.default.DEFAULT,Mp=Cp.KEY,Ip=Cp.FRAME,Pp=function(t){function e(e,n,i,a){var r;return(r=t.call(this,e,n,i,a)||this).popup=void 0,r.popupShowUpAnimation=void 0,r.popupFadeOutAnimation=void 0,r.popupFadeInMaskAnimation=void 0,r.popupFadeOutMaskAnimation=void 0,r.board=void 0,r.footerBar=void 0,r.isRequesting=void 0,r.isSwitchable=void 0,r.tabId=void 0,r.offset=void 0,r.isStateChanged=void 0,r.open=function(e){t.prototype.open.call((0,ls.default)(r),e),r.setVisible(!0),r.selectWorldTab(),r.runOpenAnimation(),r.board.showLoading(!0);var n=[{selector:Rc,callback:function(t){if(r.isRequesting=t,r.board.showLoading(t),!1===t){if(!r.scene)return;if(!r.visible||!r.scene.scene.isActive)return;var e=r.scene.game.storage.getState(),n=kc(e);r.isSwitchable=!0,n&&0!==Y()(n).length?r.board.leaders.updateData(n,r.tabId):r.board.showMessage(!0,"\u0422\u0430\u0431\u043b\u0438\u0446\u0430 \u0440\u0435\u043a\u043e\u0440\u0434\u043e\u0432 \u043f\u0443\u0441\u0442\u0430!"),r.updatePlayerEntryAsync().catch(Ht.sendException)}}}];r.handleStateChange(n)},r.handleSelectFriendTab=function(){r.isRequesting||r.isSwitchable&&r.selectFriendTab()},r.handleSelectWorldTab=function(){r.isRequesting||r.isSwitchable&&r.selectWorldTab()},r.clickClose=function(){r.runCloseAnimation()},r.setVisible(!1),r.createPopup(),r.createTitle(),r.createBoard(),r.createFooterBar(),r.setDepth(Gs),r.background.setAlpha(.5),r}(0,Kt.default)(e,t);var n=e.prototype;return n.handleStateChange=function(t){var e=this;this.isStateChanged||(t.forEach((function(t){var n=t.selector,i=t.callback;e.scene.storage.watch(n,i)})),this.isStateChanged=!0)},n.createPopup=function(){this.popup=new uo(this.scene,0,-5,340,510,{forceHeightTop:60}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,-2)},n.createTitle=function(){var t=this.scene.add.container(),e=this.scene.make.image({key:Mp,frame:Ip.TEXT_LEADER_BOARD});e.setWorldSize(260,25);var n=new Ys.default(this.scene,Mp,Ip.BUTTON_CLOSE,35,35);n.setName("Close"),n.onClick=this.clickClose,t.add([e,n]),Phaser.Display.Align.In.Center(e,t,0,9),Phaser.Display.Align.In.Center(n,t,160,-15),this.popup.add(t),Phaser.Display.Align.In.TopCenter(t,this.popup)},n.createBoard=function(){this.board=new Tp(this.scene),this.popup.add(this.board),Phaser.Display.Align.In.Center(this.board,this.popup,0,-25)},n.createFooterBar=function(){this.footerBar=new up(this.scene),this.popup.add(this.footerBar),Phaser.Display.Align.In.Center(this.footerBar,this.popup,0,178)},n.selectFriendTab=function(){this.tabId=_c,this.offset=0,this.board.showLoading(!0),this.board.leaders.removeLeaders(),this.scene.storage.dispatch(ol()),this.scene.storage.dispatch(rl(wp.LeaderboardId,_c,wp.Limit,this.offset))},n.selectWorldTab=function(){this.tabId=Oc,this.offset=0,this.board.showLoading(!0),this.board.leaders.removeLeaders(),this.footerBar.myScoreBlock.setVisible(!1),this.scene.storage.dispatch(ol()),this.scene.storage.dispatch(rl(wp.LeaderboardId,Oc,wp.Limit,this.offset))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupExitsAnimation=function(t,e){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new $s({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){i.popup.setY(0),i.board.showLoading(!1),i.close()}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.runOpenAnimation=function(){this.scene.audio.playSound(Vs.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300)},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new so({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.updatePlayerEntryAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n,i,a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.scene.player.getPlayerId(),n=this.scene.player.getPlayer(),i=null,t.prev=3,t.next=6,Zc(e);case 6:i=t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3),i=null;case 12:a={playerId:e,name:n.name,photo:n.photo,score:""+n.data.score,rank:-1},i&&(a={playerId:e,name:n.name,photo:n.photo,score:""+i.getScore(),rank:i.getRank()}),this.footerBar.updateMyScoreBlock({playerId:a.playerId,rank:a.rank,photo:a.photo,name:a.name,score:a.score,backgroundFrame:Ip.LEADERBOARD_BG_ITEM,isHighlight:!0});case 15:case"end":return t.stop()}}),t,this,[[3,9]])})));return function(){return t.apply(this,arguments)}}(),n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Tc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new $s({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),kp=Pp,Rp=n(147),Op={LOGO:{KEY:"spine-logo",JSON:"./assets/spine/logo/logo.json",ATLAS:"./assets/spine/logo/logo.atlas",ANIMATIONS:{START_GROW:"start_grow",IDLE_GROW:"idle_grow"}},BEST_SCORE:{KEY:"best-score",JSON:"./assets/spine/best-score/newbest-trim.json",ATLAS:"./assets/spine/best-score/newbest-trim.atlas",ANIMATIONS:{ANIM:"anim5"}}},_p=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.bestScoreSpine=void 0,n.scene=e,e.add.existing((0,ls.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createSpineEffect=function(){var t=this,e=this.scene.world.getPixelRatio(),n=this.scene.gameZone,i=n.width,a=n.height/2;this.bestScoreSpine=this.scene.add.spine(-i/2,a,Op.BEST_SCORE.KEY,Op.BEST_SCORE.ANIMATIONS.ANIM),this.bestScoreSpine.preMultipliedAlpha=!0,this.bestScoreSpine.scale=1/e,this.add(this.bestScoreSpine),this.bestScoreSpine.on("complete",(function(){t.bestScoreSpine.setVisible(!1)}))},n.playEffect=function(){this.bestScoreSpine?(this.bestScoreSpine.setVisible(!0),this.bestScoreSpine.play(Op.BEST_SCORE.ANIMATIONS.ANIM)):this.createSpineEffect()},e}(Phaser.GameObjects.Container),Dp=n(551),Lp=n.n(Dp),Bp=GameCore.Configs,Fp=Bp.Gameplay,Np=Bp.Match.Levels,Gp=function(){function t(){this.levelIndex=0,this.levels=Np,this.recentLevel=void 0}var e=t.prototype;return e.increaseLevel=function(){this.levelIndex++},e.getCurrentTargetScore=function(){return this.levels[this.levelIndex]},e.getNextTargetScoreLevel=function(){return this.levels[this.levelIndex+1]},e.getCurrentIndex=function(){return this.levelIndex},e.updateCurrentLevelByScore=function(t){var e,n=Lp()(e=this.levels).call(e,(function(e){return e>t}));if(-1===n)return this.handleAutoGrantNewLevel(t);this.levelIndex=n;var i=this.levels[n-1];return i&&(this.recentLevel=i),this.levels[n]},e.restart=function(){this.levelIndex=0,this.recentLevel=0},e.handleAutoGrantNewLevel=function(t){var e=Fp.Progress.BonusScore,n=this.levels[this.levels.length-1]+e;return this.levels.push(n),n<=t?this.handleAutoGrantNewLevel(t):(this.levelIndex=this.levels.length-1,this.recentLevel=this.levels[this.levelIndex],n)},t}(),Up=n(247),Vp=function(){var t,e=window.game.facebook;return e?(null==(t=e.platform)?void 0:t.toLowerCase())||"":null},Yp=function(){return"web"==Vp()},zp=Math.sin,Hp=Math.cos,Wp=function(t,e,n){return t*Hp(e)*n},Xp=function(t,e,n,i){return void 0===i&&(i=10),t*zp(e)*n-.5*i*Math.pow(n,2)},Kp=gs.default.GAMEPLAY_32,jp=Kp.KEY,qp=Kp.FRAME,Zp=function(t){function e(e,n){var i;return(i=t.call(this,e,n.x+(n.padding||0),n.y+(n.padding||0),jp,qp.GEM)||this).scene=void 0,i.canCapture={direction:"bottom",angle:0},i.status=void 0,i.rateShaking=1,i.t0=0,i.x0=void 0,i.y0=void 0,i.v0=void 0,i.alpha0=void 0,i.scale0=void 0,i.maxScale0=void 0,i.scaleRate0=void 0,i.imageBreak=void 0,i.imageGameOver=void 0,i.imageGameStart=void 0,i.tweenImageGameOver=void 0,i.imageHighlight=void 0,i.tweenImageHighlight=void 0,i.tweenScaleDown=void 0,i.tweenAlphaImageBreak=void 0,i.tweenStartMission=void 0,i.setWorldSize(n.width,n.height),i.x0=n.x+(n.padding||0),i.y0=n.y+(n.padding||0),i.scale0=i.scale,i.scene=e,i.createImageGameStart(),i.createImageBreak(),i.createImageGameOver(),i.createTweenImageGameOver(),i.createImageHighlight(),i.createTweenImageGHighlight(),i.createTweenScaleDown(),i.createTweenAlphaImageBreak(),i.createTweenStartMission(),e.add.existing((0,ls.default)(i)),i}(0,Kt.default)(e,t);var n=e.prototype;return n.createImageBreak=function(){this.imageBreak=this.scene.make.image({key:jp,frame:qp.GEM_WHITE}),this.imageBreak.setVisible(!1),this.imageBreak.setScale(this.scale0),this.imageBreak.setPosition(this.x,this.y)},n.createImageGameStart=function(){this.imageGameStart=this.scene.make.image({key:jp,frame:qp.GEM_GLARE}),this.imageGameStart.setDepth(this.depth+1),this.imageGameStart.setVisible(!1),this.imageGameStart.setScale(this.scale0),this.imageGameStart.setPosition(this.x,this.y)},n.createImageGameOver=function(){this.imageGameOver=this.scene.make.image({key:jp,frame:qp.GEM_SILVER}),this.imageGameOver.setDepth(this.depth+1),this.imageGameOver.setVisible(!1),this.imageGameOver.setScale(this.scale0),this.imageGameOver.setPosition(this.x,this.y)},n.createTweenImageGameOver=function(){this.tweenImageGameOver=this.scene.add.tween({targets:[this.imageGameOver],duration:1200,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:0,to:1,start:0},paused:!0})},n.createImageHighlight=function(){this.imageHighlight=this.scene.make.image({key:jp,frame:qp.GEM_LIGHT}),this.imageHighlight.setDepth(this.depth+1),this.imageHighlight.setVisible(!1),this.imageHighlight.setScale(this.scale0),this.imageHighlight.setPosition(this.x,this.y)},n.createTweenImageGHighlight=function(){this.tweenImageHighlight=this.scene.add.tween({targets:[this.imageHighlight],duration:100,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:0,to:1,start:0},paused:!0})},n.createTweenStartMission=function(){this.tweenStartMission=this.scene.add.tween({targets:[this.imageGameStart],duration:200,ease:Phaser.Math.Easing.Quadratic.InOut,scale:{from:0,to:this.scale0,start:0},alpha:{from:0,to:1,start:0},yoyo:!0,paused:!0})},n.createTweenScaleDown=function(){var t=this.imageBreak.scale;this.tweenScaleDown=this.scene.add.tween({delay:100,targets:[this.imageBreak],duration:600,ease:Phaser.Math.Easing.Quadratic.InOut,scale:{from:t,to:0,start:t},paused:!0})},n.createTweenAlphaImageBreak=function(){this.tweenAlphaImageBreak=this.scene.add.tween({targets:[this.imageBreak],duration:150,ease:Phaser.Math.Easing.Sine.InOut,alpha:{from:.2,to:.68},paused:!0})},n.showImageHighlight=function(){this.imageHighlight.setVisible(!0).setAlpha(1)},n.hideImageHighlight=function(){this.imageHighlight.setVisible(!1)},n.isHighlight=function(){return this.imageHighlight.visible},n.isShaking=function(){return"SHAKING"===this.status},n.playAnimShaking=function(){this.status="SHAKING"},n.playTweenBreaking=function(){this.status="BREAKING"},n.setRateShaking=function(t){this.rateShaking=t},n.stopAnimShaking=function(){this.rotation=0,this.status=""},n.reset=function(){this.x=this.x0,this.y=this.y0,this.rotation=0,this.scale=this.scale0,this.alpha=1},n.resetImageBreak=function(){this.imageBreak.x=this.x0,this.imageBreak.y=this.y0,this.imageBreak.rotation=0,this.imageBreak.scale=this.scale0,this.imageBreak.setVisible(!1)},n.resetImageGameOver=function(){this.imageGameOver.x=this.x0,this.imageGameOver.y=this.y0,this.imageGameOver.setVisible(!1)},n.playAnimImageGameOver=function(){this.resetImageGameOver(),this.imageGameOver.setVisible(!0).setAlpha(0),this.tweenImageGameOver.play()},n.playTweenScaleDown=function(){this.resetImageBreak(),this.imageBreak.setVisible(!0).setScale(this.scale0).setAlpha(0),this.tweenAlphaImageBreak.play(),this.tweenScaleDown.play()},n.playTweenStartMission=function(){this.imageGameStart.setVisible(!0).setAlpha(0),this.tweenStartMission.play()},n.preUpdate=function(){if("SHAKING"===this.status)this.rotation+=.015*this.rateShaking,this.rotation>.1&&(this.rateShaking=-1),this.rotation<-.1&&(this.rateShaking=1)},n.handleTweenBreaking=function(){var t=this.alpha0<90?1:-1;this.t0+=3e3/1900;var e=.016*this.t0,n=Wp(this.v0,this.alpha0,e),i=Xp(this.v0,this.alpha0,e);this.imageBreak.x=this.x0+n,this.imageBreak.y=this.y0-i,this.imageBreak.rotation+=.04*t,this.imageBreak.scale>.4?this.imageBreak.scale-=this.scale0:this.imageBreak.scale=.4;var a=this.scene.gameZone,r=a.width,s=a.height;(this.imageBreak.x-this.imageBreak.displayWidth/2<0||this.imageBreak.x+this.imageBreak.displayWidth/2>r||this.imageBreak.y-this.imageBreak.displayHeight/2>s)&&(this.status="")},e}(Phaser.GameObjects.Image),Jp=Zp,Qp=n(86),$p=n.n(Qp),tf=GameCore.Configs.Board,ef=(tf.cols,tf.rows),nf=void 0===ef?8:ef,af=0,rf=function(){return af},sf=function(t,e){af=0;for(var n=[],i=t.length,a=t[0].length,r=[],s=[],o=function(e){for(var i=!0,s=0;s<a;s++)0===t[e][s].value&&(i=!1);if(i){r.push(e);for(var o=function(t){n.some((function(n){return n.x===t&&n.y===e}))||n.push({x:t,y:e})},h=0;h<a;h++)o(h)}},h=0;h<i;h++)o(h);for(var c=function(e){for(var a=!0,r=0;r<i;r++)0===t[r][e].value&&(a=!1);if(a){s.push(e);for(var o=function(t){n.some((function(n){return n.x===e&&n.y===t}))||n.push({x:e,y:t})},h=0;h<i;h++)o(h)}},l=0;l<a;l++)c(l);var u=cf(t,e);if(u&&u.length>0)for(var d=function(t){var e=u[t],i=e.x,a=e.y;n.some((function(t){return t.x===i&&t.y===a}))||n.push({x:i,y:a})},p=0;p<u.length;p++)d(p);return af+=r.length,af+=s.length,af+=Math.floor(u.length/9),n},of=function(t,e){if(0===t.length)return!1;var n=c()(t).call(t,(function(t){return t.x===e.x&&t.y===e.y}));return!(!n||n.length<=0)},hf=function(t,e){for(var n=e.x,i=e.y,a=[],r=n;r<n+3;r++)for(var s=i;s<i+3;s++){if(0===t[s][r].value)return[];a.push({x:r,y:s})}return a},cf=function(t,e){for(var n=[],i=function(t){for(var e,n=[],i=0;i<t.length;i++){var a=(e=t[i],{x:3*Math.floor(e.x/3),y:3*Math.floor(e.y/3)});of(n,a)||n.push(a)}return n}(e),a=0;a<i.length;a++){var r=i[a],s=hf(t,r);n.push.apply(n,s)}return n},lf=function(t){for(var e=t.length,n=t[0].length,i=[],a=0;a<e;a++){for(var r=!0,s=0;s<n;s++)0===t[a][s].value&&(r=!1);r&&i.push(a)}return i},uf=function(t){for(var e=t.length,n=t[0].length,i=[],a=0;a<n;a++){for(var r=!0,s=0;s<e;s++)0===t[s][a].value&&(r=!1);r&&i.push(a)}return i},df=function(t,e){var n=t.length,i=t[0].length;if(0===e.length)return!1;for(var a=0;a<n;a++)for(var r=0;r<i;r++)for(var s=0;s<e.length;s++)if(pf(t,r,a,e[s]))return!1;return!0},pf=function(t,e,n,i){for(var a=!0,r=0;r<i.data.length;r++)for(var s=0;s<i.data[r].length;s++)i.data[r][s].texture&&(t[n+r]&&t[n+r][e+s]&&0===t[n+r][e+s].value||(a=!1));return a},ff=function(t,e){for(var n=t.length,i=t[0].length,a=0;a<n;a++)for(var r=0;r<i;r++)if(pf(t,r,a,e))return!0;return!1},gf=0,mf=function(){return gf++,18+10*(vf()-1)},vf=function(){return gf+1},yf=function(t){var e=t;switch(t){case Ro:e="b";break;case Oo:e="c";break;case _o:e="d";break;case Do:e="g";break;case Lo:e="o";break;case Bo:e="p";break;case Fo:e="q";break;case No:e="r";break;case Go:e="y";break;case Yo:e="l";break;case zo:e="l1";break;case Ho:e="l3";break;case Wo:e="e2";break;case Xo:e="e3";break;case Ko:e="e4";break;case jo:e="e5";break;case qo:e="s1";break;case Zo:e="s2";break;case Jo:e="s3";break;case Qo:e="tz";break;case $o:e="ta";break;case wo:e="dt";break;case bo:e="dl";break;case To:e="dr";break;case Co:e="db";break;case Eo:e="v";break;case xo:e="h";break;case Mo:e="vl";break;case Io:e="vr";break;case Po:e="hl";break;case ko:e="hr"}return e},Sf=function(t){var e=t;switch(t){case"b":e=Ro;break;case"c":e=Oo;break;case"d":e=_o;break;case"g":e=Do;break;case"o":e=Lo;break;case"p":e=Bo;break;case"q":e=Fo;break;case"r":e=No;break;case"y":e=Go;break;case"l":e=Yo;break;case"l1":e=zo;break;case"l3":e=Ho;break;case"e2":e=Wo;break;case"e3":e=Xo;break;case"e4":e=Ko;break;case"e5":e=jo;break;case"s1":e=qo;break;case"s2":e=Zo;break;case"s3":e=Jo;break;case"tz":e=Qo;break;case"ta":e=$o;break;case"dt":e=wo;break;case"dl":e=bo;break;case"dr":e=To;break;case"db":e=Co;break;case"v":e=Eo;break;case"h":e=xo;break;case"vl":e=Mo;break;case"vr":e=Io;break;case"hl":e=Po;break;case"hr":e=ko}return e},Af=function(t){for(var e=[],n="12345678x",i=t.split(""),a=0;a<i.length;a++)if(g()(n).call(n,i[a])>=0)for(var r="x"===i[a]?nf:Number(i[a]),s=0;s<r;s++)e.push({value:0,frame:"gem/gem_transparent"});else e.push({value:1,frame:Sf(i[a])});return e},Ef=function(t){var e=t.split(","),n=e[0].split("-");if(n.length<=0)throw new Error("Invalid piece");return{type:Sf(n[0]),direction:Sf(n[1])||null,isReverse:n[2]&&"r"===n[2]||!1,frame:Sf(e[1])}},xf=gs.default.GAMEPLAY_32,bf=xf.KEY,Tf=xf.FRAME,wf=GameCore.Configs.Board,Cf=wf.cols,Mf=wf.rows,If=function(t){function e(n,i,a){var r;return(r=t.call(this,n)||this).scene=void 0,r.type=void 0,r.direction=void 0,r.isReverse=!1,r.data=[],r.matrixData=void 0,r.texture=void 0,r.frame=void 0,r.maxHeight=void 0,r.cellItems=[],r.originalData=void 0,r.isSetDrag=!1,r.isCreateCell=!1,r.wrap=void 0,r.wrapPiece=void 0,r.isDragEnd=!1,r.isActive=!0,r.isVisible=!0,r.pointerY=void 0,r.parentHeight=void 0,r.index=void 0,r.props=void 0,r.cells=[],r.parent=void 0,r.moveTopNumber=30,r.backupPx=void 0,r.backupPy=void 0,r.animMoveTopAndScaleUp=void 0,r.animMoveDownAndScaleDown=void 0,r.animScaleUp=void 0,r.animScaleDown=void 0,r.distancePY=void 0,r.isCanMove=void 0,r.correctAlpha=1,r.props=a,r.type=a.type,r.matrixData=a.matrixData,r.data=e.buildData(r.matrixData),r.direction=a.direction||null,r.parentHeight=a.parentHeight||0,r.isReverse=a.isReverse||!1,r.parent=i,r.scene=n,r.scene.add.existing((0,ls.default)(r)),r.createWrapPiece(),r.listenEvents(),r}(0,Kt.default)(e,t);var n=e.prototype;return n.createWrapPiece=function(){var t=this.scene.gameZone.width/3;this.wrapPiece=this.scene.make.image({key:bf,frame:Tf.GEM_TRANSPARENT}),this.wrapPiece.setWorldSize(t,t)},n.updatePosition=function(t,e){var n=this.getContainerSize(),i=n.width,a=n.height,r=this.parent.cellSize,s=this.scene.gameZone.width;this.setPosition(t+s/6-i/2+r/2,e-a/2+r/2),this.backupPx=this.x,this.backupPy=this.y},n.updatePositionWrapPiece=function(t,e){this.wrapPiece.setPosition(t+this.wrapPiece.displayWidth/2,e-20)},n.listenEvents=function(){var t=this;this.setInteractiveContainer(),this.wrapPiece.on(Phaser.Input.Events.POINTER_DOWN,(function(){t.parent.playTweenToEnableMaxFps()})),this.wrapPiece.on(Phaser.Input.Events.DRAG_START,(function(e){t.handleDragStart(e)})),this.wrapPiece.on(Phaser.Input.Events.DRAG,(function(e){t.handleDrag(e)})),this.wrapPiece.on(Phaser.Input.Events.DRAG_END,(function(){t.handleDragEnd(),t.parent.stopTweenToEnableMaxFps()}))},n.setIndex=function(t){this.index=t},n.setInteractiveContainer=function(){var t=this.scene.gameZone.width/3;this.wrapPiece.setInteractive().input.hitArea.setTo(0,0,t/this.wrapPiece.scale,180/this.wrapPiece.scale),this.scene.input.setDraggable(this.wrapPiece)},n.handleDragStart=function(t){var e,n,i=this;if(!this.scene.isGameOver&&this.isCanMove){null==(e=this.animScaleUp)||e.stop(),null==(n=this.animScaleDown)||n.stop(),this.setAlpha(this.correctAlpha).setScale(1).setPosition(this.x,this.y),this.isDragEnd=!1,this.isSetDrag=!0,this.setDepth(zs.default.PIECE+1),this.animMoveDownAndScaleDown&&this.animMoveDownAndScaleDown.isPlaying()&&(this.animMoveDownAndScaleDown.stop(),this.setScale(1)),this.scene.tutorialManager.isRunning()&&this.scene.tutorialManager.dragStart(),this.scene.audio.playSound(Vs.default.PIECE_PICK);var a=this.scene.main.board.cellSize/this.parent.cellSize,r=this.getContainerSize(),s=r.width,o=r.height,h=t.worldX+this.parent.cellSize*a/2-s*a/2,c=0;if(Yp())c=t.worldY+this.parent.cellSize*a/2-o*a;else{var l=this.scene.gameZone.height/2+this.scene.main.board.width/2-2*this.parent.cellSize+this.moveTopNumber,u=this.y+o*a-l+o;u=this.scene.gameZone.width/this.scene.gameZone.height>=375/619?44+o*a:53+o*a,c=t.worldY-u}this.distancePY=t.worldY-c;var d=41*this.scene.main.board.cellPadding/100;this.updateCellsWithPadding(d),this.animMoveTopAndScaleUp=this.scene.tweens.add({x:h,y:c,scale:a,duration:150,targets:this,ease:"Sine.easeInOut",delay:20,onComplete:function(){if(!i.isDragEnd){i.setPosition(h,c);var t=i.getCellsHighlight();i.scene.main.board.handleRemoveHighlight(),i.scene.main.board.handleHighlight(t,i.highlightCellCanCapture.bind(i))}}}),this.drawSuggestCells()}},n.handleDrag=function(t){if(!this.scene.isGameOver&&this.isCanMove&&this.isSetDrag)try{if(this.animMoveTopAndScaleUp&&this.animMoveTopAndScaleUp.isPlaying()){var e=this.scene.main.board.cellSize/this.parent.cellSize;this.animMoveTopAndScaleUp.complete(),this.animMoveTopAndScaleUp.stop(),this.setScale(e)}this.resetCellItems(),this.scene.game.updateFps(Up.default.max);var n=this.getContainerSize().width,i=t.worldX+this.parent.cellSize*this.scale/2-n/2,a=t.worldY-this.distancePY;this.setPosition(i,a),this.canMove();var r=this.getCellsHighlight();this.scene.main.board.handleRemoveHighlight(),this.scene.main.board.handleHighlight(r,this.highlightCellCanCapture.bind(this))}catch(s){this.handleDragPieceInvalidMove()}},n.highlightCellCanCapture=function(t,e,n,i){for(var a=this,r=Cf,s=Mf,o=[],h=0;h<i.length;h++){var l=i[h],u=l.x,d=l.y;r>u&&(r=u),s>d&&(s=d)}for(var p=function(e){var n=t[e],r=c()(i).call(i,(function(t){return t.y===n}));if(!r||0===r.length)return"continue";for(var s=0;s<r.length;s++){var h=r[s];a.checkItemInArray(o,h)||o.push(h)}},f=0;f<t.length;f++)p(f);for(var g=function(t){var n=e[t],r=c()(i).call(i,(function(t){return t.x===n}));if(!r||0===r.length)return"continue";for(var s=0;s<r.length;s++){var h=r[s];a.checkItemInArray(o,h)||o.push(h)}},m=0;m<e.length;m++)g(m);for(var v=function(t){var e=n[t],r=c()(i).call(i,(function(t){return t.x===e.x&&t.y===e.y}));if(!r||0===r.length)return"continue";var s=r[0];a.checkItemInArray(o,s)||o.push(s)},y=0;y<n.length;y++)v(y);for(var S=function(t){var e,n=o[t],i=n.x,h=n.y,l=c()(e=a.cellItems).call(e,(function(t){return t.x===i-r&&t.y===h-s}));if(!l||0===l.length)return"continue";l[0].cell.setFrame(Tf.GEM_LIGHT)},A=0;A<o.length;A++)S(A)},n.resetCellItems=function(){for(var t=0;t<this.cellItems.length;t++)this.cellItems[t].cell.setFrame(Tf.GEM)},n.checkItemInArray=function(t,e){var n=c()(t).call(t,(function(t){return t.x===e.x&&t.y===e.y}));return!(!n||0===n.length)},n.handleDragPieceInvalidMove=function(){this.scene.main.board.handleRemoveHighlight(),this.scene.main.board.removeAllCanCaptureCells()},n.handleDragEnd=function(){if(!this.isDragEnd&&this.isSetDrag&&this.isCanMove){this.isDragEnd=!0,this.isSetDrag=!1,this.setDepth(zs.default.PIECE),this.scene.main.board.handleRemoveSuggestMove(),this.scene.main.board.removeAllCanCaptureCells(),this.resetCellItems();try{this.canMove(),this.scene.audio.playSound(Vs.default.PIECE_DROP),this.handleBoardMoveCompleted(),this.wrapPiece.disableInteractive()}catch(t){this.handleInvalidMove()}}},n.cancelDrag=function(){!this.isDragEnd&&this.isSetDrag&&(this.isDragEnd=!0,this.isSetDrag=!1,this.setDepth(zs.default.PIECE),this.scene.main.board.handleRemoveSuggestMove(),this.scene.main.board.removeAllCanCaptureCells(),this.resetCellItems(),this.scene.main.board.handleRemoveHighlight(),this.handleInvalidMove())},n.calculatePY=function(t,e){return 15==t?this.parent.cellSize*e*-2:30==t?0:45==t?this.parent.cellSize*e*2:60==t?this.parent.cellSize*e*4:75==t?this.parent.cellSize*e*6:t},n.handleBoardMoveCompleted=function(){var t=this,e=this.getPositionTopLeftInBoard();if(e){var n=this.calcScore();this.scene.tutorialManager.isRunning()||(this.scene.handleUpdateScore(n||0),this.scene.handleAddScoreAnim(n||0));var i=e.x,a=e.y,r=this.scene.main.board.dataBoard[a][i],s=r.x+this.scene.main.board.cellPadding,o=r.y+this.scene.main.board.cellPadding,h=this.getCellsHighlight();this.scene.add.tween({targets:this,x:s,y:o,duration:50,onComplete:function(){t.updateCellsWithPadding(.5),t.scene.main.board.handleRemoveHighlight(),t.hide(),t.setScale(1),t.parent.removeActivePiece(t.index),t.scene.main.board.handleMove(h,t.onBoardHandleMoveCompleted.bind(t))}})}else this.scene.main.board.handleRemoveHighlight()},n.calcScore=function(){var t;if(!this.matrixData)return 0;var e=this.matrixData.length||0;if(0===e)return 0;for(var n=(null==(t=this.matrixData[0])?void 0:t.length)||0,i=0,a=0;a<e;a++)for(var r=0;r<n;r++)1===this.matrixData[a][r]&&i++;return i},n.hide=function(){this.setVisible(!1),this.wrapPiece.setVisible(!1)},n.show=function(){this.setVisible(!0),this.wrapPiece.setVisible(!0)},n.playAnimShow=function(){this.setAlpha(0).setScale(0),this.show(),this.animScaleUp.play()},n.onBoardHandleMoveCompleted=function(){this.scene.tutorialManager.isRunning()||(this.parent.setActivePieces(),this.parent.existPiecesActive()||this.parent.showNewPieces())},n.drawSuggestCells=function(){var t=function(t,e){for(var n=t.length,i=t[0].length,a=0,r=0,s=0,o=0;o<n;o++)for(var h=0;h<i;h++)if(pf(t,h,o,e)&&(r=h,s=o,++a>1))return null;if(0===a)return null;for(var c=[],l=0;l<e.data.length;l++)for(var u=0;u<e.data[l].length;u++)e.data[l][u].texture&&c.push({x:r+u,y:s+l});return c&&c.length>0?c:null}(this.scene.main.board.dataBoard,{data:this.data});t&&this.scene.main.board.handleSuggestMove(t)},n.getPositionFirstCellHighlight=function(){var t=this.scene.main.board.dataBoard,e=this.getPositionTopLeftInBoard();if(!e)return{x:0,y:0};var n=e.x,i=e.y;return e?{x:t[i][n].x,y:-(this.scene.scale.height-this.parentHeight-t[i][n].y)}:{x:0,y:0}},n.handleInvalidMove=function(){var t=this;this.scene.audio.playSound(Vs.default.PIECE_INVALID_MOVE),this.scene.main.board.handleRemoveHighlight(),this.scene.tutorialManager.isRunning()&&this.scene.tutorialManager.invalidMove(),this.animMoveDownAndScaleDown=this.scene.tweens.add({x:this.backupPx,y:this.backupPy,scaleX:1,scaleY:1,duration:300,targets:this,ease:"Sine.easeInOut",delay:20,onComplete:function(){t.updateCellsWithPadding(.5)}})},n.canMove=function(){var t=this.scene.main.board.dataBoard,e=this.getCellsHighlight();if(0===e.length)throw new Error("Invalid Move");for(var n=!0,i=0;i<e.length;i++){var a=e[i],r=a.x,s=a.y;if(!t[s]||!t[s][r]||0!==t[s][r].value){n=!1;break}}if(!n||0===e.length)throw new Error("Invalid Move");return n},n.getCellsHighlight=function(){var t=this.scene.main.board.dataBoard,e=[],n=this.getPositionTopLeftInBoard();if(null===n)return e;if(this.scene.tutorialManager.isRunning()&&!this.scene.tutorialManager.validTargetPosition(n))return e;for(var i=0;i<this.data.length;i++)for(var a=0;a<this.data[i].length;a++)if(this.data[i][a].texture){var r=a+n.x,s=i+n.y,o=t[s]&&t[s][r]?t[s][r].x:0,h=t[s]&&t[s][r]?t[s][r].y:0;if(s>=Mf||r>=Cf||!t[s][r]||1===t[s][r].value)return[];e.push({x:r,y:s,pX:o,pY:h})}return e},n.getPositionTopLeftInBoard=function(){for(var t=this.scene.main.board.dataBoard,e=this.x+this.parent.cellSize*this.scale/2,n=this.y+this.parent.cellSize*this.scale/2,i=this.scene.main.board.cellPadding,a=-1,r=-1,s=0;s<Mf;s++)for(var o=0;o<Cf;o++)if(t[s][o].x-i/2<=e&&t[s][o].x+t[s][o].width+i/2>=e&&t[s][o].y-i/2<=n&&t[s][o].y+t[s][o].height+i/2>=n){a=o,r=s;break}return a<0||a>Cf-1||r<0||r>Mf-1?null:{x:a,y:r}},e.buildData=function(t){for(var e=[],n=0;n<t.length;n++){e[n]=[];for(var i=0;i<t[n].length;i++){var a=1===t[n][i]?Tf.GEM:null;e[n][i]={x:i,y:n,texture:a}}}return e},n.getPaddingCell=function(){return this.height/this.data.length/40},n.drawPiece=function(){return this.isCreateCell||this.createCells(.5),this.createAnimShow(),this.playAnimShow(),this.wrapPiece.setInteractive(),this},n.createAnimShow=function(){var t=this,e=140*this.index;this.animScaleUp=this.scene.tweens.add({delay:e,paused:!0,duration:163,targets:this,alpha:{from:0,to:this.alpha},scale:{from:0,to:1.2},ease:Phaser.Math.Easing.Sine.Out,onComplete:function(){t.animScaleDown.play()}}),this.animScaleDown=this.scene.tweens.add({delay:83,paused:!0,duration:150,targets:this,scale:1,ease:Phaser.Math.Easing.Sine.Out})},n.createCells=function(t){for(var e=this.parent.cellSize,n=0;n<this.data.length;n++){this.cells[n]=[];for(var i=0;i<this.data[n].length;i++)if(this.data[n][i].texture){var a={x:0+i*e+t,y:0+n*e+t,width:e-2*t,height:e-2*t},r=new Jp(this.scene,a);r.setVisible(!0),this.cells[n][i]=r,this.cellItems.push({x:i,y:n,cell:r}),this.add(r)}}this.isCreateCell=!0},n.updateCellsWithPadding=function(t){for(var e=this.parent.cellSize,n=e-2*t,i=e-2*t,a=0;a<this.data.length;a++)for(var r=0;r<this.data[a].length;r++)if(this.data[a][r].texture){var s=this.cells[a][r],o=r*e+t,h=a*e+t;s.setWorldSize(n,i),s.setPosition(o,h)}},n.getContainerSize=function(){for(var t=0,e=this.data.length,n=0;n<this.data.length;n++)this.data[n].length>t&&(t=this.data[n].length);var i=this.parent.cellSize;return{width:t*i*this.scale,height:e*i*this.scale}},n.resetPropsCells=function(t){for(var e=this.parent.cellSize,n=0;n<this.data.length;n++)for(var i=0;i<this.data[n].length;i++)if(this.data[n][i].texture)Math.floor(0+i*e+t),Math.floor(e-2*t),Math.floor(e-2*t),this.texture,this.frame,zs.default.PIECE,Math.floor(0+i*e+t),Math.floor(e-2*t),Math.floor(e-2*t),this.texture,this.frame,this.type,this.direction,this.isReverse},n.setCanMove=function(t){this.isCanMove=t,this.correctAlpha=t?1:.4,this.setAlpha(this.correctAlpha)},n.reset=function(){this.setVisible(!1),this.setScale(1),this.wrapPiece.disableInteractive()},e}(Phaser.GameObjects.Container),Pf=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.type,a.direction,a.isReverse)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t,e,n){void 0===n&&(n=!1);var i=[];switch(e){case bo:n?i=xh:(i=Eh,t===zo&&(i=bh),t===Ho&&(i=Th));break;case To:n?i=fh:(i=ph,t===zo&&(i=gh),t===Ho&&(i=mh));break;case wo:if(n){i=lh;break}i=ch,t===zo&&(i=uh),t===Ho&&(i=dh);break;case Co:n?i=yh:(i=vh,t===zo&&(i=Sh),t===Ho&&(i=Ah))}return i},e.getData=function(t,n,i){return void 0===i&&(i=!1),e.buildData(e.getMatrixData(t,n,i))},e}(If),kf=Pf,Rf=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.type,a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t,e){var n=[];switch(t){case jo:n=e===Eo?Rh:Oh;break;case Ko:n=e===Eo?Ph:kh;break;case Wo:n=e===Eo?wh:Ch;break;case Xo:n=e===Eo?Mh:Ih}return n},e.getData=function(t,n){return e.buildData(e.getMatrixData(t,n))},e}(If),Of=Rf,_f=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.type)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){case qo:e=_h;break;case Zo:e=Dh;break;case Jo:e=Lh}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(If),Df=_f,Lf=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){default:e=Uh;break;case"right":e=Vh;break;case"top":e=Yh;break;case"bottom":e=zh}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(If),Bf=Lf,Ff=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){default:e=Bh;break;case"vertical_right":e=Fh;break;case"horizontal_right":e=Gh;break;case"horizontal_left":e=Nh}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(If),Nf=Ff,Gf=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){default:e=Hh;break;case"right":e=Wh;break;case"top":e=Xh;break;case"bottom":e=Kh}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(If),Uf=Gf,Vf=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData()}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(){return jh},e.getData=function(){return e.buildData(e.getMatrixData())},e}(If),Yf=Vf,zf=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.type,a.direction)}))||this}return(0,Kt.default)(e,t),e.getDataByDirectionCross2=function(t){var e=[];if("right"===t)e=Zh;else e=qh;return e},e.getDataByDirectionCross3=function(t){var e=[];if("right"===t)e=Qh;else e=Jh;return e},e.getDataByDirectionCross4=function(t){var e=[];if("right"===t)e=tc;else e=$h;return e},e.getDataByDirectionCross5=function(t){var e=[];if("right"===t)e=nc;else e=ec;return e},e.getMatrixData=function(t,n){var i=[];switch(t){case nh:i=e.getDataByDirectionCross2(n);break;case ih:i=e.getDataByDirectionCross3(n);break;case ah:i=e.getDataByDirectionCross4(n);break;case rh:i=e.getDataByDirectionCross5(n)}return i},e.getData=function(t,n){return e.buildData(e.getMatrixData(t,n))},e}(If),Hf=zf,Wf=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){default:e=ic;break;case"right":e=ac;break;case"top":e=rc;break;case"bottom":e=sc}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(If),Xf=Wf,Kf=gs.default.DEFAULT,jf=Kf.KEY,qf=Kf.FRAME,Zf=function(){function t(t){this.scene=void 0,this.x=void 0,this.y=void 0,this.background=void 0,this.text=void 0,this.tweenStep1=void 0,this.tweenStep2=void 0,this.tweenStep3=void 0,this.tweenStep4=void 0,this.tweenStep5=void 0,this.tweenStep6=void 0,this.tweenTextStep1=void 0,this.tweenTextStep2=void 0,this.tweenTextStep5=void 0,this.tweenTextStep6=void 0,this.scene=t,this.init()}var e=t.prototype;return e.init=function(){this.createBackground(),this.createText(),this.createTween()},e.createBackground=function(){this.background=this.scene.make.image({key:jf,frame:qf.BG_STREAK}),this.background.setWorldSize(106,38),this.background.setVisible(!1)},e.createText=function(){this.text=this.scene.make.bitmapText({font:Hs.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(50),origin:{x:.5,y:.5},text:"3X \u041f\u041e\u041b\u041e\u0421\u0410!"}),this.text.setVisible(!1)},e.createTween=function(){var t=this,e=this.background.scale+.3;this.tweenStep1=this.scene.tweens.add({targets:[this.background],duration:100,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{start:0,from:0,to:e}},paused:!0,onComplete:function(){t.tweenStep2.play()}}),this.tweenTextStep1=this.scene.tweens.add({targets:[this.text],duration:200,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{start:.3,from:.3,to:1.4}},paused:!0,onComplete:function(){t.tweenTextStep2.play()}}),this.tweenStep2=this.scene.tweens.add({targets:[this.background],duration:200,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:e,to:e-.3}},paused:!0,onComplete:function(){t.tweenStep3.play()}}),this.tweenTextStep2=this.scene.tweens.add({targets:[this.text],duration:100,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:1.4,to:1}},paused:!0,onComplete:function(){t.tweenTextStep5.play()}}),this.tweenStep3=this.scene.tweens.addCounter({from:0,to:20,paused:!0,duration:533,ease:Phaser.Math.Easing.Sine.InOut,onUpdate:function(e){var n=e.getValue();t.text.setPosition(t.x,t.y-n),t.background.setPosition(t.x,t.y-n)},onComplete:function(){t.y=t.y-20,t.tweenStep4.play()}}),this.tweenStep4=this.scene.tweens.addCounter({from:0,to:5,paused:!0,duration:333,ease:Phaser.Math.Easing.Sine.InOut,onUpdate:function(e){var n=e.getValue();t.text.setPosition(t.x,t.y+n),t.background.setPosition(t.x,t.y+n)},onComplete:function(){t.y=t.y+5,t.tweenStep5.play(),t.tweenTextStep5.play()}}),this.tweenStep5=this.scene.tweens.add({targets:[this.background],delay:567,duration:67,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:e-.3,to:e}},paused:!0,onComplete:function(){t.tweenStep6.play()}}),this.tweenTextStep5=this.scene.tweens.add({targets:[this.text],delay:467,duration:133,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:1,to:.8}},paused:!0,onComplete:function(){t.tweenTextStep6.play()}}),this.tweenStep6=this.scene.tweens.add({targets:[this.background],duration:200,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:e,to:0}},paused:!0,onComplete:function(){t.text.setVisible(!1),t.background.setVisible(!1),t.text.setScale(0),t.background.setScale(0)}}),this.tweenTextStep6=this.scene.tweens.add({targets:[this.text],duration:167,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:.8,to:1.7},alpha:{from:1,to:0}},paused:!0,onComplete:function(){t.text.setVisible(!1),t.text.setScale(0)}})},e.playAnim=function(t,e){(this.tweenTextStep1.isPlaying()||this.tweenTextStep2.isPlaying()||this.tweenTextStep5.isPlaying()||this.tweenTextStep6.isPlaying())&&(this.tweenTextStep1.stop(),this.tweenTextStep2.stop(),this.tweenTextStep5.stop(),this.tweenTextStep6.stop(),this.text.setScale(0),this.text.setVisible(!1),this.background.setScale(0),this.background.setVisible(!1)),this.x=t,this.y=e,this.text.setScale(0).setAlpha(1),this.background.setScale(0),this.text.setPosition(t,e),this.background.setPosition(t,e),this.text.setVisible(!0),this.tweenTextStep1.play()},e.setTextCombo=function(t){this.text.setText(t+"X \u041a\u041e\u041c\u0411\u041e!")},e.setTextStreak=function(t){this.text.setText(t+"X \u041f\u041e\u041b\u041e\u0421\u0410!")},e.setBgFrame=function(t){this.background.setFrame(t)},t}(),Jf=function(){function t(t){this.scene=void 0,this.streakBreak=void 0,this.scene=t,this.init()}return t.prototype.init=function(){this.streakBreak=new Zf(this.scene)},t}(),Qf=function(){function t(){}return t.create=function(t,e,n){var i;switch(n.type){case Yo:case zo:case Ho:i=new kf(t,e,n);break;case Wo:case Xo:case Ko:case jo:i=new Of(t,e,n);break;default:i=new Df(t,e,n);break;case $o:i=new Bf(t,e,n);break;case th:i=new Uf(t,e,n);break;case sh:i=new Xf(t,e,n);break;case eh:i=new Yf(t,e,n);break;case nh:case ih:case ah:case rh:i=new Hf(t,e,n);break;case Qo:i=new Nf(t,e,n)}return i},t}(),$f=Qf,tg=gs.default.GAMEPLAY_32,eg=tg.KEY,ng=tg.FRAME,ig=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.tweenToEnableMaxFps=void 0,n.cellSize=void 0,n.canCaptureLines=void 0,n.allPieces=[],n.allPiecesGroup=[],n.piecesActive=[],e.add.existing((0,ls.default)(n)),n.scene=e,n.canCaptureLines={isCapture:!1,direction:"",minLine:5},n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.initCellSize(),this.createAllPieces(),this.createAllPiecesGroup(),this.createTweenToEnableMaxFps()},n.initCellSize=function(){this.cellSize=41*this.scene.main.board.cellSize/100},n.setContentPosition=function(t,e){this.setPosition(t,e)},n.createTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps=this.scene.add.tween({targets:[],duration:300,loop:-1,paused:!0})},n.playTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps.play()},n.stopTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps.stop()},n.getDirectionsByType=function(t){if([qo,Zo,Jo].some((function(e){return e===t})))return[];var e=[];switch(t){case Yo:case zo:case Ho:case $o:case th:case sh:e=[wo,bo,To,Co];break;case Wo:case Xo:case Ko:case jo:e=[Eo,xo];break;case Qo:e=[Mo,Io,Po,ko];break;case eh:e=[];break;case nh:case ih:case ah:case rh:e=[bo,To]}return e},n.createAllPieces=function(){for(var t=this.cellSize,e=[],n=0;n<oh.length;n++){var i=this.getDirectionsByType(oh[n]);if(i.length<=0)e.push({type:oh[n]});else{for(var a=0;a<i.length;a++)e.push({type:oh[n],direction:i[a]});if(Yo===oh[n])for(var r=0;r<i.length;r++)e.push({type:oh[n],direction:i[r],isReverse:!0})}}for(var s=0;s<e.length;s++){var o=(0,wt.default)({},e[s],{texture:eg,frame:ng.GEM,x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(t/2),height:Math.floor(t/2),cellLength:Math.floor(t/2),parentHeight:this.height,wrap:{x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(t/2),height:Math.floor(t/2)}}),h=$f.create(this.scene,this,o);h.hide(),this.allPieces.push(h)}},n.createAllPiecesGroup=function(){for(var t=0;t<this.allPieces.length;t++){var e=this.allPieces[t];this.allPiecesGroup[e.type]||(this.allPiecesGroup[e.type]=[]),this.allPiecesGroup[e.type].push(t)}},n.randomPieces=function(){var t=this;this.scene.game.updateFps(Up.default.max);for(var e=this.buildPieceRates(!1),n=[],i=function(){var i=Math.floor(Math.random()*e.length),a=e[i];if(!t.allPiecesGroup[a])return"continue";var r=Math.floor(Math.random()*t.allPiecesGroup[a].length),s=t.allPiecesGroup[a][r],o=[Ko,jo].some((function(t){return t===a}));if(t.canCaptureLines.isCapture&&o){for(var h=0;h<t.allPiecesGroup[a].length;h++){var c=t.allPiecesGroup[a][h];if(t.allPieces[c]&&t.allPieces[c].direction===t.canCaptureLines.direction){s=c;break}}e=t.buildPieceRates(!1)}n.some((function(t){return t.index===s}))||n.push({index:s,type:a})};n.length<3;)i();for(var a=[],r=0;r<n.length;r++){var s=n[r].index,o=this.allPieces[s];a.push({position:s,texture:eg,frame:ng.GEM,type:o.type,direction:o.direction,isReverse:o.isReverse})}this.piecesActive=a},n.buildPieceRates=function(t){void 0===t&&(t=!0);for(var e=[],n=0;n<hh.length;n++)e.push((0,wt.default)({},hh[n]));if(t){var i=this.scene.main.board.dataBoard,a=5;if(this.canCaptureLines=this.scene.main.board.canCaptureLines(i,a),this.canCaptureLines.isCapture)for(var r=0;r<e.length;r++)e[r].type===jo&&(e[r].rate=8);else if(a=4,this.canCaptureLines=this.scene.main.board.canCaptureLines(i,a),this.canCaptureLines.isCapture)for(var s=0;s<e.length;s++)e[s].type===Ko&&(e[s].rate=8)}for(var o=[],h=0;h<e.length;h++)for(var c=e[h],l=c.type,u=c.rate,d=0;d<u;d++)o.push(l);return o},n.drawPieces=function(){for(var t=this.scene.gameZone,e=t.width,n=t.height,i=[20,e/3,2*e/3-20],a=n/2+176-13,r=a+(n-85-a)/2,s=0;s<this.piecesActive.length;s++){var o=this.allPieces[this.piecesActive[s].position],h=i[s];o.updatePosition(h,r),o.updatePositionWrapPiece(h+20*(s-1),r),o.setIndex(s),o.drawPiece(),this.allPieces[this.piecesActive[s].position]=o}},n.removeActivePiece=function(t){this.piecesActive[t].used=!0},n.existPiecesActive=function(){var t,e=c()(t=this.piecesActive).call(t,(function(t){return!t.used}));return e&&e.length>0},n.showNewPieces=function(){for(var t=0;t<this.allPieces.length;t++)this.allPieces[t].reset();this.randomPieces(),this.setActivePieces(),this.drawPieces()},n.calculatePieceInfo=function(){for(var t=0,e=0,n=this.cellSize,i=0;i<this.piecesActive.length;i++){var a=this.allPieces[this.piecesActive[i].position].data;t+=a[0].length,a.length>e&&(e=a.length)}return{cellLength:n/2,cols:t}},n.setActivePieces=function(){for(var t=this.scene.main.board.dataBoard,e=0;e<this.piecesActive.length;e++){var n=this.piecesActive[e].position,i=ff(t,this.allPieces[n]);this.allPieces[n].setCanMove(i)}},n.getPiecesByFen=function(t){var e=[],n=t.split(" ");if(n.length<2)throw new Error("Invalid fen");for(var i=ds()(n).call(n,2),a=0;a<i.length;a++){var r,s;if("l"!==$p()(r=i[a]).call(r)){var o=Ef($p()(s=i[a]).call(s));e.push(o)}}return e},n.getFenByPieces=function(){for(var t="l",e=0;e<this.piecesActive.length;e++){var n=this.piecesActive[e],i=n.type,a=n.direction,r=n.isReverse,s=n.frame;if(!n.used){var o=yf(i);a&&""!==a&&(o+="-"+yf(a)),r&&(o+="-r"),t+=" "+o+","+yf(s)}}return t},n.clearPieces=function(){for(var t=0;t<this.piecesActive.length;t++){var e=this.piecesActive[t].position;this.allPieces[e].hide()}this.piecesActive=[]},n.showAvailablePieces=function(t){if(t&&!(t.length<=0)){for(var e=[],n=0;n<t.length;n++)for(var i=t[n],a=i.type,r=i.direction,s=i.isReverse,o=i.frame,h=0;h<this.allPieces.length;h++){var c=this.allPieces[h];if(a===c.type&&r===c.direction&&s===c.isReverse){e.push({position:h,texture:eg,frame:o,type:c.type,direction:c.direction,isReverse:c.isReverse});break}}this.piecesActive=e,this.setActivePieces(),this.drawPieces()}},n.debuggerNextPieces=function(){for(var t=0;t<this.piecesActive.length;t++)this.removeActivePiece(t);for(var e=0;e<this.allPieces.length;e++)this.allPieces[e].wrapPiece.setVisible(!1);this.showNewPieces()},e}(Phaser.GameObjects.Container),ag=gs.default.DEFAULT,rg=ag.KEY,sg=ag.FRAME,og=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.pieces=void 0,n.debugButton=void 0,n.textExist=void 0,n.scene=e,n.setSize(n.scene.gameZone.width,76),e.add.existing((0,ls.default)(n)),n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createBackground(),this.createPieces(),this.createDebugButton()},n.createBackground=function(){var t=this.scene.make.image({key:rg,frame:sg.FOOTER}),e=this.scene.gameZone.width;t.setWorldSize(e,this.height),this.add(t),Phaser.Display.Align.In.BottomCenter(t,this)},n.createPieces=function(){this.pieces=new ig(this.scene)},n.createDebugButton=function(){GameCore.Utils.Valid.isDebugger()&&this.createDebugButtonNextPieces()},n.createDebugButtonNextPieces=function(){this.debugButton=new Ys.default(this.scene,rg,sg.BUTTON_DARK_BLUE,100,30),this.debugButton.setName("Debug");var t=this.scene.make.bitmapText({font:Hs.default.PRIMARY.KEY,size:this.scene.fontSize(30),text:"Next pieces",origin:{x:.5,y:.5}});this.debugButton.add([t]),this.debugButton.onClick=this.clickButtonNextPieces.bind(this),this.add(this.debugButton),Phaser.Display.Align.In.BottomLeft(this.debugButton,this),this.textExist=this.scene.make.bitmapText({font:Hs.default.PRIMARY.KEY,size:this.scene.fontSize(30),text:"Exist",origin:{x:.5,y:.5}}),this.debugButton.add([this.textExist]),Phaser.Display.Align.In.Center(this.textExist,this,80,0)},n.clickButtonNextPieces=function(){this.scene.footer.pieces.debuggerNextPieces()},e}(Phaser.GameObjects.Container),hg=og,cg=gs.default.DEFAULT,lg=cg.KEY,ug=cg.FRAME,dg=function(t){function e(e){var n;return(n=t.call(this,e)||this).background=void 0,n.iconCrown=void 0,n.bestScoreText=void 0,n.setPosition(0,48.5),n.createBackground(),n.createScoreText(),n.createIconCrown(),n.scene.add.existing((0,ls.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createBackground=function(){this.background=this.scene.make.image({key:lg,frame:ug.BEST_SCORE_FRAME}),this.background.setWorldSize(55,77),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this)},n.createScoreText=function(){this.bestScoreText=this.scene.make.bitmapText({font:Hs.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(26),origin:{x:.5,y:.5},text:"0"}),this.add(this.bestScoreText),Phaser.Display.Align.In.Center(this.bestScoreText,this.background,0,25)},n.createIconCrown=function(){this.iconCrown=this.scene.make.image({key:lg,frame:ug.ICON_CROWN}),this.iconCrown.setWorldSize(20,18),this.add(this.iconCrown),Phaser.Display.Align.In.Center(this.iconCrown,this.background,0,5)},n.setScoreText=function(t){this.bestScoreText.setText(String(t))},n.updateBestScoreText=function(t){var e=this.scene.storage.getState();t>fu(e).bestScore&&this.setScoreText(t)},e}(Phaser.GameObjects.Container),pg=dg,fg=gs.default.DEFAULT,gg=fg.KEY,mg=fg.FRAME,vg=function(t){function e(e){var n,i=(n=t.call(this,e,0,0,gg,mg.LEAF)||this).scene.gameZone.width,a=i*n.height/n.width;return n.setWorldSize(i,a),n.scene.add.existing((0,ls.default)(n)),n}return(0,Kt.default)(e,t),e}(Phaser.GameObjects.Image),yg=vg,Sg=gs.default.GAMEPLAY,Ag=Sg.KEY,Eg=Sg.FRAME,xg=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.scoreText=void 0,n.background=void 0,n.tweenShow=void 0,n.tweenHide=void 0,n.addScore=void 0,n.score=void 0,n.currentScore=0,n.scene=e,n.scene.add.existing((0,ls.default)(n)),n.createBackground(),n.createScoreText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createBackground=function(){this.background=this.scene.make.image({key:Ag,frame:Eg.BG_MAIN_SCORE}),this.background.setWorldSize(187,48),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this,0,-1)},n.createScoreText=function(){this.scoreText=this.scene.make.bitmapText({font:Hs.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(52),text:"0",origin:{x:.5,y:.5}}),this.add(this.scoreText),Phaser.Display.Align.In.Center(this.scoreText,this.background,0,3)},n.setScore=function(t){this.score=t},n.setScoreText=function(t){this.scoreText.setText(String(t))},n.animAddScore=function(t){var e=this,n=this.score+t;this.currentScore=n,this.setScore(n),this.addScore&&this.addScore.isPlaying()&&(this.addScore.remove(),this.setScoreText(n)),this.addScore=this.scene.tweens.addCounter({from:this.score-t,to:this.score,duration:100,ease:Phaser.Math.Easing.Sine.Out,onUpdate:function(t){var n=Math.floor(t.getValue());e.setScoreText(n),e.scene.header.bestScoreBlock.updateBestScoreText(n),e.scene.updateProgressTargetScore(n)},onComplete:function(){e.setScoreText(e.score),e.scene.header.bestScoreBlock.updateBestScoreText(e.score),e.scene.tutorialManager.isRunning()?e.scene.tutorialManager.nextTutorial():(e.scene.handleNextTargetScore(),e.scene.bestScoreReached())}})},e}(Phaser.GameObjects.Container),bg=xg,Tg=gs.default.GAMEPLAY,wg=Tg.KEY,Cg=Tg.FRAME,Mg=function(t){function e(e){var n;return(n=t.call(this,e)||this).titleSprite=void 0,n.background=void 0,n.textScore=void 0,n.avatar=void 0,n.score=void 0,n}(0,Kt.default)(e,t);var n=e.prototype;return n.initScoreBlockAvatar=function(){this.createAvatar(),this.createBackgroundScore(),this.createScoreText(),this.setScore(0),this.setScoreText(0)},n.createAvatar=function(){this.avatar=new bl(this.scene,{key:wg,frame:Cg.AVATAR_BORDER,background:Cg.AVATAR_BACKGROUND,width:32,height:32,radius:32,borderWidth:5}),this.add(this.avatar),Phaser.Display.Align.In.Center(this.avatar,this,0,-10)},n.createBackgroundScore=function(){this.background=this.scene.make.image({key:wg,frame:Cg.BG_SCORE}),this.background.setWorldSize(92,27),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this,0,25)},n.createScoreText=function(){this.textScore=this.scene.make.bitmapText({font:Hs.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(35),text:"0",origin:{x:.5,y:.5}}),this.add(this.textScore),Phaser.Display.Align.In.Center(this.textScore,this.background)},n.setScore=function(t){this.score=t},n.setScoreText=function(t){this.textScore.setText(String(t))},e}(Phaser.GameObjects.Container),Ig=Mg,Pg=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.addScore=void 0,n.currentScore=0,n.scene=e,n.initScoreBlockAvatar(),n.scene.add.existing((0,ls.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.updateInfo=function(){var t=this.scene.player.getPlayer(),e=t.playerId,n=t.photo;if(this.avatar.loadPhoto(e,n),this.scene.gamePlayMode===Xr){var i=this.scene.storage.getState(),a=(fu(i)[e]||{}).score,r=void 0===a?0:a;this.textScore.setText(String(r))}},n.animAddScore=function(t){var e=this,n=this.score+t;this.currentScore=n,this.setScore(n),this.addScore&&this.addScore.isPlaying()&&(this.addScore.remove(),this.setScoreText(n)),this.addScore=this.scene.tweens.addCounter({from:this.score-t,to:this.score,duration:100,onUpdate:function(t){var n=Math.floor(t.getValue());e.setScoreText(n),e.scene.header.bestScoreBlock.updateBestScoreText(n),e.scene.updateProgressTargetScore(n)},onComplete:function(){e.setScore(e.score),e.scene.header.bestScoreBlock.updateBestScoreText(e.score),e.setScoreText(n),e.scene.handleNextTargetScore(),e.scene.bestScoreReached()}})},e}(Ig),kg=Pg,Rg=function(t){function e(e){var n;return(n=t.call(this,e)||this).initScoreBlockAvatar(),n.scene.add.existing((0,ls.default)(n)),n}return(0,Kt.default)(e,t),e.prototype.updateInfo=function(){var t=this.scene.storage.getState(),e=pu(t),n=iu(t),i=n.playerId,a=n.photo,r=(e[i]||{}).score,s=void 0===r?0:r;this.textScore.setText(String(s)),this.avatar.loadPhoto(i,a)},e}(Ig),Og=Rg,_g=gs.default.EFFECTS,Dg=_g.KEY,Lg=_g.FRAME,Bg=function(t){function e(e){var n;return(n=t.call(this,e,Dg,Lg.FX_STAR_WHITE)||this).emitZone=void 0,n.emitter=void 0,n._isPlaying=!1,n.frequency=void 0,n.count=void 0,n.createEmitZone(),n.createEmitters(),n.scene.add.existing((0,ls.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createEmitZone=function(){this.emitZone=new Phaser.Geom.Rectangle},n.createEmitters=function(){var t=1/this.scene.world.getPixelRatio();this.emitter=this.createEmitter({frame:Lg.DUST_YELLOW,tint:16710522,emitZone:{source:this.emitZone,type:"random"},frequency:16,speedX:{min:-25,max:-10},speedY:{min:-7,max:7},lifespan:{min:500,max:1500},alpha:{start:.7,end:.3},scale:{min:1*t,max:1.5*t},delay:300})},n.run=function(t,e,n,i,a,r){this.emitZone.setSize(a,r),this.emitZone.setPosition(n-a/2,i-r/2),e!=this.frequency&&(this.emitter.setFrequency(e),this.frequency=e),t!=this.count&&(this.emitter.setQuantity(t),this.count=t),this._isPlaying||(this.emitter.start(),this._isPlaying=!0)},n.stop=function(){var t;null==(t=this.emitter)||t.stop(),this._isPlaying=!1},n.isPlaying=function(){return this._isPlaying},e}(Phaser.GameObjects.Particles.ParticleEmitterManager),Fg=Bg,Ng=gs.default.GAMEPLAY,Gg=Ng.KEY,Ug=Ng.FRAME,Vg=function(t){function e(e,n,i){var a;return(a=t.call(this,e)||this).scene=void 0,a.leftBg=void 0,a.midBg=void 0,a.rightBg=void 0,a.leftProgress=void 0,a.midProgress=void 0,a.rightProgress=void 0,a.rightWhiteProgress=void 0,a.iconCup=void 0,a.glareCup=void 0,a.tweenRotationGlareCup=void 0,a.targetScore=void 0,a.listPoolMilestoneFrame=[],a.listMilestoneFrame=[],a.particle=void 0,a.emitter=void 0,a.progressBarFull=void 0,a.sparkling=void 0,a.setSize(n,i),a.scene=e,a.init(),a}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.initBg(),this.initProgressBar(),this.createParticle(),this.createEmitter(),this.createGlareCup(),this.createTweenGlare(),this.createIconCup(),this.createSparkling()},n.initBg=function(){this.leftBg=this.scene.make.image({key:Gg,frame:Ug.PROGRESS_BG_LEFT}),this.midBg=this.scene.make.image({key:Gg,frame:Ug.PROGRESS_BG_MID}),this.rightBg=this.scene.make.image({key:Gg,frame:Ug.PROGRESS_BG_RIGHT});var t=this.leftBg,e=t.width,n=t.height,i=e*this.height/n;this.leftBg.setWorldSize(i,this.height);var a=this.rightBg,r=a.width,s=a.height,o=r*this.height/s;this.rightBg.setWorldSize(o,this.height);var h=this.width-(i+o);this.midBg.setWorldSize(h,this.height),this.add(this.leftBg),this.add(this.midBg),this.add(this.rightBg),Phaser.Display.Align.In.LeftCenter(this.leftBg,this,0,0),Phaser.Display.Align.In.Center(this.midBg,this,0,0),Phaser.Display.Align.In.RightCenter(this.rightBg,this,0,0)},n.initProgressBar=function(){this.leftProgress=this.scene.make.image({key:Gg,frame:Ug.PROGRESS_BAR_LEFT}),this.midProgress=this.scene.make.image({key:Gg,frame:Ug.PROGRESS_BAR_MID}),this.rightProgress=this.scene.make.image({key:Gg,frame:Ug.PROGRESS_BAR_RIGHT}),this.rightWhiteProgress=this.scene.make.image({key:Gg,frame:Ug.PROGRESS_BAR_RIGHT_WHITE});var t=this.leftProgress,e=t.width,n=t.height,i=e*this.height/n;this.leftProgress.setWorldSize(i,this.height);var a=this.rightProgress,r=a.width,s=a.height,o=r*this.height/s;this.rightProgress.setWorldSize(o,this.height);var h=this.rightWhiteProgress,c=h.width,l=h.height,u=c*this.height/l;this.rightWhiteProgress.setWorldSize(u,this.height);var d=this.width-(i+o)+2;this.midProgress.setWorldSize(d,this.height),this.add(this.rightWhiteProgress),this.add(this.leftProgress),this.add(this.midProgress),this.add(this.rightProgress),this.leftProgress.setVisible(!1),this.rightProgress.setVisible(!1),this.midProgress.setVisible(!1),Phaser.Display.Align.In.LeftCenter(this.leftProgress,this,0,0),Phaser.Display.Align.In.Center(this.midProgress,this,0,0),Phaser.Display.Align.In.RightCenter(this.rightProgress,this,0,0)},n.createIconCup=function(){this.iconCup=this.scene.make.image({key:Gg,frame:Ug.ICON_CUP}),this.iconCup.setWorldSize(25,20),this.add(this.iconCup),Phaser.Display.Align.In.RightCenter(this.iconCup,this.glareCup,-9,1)},n.createGlareCup=function(){this.glareCup=this.scene.make.image({key:Gg,frame:Ug.CUP_GLARE}),this.glareCup.setWorldSize(44,44),this.glareCup.setVisible(!1),this.add(this.glareCup),Phaser.Display.Align.In.RightCenter(this.glareCup,this.rightBg,42,-3)},n.createTweenGlare=function(){this.tweenRotationGlareCup=new ml({targets:[this.glareCup],repeat:-1,duration:6e3})},n.createParticle=function(){this.particle=this.scene.add.particles(Gg),this.add(this.particle)},n.createEmitter=function(){this.emitter=this.particle.createEmitter({x:0,y:0,scale:{min:.3,max:1},speed:{min:10,max:30},lifespan:{min:500,max:1e3},quantity:1,on:!1,frame:Ug.DUST}),this.emitter.setPosition(this.scene.gameZone.width/2-10,-3)},n.createSparkling=function(){this.sparkling=new Fg(this.scene),this.add(this.sparkling)},n.createMilestoneFrame=function(){var t=this.scene.make.image({key:Gg,frame:Ug.FLAG});return t.setWorldSize(16,22),t},n.getMilestoneFrame=function(){var t,e=c()(t=this.listPoolMilestoneFrame).call(t,(function(t){return!t.visible}));if(!e||0===e.length){var n=this.createMilestoneFrame();return this.listPoolMilestoneFrame.push(n),this.add(n),n}return e[0]},n.handleSetAlphaListMilestone=function(t){this.listMilestoneFrame.forEach((function(e){e.score<=t?e.frame.setAlpha(1):e.frame.setAlpha(.5)}))},n.handleSetAlphaCup=function(t){t>=this.targetScore?this.iconCup.setAlpha(1):this.iconCup.setAlpha(.5)},n.runEmitter=function(){this.emitter.start()},n.stopEmitter=function(){this.emitter.stop()},n.runAnimGlare=function(){this.glareCup.setVisible(!0),this.tweenRotationGlareCup.play()},n.stopAnimGlare=function(){this.tweenRotationGlareCup.stop(),this.glareCup.setVisible(!1)},n.hideProgressBar=function(){this.leftProgress.setVisible(!1),this.rightProgress.setVisible(!1),this.midProgress.setVisible(!1)},n.hideMilestone=function(){this.listPoolMilestoneFrame.forEach((function(t){t.setVisible(!1)}))},n.resetListMilestone=function(){this.listMilestoneFrame=[]},n.reset=function(){this.hideMilestone(),this.hideProgressBar(),this.setPercent(0),this.resetListMilestone()},n.setTargetScore=function(t){this.targetScore=t},n.getTargetScore=function(){return this.targetScore},n.setPercent=function(t){var e=t*this.width,n=this.leftProgress.displayWidth,i=this.midProgress.displayWidth,a=this.rightProgress.displayWidth,r=this.leftBg.width+this.midBg.width+this.rightBg.width;if(this.sparkling.setPosition(),0===t)return this.rightWhiteProgress.setVisible(!1),this.sparkling.stop(),this.stopAnimGlare(),void this.stopEmitter();var s=r*(t>1?1:t),o=this.leftBg.x+s-this.leftBg.width/2+this.rightWhiteProgress.width/2-1;if(this.scene.isNextTarget?(this.runSparklingEmitZone(o-2),this.scene.isNextTarget=!1):this.sparkling.run(2,50,o,this.leftBg.y-.5,4,4),this.rightWhiteProgress.setVisible(!0),this.rightWhiteProgress.x=e-r/2+this.rightWhiteProgress.width/2-3,t>=1){this.rightWhiteProgress.x=r-this.rightProgress.x-a;var h=r-this.rightProgress.x-a;if(this.sparkling.run(2,50,h,this.leftBg.y-.5,4,4),this.progressBarFull)return;return this.progressBarFull=!0,this.leftProgress.setVisible(!0),this.midProgress.setVisible(!0),this.rightProgress.setVisible(!0),this.leftProgress.setCrop(0,0,n/this.leftProgress.scaleX,2*this.height),this.midProgress.setCrop(0,0,i/this.midProgress.scaleX,2*this.height),this.rightProgress.setCrop(0,0,a/this.rightProgress.scaleX,2*this.height),this.runAnimGlare(),void this.runEmitter()}if(this.stopAnimGlare(),this.stopEmitter(),this.progressBarFull=!1,e<n)return this.leftProgress.setVisible(!0),t<=.01?(this.leftProgress.setCrop(0,0,5,2*this.height),void(this.rightWhiteProgress.x+=2)):void this.leftProgress.setCrop(0,0,e/this.leftProgress.scaleX,2*this.height);if(e>n+i){this.leftProgress.setVisible(!0),this.midProgress.setVisible(!0),this.midProgress.setCrop(0,0,i/this.midProgress.scaleX,2*this.height),this.rightProgress.setVisible(!0),this.rightProgress.setCrop(0,0,(e-(n+i-2))/this.rightProgress.scaleX,2*this.height),this.rightWhiteProgress.x=this.rightProgress.x-2;var c=this.rightProgress.x-2;this.sparkling.run(2,50,c,this.leftBg.y-.5,4,4)}else this.leftProgress.setVisible(!0),this.leftProgress.setCrop(0,0,n/this.leftProgress.scaleX,2*this.height),this.midProgress.setVisible(!0),this.midProgress.setCrop(0,0,(e-n)/this.midProgress.scaleX,2*this.height)},n.runSparklingEmitZone=function(t){this.scene.tweens.add({targets:this.sparkling.emitZone,x:t,duration:400})},e}(Phaser.GameObjects.Container),Yg=gs.default.GAMEPLAY,zg=Yg.KEY,Hg=Yg.FRAME,Wg=function(t){function e(e){var n;return(n=t.call(this,e,zg,Hg.BUTTON_WOOD_SMALL)||this).button.setWorldSize(55,48),n.setName("Setting"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:zg,frame:Hg.ICON_SETTING});t.setWorldSize(30,30),this.add(t),Phaser.Display.Align.In.Center(t,this,1,-1.5)},e}(Ys.default),Xg=Wg,Kg=gs.default.GAMEPLAY,jg=Kg.KEY,qg=Kg.FRAME,Zg=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.buttonSetting=void 0,n.bestScoreBlock=void 0,n.mainScoreBlock=void 0,n.myScoreBlock=void 0,n.opponentScoreBlock=void 0,n.iconBattle=void 0,n.progressBar=void 0,n.scene=e,n.setSize(n.scene.gameZone.width,0),e.add.existing((0,ls.default)(n)),n.createLeaf(),n.creatIconBattle(),n.createBestScoreBlock(),n.createSettingButton(),n.createMainScoreBlock(),n.createMyScoreBlock(),n.createOpponentScoreBlock(),n.createProgressBar(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createLeaf=function(){var t=new yg(this.scene);this.add(t),Phaser.Display.Align.In.Center(t,this,0,t.displayHeight/2)},n.createBestScoreBlock=function(){this.bestScoreBlock=new pg(this.scene),this.add(this.bestScoreBlock),Phaser.Display.Align.In.Center(this.bestScoreBlock,this,-132,-12.5)},n.createMainScoreBlock=function(){this.mainScoreBlock=new bg(this.scene),this.add(this.mainScoreBlock),Phaser.Display.Align.In.Center(this.mainScoreBlock,this,0,52)},n.createMyScoreBlock=function(){this.myScoreBlock=new kg(this.scene),this.myScoreBlock.setVisible(!1),this.add(this.myScoreBlock),Phaser.Display.Align.In.Center(this.myScoreBlock,this,-52,35)},n.createOpponentScoreBlock=function(){this.opponentScoreBlock=new Og(this.scene),this.opponentScoreBlock.setVisible(!1),this.add(this.opponentScoreBlock),Phaser.Display.Align.In.Center(this.opponentScoreBlock,this,52,35)},n.createSettingButton=function(){this.buttonSetting=new Xg(this.scene),this.add(this.buttonSetting),Phaser.Display.Align.In.Center(this.buttonSetting,this,132,51)},n.createProgressBar=function(){this.progressBar=new Vg(this.scene,315,13),this.add(this.progressBar),Phaser.Display.Align.In.Center(this.progressBar,this,-19,92)},n.creatIconBattle=function(){this.iconBattle=this.scene.make.image({key:jg,frame:qg.ICON_BATTLE}),this.iconBattle.setWorldSize(30,27),this.iconBattle.setVisible(!1),this.add(this.iconBattle),Phaser.Display.Align.In.Center(this.iconBattle,this,0,24)},n.getScore=function(){return this.mainScoreBlock.score},n.showItemSingleMode=function(){this.mainScoreBlock.setVisible(!0),this.myScoreBlock.setVisible(!1),this.opponentScoreBlock.setVisible(!1),this.iconBattle.setVisible(!1)},n.showItemPlayWithFriendsMode=function(){this.mainScoreBlock.setVisible(!1),this.opponentScoreBlock.setVisible(!0),this.myScoreBlock.setVisible(!0),this.iconBattle.setVisible(!0)},e}(Phaser.GameObjects.Container),Jg=Zg,Qg=gs.default.GAMEPLAY_32.FRAME,$g=[""+Qg.BLOCK_GRADIENT_PREFIX+10,""+Qg.BLOCK_GRADIENT_PREFIX+9],tm=[],em=1;em<=10;em++)tm.push(""+Qg.BLOCK_GRADIENT_PREFIX+em);var nm=function(){var t=GameCore.Utils.Device,e=window.navigator.vibrate;return t.isAndroid()&&"function"===typeof e||t.isMobileWeb()&&"function"===typeof e||t.isIOS()},im=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,r,s;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Math.round(e/80),i=0,a=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,FBInstant.performHapticFeedbackAsync();case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0);case 8:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(){return t.apply(this,arguments)}}();case 3:if(!(i<n)){t.next=11;break}return r=a(),s=(0,Ge.sleepAsync)(80),i+=1,t.next=9,mt().all([r,s]);case 9:t.next=3;break;case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),am=function(t){window.navigator.vibrate(0),window.navigator.vibrate(t)},rm=function(t){try{if(!nm())return!1;var e=GameCore.Utils.Device;e.isAndroid()||e.isMobileWeb()?am(t):e.isIOS()&&im(t).catch((function(t){}))}catch(n){}},sm=function(){function t(t){this.angle=void 0,this.scene=void 0,this.scaleUpTween=void 0,this.breakingTween=void 0,this.breakingDelay=0,this.captureCells=void 0,this.timerEventRemoveCaptureCells=void 0,this.scene=t,this.init()}var e=t.prototype;return e.init=function(){this.createTweenBreaking()},e.handleShowEffect=function(t){var e=this;t&&0!==t.length&&(this.removeCaptureCell(),this.captureCells=t,this.setValueCaptureCell(),this.breakingTween.resetTweenData(!1),this.breakingTween.restart(),this.timerEventRemoveCaptureCells&&this.timerEventRemoveCaptureCells.remove(),this.timerEventRemoveCaptureCells=this.scene.time.addEvent({delay:500,callback:function(){e.breakingTween.isPlaying()||e.removeCaptureCell()}}))},e.onCaptureCellComplete=function(){if(this.captureCells&&this.scene.main&&this.scene.main.board)for(var t=this.scene.main.board.dataBoard,e=0;e<this.captureCells.length;e++){var n=this.captureCells[e],i=n.x;t[n.y][i].cell.resetImageBreak()}},e.removeCaptureCell=function(){var t=this.scene.main.board.dataBoard;if(this.captureCells)for(var e=0;e<this.captureCells.length;e++){var n=this.captureCells[e],i=n.x;t[n.y][i].cell.resetImageBreak()}},e.setValueCaptureCell=function(){for(var t=this.scene.main.board.dataBoard,e=Math.round(68.25),n=0;n<this.captureCells.length;n++){var i=Phaser.Math.Between(50,e),a=Phaser.Math.Between(82,98)*Math.PI/180,r=Phaser.Math.Between(3,10)/1e3,s=this.captureCells[n],o=s.x,h=t[s.y][o].cell;h.maxScale0=Phaser.Math.FloatBetween(2.5,4)/10,h.imageBreak.setFrame(gs.default.GAMEPLAY_32.FRAME.GEM),h.imageBreak.setVisible(!0),h.v0=i,h.alpha0=a,h.scaleRate0=r}},e.createTweenBreaking=function(){var t=this;this.breakingTween=this.scene.tweens.addCounter({from:0,to:1900,onUpdate:function(e){if(t.captureCells)for(var n=t.scene.main.board.dataBoard,i=0;i<t.captureCells.length;i++){t.angle=Phaser.Math.Between(-15,15);var a=t.captureCells[i],r=a.x,s=n[a.y][r].cell,o=s.imageBreak,h=s.maxScale0,c=s.alpha0<1.57?1:-1,l=.016*e.getValue(),u=Wp(s.v0,s.alpha0,l),d=Xp(s.v0,s.alpha0,l);o.setVisible(!0),o.x=s.x0+u,o.y=s.y0+-d,o.rotation+=.04*c,o.scale>h?o.scale-=s.scaleRate0:o.scale=h}},onComplete:function(){t.onCaptureCellComplete()},delay:this.breakingDelay,duration:2500}).stop()},t}(),om=sm,hm=gs.default.GAMEPLAY,cm=hm.KEY,lm=hm.FRAME,um=gs.default.GAMEPLAY_32,dm=um.KEY,pm=um.FRAME,fm=gs.default.DEFAULT.FRAME,gm=GameCore.Configs.Board,mm=gm.cols,vm=gm.rows,ym=GameCore.Configs.Gameplay.VibrateValue,Sm=function(t){function e(e,n,i){var a;return(a=t.call(this,e)||this).scene=void 0,a.suggestCells=[],a.pX=void 0,a.pY=void 0,a.borderLeftSize=4.5,a.borderTopSize=3,a.cellSize=void 0,a.cellPadding=void 0,a.diceSize=void 0,a.dataBoard=[],a.cellsHighlight=[],a.cellSharking=[],a.boardFrame=void 0,a.woodenEffect=void 0,a.canCaptureLines=function(t,e){void 0===e&&(e=5);for(var n=t.length,i=t[0].length,a=[],r=[],s=[],o=0;o<n;o++){for(var h=0,c={x:-1,y:-1},l=0;l<i;l++)0===o&&(s[l]={count:0,x:-1,y:-1}),1===t[o][l].value?(s[l].count++,h++):(c.x=l,c.y=o,s[l].x=l,s[l].y=o);if(h===i-1&&r.push((0,wt.default)({row:o},c)),o===n-1)for(var u=0;u<i;u++)s[u].count===n-1&&a.push((0,wt.default)({col:u},s[u]))}if(r.length>=e)for(var d=0,p={x:-1,y:-1},f=0;f<r.length;f++)if(0!==f){if(r[f].x===p.x&&r[f].y===p.y+1?(p.x=r[f].x,p.y=r[f].y,d++):d=1,d>=e)return{isCapture:!0,direction:"vertical",minLine:e}}else p.x=r[f].x,p.y=r[f].y,d++;if(a.length>=e)for(var g=0,m={x:-1,y:-1},v=0;v<a.length;v++)if(0!==v){if(a[v].x===m.x+1&&a[v].y===m.y?(m.x=a[v].x,m.y=a[v].y,g++):g=1,g>=e)return{isCapture:!0,direction:"horizontal",minLine:e}}else m.x=a[v].x,m.y=a[v].y,g++;return{isCapture:!1,direction:"",minLine:e}},a.scene=e,a.setSize(n,i),a.woodenEffect=new om(a.scene),a.init(),a}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createBoard(),this.calcCellLength(),this.initDataBoard()},n.createBoard=function(){var t=this.scene.gameZone,e=t.width/2,n=t.height/2-27;this.boardFrame=this.scene.make.image({x:e,y:n,key:cm,frame:lm.BOARD}),this.boardFrame.setWorldSize(this.width,this.height)},n.calcCellLength=function(){this.cellPadding=1.8,this.cellSize=(this.width-2*this.borderLeftSize-this.cellPadding*(mm+1))/mm},n.initDataBoard=function(){for(var t=this.boardFrame.x-this.boardFrame.displayWidth/2+this.cellSize/2+this.borderLeftSize,e=this.boardFrame.y-this.boardFrame.displayHeight/2+this.cellSize/2+this.borderTopSize,n=0;n<vm;n++){this.dataBoard[n]=[];for(var i=0;i<mm;i++){var a=t+i*this.cellSize+this.cellPadding*i,r=e+n*this.cellSize+this.cellPadding*n,s={x:a,y:r,width:this.cellSize,height:this.cellSize,texture:dm,frame:pm.GEM_TRANSPARENT,depth:zs.default.PIECE-.1,padding:this.cellPadding,isWoodenEffect:!0},o=new Jp(this.scene,s);o.setVisible(!1),this.dataBoard[n][i]={x:a,y:r,width:this.cellSize,height:this.cellSize,frame:pm.GEM_TRANSPARENT,value:0,cell:o}}}},n.handleTweenStartMission=function(){for(var t=this,e=100,n=0;n<vm;n++)for(var i=function(i){var a=t.dataBoard[n][i].cell,r=0;r=4==n&&4==i?e:n>=3&&n<=5&&i>=3&&i<=5?200:n>=2&&n<=6&&i>=2&&i<=6?300:n>=1&&n<=7&&i>=1&&i<=7?400:500,t.scene.time.delayedCall(r,(function(){a.playTweenStartMission()}))},a=0;a<mm;a++)i(a)},n.handleHighlight=function(t,e){this.cellsHighlight=t;for(var n=0;n<t.length;n++){var i=t[n],a=i.x,r=i.y;if(this.dataBoard[r]&&this.dataBoard[r][a]&&0===this.dataBoard[r][a].value){var s=this.dataBoard[r][a].cell;this.dataBoard[r][a].frame=pm.GEM,s.setVisible(!0),s.setFrame(pm.GEM),s.setAlpha(.3)}}this.canCaptureCells(t,e)},n.handleCapturePiece=function(t){var e=this;try{!function(){if(!t||t.length<=0)throw gf=0,new Error("Invalid Capture");for(var n=300,i=0,a=lf(e.dataBoard),r=uf(e.dataBoard),s=rf(),o=function(o){var h=t[o],c=h.x,l=h.y,u=e.dataBoard[l][c].cell,d=0,p=0,f=0;if(a.length>0&&r.length>0){var m=0,v=0;i=n/mm,-1!==g()(a).call(a,l)&&-1===g()(r).call(r,c)&&(m=i*c,v=0,p=g()(a).call(a,l)),-1===g()(a).call(a,l)&&-1!==g()(r).call(r,c)&&(m=0,v=i*l,p=g()(r).call(r,c)),-1!==g()(a).call(a,l)&&-1!==g()(r).call(r,c)&&(m=i*c,v=i*l,p=Math.max(g()(r).call(r,c),g()(a).call(a,l),0)),-1===g()(a).call(a,l)&&-1===g()(r).call(r,c)&&(m=i*c,v=i*l),d=Math.max(m,v,0)}else if(r.length>0)d=(i=n/mm)*l,p=g()(r).call(r,c),f=l;else if(a.length>0)d=(i=n/vm)*c,p=g()(a).call(a,l),f=c;else{i=100;var y=t[0].x;d=i*(c-y),p=0}u.hideImageHighlight(),e.scene.time.delayedCall(d,(function(){var t="";s>2&&(r.length>=3||a.length>=3)?(t=tm[f]||tm[0],u.imageBreak.setFrame(t)):(t=$g[p]||$g[0],u.imageBreak.setFrame(t)),u.playTweenScaleDown(),0==e.dataBoard[l][c].value&&u.setVisible(!1)})),e.dataBoard[l][c].frame=pm.GEM_TRANSPARENT,e.dataBoard[l][c].value=0},h=0;h<t.length;h++)o(h)}()}catch(n){}},n.checkPositionCellOnCaptureCell=function(t,e){var n=c()(e).call(e,(function(e){return e.x===t.x&&e.y===t.y}));return n&&n.length>0},n.handlePraise=function(t,e){if(e&&0!==e.length){var n=mf(),i=rf();i>1&&(n=18*af+10*(vf()-1));for(var a=[],r=0;r<t.length;r++){var s=t[r];this.checkPositionCellOnCaptureCell(s,e)&&a.push(s)}if(0!==a.length){for(var o=a[0].pX,h=0,c=a[0].pY,l=0,u=0;u<a.length;u++){var d=a[u];d.pX<o&&(o=d.pX),d.pX>h&&(h=d.pX),d.pY<c&&(c=d.pY),d.pY>l&&(l=d.pY)}var p=o+(h-o)/2,f=c+(l-c)/2;this.scene.main.praise.handlePraise(p,f,n,i),this.handleStreakBreak(p,f),this.playEatSound(i)}}},n.handleStreakBreak=function(t,e){if(!this.scene.tutorialManager.isRunning()){var n=rf(),i=vf()-1;if(t-75<0&&(t=75),t+75>375&&(t=300),!(i<2||n>=2)){var a=i>6?6:i,r=this.getVibrateByLevel(a);this.scene.player.getPlayerSettings().vibrate&&rm(r),this.playEatSound(a),this.scene.effectManager.streakBreak.setTextStreak(i),this.scene.effectManager.streakBreak.setBgFrame(fm.BG_STREAK),this.scene.effectManager.streakBreak.playAnim(t,e-20)}}},n.getVibrateByLevel=function(t){return ym[t]||0},n.playEatSound=function(t){switch(this.scene.audio.playSound(Vs.default.EAT_BLOCK,{volume:1}),t){default:break;case 2:this.scene.audio.playSound(Vs.default.GOOD);break;case 3:this.scene.audio.playSound(Vs.default.COOL);break;case 4:case 5:case 6:this.scene.audio.playSound(Vs.default.EXCELLENT)}},n.handleRemoveHighlight=function(){try{if(!this.cellsHighlight)return;for(var t=0;t<this.cellsHighlight.length;t++){var e=this.cellsHighlight[t],n=e.x,i=e.y;if(this.dataBoard[i]&&this.dataBoard[i][n]&&0===this.dataBoard[i][n].value){var a=this.dataBoard[i][n].cell;this.dataBoard[i][n].frame=pm.GEM_TRANSPARENT,a.setVisible(!1),a.setFrame(pm.GEM_TRANSPARENT),a.setAlpha(1)}}this.cellsHighlight=[]}catch(r){}},n.canCaptureCells=function(t,e){for(var n=this,i=this.dataBoard,a=[],r=0;r<i.length;r++){a[r]=[];for(var s=0;s<i[r].length;s++)a[r][s]=(0,wt.default)({},i[r][s])}for(var o=0;o<t.length;o++){var h=t[o],c=h.x;a[h.y][c].value=1}this.removeAnimCanCaptureCells(a,t);var l=sf(a,t);if(!l||l.length<=0)return!1;for(var u=function(e){var i=l[e],a=i.x,r=i.y;t.some((function(t){return t.x===a&&t.y===r}))||n.cellSharking.push((0,wt.default)({},l[e]))},d=0;d<l.length;d++)u(d);for(var p=0;p<this.cellSharking.length;p++){var f=this.cellSharking[p],g=f.x,m=f.y,v=this.dataBoard[m][g].cell;v.isHighlight()||v.showImageHighlight()}e(lf(a),uf(a),cf(a,t),t)},n.removeAnimCanCaptureCells=function(t,e){var n=this;if(0!==this.cellSharking.length){for(var i=lf(t),a=uf(t),r=cf(t,e),s=function(t){var e=n.cellSharking[t],s=e.x,o=e.y,h=n.dataBoard[o][s].cell;if(-1!==g()(i).call(i,o)||-1!==g()(a).call(a,s)||r.some((function(t){return t.x===s&&t.y===o})))return"continue";h.hideImageHighlight()},o=0;o<this.cellSharking.length;o++)s(o);this.cellSharking=[]}},n.removeAllCanCaptureCells=function(){if(0!==this.cellSharking.length){for(var t=0;t<this.cellSharking.length;t++){var e=this.cellSharking[t],n=e.x,i=e.y;this.dataBoard[i][n].cell.hideImageHighlight()}this.cellSharking=[]}},n.handleSuggestMove=function(t){try{this.suggestCells=t;for(var e=0;e<t.length;e++){var n=t[e],i=n.x,a=n.y,r=this.dataBoard[a][i].cell;r.setFrame(pm.GEM_HIGHT_LIGHT),r.setVisible(!0),r.setAlpha(1)}}catch(s){}},n.handleRemoveSuggestMove=function(){try{for(var t=0;t<this.suggestCells.length;t++){var e=this.suggestCells[t],n=e.x,i=e.y,a=this.dataBoard[i][n].cell;this.isCellHighlight(a)||(a.setFrame(pm.GEM_TRANSPARENT),a.setVisible(!1))}this.suggestCells=[]}catch(r){}},n.handleMove=function(t,e){try{for(var n=0;n<t.length;n++){var i=t[n],a=i.x,r=i.y;if(this.dataBoard[r]&&this.dataBoard[r][a]){this.dataBoard[r][a].frame=pm.GEM,this.dataBoard[r][a].value=1;var s=this.dataBoard[r][a].cell;s.setVisible(!0),s.setFrame(pm.GEM),s.setAlpha(1)}}var o=sf(this.dataBoard,t);this.handleCapturePiece(o),this.checkIsGameOver()&&this.scene.setIsGameOver(!0),this.handlePraise(t,o),e&&e(),this.handleResetFrameBoard(),this.scene.updateMatchData(),this.handleGameOver()}catch(h){}},n.handleResetFrameBoard=function(){for(var t=0;t<vm;t++)for(var e=0;e<mm;e++)if(this.dataBoard[t]&&this.dataBoard[t][e]&&1===this.dataBoard[t][e].value){var n=this.dataBoard[t][e],i=n.frame,a=n.cell;a.visible||(0,Ht.sendException)(new Error("Cell is invisible")),a.frame.name!==i&&(0,Ht.sendException)(new Error("Cell is frame not true")),a.setVisible(!0).setFrame(i)}},n.checkIsGameOver=function(){for(var t=[],e=this.scene.footer.pieces.piecesActive,n=this.scene.footer.pieces.allPieces,i=0;i<e.length;i++){var a=e[i],r=a.position;if(!a.used){var s=n[r];t.push({data:s.data,type:s.type,direction:s.direction,isReverse:s.isReverse,frame:s.frame})}}return!!df(this.dataBoard,t)},n.handleGameOver=function(){this.checkIsGameOver()&&(this.scene.disableInput(),this.runAnimationGameOver())},n.runAnimationGameOver=function(){var t=this;try{this.scene.audio.playSound(Vs.default.BOARD_GAME_OVER);for(var e=[],n=function(n){for(var i=function(i){if(t.dataBoard[n]&&t.dataBoard[n][i]&&1===t.dataBoard[n][i].value){var a=Math.floor(100*(n+1));e.push({delay:a,x:i,y:n}),t.scene.time.delayedCall(a,(function(){t.dataBoard[n][i].cell.playAnimImageGameOver()}))}},a=0;a<mm;a++)i(a)},i=0;i<vm;i++)n(i);this.scene.time.addEvent({delay:e[e.length-1].delay+300,callback:function(){t.scene.handleRequestFinishGame()}})}catch(a){}},n.rescue=function(){for(var t=0;t<this.dataBoard.length;t++)for(var e=0;e<this.dataBoard[t].length;e++)if(this.dataBoard[t]){var n=this.dataBoard[t][e];n&&1===n.value&&(this.dataBoard[t][e].cell.setFrame(pm.GEM),this.dataBoard[t][e].cell.resetImageGameOver())}this.handleUseBomb()},n.hasPieceL5=function(){var t=this.scene.footer.pieces.piecesActive;return c()(t).call(t,(function(t){return t.type===jo})).length>0},n.hasPieceCross5=function(){var t=this.scene.footer.pieces.piecesActive;return c()(t).call(t,(function(t){return t.type===rh})).length>0},n.handleUseBomb=function(){try{var t=this.hasPieceL5(),e=this.hasPieceCross5(),n=Math.floor(Math.random()*yo.length),i=yo[n];t&&(i=So[n]),e&&(i=Ao[n]);for(var a=[],r=i.minRow;r<i.minRow+i.rows;r++)for(var s=i.minCol;s<i.minCol+i.cols;s++)this.dataBoard[r][s].frame!==pm.GEM_TRANSPARENT&&a.push({x:s,y:r});for(var o=0;o<a.length;o++){var h=a[o],c=h.x,l=h.y,u=this.dataBoard[l][c];u.frame=pm.GEM_TRANSPARENT,u.value=0,u.cell.setFrame(pm.GEM_TRANSPARENT),u.cell.setVisible(!1)}this.woodenEffect.handleShowEffect(a),this.scene.footer.pieces.setActivePieces(),this.scene.updateMatchData()}catch(d){}},n.getBoardByFen=function(t){var e=[],n=t.split(" ");if(n.length<2)throw new Error("Invalid fen");for(var i=n[0].split("/"),a=i.length,r=0;r<a;r++){e[r]=[];for(var s=Af(i[r]),o=0;o<s.length;o++)e[r][o]=s[o]}return e},n.getFenByBoard=function(){for(var t="",e=0;e<vm;e++){for(var n=0,i="",a=0;a<mm;a++){if(0===this.dataBoard[e][a].value&&n++,1===this.dataBoard[e][a].value)n>0&&(i+=n>=vm?"x":""+n,n=0),i+=""+yf(this.dataBoard[e][a].frame);a===this.dataBoard[e].length-1&&n>0&&(i+=n>=vm?"x":""+n)}t+=e===this.dataBoard.length-1?""+i:i+"/"}return t},n.startGame=function(t){if(t)for(var e=0;e<t.length;e++)for(var n=0;n<t[e].length;n++){var i=t[e][n],a=i.value,r=i.frame,s=this.dataBoard[e][n];1===a&&(s.value=1,s.frame=r,s.cell.setFrame(pm.GEM),s.cell.setVisible(!0))}},n.clearBoard=function(){for(var t=0;t<vm;t++)for(var e=0;e<mm;e++){var n=this.dataBoard[t][e];n.value=0,n.frame=pm.GEM_TRANSPARENT,n.cell.reset(),n.cell.setFrame(pm.GEM_TRANSPARENT),n.cell.setVisible(!1),n.cell.resetImageGameOver()}},n.isCellHighlight=function(t){var e,n=c()(e=this.cellsHighlight).call(e,(function(e){return e.x===t.x&&e.y&&t.y}));return!!(n&&n.length>0)},e}(Phaser.GameObjects.Container),Am=GameCore.Configs.Gameplay,Em=Am.VibrateValue,xm=gs.default.EFFECTS,bm=xm.KEY,Tm=xm.FRAME,wm=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.listScore=[],n.score=void 0,n.startX=void 0,n.startY=void 0,n.scoreText=void 0,n.tweenShowScoreText=void 0,n.tweenHideScoreText=void 0,n.tweenShowPraiseFrame=void 0,n.tweenHidePraiseFrame=void 0,n.praiseFrame=void 0,n.praiseScoreText=void 0,n.particle=void 0,n.emitter=void 0,n.scene=e,e.add.existing((0,ls.default)(n)),n.setVisible(!1).setAlpha(0),n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createScoreText(),this.createTweenScoreText(),this.createPraiseFrame(),this.createPraiseScoreText(),this.createParticle(),this.createEmitter()},n.createParticle=function(){this.particle=this.scene.add.particles(bm),this.particle.setDepth(zs.default.ON_TOP+1)},n.createEmitter=function(){this.emitter=this.particle.createEmitter({x:0,y:0,scale:{start:.05,end:.2},speed:{min:20,max:70},lifespan:{min:500,max:1e3},quantity:20,on:!1,tint:[16441092,16422659],frame:Tm.FX_STAR,delay:350})},n.createScoreText=function(){this.scoreText=this.scene.make.bitmapText({font:Hs.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(50),text:"+0",origin:{x:.5,y:.5}}),this.scoreText.setScale(0).setAlpha(0),this.scoreText.setDepth(zs.default.ON_TOP),this.scoreText.setVisible(!1)},n.createTweenScoreText=function(){var t,e=this,n=this.scene.storage.getState(),i=Ml(n),a=this.scene.gameZone.width/2;g()(t=[Kr,Xr,jr]).call(t,i)>=0&&(a=105),this.tweenShowScoreText=this.scene.tweens.add({paused:!0,targets:this.scoreText,scale:{from:0,to:1},alpha:{from:0,to:1},duration:300,onComplete:function(){e.tweenHideScoreText=e.scene.tweens.add({targets:e.scoreText,scale:{from:1,to:.5},alpha:{from:1,to:.5},x:a,y:65,delay:600,duration:210,onComplete:function(){e.scoreText.setVisible(!1),e.scoreText.setAlpha(0),e.scoreText.setScale(0),e.scene.handleAddScoreAnim(e.score||0)}})}})},n.playAnimShowScoreText=function(){if(this.tweenHideScoreText&&this.tweenHideScoreText.isPlaying()){var t;this.tweenHideScoreText.stop(),this.scoreText.setPosition(this.startX,this.startY);var e=this.scene.storage.getState(),n=Ml(e),i=0;n===Wr?(i=this.scene.header.mainScoreBlock.score,this.scene.header.mainScoreBlock.setScore(i+(this.score||0)),this.scene.header.mainScoreBlock.setScoreText(i+(this.score||0))):g()(t=[Kr,Xr,jr]).call(t,n)>=0&&(i=this.scene.header.myScoreBlock.score,this.scene.header.myScoreBlock.setScore(i+(this.score||0)),this.scene.header.myScoreBlock.setScoreText(i+(this.score||0)))}this.score=this.listScore.shift()||0,this.scene.handleUpdateScore(this.score),this.scoreText.setScale(0).setAlpha(0).setVisible(!0),this.tweenShowScoreText.play()},n.createPraiseFrame=function(){this.praiseFrame=this.scene.make.image({x:0,y:0,key:bm}),this.praiseFrame.setScale(0),this.praiseFrame.setAlpha(0),this.praiseFrame.setDepth(zs.default.ON_TOP),this.praiseFrame.setVisible(!1)},n.createTweenPraiseFrame=function(){var t=this;if(!this.tweenShowPraiseFrame||!this.tweenHidePraiseFrame){var e=this.praiseFrame.scale;this.tweenShowPraiseFrame=this.scene.tweens.add({paused:!0,targets:this.praiseFrame,scale:{from:0,to:e},alpha:{from:0,to:1},duration:300,delay:100,ease:Phaser.Math.Easing.Back.Out,onComplete:function(){t.tweenHidePraiseFrame.play()}}),this.tweenHidePraiseFrame=this.scene.tweens.add({paused:!0,targets:this.praiseFrame,scale:{from:e,to:0},alpha:{from:1,to:0},duration:300,delay:1e3,onComplete:function(){t.praiseFrame.setScale(0),t.praiseFrame.setAlpha(0),t.praiseFrame.setVisible(!1)}})}},n.playAnimShowPraiseFrame=function(){this.createTweenPraiseFrame(),(this.tweenShowPraiseFrame.isPlaying()||this.tweenHidePraiseFrame.isPlaying())&&(this.tweenShowPraiseFrame.resetTweenData(!1),this.tweenHidePraiseFrame.resetTweenData(!1)),this.praiseFrame.setScale(0).setAlpha(0).setVisible(!0),this.tweenShowPraiseFrame.play()},n.createPraiseScoreText=function(){this.praiseScoreText=this.scene.make.bitmapText({font:Hs.default.PRIMARY.KEY,size:this.scene.fontSize(30),origin:{x:.5,y:.5}}),this.praiseScoreText.setDepth(zs.default.ON_TOP),this.add(this.praiseScoreText),Phaser.Display.Align.In.Center(this.praiseScoreText,this,0,20)},n.handlePraise=function(t,e,n,i){this.startX=t,this.startY=e+15,this.listScore.push(n);var a=t-10;this.scoreText.setPosition(a,e+15),this.scoreText.setText("+"+n),a-this.scoreText.fontSize/2<0&&(a+=this.scoreText.fontSize/2,this.scoreText.setPosition(a,e+15)),this.playAnimShowScoreText(),this.handlePraiseFrameText(t,e,i);var r=this.getVibrateByLevel(i);this.scene.player.getPlayerSettings().vibrate&&rm(r),i<=1||this.changeExplode(a,e,i)},n.getVibrateByLevel=function(t){return Em[t]||0},n.changeExplode=function(t,e,n){var i=this.getExplodeByLevel(n);i&&(this.emitter.setScale({start:.05*i.scale,end:.2*i.scale}),this.emitter.setSpeed({min:30*i.speed,max:80*i.speed}),this.emitter.setQuantity(20*i.quantity)),this.emitter.explode(20*i.quantity,t,e)},n.handlePraiseFrameText=function(t,e,n){var i=this.getMainFrameByLevel(n);if(i){var a=0,r=0;switch(i){case Tm.TEXT_COOL:a=84,r=30;break;case Tm.TEXT_GOOD:a=115.5,r=30;break;case Tm.TEXT_EXCELLENT:a=207,r=30}this.praiseFrame.setFrame(i),this.praiseFrame.setWorldSize(a,r),this.praiseFrame.setPosition(t-a/2<0?a/2:t,e-40),this.playAnimShowPraiseFrame()}},n.getExplodeByLevel=function(t){return Vo[t-1]||Vo[0]||null},n.getMainFrameByLevel=function(t){if(t>6)return gs.default.EFFECTS.FRAME.TEXT_EXCELLENT;var e=Uo[t-1]||Uo[0];return Phaser.Utils.Array.GetRandom(e.frames)},n.reset=function(){this.createTweenScoreText()},e}(Phaser.GameObjects.Container),Cm=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.board=void 0,n.praise=void 0,n.scene=e,e.add.existing((0,ls.default)(n)),n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createBoard(),this.createPraise()},n.createBoard=function(){this.board=new Sm(this.scene,354,352)},n.createPraise=function(){this.praise=new wm(this.scene)},e}(Phaser.GameObjects.Container),Mm=Cm,Im=n(469),Pm=n(470),km=gs.default.DEFAULT,Rm=km.KEY,Om=km.FRAME,_m=function(t){function e(e,n,i,a){var r;return(r=t.call(this,e,n,i,a)||this).glare=void 0,r.bestScoreText=void 0,r.tweenGlare=void 0,r.tweenScoreText=void 0,r.scorePanel=void 0,r.closeButton=void 0,r.popupShowUpAnimation=void 0,r.popupFadeOutAnimation=void 0,r.paperFireworksCelebration=void 0,r.starTwinkle=void 0,r.scene=void 0,r.open=function(e){t.prototype.open.call((0,ls.default)(r),e),r.setVisible(!0),r.runOpenAnimation(),r.paperFireworksCelebration.run(0,r.scene.gameZone.height,375,200),r.scene.audio.playSound(Vs.default.CONGRATULATION),r.setBestScoreText(e.bestScore)},r.handleClosePopup=function(){r.runCloseAnimation(),r.popupFadeOutAnimation.next((function(){r.scene.screen.close(r.name)})),yu.emit("best_score_screen_close")},r.scene=e,r.setVisible(!1),r.setDepth(Gs),r.createContent(),r.createConfetti(),r.createStarTwinkle(),r.background.setAlpha(.5),r}(0,Kt.default)(e,t);var n=e.prototype;return n.handleDelegate=function(){var t=this,e=this.getData(["duration"])[0],n=void 0===e?0:e;this.scene.time.delayedCall(n,(function(){t.runCloseAnimation()}))},n.createConfetti=function(){this.paperFireworksCelebration=new Im.default(this.scene),this.paperFireworksCelebration.setDepth(zs.default.ON_TOP)},n.createStarTwinkle=function(){this.starTwinkle=new Pm.default(this.scene),this.add(this.starTwinkle)},n.runAnim=function(){this.glare.setScale(0).setAlpha(0),this.bestScoreText.setScale(0).setAlpha(0),this.tweenScoreText.play(),this.tweenGlare.play()},n.createContent=function(){this.createCup(),this.createScorePanel(),this.createButtons()},n.createCup=function(){var t=this.scene.make.image({key:Rm,frame:Om.ICON_CUP});t.setWorldSize(290,216),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-105)},n.createScorePanel=function(){this.scorePanel=this.scene.add.container();var t=this.scene.make.image({key:Rm,frame:Om.POPUP_SCORE_PANEL});t.setWorldSize(200,56),this.scorePanel.add(t),this.bestScoreText=this.scene.make.bitmapText({font:Hs.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(60),origin:{x:.5,y:.5}}),this.bestScoreText.setText("0"),this.scorePanel.add(this.bestScoreText),this.add(this.scorePanel),Phaser.Display.Align.In.Center(t,this.scorePanel,0,0),Phaser.Display.Align.In.Center(this.bestScoreText,this.scorePanel,0,1.5),Phaser.Display.Align.In.Center(this.scorePanel,this,0,46.5)},n.createButtons=function(){this.createCloseButton(),this.createCloseBlueButton()},n.createCloseButton=function(){var t=new Ys.default(this.scene,Rm,Om.BUTTON_CLOSE,0,0);t.button.setWorldSize(35,35),t.setName("Close"),this.add(t),t.onClick=this.handleClosePopup,Phaser.Display.Align.In.Center(t,this,126,-213)},n.createCloseBlueButton=function(){this.closeButton=new Ys.default(this.scene,Rm,Om.BUTTON_DARK_BLUE_SMALL,119,46),this.closeButton.onClick=this.handleClosePopup,this.closeButton.setName("Share");var t=this.scene.make.image({key:Rm,frame:Om.TEXT_CLOSE_BLUE});t.setWorldSize(58.5,13),this.closeButton.add(t),this.add(this.closeButton),Phaser.Display.Align.In.Center(t,this.closeButton,0,0),Phaser.Display.Align.In.Center(this.closeButton,this,0,129)},n.setBestScoreText=function(t){this.bestScoreText.setText(""+t)},n.runCloseAnimation=function(){this.runPopupExitsAnimation(0,200)},n.runPopupExitsAnimation=function(t,e){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new $s({targets:[this],delay:t,duration:e,props:{y:250,scale:0},onComplete:function(){i.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.runOpenAnimation=function(){var t=this;this.scene.audio.playSound(Vs.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.scene.time.delayedCall(2e3,(function(){t.scene.postSessionScore()}))},n.runPopupEntrancesAnimation=function(t,e){var n=this;if(!this.popupShowUpAnimation){var i=this.y,a=this.scale;this.popupShowUpAnimation=new so({targets:[this],delay:t,duration:e,props:{y:{from:350,to:i},alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:a}},onComplete:function(){n.starTwinkle.run(1,0,-108,290,216),n.handleDelegate()}})}this.popupShowUpAnimation.play()},e}(GameCore.Screen),Dm=_m,Lm=n(471),Bm=gs.default.DEFAULT,Fm=Bm.KEY,Nm=Bm.FRAME,Gm=function(t){function e(e){var n;return(n=t.call(this,e,Fm,Nm.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Home"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:Fm,frame:Nm.ICON_HOME});t.setWorldSize(31,28),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-2)},e}(Ys.default),Um=Gm,Vm=gs.default.DEFAULT,Ym=Vm.KEY,zm=Vm.FRAME,Hm=function(t){function e(e){var n;return(n=t.call(this,e,Ym,zm.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Share"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:Ym,frame:zm.ICON_SHARE});t.setWorldSize(24,31),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-2)},e}(Ys.default),Wm=Hm,Xm=gs.default.DEFAULT,Km=Xm.KEY,jm=Xm.FRAME,qm=function(t){function e(e){var n;return(n=t.call(this,e,Km,jm.BUTTON_DARK_BLUE_BIG)||this).button.setWorldSize(120,55),n.setName("PlayWithFriends"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:Km,frame:jm.ICON_SWORD_BLUE});t.setWorldSize(22,20),this.add(t),Phaser.Display.Align.In.Center(t,this,-40)},n.createText=function(){var t=this.scene.make.image({key:Km,frame:jm.TEXT_PLAY_WITH_BLUE});t.setWorldSize(159.5,15.5),this.add(t),Phaser.Display.Align.In.Center(t,this,12)},e}(Ys.default),Zm=qm,Jm=gs.default.DEFAULT,Qm=Jm.KEY,$m=Jm.FRAME,tv=function(t){function e(e){var n;return(n=t.call(this,e,Qm,$m.BUTTON_GREEN_BIG)||this).button.setWorldSize(120,55),n.setName("Play"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:Qm,frame:$m.ICON_I_PLAY});t.setWorldSize(22,27),this.add(t),Phaser.Display.Align.In.Center(t,this,-35,-2)},n.createText=function(){var t=this.scene.make.image({key:Qm,frame:$m.TEXT_PLAY});t.setWorldSize(74,17),this.add(t),Phaser.Display.Align.In.Center(t,this,15,-2)},e}(Ys.default),ev=tv,nv=gs.default.DEFAULT,iv=nv.KEY,av=nv.FRAME,rv=function(t){function e(e){var n;return(n=t.call(this,e)||this).popup=void 0,n.avatarMe=void 0,n.textScoreMe=void 0,n.avatarOpponent=void 0,n.textScoreOpponent=void 0,n.title=void 0,n.titleFrame=void 0,n.contents=void 0,n.popupShowUpAnimation=void 0,n.contentShowUpAnimation=void 0,n.popupFadeOutAnimation=void 0,n.myInfoBlock=void 0,n.tweenMyInfoBlock=void 0,n.opponentInfoBlock=void 0,n.tweenOpponentInfoBlock=void 0,n.icon=void 0,n.tweenIcon=void 0,n.iconCrown=void 0,n.tweenIconCrown=void 0,n.playWithFriendsButton=void 0,n.playButton=void 0,n.homeButton=void 0,n.shareButton=void 0,n.buttonClose=void 0,n.clickPlayWithFriends=function(){n.runCloseAnimation(),n.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.scene.storage.dispatch(qd());case 2:yu.emit(Ec.REPLAY);case 3:case"end":return t.stop()}}),t)}))))},n.clickPlay=function(){n.runCloseAnimation(),n.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.scene.storage.dispatch(Hd());case 2:yu.emit(Ec.REPLAY);case 3:case"end":return t.stop()}}),t)}))))},n.clickShare=function(){n.scene.storage.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,r,s,o,h,c,l,u,d,p,f;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=window.game,a=i.player,r=i.analytics,s=i.facebook,o=i.globalScene,h=i.lang,t.prev=1,o.screen.open(vs,{message:h.Text.LOADING,loading:!0}),c=n(),t.next=6,Mu(c);case 6:return l=t.sent,Eu(l),u=a.getPlayer(),d=u.playerId,p=u.name,f=u.photo,t.next=12,s.shareAsync({text:h.Text.SHARE_GAME_RESULTS,intent:"SHARE",image:l||"",data:{playerId:d,playerName:p,playerPhoto:f,type:Nr}});case 12:r.event(ni.AnalyticsEvents.SHARE,{share_content_type:"MatchResult",success:!0}),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(1),r.event(ni.AnalyticsEvents.SHARE,{share_content_type:"MatchResult",success:!1}),(0,Ht.sendException)(t.t0);case 19:return t.prev=19,o.screen.close(vs),t.finish(19);case 22:case"end":return t.stop()}}),t,null,[[1,15,19,22]])})));return function(e,n){return t.apply(this,arguments)}}())},n.handleShareBestScore=function(){n.scene.storage.dispatch(xu())},n.createPopup(),n.createPopupContent(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createPopup=function(){this.popup=new uo(this.scene,0,0,290,290,{forceHeightTop:54}),this.add(this.popup)},n.createPopupContent=function(){this.createTitle(),this.createContentBackground(),this.createMyInfoBlock(),this.createOpponentInfoBlock(),this.createIcon(),this.createIconCrown(),this.createButtons(),this.popup.add([this.title]),this.contents=this.scene.make.group({}),this.contents.addMultiple([this.homeButton,this.playWithFriendsButton,this.playButton,this.shareButton])},n.updateButtons=function(){try{this.checkExistConnectedPlayerId()?(this.playWithFriendsButton.setVisible(!0),this.playButton.setVisible(!1)):(this.playWithFriendsButton.setVisible(!1),this.playButton.setVisible(!0))}catch(t){}},n.createTitle=function(){this.title=this.scene.add.container(),this.titleFrame=this.scene.make.image({key:iv,frame:av.TEXT_WAITING_OPPONENT}),this.titleFrame.setWorldSize(238,25),Phaser.Display.Align.In.Center(this.titleFrame,this.title,0,10),this.buttonClose=new Ys.default(this.scene,iv,av.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),Phaser.Display.Align.In.RightCenter(this.buttonClose,this.title,155,-12),this.title.add([this.titleFrame,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,-2)},n.createContentBackground=function(){var t=this.scene.make.image({key:iv,frame:av.POPUP_CONTENT_BACKGROUND});t.setWorldSize(263,140),this.popup.add(t),Phaser.Display.Align.In.Center(t,this.popup,0,-30)},n.createButtons=function(){this.createButtonHome(),this.createButtonPlayWithFriend(),this.createButtonPlay(),this.createButtonShare()},n.createButtonHome=function(){this.homeButton=new Um(this.scene),this.homeButton.onClick=this.clickHome.bind(this),this.popup.add(this.homeButton),Phaser.Display.Align.In.Center(this.homeButton,this.popup,-100,80)},n.clickHome=function(){this.scene.scene.switch(is.SceneKeys.DASHBOARD_SCENE)},n.createButtonPlayWithFriend=function(){this.playWithFriendsButton=new Zm(this.scene),this.playWithFriendsButton.onClick=this.clickPlayWithFriends,this.playWithFriendsButton.setVisible(!1),this.popup.add(this.playWithFriendsButton),Phaser.Display.Align.In.Center(this.playWithFriendsButton,this.popup,0,80)},n.createButtonPlay=function(){this.playButton=new ev(this.scene),this.playButton.onClick=this.clickPlay,this.playButton.setVisible(!1),this.popup.add(this.playButton),Phaser.Display.Align.In.Center(this.playButton,this.popup,0,80)},n.createButtonShare=function(){this.shareButton=new Wm(this.scene),this.shareButton.onClick=this.clickShare,this.popup.add(this.shareButton),Phaser.Display.Align.In.Center(this.shareButton,this.popup,100,80)},n.createMyInfoBlock=function(){this.myInfoBlock=this.scene.add.container(),this.avatarMe=new bl(this.scene,{key:iv,frame:av.AVATAR_BORDER_BIG,background:av.AVATAR_BACKGROUND,width:87,height:87,borderWidth:8}),this.myInfoBlock.add(this.avatarMe),Phaser.Display.Align.In.Center(this.avatarMe,this.myInfoBlock,0,0);var t=this.scene.make.image({key:iv,frame:av.SCORE_PANEL_DARK});t.setWorldSize(95,26),this.myInfoBlock.add(t),Phaser.Display.Align.In.BottomCenter(t,this.avatarMe,0,10),this.textScoreMe=this.scene.make.bitmapText({font:Hs.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(42),text:"0",origin:{x:.5,y:.5}}),this.myInfoBlock.add(this.textScoreMe),Phaser.Display.Align.In.Center(this.textScoreMe,t),this.popup.add(this.myInfoBlock),Phaser.Display.Align.In.Center(this.myInfoBlock,this.popup,-72,-38),this.myInfoBlock.setAlpha(0),this.tweenMyInfoBlock=this.scene.tweens.add({targets:this.myInfoBlock,paused:!0,duration:200,delay:400,scale:{from:1.5,to:1},alpha:{from:0,to:1},ease:Phaser.Math.Easing.Bounce.Out})},n.createOpponentInfoBlock=function(){this.opponentInfoBlock=this.scene.add.container(),this.avatarOpponent=new bl(this.scene,{key:iv,frame:av.AVATAR_BORDER_BIG,background:av.AVATAR_BACKGROUND,width:87,height:87,borderWidth:8}),this.opponentInfoBlock.add(this.avatarOpponent),Phaser.Display.Align.In.Center(this.avatarOpponent,this.opponentInfoBlock,0,0);var t=this.scene.make.image({key:iv,frame:av.SCORE_PANEL_DARK});t.setWorldSize(95,26),this.opponentInfoBlock.add(t),Phaser.Display.Align.In.BottomCenter(t,this.avatarOpponent,0,10),this.textScoreOpponent=this.scene.make.bitmapText({font:Hs.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(42),text:"0",origin:{x:.5,y:.5}}),this.opponentInfoBlock.add(this.textScoreOpponent),Phaser.Display.Align.In.Center(this.textScoreOpponent,t),this.popup.add(this.opponentInfoBlock),Phaser.Display.Align.In.Center(this.opponentInfoBlock,this.popup,72,-38),this.opponentInfoBlock.setAlpha(0),this.tweenOpponentInfoBlock=this.scene.tweens.add({targets:this.opponentInfoBlock,paused:!0,duration:200,delay:500,scale:{from:1.5,to:1},alpha:{from:0,to:1},ease:Phaser.Math.Easing.Bounce.Out})},n.createIcon=function(){this.icon=this.scene.make.image({key:iv,frame:av.TEXT_VS}),this.icon.setWorldSize(86,16.5);var t=this.icon.scale;this.popup.add(this.icon),Phaser.Display.Align.In.Center(this.icon,this.popup,0,-30),this.icon.setAlpha(0),this.tweenIcon=this.scene.tweens.add({targets:this.icon,paused:!0,duration:200,delay:300,scale:{from:1.5,to:t},alpha:{from:0,to:1},ease:"Power1"})},n.createIconCrown=function(){this.iconCrown=this.scene.make.image({key:iv,frame:av.ICON_CROWN_BIG}),this.iconCrown.setWorldSize(50,46),this.iconCrown.setVisible(!1);var t=this.iconCrown.scale;this.popup.add(this.iconCrown),this.iconCrown.setScale(0),this.tweenIconCrown=this.scene.tweens.add({targets:this.iconCrown,paused:!0,duration:200,delay:300,scale:{from:1.5,to:t},alpha:{from:0,to:1},ease:"Power1"})},n.runCloseAnimation=function(){this.runPopupExitsAnimation(0,200)},n.runPopupExitsAnimation=function(t,e){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new $s({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){i.popup.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.runOpenAnimation=function(){this.scene.audio.playSound(Vs.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runPopupContentEntrancesAnimation(200,300)},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new so({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){this.contentShowUpAnimation||(this.contentShowUpAnimation=new io({targets:this.contents.getChildren(),duration:e,delay:this.scene.tweens.stagger(80,{start:t}),props:{alpha:{start:0,from:0,to:1}}})),this.contentShowUpAnimation.play()},n.updateInfo=function(){var t=this.scene.storage.getState(),e=pu(t),n=this.scene.player.getPlayer().playerId,i=iu(t).playerId,a=ru(t,{playerId:n}),r=su(t,{opponentId:i}),s=(e[n]||{}).score,o=void 0===s?0:s,h=(e[i]||{}).score,c=void 0===h?0:h;return this.textScoreMe.setText(String(o)),this.textScoreOpponent.setText(String(c)),a&&r?o===c?(this.titleFrame.setFrame(av.TEXT_DRAW),this.titleFrame.setWorldSize(83.5,20.5),void this.scene.audio.playSound(Vs.default.DRAW)):o>c?(this.titleFrame.setFrame(av.TEXT_WIN),this.titleFrame.setWorldSize(182.5,25),this.iconCrown.setVisible(!0),Phaser.Display.Align.In.Center(this.iconCrown,this.avatarMe,-110,-80),void this.scene.audio.playSound(Vs.default.WIN)):o<c?(this.titleFrame.setFrame(av.TEXT_LOSE),this.titleFrame.setWorldSize(193.5,20.5),this.iconCrown.setVisible(!0),Phaser.Display.Align.In.Center(this.iconCrown,this.avatarOpponent,35,-80),void this.scene.audio.playSound(Vs.default.LOSE)):void 0:(this.titleFrame.setFrame(av.TEXT_WAITING_OPPONENT),this.titleFrame.setWorldSize(238,25),void this.scene.audio.playSound(Vs.default.WAIT_OPPONENT))},n.loadAvatars=function(){var t=this.scene.storage.getState(),e=this.scene.player.getPlayer(),n=e.photo,i=e.playerId,a=iu(t),r=a.playerId,s=a.photo;this.avatarMe.loadPhoto(i,n,5),this.avatarOpponent.loadPhoto(r,s,5)},n.runAnim=function(){this.icon.setVisible(!0),this.myInfoBlock.setVisible(!0),this.opponentInfoBlock.setVisible(!0),this.iconCrown.setScale(0),this.tweenIconCrown.play(),this.tweenIcon.play(),this.tweenMyInfoBlock.play(),this.tweenOpponentInfoBlock.play()},n.checkExistConnectedPlayerId=function(){var t=this,e=this.scene.player.getConnectedPlayerIds(20,0);return!(c()(e).call(e,(function(e){return e!==t.scene.player.getPlayerId()})).length<=Fd.length)},e}(Phaser.GameObjects.Container),sv=rv,ov={targets:[],yoyo:!0,duration:120,ease:Phaser.Math.Easing.Circular.Out,props:{scale:{from:1,to:1.3}}},hv=function(t){function e(e){return t.call(this,ov,e)||this}return(0,Kt.default)(e,t),e}(Zs.default),cv=hv,lv=gs.default.DEFAULT,uv=lv.KEY,dv=lv.FRAME,pv=function(t){function e(e){var n;return(n=t.call(this,e,uv,dv.BUTTON_MINOR)||this).button.setWorldSize(62,53),n.setName("JourneyIcon"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:uv,frame:dv.ICON_BROWN_JOURNEY});t.setWorldSize(28,26),this.add(t),Phaser.Display.Align.In.Center(t,this)},e}(Ys.default),fv=pv,gv=gs.default.DEFAULT,mv=gv.KEY,vv=gv.FRAME,yv=function(t){function e(e){var n;return(n=t.call(this,e)||this).popup=void 0,n.title=void 0,n.contents=void 0,n.scoreText=void 0,n.bestScoreText=void 0,n.tweenScoreText=void 0,n.popupShowUpAnimation=void 0,n.contentShowUpAnimation=void 0,n.popupFadeOutAnimation=void 0,n.scoreBlock=void 0,n.bestScoreBlock=void 0,n.playWithFriendsButton=void 0,n.playButton=void 0,n.homeButton=void 0,n.journeyButton=void 0,n.bestScore=void 0,n.currentScore=void 0,n.payload=void 0,n.buttonClose=void 0,n.counterAnimation=void 0,n.scoreAnimation=void 0,n.clickPlayWithFriends=function(){n.runCloseAnimation(),n.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.scene.storage.dispatch(qd());case 2:yu.emit(Ec.REPLAY);case 3:case"end":return t.stop()}}),t)}))))},n.clickPlay=function(){n.runCloseAnimation(),n.scene.storage.dispatch(Hd()),yu.emit(Ec.REPLAY)},n.clickJourney1=function(){n.scene.scene.switch(is.SceneKeys.LEVEL_SCENE)},n.initScore(),n.scene=e,n.createPopup(),n.createPopupContent(),n.createScoreAnimation(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createPopup=function(){this.popup=new uo(this.scene,0,0,290,290,{forceHeightTop:54}),this.add(this.popup)},n.createPopupContent=function(){this.createTitle(),this.createScoreBlock(),this.createBestScoreBlock(),this.createButtons(),this.contents=this.scene.make.group({}),this.contents.addMultiple([this.homeButton,this.playWithFriendsButton,this.playButton,this.journeyButton])},n.updateButtons=function(){try{this.playWithFriendsButton.setVisible(!1),this.playButton.setVisible(!0)}catch(t){}},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:mv,frame:vv.TEXT_YOUR_SCORE});t.setWorldSize(124.5,20.5),Phaser.Display.Align.In.Center(t,this.title,0,10),this.buttonClose=new Ys.default(this.scene,mv,vv.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),Phaser.Display.Align.In.RightCenter(this.buttonClose,this.title,155,-12),this.title.add([t,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,-2)},n.createScoreBlock=function(){this.scoreBlock=this.scene.add.container();var t=this.scene.make.image({key:mv,frame:vv.SCORE_PANEL});t.setWorldSize(263,70),this.scoreBlock.add(t),this.scoreText=this.scene.make.bitmapText({font:Hs.default.PRIMARY.KEY,size:this.scene.fontSize(85),text:"0",origin:{x:.5,y:.5}}),this.scoreBlock.add(this.scoreText),Phaser.Display.Align.In.Center(this.scoreText,this.scoreBlock,0,4),this.popup.add(this.scoreBlock),Phaser.Display.Align.In.TopCenter(this.scoreBlock,this.popup,0,-78)},n.createBestScoreBlock=function(){this.bestScoreBlock=this.scene.add.container();var t=this.scene.make.image({key:mv,frame:vv.BEST_SCORE_FRAME_LONG});t.setWorldSize(193,77),this.bestScoreBlock.add(t),this.bestScoreText=this.scene.make.bitmapText({font:Hs.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(44),text:"0",origin:{x:.5,y:.5}}),this.bestScoreBlock.add(this.bestScoreText),Phaser.Display.Align.In.Center(this.bestScoreText,this.bestScoreBlock,0,16),this.popup.add(this.bestScoreBlock),Phaser.Display.Align.In.Center(this.bestScoreBlock,this.scoreBlock,0,65)},n.createButtons=function(){this.createButtonHome(),this.createButtonPlayWithFriend(),this.createButtonPlay(),this.createButtonJourney()},n.createButtonHome=function(){this.homeButton=new Um(this.scene),this.homeButton.onClick=this.clickHome.bind(this),this.popup.add(this.homeButton),Phaser.Display.Align.In.Center(this.homeButton,this.bestScoreBlock,-100,80)},n.clickHome=function(){this.scene.scene.switch(is.SceneKeys.DASHBOARD_SCENE)},n.createButtonPlayWithFriend=function(){this.playWithFriendsButton=new Zm(this.scene),this.playWithFriendsButton.onClick=this.clickPlayWithFriends,this.playWithFriendsButton.setVisible(!1),this.popup.add(this.playWithFriendsButton),Phaser.Display.Align.In.Center(this.playWithFriendsButton,this.bestScoreBlock,0,80)},n.createButtonPlay=function(){this.playButton=new ev(this.scene),this.playButton.onClick=this.clickPlay,this.playButton.setVisible(!1),this.popup.add(this.playButton),Phaser.Display.Align.In.Center(this.playButton,this.bestScoreBlock,0,80)},n.createButtonJourney=function(){this.journeyButton=new fv(this.scene),this.journeyButton.onClick=this.clickJourney1,this.popup.add(this.journeyButton),Phaser.Display.Align.In.Center(this.journeyButton,this.bestScoreBlock,100,80)},n.runCloseAnimation=function(){this.runPopupExitsAnimation(0,200)},n.runPopupExitsAnimation=function(t,e){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new $s({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){i.popup.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.setBestScore=function(t){this.bestScoreText.setText(""+t)},n.runOpenAnimation=function(){this.scene.audio.playSound(Vs.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runPopupContentEntrancesAnimation(200,300)},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup,i=(n.y,n.scale);this.popupShowUpAnimation=new so({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){this.contentShowUpAnimation||(this.contentShowUpAnimation=new io({targets:this.contents.getChildren(),duration:e,delay:this.scene.tweens.stagger(80,{start:t}),props:{alpha:{start:0,from:0,to:1}}})),this.contentShowUpAnimation.play()},n.initScore=function(){var t=this.scene.player.getBestScore();this.bestScore=t,this.currentScore=0},n.updateScore=function(){var t=this.scene.storage.getState(),e=fu(t),n=e.score,i=e.bestScore;if(void 0===n&&void 0===i){var a=pu(t)[this.scene.player.getPlayerId()];n=(null==a?void 0:a.score)||0,i=this.scene.player.getBestScore()}this.bestScore=(i||0)<this.bestScore?this.bestScore:i||0,this.currentScore=n,this.updateData({bestScore:this.bestScore,currentScore:this.currentScore})},n.updateData=function(t){this.payload=t;var e=t.bestScore,n=t.currentScore;if(this.setBestScore(e),n<=e)return this.setCurrentScore(0),this.runScoreAnimation(),void(n>0?this.runScoreCounter():this.counterAnimation=null);this.runAnimation()},n.runAnimation=function(){this.runScoreCounter()},n.runScoreAnimation=function(){this.scoreAnimation.play()},n.createScoreAnimation=function(){this.scoreAnimation=new cv({targets:[this.scoreText],props:{scale:{from:1,to:1.3}}})},n.runScoreCounter=function(){var t,e=this,n=this.payload,i=n.bestScore,a=n.currentScore;null==(t=this.counterAnimation)||t.remove(),this.counterAnimation=this.scene.tweens.addCounter({from:0,to:a,delay:700,duration:2e3,completeDelay:300,onUpdate:function(t){e.scene.audio.playSound(Vs.default.SCORE_COUNT);var n=Math.floor(t.getValue());e.runScoreAnimation(),e.setCurrentScore(n)},onComplete:function(){e.setBestScore(i<a?a:i),e.setCurrentScore(a)}})},n.setCurrentScore=function(t){this.scoreText.setText(""+t)},e}(Phaser.GameObjects.Container),Sv=yv,Av=(GameCore.Configs.LeadersBoard,gs.default.DEFAULT),Ev=(Av.KEY,Av.FRAME,function(t){function e(e,n,i,a){var r;return(r=t.call(this,e,n,i,a)||this).bestScore=void 0,r.currentScore=void 0,r.confettiLeftEffect=void 0,r.confettiRightEffect=void 0,r.queueScreens=[],r.popupYourScore=void 0,r.popupResult=void 0,r.popupFadeInMaskAnimation=void 0,r.popupFadeOutMaskAnimation=void 0,r.open=function(){t.prototype.open.call((0,ls.default)(r)),r.popupYourScore.setVisible(!1),r.popupResult.setVisible(!1),r.runFadeInMaskAnimation(100,300),r.initScore(),r.updateScore(),r.showPopupYourScore(),r.scene.audio.playSound(Vs.default.GAME_OVER_SCENE)},r.onPopupClose=function(){var t,e;null==(t=r.popupYourScore)||t.runCloseAnimation(),null==(e=r.popupResult)||e.runCloseAnimation(),r.runFadeOutMaskAnimation(0,200),r.scene.time.delayedCall(300,(function(){r.close(),r.scene.screen.open(ws,{onClose:function(){r.scene.storage.dispatch(Hd()),yu.emit(Ec.START_GAME)}})}))},r.createConfettiSmallAnimation(),r.createPopups(),r.setDepth(Gs),r.background.setAlpha(.5),r}(0,Kt.default)(e,t);var n=e.prototype;return n.showQueueScreens=function(){var t=this.queueScreens.pop();if(t&&t===Es)this.showPopupResult()},n.showPopupBestScore=function(){},n.showPopupYourScore=function(){this.popupYourScore.setVisible(!0),this.popupYourScore.runOpenAnimation(),this.popupYourScore.updateButtons(),this.popupYourScore.updateScore()},n.showPopupResult=function(){this.popupResult.setVisible(!0),this.popupResult.runOpenAnimation(),this.popupResult.updateInfo(),this.popupResult.loadAvatars(),this.popupResult.updateButtons(),this.popupResult.runAnim()},n.updateQueueScreens=function(){this.updateQueueResultScreen()},n.updateQueueResultScreen=function(){var t,e=this.scene.storage.getState(),n=Ml(e);if(-1!==g()(t=[Xr,Kr,jr]).call(t,n)&&eu(e)){var i=iu(e).playerId;n===Kr&&i===Hr.playerId||this.queueScreens.push(Es)}},n.createPopups=function(){this.createPopupYourScore(),this.createPopupResult()},n.createPopupYourScore=function(){this.popupYourScore=new Sv(this.scene),this.popupYourScore.setVisible(!1),this.popupYourScore.buttonClose.onClick=this.onPopupClose,this.add(this.popupYourScore),Phaser.Display.Align.In.Center(this.popupYourScore,this,0,0)},n.createPopupResult=function(){this.popupResult=new sv(this.scene),this.popupResult.setVisible(!1),this.popupResult.buttonClose.onClick=this.onPopupClose,this.add(this.popupResult),Phaser.Display.Align.In.Center(this.popupResult,this,0,-61)},n.createConfettiSmallAnimation=function(){this.confettiLeftEffect=new Lm.default(this.scene,{speedX:{min:-20,max:100},rotate:{start:-1080,end:0}}),this.confettiRightEffect=new Lm.default(this.scene,{speedX:{min:20,max:-100},rotate:{start:0,end:1080}}),this.confettiLeftEffect.setDepth(zs.default.ON_TOP),this.confettiRightEffect.setDepth(zs.default.ON_TOP)},n.initScore=function(){var t=this.scene.player.getBestScore();this.bestScore=t,this.currentScore=0},n.updateScore=function(){var t=this.scene.storage.getState(),e=fu(t),n=e.score,i=e.bestScore;if(this.bestScore=i,void 0===n||void 0===i){var a=pu(t)[this.scene.player.getPlayerId()];n=(null==a?void 0:a.score)||0,i=this.scene.player.getBestScore()}this.bestScore=(i||0)<this.bestScore?this.bestScore:i||0,this.currentScore=n},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Tc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new $s({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen)),xv=Ev,bv=n(248),Tv=n.n(bv),wv=function(t){return t.lives},Cv=(0,be.createSelector)([function(t){return wv(t).lives}],(function(t){return t})),Mv=(0,be.createSelector)([function(t){return wv(t).lastBonusLifeTime}],(function(t){return t})),Iv=(0,be.createSelector)([function(t){return wv(t).countDownStartAt}],(function(t){return t})),Pv=GameCore.Configs,kv=Pv.Match,Rv=Pv.Lives,Ov=function(t){return function(e){setTimeout((function(){e(Lv()),e(Dv()),e(_v())}),t)}},_v=function(){return function(t){var e=60*Rv.bonusDurationMins*1e3;setInterval((function(){t(Lv()),t(Dv())}),e)}},Dv=function(){return function(t){t({type:mr,payload:{}})}},Lv=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,r,s,o,h,c;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game.player,a=i.getPlayer(),r=a.playerId,s=n(),o=Cv(s),(h=Rv.bonusLife+o)>Rv.livesCapacity&&(h=Rv.livesCapacity),c={lives:h,lastBonusLifeTime:(new Date).getTime()},e({type:fr,payload:{data:c}}),t.next=11,window.FBInstant.player.setDataAsync({lives:c});case 11:Be(kv.LivesStore+"-"+r,c),t.next=16;break;case 14:t.prev=14,t.t0=t.catch(0);case 16:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e,n){return t.apply(this,arguments)}}()},Bv=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,r,s,o,h,c,l;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game.player,a=i.getPlayer(),r=a.playerId,s=n(),o=Cv(s),h=Mv(s),(c=o-Rv.bonusLife)>Rv.livesCapacity&&(c=Rv.livesCapacity),c<0&&(c=0),e({type:fr,payload:{data:l={lives:c,lastBonusLifeTime:h}}}),t.next=13,window.FBInstant.player.setDataAsync({lives:l});case 13:Be(kv.LivesStore+"-"+r,l),t.next=18;break;case 16:t.prev=16,t.t0=t.catch(0);case 18:case"end":return t.stop()}}),t,null,[[0,16]])})));return function(e,n){return t.apply(this,arguments)}}()},Fv=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,r,s,o,h,c;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,i=n(),a=Cv(i)||0,r=Mv(i)){t.next=8;break}return t.next=7,e(Nv({lives:a,lastBonusLifeTime:(new Date).getTime()}));case 7:return t.abrupt("return");case 8:return s=(new Date).getTime(),o=Math.floor((s-r)/1e3/(60*Rv.bonusDurationMins)),(h=o+a)>Rv.livesCapacity&&(h=Rv.livesCapacity),c={lives:h,lastBonusLifeTime:h===a?r:(new Date).getTime()},t.next=15,e(Nv(c));case 15:t.next=19;break;case 17:t.prev=17,t.t0=t.catch(0);case 19:case"end":return t.stop()}}),t,null,[[0,17]])})));return function(e,n){return t.apply(this,arguments)}}()},Nv=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n){var i,a,r;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=window.game.player,a=i.getPlayer(),r=a.playerId,n({type:fr,payload:{data:t}}),e.next=5,window.FBInstant.player.setDataAsync({lives:t});case 5:Be(kv.LivesStore+"-"+r,t);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},Gv=n(63),Uv=gs.default.GAMEPLAY_32.FRAME,Vv="vertical",Yv="horizontal",zv="left",Hv="right",Wv="top",Xv="bottom",Kv="vertical_left",jv="vertical_right",qv="horizontal_left",Zv="horizontal_right",Jv="gem/gem",Qv="gem/diamond/diamond-10",$v="gem/diamond/diamond-11",ty="gem/diamond/diamond-12",ey="gem/diamond/diamond-13",ny="gem/diamond/diamond-14",iy="gem/diamond/diamond-15",ay="gem/ruby/ruby-20",ry="gem/sapphire/sapphire-30",sy=[{level:1,frames:[],width:480,height:189},{level:2,frames:[gs.default.EFFECTS.FRAME.TEXT_COOL],width:480,height:189},{level:3,frames:[gs.default.EFFECTS.FRAME.TEXT_GOOD],width:579,height:189},{level:4,frames:[gs.default.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189},{level:5,frames:[gs.default.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189},{level:6,frames:[gs.default.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189}],oy=[{level:1,scale:.5,speed:.5,quantity:.5},{level:2,scale:.6,speed:.6,quantity:.6},{level:3,scale:.7,speed:.7,quantity:.7},{level:4,scale:.8,speed:.8,quantity:.8},{level:5,scale:.9,speed:.9,quantity:.9},{level:6,scale:1,speed:1,quantity:1}],hy="l",cy="l_1",ly="l_3",uy="line_2",dy="line_3",py="line_4",fy="line_5",gy="square_1",my="square_2",vy="square_3",yy="trapezoid",Sy="triangle",Ay="t_piece",Ey="plus_piece",xy="cross_piece_2",by="cross_piece_3",Ty="cross_piece_4",wy="cross_piece_5",Cy="u_piece",My=[hy,cy,ly,uy,dy,py,fy,gy,my,vy,Sy,yy,Ay,Ey,xy,by,Ty,wy,Cy],Iy=[{type:hy,rate:3},{type:cy,rate:4},{type:ly,rate:2},{type:uy,rate:16},{type:dy,rate:12},{type:py,rate:8},{type:fy,rate:4},{type:gy,rate:16},{type:my,rate:8},{type:Sy,rate:4},{type:yy,rate:4},{type:Ay,rate:2},{type:Ey,rate:1},{type:xy,rate:4},{type:by,rate:2},{type:Ty,rate:1},{type:Cy,rate:2}],Py=[[1,0],[1,0],[1,1]],ky=[[0,1],[0,1],[1,1]],Ry=[[1,0],[1,1]],Oy=[[1,0,0],[1,0,0],[1,1,1]],_y=[[1,1,1],[1,0,0]],Dy=[[1,1,1],[0,0,1]],Ly=[[1,1],[1,0]],By=[[1,1,1],[1,0,0],[1,0,0]],Fy=[[1,1],[0,1],[0,1]],Ny=[[1,1],[1,0],[1,0]],Gy=[[1,1],[0,1]],Uy=[[1,1,1],[0,0,1],[0,0,1]],Vy=[[0,0,1],[1,1,1]],Yy=[[1,0,0],[1,1,1]],zy=[[0,1],[1,1]],Hy=[[0,0,1],[0,0,1],[1,1,1]],Wy=[[1],[1]],Xy=[[1,1]],Ky=[[1],[1],[1]],jy=[[1,1,1]],qy=[[1],[1],[1],[1]],Zy=[[1,1,1,1]],Jy=[[1],[1],[1],[1],[1]],Qy=[[1,1,1,1,1]],$y=[[1]],tS=[[1,1],[1,1]],eS=[[1,1,1],[1,1,1],[1,1,1]],nS=[[1,0],[1,1],[0,1]],iS=[[0,1],[1,1],[1,0]],aS=[[1,1,0],[0,1,1]],rS=[[0,1,1],[1,1,0]],sS=[[0,1],[1,1],[0,1]],oS=[[1,0],[1,1],[1,0]],hS=[[0,1,0],[1,1,1]],cS=[[1,1,1],[0,1,0]],lS=[[0,0,1],[1,1,1],[0,0,1]],uS=[[1,0,0],[1,1,1],[1,0,0]],dS=[[0,1,0],[0,1,0],[1,1,1]],pS=[[1,1,1],[0,1,0],[0,1,0]],fS=[[0,1,0],[1,1,1],[0,1,0]],gS=[[1,0],[0,1]],mS=[[0,1],[1,0]],vS=[[1,0,0],[0,1,0],[0,0,1]],yS=[[0,0,1],[0,1,0],[1,0,0]],SS=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],AS=[[0,0,0,1],[0,0,1,0],[0,1,0,0],[1,0,0,0]],ES=[[1,0,0,0,0],[0,1,0,0,0],[0,0,1,0,0],[0,0,0,1,0],[0,0,0,0,1]],xS=[[0,0,0,0,1],[0,0,0,1,0],[0,0,1,0,0],[0,1,0,0,0],[1,0,0,0,0]],bS=[[1,1],[0,1],[1,1]],TS=[[1,1],[1,0],[1,1]],wS=[[1,0,1],[1,1,1]],CS=[[1,1,1],[1,0,1]],MS={1:Uv.GEM,10:Uv.GEM_DIAMOND_10,11:Uv.GEM_DIAMOND_11,12:Uv.GEM_DIAMOND_12,13:Uv.GEM_DIAMOND_13,14:Uv.GEM_DIAMOND_14,15:Uv.GEM_DIAMOND_15},IS={1:{type:gy,direction:null,isReverse:!1,data:$y},I2:{type:uy,direction:Vv,isReverse:!1,data:Wy},I3:{type:dy,direction:Vv,isReverse:!1,data:Ky},I4:{type:py,direction:Vv,isReverse:!1,data:qy},I5:{type:fy,direction:Vv,isReverse:!1,data:Jy},II2:{type:uy,direction:Yv,isReverse:!1,data:Xy},II3:{type:dy,direction:Yv,isReverse:!1,data:jy},II4:{type:py,direction:Yv,isReverse:!1,data:Zy},II5:{type:fy,direction:Yv,isReverse:!1,data:Qy},J1:{type:hy,direction:Wv,isReverse:!0,data:Py},J2:{type:hy,direction:zv,isReverse:!0,data:Yy},J3:{type:hy,direction:Xv,isReverse:!0,data:Ny},J4:{type:hy,direction:Hv,isReverse:!0,data:Dy},L1:{type:hy,direction:Wv,isReverse:!1,data:Py},L2:{type:hy,direction:Hv,isReverse:!1,data:_y},L3:{type:hy,direction:Xv,isReverse:!1,data:Fy},L4:{type:hy,direction:zv,isReverse:!1,data:Vy},O:{type:my,direction:null,isReverse:!1,data:tS},"polyplet-left-2":{type:xy,direction:zv,isReverse:!1,data:gS},"polyplet-left-3":{type:by,direction:zv,isReverse:!1,data:vS},"polyplet-left-4":{type:Ty,direction:zv,isReverse:!1,data:SS},"polyplet-left-5":{type:wy,direction:zv,isReverse:!1,data:ES},"polyplet-right-2":{type:xy,direction:Hv,isReverse:!1,data:mS},"polyplet-right-3":{type:by,direction:Hv,isReverse:!1,data:yS},"polyplet-right-4":{type:Ty,direction:Hv,isReverse:!1,data:AS},"polyplet-right-5":{type:wy,direction:Hv,isReverse:!1,data:xS},S1:{type:yy,direction:Zv,isReverse:!1,data:rS},S2:{type:yy,direction:Kv,isReverse:!1,data:nS},T1:{type:Sy,direction:Wv,isReverse:!1,data:hS},T2:{type:Sy,direction:Hv,isReverse:!1,data:oS},T3:{type:Sy,direction:Xv,isReverse:!1,data:cS},T4:{type:Sy,direction:zv,isReverse:!1,data:sS},TT1:{type:Ay,direction:Xv,isReverse:!1,data:pS},TT2:{type:Ay,direction:zv,isReverse:!1,data:lS},TT3:{type:Ay,direction:Wv,isReverse:!1,data:dS},TT4:{type:Ay,direction:Hv,isReverse:!1,data:uS},U1:{type:Cy,direction:Wv,isReverse:!1,data:wS},U2:{type:Cy,direction:Hv,isReverse:!1,data:TS},U3:{type:Cy,direction:Xv,isReverse:!1,data:CS},U4:{type:Cy,direction:zv,isReverse:!1,data:bS},V1:{type:cy,direction:Hv,isReverse:!1,data:Ly},V2:{type:cy,direction:Xv,isReverse:!1,data:Gy},V3:{type:cy,direction:Wv,isReverse:!1,data:Ry},V4:{type:cy,direction:zv,isReverse:!1,data:zy},VV1:{type:ly,direction:Hv,isReverse:!1,data:By},VV2:{type:ly,direction:Xv,isReverse:!1,data:Uy},VV3:{type:ly,direction:Wv,isReverse:!1,data:Oy},VV4:{type:ly,direction:zv,isReverse:!1,data:Hy},X:{type:Ey,direction:null,isReverse:!1,data:fS},Z1:{type:yy,direction:qv,isReverse:!1,data:aS},Z2:{type:yy,direction:jv,isReverse:!1,data:iS}},PS=GameCore.Configs.Board,kS=(PS.cols,PS.rows,0),RS=function(){return kS},OS=function(t,e){kS=0;for(var n=[],i=t.length,a=t[0].length,r=[],s=[],o=function(e){for(var i=!0,s=0;s<a;s++)0===t[e][s].value&&(i=!1);if(i){r.push(e);for(var o=function(i){n.some((function(t){return t.x===i&&t.y===e}))||n.push({x:i,y:e,frame:t[e][i].frame})},h=0;h<a;h++)o(h)}},h=0;h<i;h++)o(h);for(var c=function(e){for(var a=!0,r=0;r<i;r++)0===t[r][e].value&&(a=!1);if(a){s.push(e);for(var o=function(i){n.some((function(t){return t.x===e&&t.y===i}))||n.push({x:e,y:i,frame:t[i][e].frame})},h=0;h<i;h++)o(h)}},l=0;l<a;l++)c(l);var u=LS(t,e);if(u&&u.length>0)for(var d=function(e){var i=u[e],a=i.x,r=i.y;n.some((function(t){return t.x===a&&t.y===r}))||n.push({x:a,y:r,frame:t[r][a].frame})},p=0;p<u.length;p++)d(p);return kS+=r.length,kS+=s.length,kS+=Math.floor(u.length/9),n},_S=function(t,e){if(0===t.length)return!1;var n=c()(t).call(t,(function(t){return t.x===e.x&&t.y===e.y}));return!(!n||n.length<=0)},DS=function(t,e){for(var n=e.x,i=e.y,a=[],r=n;r<n+3;r++)for(var s=i;s<i+3;s++){if(0===t[s][r].value)return[];a.push({x:r,y:s})}return a},LS=function(t,e){for(var n=[],i=function(t){for(var e,n=[],i=0;i<t.length;i++){var a=(e=t[i],{x:3*Math.floor(e.x/3),y:3*Math.floor(e.y/3)});_S(n,a)||n.push(a)}return n}(e),a=0;a<i.length;a++){var r=i[a],s=DS(t,r);n.push.apply(n,s)}return n},BS=function(t){for(var e=t.length,n=t[0].length,i=[],a=0;a<e;a++){for(var r=!0,s=0;s<n;s++)0===t[a][s].value&&(r=!1);r&&i.push(a)}return i},FS=function(t){for(var e=t.length,n=t[0].length,i=[],a=0;a<n;a++){for(var r=!0,s=0;s<e;s++)0===t[s][a].value&&(r=!1);r&&i.push(a)}return i},NS=function(t,e){var n=t.length,i=t[0].length;if(0===e.length)return!1;for(var a=0;a<n;a++)for(var r=0;r<i;r++)for(var s=0;s<e.length;s++)if(GS(t,r,a,e[s]))return!1;return!0},GS=function(t,e,n,i){for(var a=!0,r=0;r<i.data.length;r++)for(var s=0;s<i.data[r].length;s++)i.data[r][s].texture&&(t[n+r]&&t[n+r][e+s]&&0===t[n+r][e+s].value||(a=!1));return a},US=function(t,e){for(var n=t.length,i=t[0].length,a=0;a<n;a++)for(var r=0;r<i;r++)if(GS(t,r,a,e))return!0;return!1},VS=0,YS=function(){return VS+1},zS=function(t){var e=t;switch(t){case Jv:e="g";break;case Qv:e="d10";break;case $v:e="d11";break;case ty:e="d12";break;case ey:e="d13";break;case ny:e="d14";break;case iy:e="d15";break;case ay:e="r20";break;case ry:e="s30";break;case hy:e="l";break;case cy:e="l1";break;case ly:e="l3";break;case uy:e="e2";break;case dy:e="e3";break;case py:e="e4";break;case fy:e="e5";break;case gy:e="s1";break;case my:e="s2";break;case vy:e="s3";break;case yy:e="tz";break;case Sy:e="ta";break;case Ey:e="pl";break;case Ay:e="tp";break;case xy:e="cr2";break;case by:e="cr3";break;case Ty:e="cr4";break;case wy:e="cr5";break;case Cy:e="up";break;case Wv:e="dt";break;case zv:e="dl";break;case Hv:e="dr";break;case Xv:e="db";break;case Vv:e="v";break;case Yv:e="h";break;case Kv:e="vl";break;case jv:e="vr";break;case qv:e="hl";break;case Zv:e="hr"}return e},HS=function(t){var e=t;switch(t){case"g":e=Jv;break;case"d10":e=Qv;break;case"d11":e=$v;break;case"d12":e=ty;break;case"d13":e=ey;break;case"d14":e=ny;break;case"d15":e=iy;break;case"r20":e=ay;break;case"s30":e=ry;break;case"b":case"c":case"d":case"g":case"o":case"p":case"q":case"r":case"y":e="gem/gem";break;case"l":e=hy;break;case"l1":e=cy;break;case"l3":e=ly;break;case"e2":e=uy;break;case"e3":e=dy;break;case"e4":e=py;break;case"e5":e=fy;break;case"s1":e=gy;break;case"s2":e=my;break;case"s3":e=vy;break;case"tz":e=yy;break;case"ta":e=Sy;break;case"pl":e=Ey;break;case"tp":e=Ay;break;case"cr2":e=xy;break;case"cr3":e=by;break;case"cr4":e=Ty;break;case"cr5":e=wy;break;case"up":e=Cy;break;case"dt":e=Wv;break;case"dl":e=zv;break;case"dr":e=Hv;break;case"db":e=Xv;break;case"v":e=Vv;break;case"h":e=Yv;break;case"vl":e=Kv;break;case"vr":e=jv;break;case"hl":e=qv;break;case"hr":e=Zv}return e},WS=function(t){for(var e=[],n=t.split(","),i=0;i<n.length;i++){var a=n[i],r=HS(a);"x"===a?e.push({value:0,frame:"gem/gem_transparent"}):e.push({value:1,frame:r})}return e},XS=function(t){var e=t.split("|"),n=e[0].split("-");if(n.length<=0)throw new Error("Invalid piece");return{type:HS(n[0]),direction:HS(n[1])||null,isReverse:n[2]&&"r"===n[2]||!1,fenPiece:e[1]}},KS=gs.default.DEFAULT,jS=KS.KEY,qS=KS.FRAME,ZS=gs.default.GAMEPLAY,JS=ZS.KEY,QS=ZS.FRAME,$S=gs.default.GAMEPLAY_32,tA=$S.KEY,eA=$S.FRAME,nA=GameCore.Configs,iA=nA.Network,aA=nA.Board,rA=function(t){function e(e,n,i,a){var r;(r=t.call(this,e,n,i,a)||this).popup=void 0,r.title=void 0,r.buttonClose=void 0,r.contents=void 0,r.buttonPlay=void 0,r.boardCellData=[],r.targetData=[],r.popupShowUpAnimation=void 0,r.popupFadeOutAnimation=void 0,r.contentShowUpAnimation=void 0,r.popupFadeInMaskAnimation=void 0,r.popupFadeOutMaskAnimation=void 0,r.clickClose=function(){r.runCloseAnimation(),r.popupFadeOutAnimation.next((function(){var t=r.getData(["onClose"])[0];r.scene.screen.close(r.name),t&&t()}))},r.decodeMathData=function(t){try{return JSON.parse(GameCore.Utils.Hash.hashToString(t))}catch(e){return""}};try{r.createPopup(),r.createTitle(),r.createTargetItems(),r.createBoard(),r.createButtonPlay(),r.setDepth(Gs),r.background.setAlpha(.5)}catch(s){}return r}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){var e=(0,Xt.default)(qt().mark((function e(n){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.prototype.open.call(this,n),e.next=3,this.checkReceiveLevelFromFb();case 3:this.loadLevelConfig();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.startGame=function(){this.runOpenAnimation(),this.updateContent(),this.popup.setVisible(!0)},n.loadLevelConfig=function(){try{var t=this.scene.storage.getState(),e=lu(t),n=qu[e];n||(n=qu[qu.length-1]);var i=n,a=i.key,r=i.mapJson;if(this.scene.cache.tilemap.exists(a))return void this.handleLoadCurrentMapComplete();this.scene.load.tilemapTiledJSON(a,r),this.scene.load.start(),this.scene.load.off(Phaser.Loader.Events.COMPLETE),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this))}catch(s){(0,Ht.sendException)(s)}},n.handleLoadCurrentMapComplete=function(){this.hideLoadingScreen(),this.startGame()},n.updateContent=function(){this.resetTarget(),this.drawTargetItems(),this.resetCellBoard(),this.updateCellBoard()},n.checkReceiveLevelFromFb=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=this.scene.storage.getState(),!lu(e)){t.next=5;break}return t.abrupt("return");case 5:return this.showLoadingScreen(),t.next=8,this.scene.storage.dispatch(Rd());case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 13:case"end":return t.stop()}}),t,this,[[0,10]])})));return function(){return t.apply(this,arguments)}}(),n.showLoadingScreen=function(){this.scene.game.globalScene.screen.open(vs,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",duration:iA.Timeout,loading:!0})},n.hideLoadingScreen=function(){this.scene.game.globalScene.screen.close(vs)},n.createPopup=function(){this.popup=new uo(this.scene,0,-7,286,373),this.popup.setVisible(!1),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,10)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:jS,frame:qS.TEXT_JOURNEY});t.setWorldSize(143.5,16.5),this.buttonClose=new Ys.default(this.scene,jS,qS.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickClose,this.title.add([t,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title),Phaser.Display.Align.In.Center(this.buttonClose,this.title,138.5,-19.5),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,7)},n.createTargetItems=function(){var t=this.scene.make.image({key:jS,frame:qS.TEXT_COLLECT});t.setWorldSize(85,13);var e=this.scene.make.image({key:jS,frame:qS.WOOD_PANEL});e.setWorldSize(200,37),this.popup.add([t,e]),Phaser.Display.Align.In.Center(t,this.popup,0,-155),Phaser.Display.Align.In.Center(e,this.popup,0,-125)},n.drawTargetItems=function(){var t,e,n=this.scene.storage.getState(),i=lu(n),a=qu[i];a||(a=qu[qu.length-1]);var r=this.scene.make.tilemap({key:a.key}).properties;if(r&&(0,Gv.isArray)(r)&&!(r.length<2))for(var s=r[0].value,o=Tv()(t=Tv()(e=Tv()(s).call(s,"{",'{"')).call(e,", ",', "')).call(t,":",'":'),h=JSON.parse(o),c=Y()(h),l=this.calcPosition(c.length),u=0;u<c.length;u++){var d=c[u],p=MS[d],f=h[d],g=this.targetData[u];g||(g=this.spawnTargetItem(p,f));var m=g,v=m.container,y=m.text,S=m.gem;v.setVisible(!0),y.setText("x"+f),S.setFrame(p),this.targetData.push(g),Phaser.Display.Align.In.Center(v,this.popup,l[u],-130)}},n.spawnTargetItem=function(t,e){var n=this.scene.make.container({}),i=this.scene.make.image({key:tA,frame:t});i.setWorldSize(15,15);var a=this.scene.make.bitmapText({font:Hs.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5},text:"x"+e});return n.add([i,a]),Phaser.Display.Align.In.Center(a,n,0,15),this.popup.add(n),{container:n,gem:i,text:a}},n.calcPosition=function(t){for(var e=[],n=150/(t+1),i=n*(t-1)/2,a=0;a<t;a++)e.push(n*a-i);return e},n.createBoard=function(){var t=this.scene.make.image({key:JS,frame:QS.BOARD});t.setWorldSize(200,184),this.popup.add(t),Phaser.Display.Align.In.Center(t,this.popup,0,-12),this.initCellBoard()},n.initCellBoard=function(){for(var t=0;t<aA.rows;t++){this.boardCellData[t]=[];for(var e=0;e<aA.cols;e++){var n=20*e-86.5+1.65*e,i=19*t-92+1*t,a=eA.GEM_TRANSPARENT,r=this.spawnCellBoard(a,n,i);this.boardCellData[t].push(r)}}},n.updateCellBoard=function(){var t=this.scene.storage.getState(),e=hu(t).data.fen;if(e){var n=e.split("l")[0];this.drawBoardByFen(n)}else this.drawBoardByMap()},n.resetTarget=function(){for(var t=0;t<this.targetData.length;t++){var e,n;null==(e=this.targetData[t])||null==(n=e.container)||n.setVisible(!1)}},n.resetCellBoard=function(){for(var t=0;t<aA.rows;t++)for(var e=0;e<aA.cols;e++){this.boardCellData[t][e].setFrame(eA.GEM_TRANSPARENT)}},n.drawBoardByFen=function(t){for(var e=$p()(t).call(t).split("/"),n=0;n<e.length;n++)for(var i=e[n].split(","),a=0;a<i.length;a++){var r=i[a];if("x"!==r){var s=HS(r);this.boardCellData[n][a].setFrame(s)}}},n.drawBoardByMap=function(){var t=this.scene.storage.getState(),e=lu(t),n=qu[e],i=this.scene.make.tilemap({key:n.key}).layers;if((0,Gv.isArray)(i)){var a=i[0].data;if((0,Gv.isArray)(a))for(var r=0;r<a.length;r++)for(var s=a[r],o=0;o<s.length;o++){var h=s[o];if(!(h.index<0)){var c=MS[h.index-1];this.boardCellData[r][o].setFrame(c)}}}},n.spawnCellBoard=function(t,e,n){var i=this.scene.make.image({key:tA,frame:t});return i.setWorldSize(20,19),this.popup.add(i),Phaser.Display.Align.In.Center(i,this.popup,e,n),i},n.createButtonPlay=function(){this.buttonPlay=new Ys.default(this.scene,jS,qS.BUTTON_GREEN_BIG,118,50),this.buttonPlay.setName("Play"),this.buttonPlay.onClick=this.handlePlay.bind(this);var t=this.scene.make.image({key:jS,frame:qS.TEXT_PLAY});t.setWorldSize(65,15);var e=this.scene.make.image({key:jS,frame:qS.ICON_I_PLAY});e.setWorldSize(20,26),this.buttonPlay.add([t,e]),Phaser.Display.Align.In.Center(t,this.buttonPlay,16,-2),Phaser.Display.Align.In.Center(e,this.buttonPlay,-28,-2),this.popup.add(this.buttonPlay),Phaser.Display.Align.In.Center(this.buttonPlay,this.popup,0,111)},n.handlePlay=function(){var t=this,e=this.scene.storage.getState();Cv(e)<1?this.scene.screen.open(Ns):(this.scene.storage.dispatch(Bv()),this.runCloseAnimation(),this.popupFadeOutAnimation.next((function(){t.scene.screen.close(t.name);var e=t.scene.storage.getState(),n=lu(e);n>qu.length||(t.scene.analytics.levelStart(n,void 0,t.getLevelName(n)),t.scene.storage.dispatch(Wd()))})))},n.getLevelName=function(t){var e;return"journey_"+fs()(e=GameCore.Utils.Number).call(e,t,4,"0")},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Vs.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new so({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new io({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new $s({targets:[this.popup],delay:t,duration:e,props:{scale:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.popup.setVisible(!1)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Tc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new $s({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),sA=gs.default.DEFAULT,oA=sA.KEY,hA=sA.FRAME,cA=function(t){function e(e,n,i,a){var r;return(r=t.call(this,e,n,i,a)||this).scene=void 0,r.popup=void 0,r.title=void 0,r.buttonContinue=void 0,r.contents=void 0,r.textTargetScore=void 0,r.textScore=void 0,r.backgroundContent=void 0,r.popupShowUpAnimation=void 0,r.popupFadeOutAnimation=void 0,r.popupFadeInMaskAnimation=void 0,r.popupFadeOutMaskAnimation=void 0,r.scene=e,r.createPopup(),r.createContentBackground(),r.createTitle(),r.createTexts(),r.createButtons(),r.setDepth(Gs),r.background.setAlpha(.5),r}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){t.prototype.open.call(this);var e=this.scene.levelManager.getCurrentTargetScore();this.textScore.setText(""+e),this.runOpenAnimation()},n.createPopup=function(){this.popup=new uo(this.scene,0,0,310,300),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:oA,frame:hA.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(280,200),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-55)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:oA,frame:hA.TEXT_NEXT_MILESTONE});t.setWorldSize(234.5,24.5),this.title.add([t]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title,0,11),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.createTexts=function(){this.createTextTargetScore(),this.createTextScore()},n.createTextTargetScore=function(){this.textTargetScore=this.scene.make.bitmapText({font:Hs.default.PRIMARY.KEY,size:this.scene.fontSize(50),text:"\u0426\u0435\u043b\u0435\u0432\u043e\u0439 \u0441\u0447\u0435\u0442",origin:{x:.5,y:.5}}),this.popup.add(this.textTargetScore),Phaser.Display.Align.In.Center(this.textTargetScore,this.popup,0,-60)},n.createTextScore=function(){this.textScore=this.scene.make.bitmapText({font:Hs.default.PRIMARY.KEY,size:this.scene.fontSize(80),text:"0",origin:{x:.5,y:.5}}),this.popup.add(this.textScore),Phaser.Display.Align.In.Center(this.textScore,this.popup,0,-15)},n.createButtons=function(){this.createButtonContinue()},n.createButtonContinue=function(){var t=this.scene.make.image({key:oA,frame:hA.TEXT_PLAY});t.setWorldSize(83,19),this.buttonContinue=new Ys.default(this.scene,oA,hA.BUTTON_GREEN,172,54),this.buttonContinue.setName("Continue"),this.buttonContinue.add(t);var e=this.scene.make.image({key:oA,frame:hA.ICON_I_PLAY});e.setWorldSize(20,26),this.buttonContinue.add(e),this.popup.add(this.buttonContinue),this.buttonContinue.onClick=this.clickButtonContinue.bind(this),Phaser.Display.Align.In.Center(t,this.buttonContinue,20,-2),Phaser.Display.Align.In.Center(e,this.buttonContinue,-50,-2),Phaser.Display.Align.In.Center(this.buttonContinue,this.popup,0,55)},n.clickButtonContinue=function(){this.scene.nextLevel(),this.runCloseAnimation()},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Vs.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new so({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new $s({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.scene.main.board.handleTweenStartMission(),n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Tc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new $s({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),lA=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).textMain=void 0,i.payload=void 0,i.chars=void 0,i.listText=[],i.tweenText=void 0,i.payload=n,i.createTextMain(),i.initListText(),i.createAnim(),i.scene.add.existing((0,ls.default)(i)),i}(0,Kt.default)(e,t);var n=e.prototype;return n.createTextMain=function(){var t=this.payload,e=t.font,n=t.size,i=t.text;this.textMain=this.scene.make.bitmapText({font:e,size:n,origin:{x:.5,y:.5},text:i}).setVisible(!1),this.add(this.textMain)},n.initListText=function(){var t=this.payload,e=t.text,n=t.font,i=t.size;if(e){this.chars=e.split("");for(var a=0,r=0;r<this.chars.length;r++){var s=this.chars[r],o=this.scene.make.bitmapText({font:n,size:i,origin:{x:.5,y:.5},text:s});this.listText.push(o),a+=o.width}for(var h=-a/2+4,c=0;c<this.chars.length;c++){var l=this.listText[c],u=0;"!"===l.text&&(u=-5),"W"===l.text&&(u=6),l.setX(h+u),l.setAlpha(0),h+=l.width+1}this.add(this.listText)}},n.createAnim=function(){this.tweenText=this.scene.tweens.add({targets:this.listText,paused:!0,duration:150,scale:{from:0,to:1},alpha:{from:0,to:1},ease:"Back.easeOut",delay:this.scene.tweens.stagger(100,{})})},n.runAnim=function(){this.resetListText(),this.tweenText.play()},n.resetListText=function(){for(var t=0;t<this.listText.length;t++)this.listText[t].setScale(0).setAlpha(0)},n.restart=function(){this.resetListText()},n.start=function(t){var e=this;void 0===t&&(t=0),t?this.scene.time.addEvent({delay:t,callback:function(){e.runAnim()}}):this.runAnim()},e}(Phaser.GameObjects.Container),uA=function(t){function e(e,n,i,a){var r;return(r=t.call(this,e,n,i,a)||this).scene=void 0,r.textNoSpaceLeft=void 0,r.closeTimerEvent=void 0,r.tweenBackground=void 0,r.open=function(e){t.prototype.open.call((0,ls.default)(r),e),r.runPopupEntrancesAnimation(300,300),r.handleDelegate()},r.close=function(){t.prototype.close.call((0,ls.default)(r))},r.scene=e,r.setDepth(Gs),r.background.setAlpha(0),r.createContent(),r}(0,Kt.default)(e,t);var n=e.prototype;return n.handleDelegate=function(){var t,e=this,n=this.getData(["duration","onClose"]),i=n[0],a=void 0===i?0:i,r=n[1];null==(t=this.closeTimerEvent)||t.remove(),a>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:a,callback:function(){e.textNoSpaceLeft.setVisible(!1),e.textNoSpaceLeft.restart(),e.visible&&e.scene.screen.close(e.name),r&&r()}}))},n.runAnim=function(){this.textNoSpaceLeft.setVisible(!0),this.textNoSpaceLeft.start(300)},n.createContent=function(){this.createText()},n.createText=function(){this.textNoSpaceLeft=new lA(this.scene,{text:"\u041c\u0415\u0421\u0422\u0410 \u041d\u0415 \u041e\u0421\u0422\u0410\u041b\u041e\u0421\u042c!",font:Hs.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(76)}),this.add(this.textNoSpaceLeft),Phaser.Display.Align.In.Center(this.textNoSpaceLeft,this)},n.runPopupEntrancesAnimation=function(t,e){var n=this;this.tweenBackground||(this.tweenBackground=this.scene.tweens.addCounter({paused:!0,from:0,to:.6,delay:t,duration:e,onUpdate:function(t){var e=t.getValue();n.background.setAlpha(e)},onComplete:function(){n.runAnim()}})),this.tweenBackground.play()},e}(GameCore.Screen),dA=gs.default.DEFAULT,pA=dA.KEY,fA=dA.FRAME,gA=GameCore.Configs.Match,mA=function(t){function e(e,n,i,a){var r;return(r=t.call(this,e,n,i,a)||this).scene=void 0,r.isUseRescue=void 0,r.countdownCount=void 0,r.popup=void 0,r.skipText=void 0,r.continueButton=void 0,r.tweenContinueButton=void 0,r.continueButtonAnimation=void 0,r.textRescueTime=void 0,r.tweenTextRescueTime=void 0,r.progressCircle=void 0,r.skipTextTween=void 0,r.countdownTimer=void 0,r.bgProgress=void 0,r.popupShowUpAnimation=void 0,r.popupFadeInMaskAnimation=void 0,r.popupFadeOutMaskAnimation=void 0,r.open=function(){t.prototype.open.call((0,ls.default)(r)),r.scene.audio.playSound(Vs.default.RESCUE_TIME),r.runOpenAnimation()},r.close=function(){t.prototype.close.call((0,ls.default)(r)),r.bgProgress.setVisible(!1),r.progressCircle.setVisible(!1),r.continueButton.setVisible(!1),r.skipText.setVisible(!1),r.textRescueTime.setScale(0).setAlpha(0)},r.handleShowRewardedVideoAd=(0,Xt.default)(qt().mark((function t(){var e,n,i,a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=r.scene.game,n=e.globalScene,i=e.lang,a=e.audio,r.countdownTimer.remove(),t.prev=2,!r.isUseRescue){t.next=5;break}return t.abrupt("return");case 5:return r.isUseRescue=!0,r.scene.audio.pauseMusic(),n.screen.open(vs,{message:i.Text.LOADING_AD,duration:0,loading:!0}),a.pauseMusic(),a.muteAll(),t.next=12,r.scene.ads.showRewardedVideoAsync();case 12:r.scene.storage.dispatch(ip()),r.scene.analytics.showRewardedVideoAd(r.scene.getSceneName()),n.screen.close(vs),yu.emit(Ec.RESCUE),r.scene.screen.close(r.name),r.scene.audio.playSound(Vs.default.DAILY_REWARD),n.screen.close(vs),t.next=29;break;case 21:if(t.prev=21,t.t0=t.catch(2),r.scene.analytics.showAdFail(GameCore.Ads.Types.REWARDED,r.getScreenName(),t.t0),!(t.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(t.t0,"code"))){t.next=28;break}if("USER_INPUT"!==t.t0.code){t.next=28;break}return r.showNotifySkipAds(),t.abrupt("return");case 28:r.showNotifyNoAds();case 29:return t.prev=29,r.scene.audio.unmuteAll(),r.scene.audio.playMusic(),r.scene.ads.preloadRewardedVideoAsync().catch((function(t){})),t.finish(29);case 34:case"end":return t.stop()}}),t,null,[[2,21,29,34]])}))),r.showNotifyNoAds=function(t){if(!t||t.name===vs){var e=r.scene.game,n=e.globalScene,i=e.lang;n.screen.events.off(GameCore.Screens.Events.CLOSE),n.screen.events.once(GameCore.Screens.Events.CLOSE,r.showGameOver),n.screen.open(vs,{message:i.Text.NO_ADS_TO_DISPLAY,duration:2e3,loading:!1})}},r.showNotifySkipAds=function(){var t=r.scene.game,e=t.globalScene,n=t.lang;e.screen.events.off(GameCore.Screens.Events.CLOSE),e.screen.events.once(GameCore.Screens.Events.CLOSE,r.showGameOver),e.screen.open(vs,{message:n.Text.NO_REWARDS+"\n"+n.Text.CANCELLED_AD,duration:3e3,loading:!1})},r.showGameOver=function(t){t&&t.name!==vs||(r.countdownTimer.remove(),r.scene.screen.close(r.name),r.scene.endGame())},r.handleSkip=function(){r.countdownTimer.remove(),r.scene.screen.close(r.name),r.scene.endGame()},r.handleRunCountdown=function(){r.countdownCount-=1,r.countdownCount<=0?r.rescueTimeout():r.setTime(r.countdownCount)},r.scene=e,r.countdownCount=gA.MaxRescueCount,r.setDepth(Gs),r.background.setAlpha(.5),r.createPopup(),r.createContent(),r}(0,Kt.default)(e,t);var n=e.prototype;return n.runAnim=function(){this.tweenTextRescueTime.play(),this.skipText.setVisible(!0),this.skipTextTween.play(),this.tweenContinueButton.play()},n.updateInfo=function(){var t=this.scene.storage.getState(),e=fu(t);this.textRescueTime.setText(String(e.score||0))},n.setTime=function(t){this.textRescueTime.setText(""+t),Phaser.Display.Align.In.Center(this.textRescueTime,this.zone,0,-42)},n.createPopup=function(){this.popup=new uo(this.scene,0,-5,290,310),this.add(this.popup)},n.createContent=function(){this.createTitle(),this.createTextRescueTime(),this.createBgProgressCircle(),this.createProgressCircle(),this.createContinueButton(),this.createSkipText()},n.createTitle=function(){var t=this.scene.add.container(),e=this.scene.make.image({key:pA,frame:fA.TEXT_SECOND_CHANGE});e.setWorldSize(194.5,24),Phaser.Display.Align.In.Center(e,t,0,12),t.add([e]),this.popup.add(t),Phaser.Display.Align.In.TopCenter(t,this.popup,0,-2)},n.createTextRescueTime=function(){this.textRescueTime=this.scene.make.bitmapText({font:Hs.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(140),origin:{x:.5,y:.5}}),this.textRescueTime.setOrigin(.5).setScale(0).setAlpha(0),this.add(this.textRescueTime),Phaser.Display.Align.In.Center(this.textRescueTime,this,0,-40),this.tweenTextRescueTime=this.scene.tweens.add({delay:100,targets:this.textRescueTime,paused:!0,duration:200,scale:{from:0,to:1},alpha:{from:0,to:1},ease:"Power1"})},n.createProgressCircle=function(){this.progressCircle=this.scene.add.graphics(),this.add(this.progressCircle)},n.setProgressCircle=function(t){var e=Phaser.Math.DegToRad(-90),n=Phaser.Math.DegToRad(t-360-90);this.progressCircle.clear(),this.progressCircle.beginPath(),this.progressCircle.lineStyle(7,16762368),this.progressCircle.arc(0,-44,54,e,n,!0,.02),this.progressCircle.strokePath(),this.progressCircle.closePath()},n.runCountdown=function(){this.startProgressCircle();var t={delay:1e3,loop:!0,callback:this.handleRunCountdown};this.countdownTimer=this.scene.time.addEvent(t)},n.startProgressCircle=function(){var t=this;this.scene.tweens.addCounter({from:0,to:360,duration:1e3*gA.RescueGamePopupTimeout,onUpdate:function(e){var n=+e.getValue().toFixed(2);t.setProgressCircle(n)},onComplete:function(){t.setProgressCircle(0),t.progressCircle.setAlpha(1)}})},n.createBgProgressCircle=function(){this.bgProgress=this.scene.make.image({key:pA,frame:fA.BG_PROGRESS_CIRCLE}),this.bgProgress.setWorldSize(115,115),this.popup.add(this.bgProgress),Phaser.Display.Align.In.Center(this.bgProgress,this.popup,0,-38)},n.rescueTimeout=function(){this.countdownTimer.remove(),this.scene.screen.close(this.name),this.scene.endGame()},n.createContinueButton=function(){this.continueButton=new Ys.default(this.scene,pA,fA.BUTTON_GREEN,160,54),this.continueButton.setName("Continue"),this.add(this.continueButton),this.continueButton.onClick=this.handleShowRewardedVideoAd;var t=this.scene.add.image(0,0,pA,fA.ICON_ADS);t.setWorldSize(30,27),Phaser.Display.Align.In.Center(t,this.continueButton,-54,-2.5),this.continueButton.add(t);var e=this.scene.make.image({key:pA,frame:this.scene.lang.Texture.CONTINUE});e.setWorldSize(99,16),this.continueButton.add(e),Phaser.Display.Align.In.Center(e,this.continueButton,19,-2),Phaser.Display.Align.In.Center(this.continueButton,this.textRescueTime,0,115),this.continueButton.setScale(0).setAlpha(0),this.tweenContinueButton=this.scene.tweens.add({paused:!0,targets:this.continueButton,ease:to.default,props:{alpha:{from:0,to:1},scale:{from:1.2,to:1}},delay:300,duration:300})},n.createSkipText=function(){this.skipText=new Ys.default(this.scene,pA,this.scene.lang.Texture.NO_THANKS,98,17),this.skipText.setName("NoThanks"),this.add(this.skipText),this.skipText.onClick=this.handleSkip,Phaser.Display.Align.In.BottomCenter(this.skipText,this.continueButton,0,43.5),this.skipText.setVisible(!1).setAlpha(0),this.skipTextTween=this.scene.tweens.add({targets:this.skipText,delay:gA.DelayNoThank,paused:!0,alpha:{from:0,to:1},ease:"Power1",duration:500})},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Vs.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runPopupEntrancesAnimation=function(t,e){var n=this;if(!this.popupShowUpAnimation){var i=this.popup.scale;this.popupShowUpAnimation=new so({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}},onComplete:function(){n.bgProgress.setVisible(!0),n.progressCircle.setVisible(!0),n.continueButton.setVisible(!0),n.skipText.setVisible(!0),n.runAnim(),n.updateInfo(),n.isUseRescue=!1,n.countdownCount=gA.RescueGamePopupTimeout,n.setTime(n.countdownCount),n.runCountdown()}})}this.popupShowUpAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Tc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new $s({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),vA=mA,yA=n(559),SA=n.n(yA),AA=function(t,e,n){return void 0===e&&(e=.1),void 0===n&&(n=.04),e*t+SA()(t)*n*t*t},EA=function(t){function e(n){var i;return(i=t.call(this,n)||this).windX=1,i.airFrictionX=.05,i.airFrictionY=.01,i._lastRotaion=0,i.rotationRate=Math.random()+e.bonusRotationRate<.5?-1:1,i.scaleXNumber=i.getRandomFloat(.1,.2),i.scaleYNumber=i.scaleXNumber,i.scaleRate=-1,i.maxScale=i.getRandomFloat(.5,1),i.deltaAlpha=0,i.airFrictionX=.01*Math.random()+(e.bonusAirFrictionX||.007),i.airFrictionY=.004*Math.random()+(e.bonusAirFrictionY||.006),i.maxScale=Math.max(i.scaleXNumber,i.maxScale),i.alpha=0,(0,ls.default)(i)||(0,ls.default)(i)}(0,Kt.default)(e,t);var n=e.prototype;return n.getRandomNumberBetween=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},n.getRandomFloat=function(t,e){return Math.random()*(e-t)+t},n.setValueAirFrictionX=function(t){e.bonusAirFrictionX=t,this.airFrictionX=.01*Math.random()+(e.bonusAirFrictionX||.007)},n.setValueAirFrictionY=function(t){e.bonusAirFrictionY=t},n.setValueRotationRate=function(t){e.bonusRotationRate=t},n.reset=function(){this.scaleXNumber=this.getRandomFloat(.3,.8),this.scaleYNumber=this.scaleXNumber,this.scaleRate=-1,this.alpha=0,this.deltaAlpha=0},n.update=function(e,n,i){for(var a=t.prototype.update.call(this,e,n,i),r=.5,s=e;s>16.67;)this.velocityX-=AA(this.velocityX,r,this.airFrictionX)/60,this.velocityY-=AA(this.velocityY,r,this.airFrictionY)/60,s-=16.67;if(this.velocityX-=AA(this.velocityX,r,this.airFrictionX)*s/1e3,this.velocityY-=AA(this.velocityY,r,this.airFrictionY)*s/1e3,this._lastRotaion=this.rotation,this.lifeCurrent>3*this.life/4)this.scaleX=this.maxScale,this.scaleY=this.maxScale,this.deltaAlpha+=e/(this.life/4),this.alpha=this.deltaAlpha;else if(this.lifeCurrent>0){var o=this.scaleRate>0?this.maxScale:1;this.scaleXNumber+=o*this.scaleRate*(e/(3*this.life/4)*3),this.scaleYNumber+=o*this.scaleRate*(e/(3*this.life/4)*3),this.scaleX=this.scaleXNumber,this.scaleY=this.scaleYNumber,this.alpha=this.deltaAlpha,this.scaleX<=0&&(this.scaleRate=1),this.scaleX>=this.maxScale&&(this.scaleRate=-1)}else this.reset();return a},e}(Phaser.GameObjects.Particles.Particle);EA.bonusAirFrictionX=0,EA.bonusAirFrictionY=0,EA.bonusRotationRate=0,EA.scaleXNumber=void 0,EA.scaleYNumber=void 0,EA.bonusAirFrictionX=0,EA.bonusAirFrictionY=0,EA.bonusRotationRate=0,EA.scaleXNumber=Math.random(),EA.scaleYNumber=Math.random();var xA=EA,bA=gs.default.EFFECTS,TA=bA.KEY,wA=bA.FRAME,CA=function(t){function e(e){var n;return(n=t.call(this,e,TA)||this).position1={x:-70,y:-180},n.emitterStar1=void 0,n.circleImage1=void 0,n.tweenShowCircle1=void 0,n.tweenHideCircle1=void 0,n.position2={x:-20,y:190},n.emitterStar2=void 0,n.circleImage2=void 0,n.tweenShowCircle2=void 0,n.tweenHideCircle2=void 0,n.position3={x:90,y:0},n.emitterStar3=void 0,n.circleImage3=void 0,n.tweenShowCircle3=void 0,n.tweenHideCircle3=void 0,n.setDepth(zs.default.ON_TOP+1),n.createEmitterStars(),n.createTweenCircle(),n.scene.add.existing((0,ls.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createEmitterStars=function(){var t=[wA.GLARE_CROSS,wA.DUST],e=[16636263,5289969,15880535];this.emitterStar1=this.createEmitter({name:"Emitter1",frame:t,tint:e,x:this.position1.x,y:this.position1.y,speed:{min:50,max:200},gravityY:40,lifespan:{min:1e3,max:4e3},maxParticles:0,on:!1,alpha:0,particleClass:xA,emitZone:{type:"edge",source:new Phaser.Geom.Circle(0,0,1)}}),this.emitterStar2=this.createEmitter({name:"Emitter1",frame:t,tint:e,x:this.position2.x,y:this.position2.y,speed:{min:100,max:200},gravityY:40,lifespan:{min:1e3,max:4e3},maxParticles:0,on:!1,alpha:0,particleClass:xA,emitZone:{type:"edge",source:new Phaser.Geom.Circle(0,0,1)}}),this.emitterStar3=this.createEmitter({name:"Emitter1",frame:t,tint:e,x:this.position3.x,y:this.position3.y,speed:{min:100,max:200},gravityY:40,lifespan:{min:1e3,max:4e3},maxParticles:0,on:!1,alpha:0,particleClass:xA,emitZone:{type:"edge",source:new Phaser.Geom.Circle(0,0,1)}})},n.createTweenCircle=function(){var t=this;this.circleImage1=this.scene.make.image({x:this.position1.x,y:this.position1.y,key:TA,frame:wA.GLOW_CIRCLE}).setAlpha(0).setVisible(!1).setScale(0),this.tweenShowCircle1=this.scene.add.tween({paused:!0,targets:this.circleImage1,scale:{from:0,to:1},alpha:{from:0,to:1},ease:"Sine.easeInOut",duration:1e3,onComplete:function(){t.tweenHideCircle1.play()}}),this.tweenHideCircle1=this.scene.add.tween({paused:!0,targets:this.circleImage1,alpha:{from:1,to:0},ease:"Sine.easeInOut",duration:1e3,onComplete:function(){t.circleImage1.setVisible(!1),t.emitterStar1.stop()}}),this.circleImage2=this.scene.make.image({x:this.position2.x,y:this.position2.y,key:TA,frame:wA.GLOW_CIRCLE}).setAlpha(0).setVisible(!1).setScale(0),this.tweenShowCircle2=this.scene.add.tween({paused:!0,targets:this.circleImage2,scale:{from:0,to:1},alpha:{from:0,to:1},ease:"Sine.easeInOut",duration:1e3,onComplete:function(){t.tweenHideCircle2.play()}}),this.tweenHideCircle2=this.scene.add.tween({paused:!0,targets:this.circleImage2,alpha:{from:1,to:0},ease:"Sine.easeInOut",duration:1e3,onComplete:function(){t.circleImage2.setVisible(!1),t.emitterStar2.stop()}}),this.circleImage3=this.scene.make.image({x:this.position3.x,y:this.position3.y,key:TA,frame:wA.GLOW_CIRCLE}).setAlpha(0).setVisible(!1).setScale(0),this.tweenShowCircle3=this.scene.add.tween({paused:!0,targets:this.circleImage3,scale:{from:0,to:1},alpha:{from:0,to:1},ease:"Sine.easeInOut",duration:1e3,onComplete:function(){t.tweenHideCircle3.play()}}),this.tweenHideCircle3=this.scene.add.tween({paused:!0,targets:this.circleImage3,alpha:{from:1,to:0},ease:"Sine.easeInOut",duration:1e3,onComplete:function(){t.circleImage3.setVisible(!1),t.emitterStar3.stop()}})},n.getImages=function(){return[this.circleImage1,this.circleImage2,this.circleImage3]},n.playConfettiAnimation=function(){var t=this;this.scene.time.addEvent({delay:300,callback:function(){t.emitterStar1.flow(1e4,30),t.circleImage1.setVisible(!0),t.tweenShowCircle1.play()},callbackScope:this}),this.scene.time.addEvent({delay:800,callback:function(){t.emitterStar2.flow(1e4,25),t.circleImage2.setVisible(!0),t.tweenShowCircle2.play()},callbackScope:this}),this.scene.time.addEvent({delay:1300,callback:function(){t.emitterStar3.flow(1e4,30),t.circleImage3.setVisible(!0),t.tweenShowCircle3.play()},callbackScope:this})},e}(Phaser.GameObjects.Particles.ParticleEmitterManager),MA=CA,IA=function(t){function e(e,n,i,a){var r;return(r=t.call(this,e,n,i,a)||this).scene=void 0,r.textScoreReached=void 0,r.closeTimerEvent=void 0,r.tweenBackground=void 0,r.starSuperTwinkle=void 0,r.open=function(e){t.prototype.open.call((0,ls.default)(r),e),r.scene.enableInput(),r.runPopupEntrancesAnimation(300,300),r.textScoreReached.restart(),r.scene.audio.playSound(Vs.default.SCORE_REACHED)},r.close=function(){t.prototype.close.call((0,ls.default)(r))},r.scene=e,r.setDepth(Gs),r.background.setAlpha(0),r.createContent(),r}(0,Kt.default)(e,t);var n=e.prototype;return n.runPopupEntrancesAnimation=function(t,e){var n=this;this.tweenBackground||(this.tweenBackground=this.scene.tweens.addCounter({paused:!0,from:0,to:.6,delay:t,duration:e,onUpdate:function(t){var e=t.getValue();n.background.setAlpha(e)},onComplete:function(){n.textScoreReached.start(),n.starSuperTwinkle.playConfettiAnimation(),n.handleDelegate(),n.runAnim()}})),this.tweenBackground.play()},n.handleDelegate=function(){var t,e=this,n=this.getData(["duration","onClose"]),i=n[0],a=void 0===i?0:i,r=n[1];null==(t=this.closeTimerEvent)||t.remove(),a>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:a,callback:function(){e.visible&&e.scene.screen.close(e.name),r&&r()}}))},n.runAnim=function(){},n.createContent=function(){this.createText(),this.createAnim()},n.createText=function(){this.textScoreReached=new lA(this.scene,{text:"\u0421\u0427\u0415\u0422 \u0414\u041e\u0421\u0422\u0418\u0413\u041d\u0423\u0422!",font:Hs.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(80)}),this.add(this.textScoreReached),Phaser.Display.Align.In.Center(this.textScoreReached,this)},n.createAnim=function(){this.starSuperTwinkle=new MA(this.scene),this.add(this.starSuperTwinkle),this.add(this.starSuperTwinkle.getImages())},e}(GameCore.Screen),PA=gs.default.DEFAULT,kA=PA.KEY,RA=PA.FRAME,OA=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).onClick=void 0,i.options=void 0,i.text=void 0,i.panel=void 0,i.icon=void 0,i.animOn=void 0,i.animOff=void 0,i.setSize(n.width,n.height),i.options=n,i.createPanel(),i.createIcon(),i.createText(),i.createAnimation(),i.updateStatus(i.options.enable),i.createInput(),i}(0,Kt.default)(e,t);var n=e.prototype;return n.createInput=function(){var t=this;this.setInteractive().on(Phaser.Input.Events.POINTER_DOWN,(function(){t.options.enable?t.animOff.play():t.animOn.play(),t.onClick&&t.onClick(!t.options.enable)}))},n.createPanel=function(){this.panel=this.scene.make.image({key:kA,frame:RA.BUTTON_TOGGLE_ON}),this.panel.setWorldSize(this.width,this.height),this.add(this.panel),Phaser.Display.Align.In.Center(this.panel,this)},n.createIcon=function(){this.icon=this.scene.make.image({key:kA,frame:RA.BUTTON_CIRCLE}),this.icon.setWorldSize(27,27),this.add(this.icon),Phaser.Display.Align.In.LeftCenter(this.icon,this)},n.createText=function(){this.text=this.scene.make.image({key:kA}),this.text.setWorldSize(30,17),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this.panel)},n.createAnimation=function(){var t=this;this.animOn=this.scene.add.tween({targets:this.icon,duration:200,paused:!0,x:{from:-this.panel.width/2+this.icon.width/2,to:this.panel.width/2-this.icon.width/2-3},onComplete:function(){t.text.setFrame(RA.TEXT_ON),t.text.setWorldSize(35,15.5),t.panel.setFrame(RA.BUTTON_TOGGLE_ON),t.panel.setWorldSize(t.width,t.height),Phaser.Display.Align.In.LeftCenter(t.text,t.panel,-15),t.options.enable=!0}}),this.animOff=this.scene.add.tween({targets:this.icon,duration:200,paused:!0,x:{from:this.panel.width/2-this.icon.width/2,to:-this.panel.width/2+this.icon.width/2},onComplete:function(){t.text.setFrame(RA.TEXT_OFF),t.text.setWorldSize(50.5,15.5),t.panel.setFrame(RA.BUTTON_TOGGLE_OFF),t.panel.setWorldSize(t.width,t.height),Phaser.Display.Align.In.RightCenter(t.text,t.panel,-10),t.options.enable=!1}})},n.updateStatus=function(t){this.options.enable=t,t?this.animOn.play():this.animOff.play()},e}(Phaser.GameObjects.Container),_A=OA,DA=gs.default.DEFAULT,LA=DA.KEY,BA=DA.FRAME,FA=function(t){function e(e){var n;return(n=t.call(this,e,LA,BA.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Home"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:LA,frame:BA.ICON_HOME});t.setWorldSize(31,28),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-2)},e}(Ys.default),NA=FA,GA=gs.default.DEFAULT,UA=GA.KEY,VA=GA.FRAME,YA=function(t){function e(e){var n;return(n=t.call(this,e,UA,VA.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Journey"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:UA,frame:VA.ICON_JOURNEY_2});t.setWorldSize(35,28),this.add(t),Phaser.Display.Align.In.Center(t,this,-.25,-1.5)},e}(Ys.default),zA=YA,HA=gs.default.DEFAULT,WA=HA.KEY,XA=HA.FRAME,KA=function(t){function e(e){var n;return(n=t.call(this,e,WA,XA.BUTTON_DARK_BLUE)||this).button.setWorldSize(246,53),n.setName("PlayWithFriends"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:WA,frame:XA.ICON_SWORD_BLUE});t.setWorldSize(31,25),this.add(t),Phaser.Display.Align.In.Center(t,this,-60)},n.createText=function(){var t=this.scene.make.image({key:WA,frame:XA.TEXT_PLAY_WITH_BLUE});t.setWorldSize(159.5,15.5),this.add(t),Phaser.Display.Align.In.Center(t,this,20)},e}(Ys.default),jA=KA,qA=gs.default.DEFAULT,ZA=qA.KEY,JA=qA.FRAME,QA=function(t){function e(e){var n;return(n=t.call(this,e,ZA,JA.BUTTON_BROWN)||this).button.setWorldSize(246,53),n.setName("Replay"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:ZA,frame:JA.ICON_REPLAY});t.setWorldSize(26,31),this.add(t),Phaser.Display.Align.In.Center(t,this,-45,-2)},n.createText=function(){var t=this.scene.make.image({key:ZA,frame:JA.TEXT_REPLAY});t.setWorldSize(69.5,14.5),this.add(t),Phaser.Display.Align.In.Center(t,this,20,-1)},e}(Ys.default),$A=QA,tE=gs.default.DEFAULT,eE=tE.KEY,nE=tE.FRAME,iE=function(t){function e(e){var n;return(n=t.call(this,e,eE,nE.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Share"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:eE,frame:nE.ICON_SHARE});t.setWorldSize(24,31),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-2)},e}(Ys.default),aE=iE,rE=gs.default.DEFAULT,sE=rE.KEY,oE=rE.FRAME,hE=function(t){function e(e,n,i,a){var r;return(r=t.call(this,e,n,i,a)||this).popup=void 0,r.title=void 0,r.buttonClose=void 0,r.contents=void 0,r.backgroundContent=void 0,r.settingMusic=void 0,r.settingSound=void 0,r.settingVibrate=void 0,r.settingSoundContainer=void 0,r.settingMusicContainer=void 0,r.settingVibrateContainer=void 0,r.popupShowUpAnimation=void 0,r.popupFadeOutAnimation=void 0,r.contentShowUpAnimation=void 0,r.buttonReplay=void 0,r.buttonPlayWithFriend=void 0,r.buttonHome=void 0,r.buttonJourney=void 0,r.buttonShare=void 0,r.popupFadeInMaskAnimation=void 0,r.popupFadeOutMaskAnimation=void 0,r.handleClose=function(){r.runCloseAnimation()},r.handleMusicSetting=function(t){r.scene.player.setSetting("music",t),t?r.scene.audio.playMusic():r.scene.audio.pauseMusic()},r.handleSoundSetting=function(t){r.scene.player.setSetting("sound",t)},r.handleVibrateSetting=function(t){t&&rm(199),r.scene.player.setSetting("vibrate",t)},r.clickReplay=function(){r.runCloseAnimation(),r.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.scene.screen.close(r.name),t.next=3,r.scene.storage.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,r,s,o,h,c;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=window.game,r=a.globalScene,s=a.lang,r.screen.open(vs,{message:s.Text.LOADING,loading:!0}),o=n(),h=Ml(o),u()(i=[Wr,jr]).call(i,h)&&(e(bd()),e(yd())),c=null,h===Xr&&(c=iu(o),e({type:ga,payload:{}})),e(_d()),t.next=11,e($d(h,c));case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 16:return t.prev=16,Ud(300),t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[0,13,16,19]])})));return function(e,n){return t.apply(this,arguments)}}());case 3:yu.emit(Ec.REPLAY);case 4:case"end":return t.stop()}}),t)}))))},r.clickButtonPlayWithFriends=function(){r.scene.storage.dispatch(Kd()),r.scene.screen.close(r.name)},r.clickButtonHome=function(){r.runCloseAnimation(),r.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r.scene.scene.switch(is.SceneKeys.DASHBOARD_SCENE);case 1:case"end":return t.stop()}}),t)}))))},r.clickButtonLeaderboard=function(){r.scene.screen.open(Ts)},r.clickButtonShare=function(){r.runCloseAnimation(),r.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r.scene.storage.dispatch(ku());case 1:case"end":return t.stop()}}),t)}))))},r.createPopup(),r.createTitle(),r.createContentBackground(),r.createSwitchButtons(),r.createButtons(),r.addItem(),r.arrangeItems(),r.createInput(),r.setDepth(Gs),r.background.setAlpha(.5),r}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){var e;t.prototype.open.call(this);var n=this.scene.player.getPlayerSettings(),i=n.sound,a=n.vibrate;this.settingSound.updateStatus(i),null==(e=this.settingVibrate)||e.updateStatus(a),this.runOpenAnimation()},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:sE,frame:oE.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(263,147),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-48)},n.createInput=function(){this.buttonClose.onClick=this.handleClose,this.settingSound.onClick=this.handleSoundSetting,this.settingVibrate&&(this.settingVibrate.onClick=this.handleVibrateSetting)},n.createPopup=function(){this.popup=new uo(this.scene,0,0,290,390),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:sE,frame:oE.TEXT_SETTING});t.setWorldSize(151.5,24),this.buttonClose=new Ys.default(this.scene,sE,oE.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.title.add([t,this.buttonClose]),Phaser.Display.Align.In.Center(t,this.title,0,11),Phaser.Display.Align.In.Center(this.buttonClose,this.title,135,-14)},n.createButtons=function(){this.createReplayButton(),this.createHomeButton(),this.createJourneyButton(),this.createShareButton()},n.createReplayButton=function(){this.buttonReplay=new $A(this.scene),this.popup.add(this.buttonReplay),this.buttonReplay.onClick=this.clickReplay,Phaser.Display.Align.In.Center(this.buttonReplay,this.popup,0,43)},n.createPlayWithFriendButton=function(){this.buttonPlayWithFriend=new jA(this.scene),this.popup.add(this.buttonPlayWithFriend),this.buttonPlayWithFriend.onClick=this.clickButtonPlayWithFriends,Phaser.Display.Align.In.Center(this.buttonPlayWithFriend,this.buttonReplay,0,65)},n.createHomeButton=function(){this.buttonHome=new NA(this.scene),this.popup.add(this.buttonHome),this.buttonHome.onClick=this.clickButtonHome,Phaser.Display.Align.In.Center(this.buttonHome,this.buttonReplay,-90,72)},n.createJourneyButton=function(){this.buttonJourney=new zA(this.scene),this.popup.add(this.buttonJourney),this.buttonJourney.onClick=this.clickButtonJourney.bind(this),Phaser.Display.Align.In.Center(this.buttonJourney,this.buttonReplay,0,72)},n.clickButtonJourney=function(){var t=this;this.runCloseAnimation(),this.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function e(){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.scene.scene.switch(is.SceneKeys.LEVEL_SCENE);case 1:case"end":return e.stop()}}),e)}))))},n.createShareButton=function(){this.buttonShare=new aE(this.scene),this.popup.add(this.buttonShare),this.buttonShare.onClick=this.clickButtonShare,Phaser.Display.Align.In.Center(this.buttonShare,this.buttonReplay,90,72)},n.createSwitchButtons=function(){var t=this.scene.player.getPlayerSettings(),e=(t.music,t.sound),n=t.vibrate;this.createSoundButton(e),nm()?(this.createVibrateButton(n),Phaser.Display.Align.In.Center(this.settingSoundContainer,this.backgroundContent,0,-33),Phaser.Display.Align.In.Center(this.settingVibrateContainer,this.backgroundContent,0,28)):Phaser.Display.Align.In.Center(this.settingSoundContainer,this.backgroundContent,0,0)},n.createMusicButton=function(t){this.settingMusicContainer=this.scene.make.container({});var e=this.scene.make.image({key:sE,frame:oE.ICON_MUSIC});e.setWorldSize(37,40),this.settingMusic=new _A(this.scene,{enable:t,width:89,height:31}),this.settingMusic.setName("Music"),Phaser.Display.Align.In.Center(e,this.settingMusicContainer,-60),Phaser.Display.Align.In.Center(this.settingMusic,this.settingMusicContainer,40),this.settingMusicContainer.add([e,this.settingMusic]),this.popup.add(this.settingMusicContainer),Phaser.Display.Align.In.Center(this.settingMusicContainer,this.backgroundContent,0,60)},n.createVibrateButton=function(t){this.settingVibrateContainer=this.scene.make.container({});var e=this.scene.make.image({key:sE,frame:oE.ICON_VIBRATE});e.setWorldSize(41,48),this.settingVibrate=new _A(this.scene,{enable:t,width:89,height:31}),this.settingVibrate.setName("Vibrate"),this.settingVibrateContainer.add([e,this.settingVibrate]),Phaser.Display.Align.In.Center(e,this.settingVibrateContainer,-60),Phaser.Display.Align.In.Center(this.settingVibrate,this.settingVibrateContainer,35),this.popup.add(this.settingVibrateContainer)},n.createSoundButton=function(t){this.settingSoundContainer=this.scene.make.container({});var e=this.scene.make.image({key:sE,frame:oE.ICON_SOUND});e.setWorldSize(41,36),this.settingSound=new _A(this.scene,{enable:t,width:89,height:31}),this.settingSound.setName("Sound"),this.settingSoundContainer.add([e,this.settingSound]),Phaser.Display.Align.In.Center(e,this.settingSoundContainer,-58),Phaser.Display.Align.In.Center(this.settingSound,this.settingSoundContainer,35),this.popup.add(this.settingSoundContainer)},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.arrangeItems=function(){Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Vs.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new so({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new io({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new $s({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Tc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new $s({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),cE=hE,lE=gs.default.DEFAULT,uE=lE.KEY,dE=lE.FRAME,pE=function(t){function e(e,n,i,a){var r;return(r=t.call(this,e,n,i,a)||this).scene=void 0,r.popup=void 0,r.title=void 0,r.contents=void 0,r.backgroundContent=void 0,r.textTargetScore=void 0,r.textScore=void 0,r.titleFrame=void 0,r.popupShowUpAnimation=void 0,r.popupFadeOutAnimation=void 0,r.contentShowUpAnimation=void 0,r.popupFadeInMaskAnimation=void 0,r.popupFadeOutMaskAnimation=void 0,r.handleClose=function(){r.runCloseAnimation()},r.scene=e,r.createPopup(),r.createTitle(),r.createContentBackground(),r.createTextTargetScore(),r.createTextScore(),r.addItem(),r.setDepth(Gs),r.background.setAlpha(.5),r}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(e){var n=this;t.prototype.open.call(this,e);var i=this.scene.levelManager.getCurrentTargetScore(),a=this.scene.levelManager.getCurrentIndex();this.textScore.setText(""+i),0===a?(this.titleFrame.setFrame(dE.TEXT_FIRST_MILESTONE),this.titleFrame.setWorldSize(166,20)):(this.titleFrame.setFrame(dE.TEXT_NEXT_MILESTONE),this.titleFrame.setWorldSize(234.5,24.5));var r=this.getData(["duration"])[0];this.runOpenAnimation(),this.scene.time.delayedCall(r,(function(){n.handleClose()}))},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:uE,frame:dE.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(263,135),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-24)},n.createTextTargetScore=function(){this.textTargetScore=this.scene.make.bitmapText({font:Hs.default.PRIMARY.KEY,size:this.scene.fontSize(50),text:"\u0426\u0435\u043b\u0435\u0432\u043e\u0439 \u0441\u0447\u0435\u0442",origin:{x:.5,y:.5}}),this.popup.add(this.textTargetScore),Phaser.Display.Align.In.Center(this.textTargetScore,this.backgroundContent,0,-30)},n.createTextScore=function(){this.textScore=this.scene.make.bitmapText({font:Hs.default.PRIMARY.KEY,size:this.scene.fontSize(80),text:"0",origin:{x:.5,y:.5}}),this.popup.add(this.textScore),Phaser.Display.Align.In.Center(this.textScore,this.backgroundContent,0,15)},n.createPopup=function(){this.popup=new uo(this.scene,0,-19,290,218,{forceHeightTop:55}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createTitle=function(){this.title=this.scene.add.container(),this.titleFrame=this.scene.make.image({key:uE,frame:dE.TEXT_FIRST_MILESTONE}),this.titleFrame.setWorldSize(166,20),this.title.add([this.titleFrame]),this.popup.add(this.title),Phaser.Display.Align.In.Center(this.titleFrame,this.title,0,-10),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Vs.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new so({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new io({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new $s({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.scene.startGameAfterTargetScoreScreenClose()}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Tc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new $s({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),fE=pE,gE=gs.default.DEFAULT,mE=gE.KEY,vE=gE.FRAME,yE=function(t){function e(e,n,i,a){var r;return(r=t.call(this,e,n,i,a)||this).popup=void 0,r.title=void 0,r.contents=void 0,r.scoreText=void 0,r.bestScoreText=void 0,r.tweenScoreText=void 0,r.popupShowUpAnimation=void 0,r.contentShowUpAnimation=void 0,r.popupFadeOutAnimation=void 0,r.scoreBlock=void 0,r.bestScoreBlock=void 0,r.playWithFriendsButton=void 0,r.homeButton=void 0,r.shareButton=void 0,r.bestScore=void 0,r.currentScore=void 0,r.payload=void 0,r.counterAnimation=void 0,r.scoreAnimation=void 0,r.scene=void 0,r.open=function(e){t.prototype.open.call((0,ls.default)(r),e),r.initScore(),r.updateScore(),r.setVisible(!0),r.runOpenAnimation()},r.clickPlayWithFriends=function(){r.scene.storage.dispatch(Kd())},r.clickShare=function(){r.scene.storage.dispatch(xu())},r.handleClosePopup=function(){r.runCloseAnimation(),r.popupFadeOutAnimation.next((function(){}))},r.setVisible(!1),r.scene=e,r.setDepth(Gs),r.createPopup(),r.createPopupContent(),r.createScoreAnimation(),Phaser.Display.Align.In.Center(r.popup,r.zone,0,-100),r.background.setVisible(!1),r}(0,Kt.default)(e,t);var n=e.prototype;return n.createPopup=function(){this.popup=new uo(this.scene,0,0,300,310),this.add(this.popup)},n.createPopupContent=function(){this.createTitle(),this.createScoreBlock(),this.createBestScoreBlock(),this.createButtons(),this.contents=this.scene.make.group({}),this.contents.addMultiple([this.homeButton,this.playWithFriendsButton,this.shareButton])},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:mE,frame:vE.TEXT_YOUR_SCORE});t.setWorldSize(124.5,20.5),Phaser.Display.Align.In.Center(t,this.title,0,10);var e=new Ys.default(this.scene,mE,vE.BUTTON_CLOSE,35,35);e.onClick=this.handleClosePopup,e.setName("Close"),Phaser.Display.Align.In.RightCenter(e,this.title,165,-15),this.title.add([t,e]),this.popup.add(this.title),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,-2)},n.createScoreBlock=function(){this.scoreBlock=this.scene.add.container();var t=this.scene.make.image({key:mE,frame:vE.SCORE_PANEL});t.setWorldSize(263,76),this.scoreBlock.add(t),this.scoreText=this.scene.make.bitmapText({font:Hs.default.PRIMARY.KEY,size:this.scene.fontSize(55),text:"0",origin:{x:.5,y:.5}}),this.scoreBlock.add(this.scoreText),this.popup.add(this.scoreBlock),Phaser.Display.Align.In.TopCenter(this.scoreBlock,this.popup,0,-90)},n.createBestScoreBlock=function(){this.bestScoreBlock=this.scene.add.container();var t=this.scene.make.image({key:mE,frame:vE.BEST_SCORE_FRAME_LONG});t.setWorldSize(193,77),this.bestScoreBlock.add(t),this.bestScoreText=this.scene.make.bitmapText({font:Hs.default.PRIMARY.KEY,size:this.scene.fontSize(48),text:"0",origin:{x:.5,y:.5}}),this.bestScoreBlock.add(this.bestScoreText),Phaser.Display.Align.In.Center(this.bestScoreText,this.bestScoreBlock,0,16),this.popup.add(this.bestScoreBlock),Phaser.Display.Align.In.Center(this.bestScoreBlock,this.scoreBlock,0,65)},n.createButtons=function(){this.createButtonHome(),this.createButtonPlayWithFriend(),this.createButtonShare()},n.createButtonHome=function(){this.homeButton=new Um(this.scene),this.homeButton.onClick=this.clickHome.bind(this),this.popup.add(this.homeButton),Phaser.Display.Align.In.Center(this.homeButton,this.bestScoreBlock,-100,80)},n.clickHome=function(){this.scene.scene.switch(is.SceneKeys.DASHBOARD_SCENE)},n.createButtonPlayWithFriend=function(){this.playWithFriendsButton=new Zm(this.scene),this.playWithFriendsButton.onClick=this.clickPlayWithFriends,this.popup.add(this.playWithFriendsButton),Phaser.Display.Align.In.Center(this.playWithFriendsButton,this.bestScoreBlock,0,80)},n.createButtonShare=function(){this.shareButton=new Wm(this.scene),this.shareButton.onClick=this.clickShare,this.popup.add(this.shareButton),Phaser.Display.Align.In.Center(this.shareButton,this.bestScoreBlock,100,80)},n.runCloseAnimation=function(){this.runPopupExitsAnimation(0,200)},n.runPopupExitsAnimation=function(t,e){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new $s({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){i.popup.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.setBestScore=function(t){this.bestScoreText.setText(""+t)},n.runOpenAnimation=function(){this.scene.audio.playSound(Vs.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runPopupContentEntrancesAnimation(200,300)},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup,i=(n.y,n.scale);this.popupShowUpAnimation=new so({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){this.contentShowUpAnimation||(this.contentShowUpAnimation=new io({targets:this.contents.getChildren(),duration:e,delay:this.scene.tweens.stagger(80,{start:t}),props:{alpha:{start:0,from:0,to:1}}})),this.contentShowUpAnimation.play()},n.initScore=function(){var t=this.scene.player.getBestScore();this.bestScore=t,this.currentScore=0},n.updateScore=function(){var t=this.scene.storage.getState(),e=fu(t),n=e.score,i=e.bestScore;if(void 0===n&&void 0===i){var a=pu(t)[this.scene.player.getPlayerId()];n=(null==a?void 0:a.score)||0,i=this.scene.player.getBestScore()}this.bestScore=(i||0)<this.bestScore?this.bestScore:i||0,this.currentScore=n,this.updateData({bestScore:this.bestScore,currentScore:this.currentScore})},n.updateData=function(t){this.payload=t;var e=t.bestScore,n=t.currentScore;if(this.setBestScore(e),n<=e)return this.setCurrentScore(n),this.runScoreAnimation(),void(n>0?this.runScoreCounter():this.counterAnimation=null);this.runAnimation()},n.runAnimation=function(){this.runScoreCounter(),this.scene.time.delayedCall(1300,(function(){}))},n.runScoreAnimation=function(){this.scoreAnimation.play()},n.createScoreAnimation=function(){this.scoreAnimation=new cv({targets:[this.scoreText],props:{scale:{from:1,to:1.3}}})},n.runScoreCounter=function(){var t,e=this,n=this.payload,i=n.bestScore,a=n.currentScore;null==(t=this.counterAnimation)||t.remove(),this.counterAnimation=this.scene.tweens.addCounter({from:0,to:a,delay:700,duration:2e3,completeDelay:300,onUpdate:function(t){e.scene.audio.playSound(Vs.default.SCORE_COUNT);var n=Math.floor(t.getValue());e.runScoreAnimation(),e.setCurrentScore(n)},onComplete:function(){e.setBestScore(i<a?a:i),e.setCurrentScore(a),e.scene.audio.playSound(Vs.default.GAME_OVER)}})},n.setCurrentScore=function(t){this.scoreText.setText(""+t)},e}(GameCore.Screen),SE=yE,AE=GameCore.Configs,EE=AE.Match,xE=(AE.Network,AE.Tutorial),bE=AE.Board,TE=AE.Ads,wE=gs.default.GAMEPLAY_32.FRAME,CE=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).lastTimeInputEnabled=0,n.usedRescue=!1,n.levelManager=void 0,n.bestScoreGlareEffect=void 0,n.header=void 0,n.main=void 0,n.footer=void 0,n.tutorialManager=void 0,n.effectManager=void 0,n.bestScore=0,n.isBestScoreScreenShowed=void 0,n.isGameOver=void 0,n.isShowedNextTargetScreen=void 0,n.piecesByFen=void 0,n.isGameError=void 0,n.gamePlayMode=void 0,n.isNextTarget=!1,n.run=function(){var t=n.storage.getState();if(null===Rl(t)&&n.storage.dispatch(Yd(!1)),n.checkAndAddShortcut(),n.tutorialManager.isValidForTutorial()||xE.ForceUseTutorial)return n.handleStartTutorial(),void n.player.incUserGuideDisplays();var e=n.player.getPlayerId(),i=iu(t).playerId,a=ru(t,{playerId:e}),r=su(t,{opponentId:i});a&&r?n.screen.open(xs):n.startGame()},n.create=function(){t.prototype.create.call((0,ls.default)(n)),n.createBackground(zr.default.BACKGROUND.KEY);var e=n.player.getBestScore();n.bestScore=e,n.createLevelManager(),n.createMain(),n.createHeader(),n.createFooter(),n.createTutorialManager(),n.createEffectManager(),n.createScreens(),n.createBestScoreGlareEffect(),n.createInput(),n.listenEvents(),n.input.setTopOnly(!0),n.preLoadAds()},n.closeSettingScreen=function(){(0,ls.default)(n).screen.close(Ss)},n.closeGameOverScreen=function(){(0,ls.default)(n).screen.close(xs)},n.handlePauseGame=function(){n.isGameOver||n.checkReachTargetScore()||(0,ls.default)(n).screen.open(Ss)},n.handleShowInterstitialAd=function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e&&(e=!0),t.prev=1,n.audio.pauseMusic(),n.ads.canbeShowInterstitialAd()){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,n.ads.showInterstitialAdAsync();case 7:n.analytics.showInterstitialAd(n.getSceneName()),t.next=13;break;case 10:return t.prev=10,t.t0=t.catch(1),t.abrupt("return");case 13:return t.prev=13,e&&n.postSessionScore(),n.audio.playMusic(),n.ads.preloadInterstitialAdAsync().catch(Ht.sendException),n.audio.playMusic(),t.finish(13);case 19:case"end":return t.stop()}}),t,null,[[1,10,13,19]])})));return function(e){return t.apply(this,arguments)}}(),n.rescued=function(){try{var t=n.getLevelLogInfo(),e=t.level,i=t.score,a=t.levelName;n.analytics.levelRescue(e,i,a),n.main.board.rescue(),n.nextLevel(),n.usedRescue=!0}catch(r){}},n.replay=function(){n.restartGame(),n.startGame()},n}(0,Kt.default)(e,t);var n=e.prototype;return n.preload=function(){this.events.on(Phaser.Scenes.Events.WAKE,this.run),this.events.on(Phaser.Scenes.Events.CREATE,this.run)},n.preLoadAds=function(){this.ads.preloadInterstitialAdAsync().catch((function(t){})),this.ads.preloadRewardedVideoAsync().catch((function(t){}))},n.createHeader=function(){this.header=new Jg(this),Phaser.Display.Align.In.TopCenter(this.header,this.gameZone)},n.createLevelManager=function(){this.levelManager=new Gp},n.createBestScoreGlareEffect=function(){this.bestScoreGlareEffect=new _p(this),Phaser.Display.Align.In.Center(this.bestScoreGlareEffect,this.gameZone)},n.createMain=function(){this.main=new Mm(this)},n.createFooter=function(){this.footer=new hg(this),Phaser.Display.Align.In.BottomCenter(this.footer,this.gameZone)},n.createTutorialManager=function(){this.tutorialManager=new Ac(this)},n.createEffectManager=function(){this.effectManager=new Jf(this)},n.createInput=function(){this.isGameOver||(this.header.buttonSetting.onClick=this.handlePauseGame)},n.createScreens=function(){this.createSettingScreen(),this.createRescueScreen(),this.createGameOverScreen(),this.createYourScoreScreen(),this.createScoreReachedScreen(),this.createNextTargetScoreScreen(),this.createBestScoreScreen(),this.createNoSpaceLeftScreen(),this.createTargetScoreScreen(),this.createLeaderboardScreen(),this.createMiniJourneyScreen()},n.createLeaderboardScreen=function(){this.screen.add(Ts,kp)},n.createMiniJourneyScreen=function(){this.screen.add(ws,rA)},n.createTargetScoreScreen=function(){this.screen.add(Fs,fE)},n.createNoSpaceLeftScreen=function(){this.screen.add(_s,uA)},n.createBestScoreScreen=function(){this.screen.add(As,Dm)},n.createNextTargetScoreScreen=function(){this.screen.add(Ls,cA)},n.createScoreReachedScreen=function(){this.screen.add(Ds,IA)},n.createYourScoreScreen=function(){this.screen.add(Ms,SE)},n.createSettingScreen=function(){this.screen.add(Ss,cE)},n.startGame=function(){var t=this;try{this.isGameOver=!1,this.tutorialManager.skipTutorial(),this.closeSettingScreen(),this.closeGameOverScreen(),this.handleUsedRescue(),this.restartGame(),this.header.setVisible(!0),this.header.progressBar.reset(),this.handleGameModeUI(),this.updateCurrentBestScore(),this.updateLevelManager(),this.updateProgressBar(),this.header.buttonSetting.setDisabled(!0),this.time.delayedCall(300,(function(){t.header.buttonSetting.setDisabled(!1)})),this.openTargetScoreScreen(),this.handleGameModeChange()}catch(e){this.isGameError||(this.isGameError=!0,this.replay()),(0,Ht.sendExceptionWithScope)(new Error("Start game scene"),{error:e,scene:"GameScene"})}},n.handleGameModeChange=function(){var t=this,e=[{selector:Ml,callback:function(e){e!==t.gamePlayMode&&t.handleGameModeUI()}}];this.handleStateChange(e)},n.handleGameModeUI=function(){var t,e=this.storage.getState();this.gamePlayMode=Ml(e),this.gamePlayMode&&this.gamePlayMode!==Wr&&g()(t=[Kr,Xr,jr]).call(t,this.gamePlayMode)>=0?this.handleStartGameFriendMode():this.handleStartGameSingleMode()},n.startGameAfterTargetScoreScreenClose=function(){var t,e=this.storage.getState(),n=Ml(e),i=this.getLevelLogInfo(),a=i.level,r=i.score,s=i.levelName;this.analytics.levelStart(a,r,s),this.levelManager.getCurrentIndex()>0&&this.main.board.handleTweenStartMission(),g()(t=[Kr,Xr,jr]).call(t,n)>=0?this.footer.pieces.showNewPieces():this.piecesByFen?this.footer.pieces.showAvailablePieces(this.piecesByFen):this.footer.pieces.showNewPieces()},n.openTargetScoreScreen=function(){var t=this;this.disableInput(),this.time.delayedCall(500,(function(){t.enableInput(),t.screen.open(Fs,{duration:1500})}))},n.handleUsedRescue=function(){this.usedRescue&&this.storage.dispatch(ip())},n.handleStartTutorial=function(){this.analytics.event(ni.AnalyticsEvents.TUTORIAL_BEGIN),this.tutorialManager.start(),this.header.setVisible(!1)},n.handleStartGameSingleMode=function(){var t,e,n=this.storage.getState(),i=(null==(t=Jl(n))?void 0:t.data)||{},a=(null==(e=Jl(n))?void 0:e.score)||0;if(i){var r=i.fen,s=null;if(this.piecesByFen=null,r){var o=this.main.board.getBoardByFen(r);s=this.handleDynamicFenSize(o),this.piecesByFen=this.footer.pieces.getPiecesByFen(r),this.isFenGameOver(s,this.piecesByFen)&&(s=null,this.piecesByFen=null,this.storage.dispatch(_d()),n=this.storage.getState(),a=0,this.resetRescued())}this.main.board.clearBoard(),s&&this.main.board.startGame(s),this.footer.pieces.clearPieces(),this.header.showItemSingleMode(),this.header.mainScoreBlock.setScore(a),this.header.mainScoreBlock.setScoreText(a),this.main.praise.reset()}},n.handleStartGameFriendMode=function(){this.header.showItemPlayWithFriendsMode(),this.header.myScoreBlock.updateInfo(),this.header.opponentScoreBlock.updateInfo(),this.main.praise.reset(),this.main.board.clearBoard(),this.footer.pieces.clearPieces()},n.listenEvents=function(){var t=this;yu.on(Ec.START_GAME,(function(){t.startGame()})),yu.on(Ec.RESCUE,this.rescued),yu.on(Ec.REPLAY,this.replay),yu.on(Ec.GAME_OVER,this.handleGameOver.bind(this)),yu.on("handle_state_change",this.handleStateChange.bind(this))},n.postSessionScore=function(){var t=this.storage.getState(),e=fu(t).score,n=void 0===e?0:e;this.storage.dispatch(Wl(n))},n.getFen=function(){return this.main.board.getFenByBoard()+" "+this.footer.pieces.getFenByPieces()},n.createRescueScreen=function(){this.screen.add(ys,vA)},n.createGameOverScreen=function(){this.screen.add(xs,xv)},n.updateCurrentBestScore=function(){var t=this.player.getBestScore()||0,e=this.storage.getState(),n=fu(e),i=n.score,a=void 0===i?0:i,r=n.bestScore,s=void 0===r?0:r,o=t>s?t:s;o=o>a?o:a,this.player.setScore(o),this.header.bestScoreBlock.setScoreText(o)},n.updateLevelManager=function(){var t=this.getCurrentScoreByMode();this.levelManager.updateCurrentLevelByScore(t)},n.updateProgressBar=function(){var t=this.getCurrentScoreByMode(),e=this.levelManager.updateCurrentLevelByScore(t);this.header.progressBar.setTargetScore(e),this.header.progressBar.setPercent(t/e)},n.setIsGameOver=function(t){this.isGameOver=t},n.handleGameOver=function(){this.isGameOver=!0;var t=this.getLevelLogInfo(),e=t.level,n=t.score,i=t.levelName;this.analytics.levelFail(e,n,i),this.screen.open(xs)},n.handleRequestFinishGame=function(){var t=this;this.isGameOver=!0;var e=this.storage.getState(),n=Il(e);n<EE.MaxRescueCount&&this.ads.preloadRewardedVideoAsync().catch((function(t){})),this.screen.open(_s,{duration:3e3,onClose:function(){if(t.enableInput(),n<EE.MaxRescueCount&&TE.Enabled)return t.screen.open(ys),void(t.isGameOver=!1);t.usedRescue=!1,t.endGame()}})},n.checkAnimPlaying=function(){var t=this.tweens.getAllTweens();return!(!t||0===t.length)},n.disableInput=function(){this.input.enabled=!1,this.footer.pieces.allPieces.forEach((function(t){return t.cancelDrag()}))},n.enableInput=function(){this.input.enabled=!0},n.restartGame=function(){var t;null==(t=this.header.mainScoreBlock.addScore)||t.stop().remove(),this.header.mainScoreBlock.setScore(0),this.header.mainScoreBlock.setScoreText(0),this.header.myScoreBlock.setScore(0),this.header.myScoreBlock.setScoreText(0),this.header.progressBar.hideProgressBar(),this.header.progressBar.setPercent(0),this.levelManager.restart(),this.main.praise.listScore=[]},n.endGame=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.restartGame(),this.handleShowInterstitialAd(!1).catch(Ht.sendException),this.storage.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,r,s,o,h,c,l,u,d,p,f,g,m,v,y,S,A,E,x,b,T,w,C,M,I;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game,a=i.analytics,r=i.facebook,s=i.globalScene,o=i.lang,s.screen.open(vs,{message:o.Text.LOADING,loading:!0}),h=n(),c=Ml(h),l=fu(h),u=l.score,d=void 0===u?0:u,p=l.level,f=void 0===p?0:p,e(Wl(d)),e(Qd(d)),t.next=10,e(ep(c,{score:d}));case 10:if(h=n(),g=Pl(h),m=kl(h),v=Math.floor((m-g)/1e3),a.event(ni.AnalyticsEvents.MATCH_END,{game_mode:GameCore.Utils.String.toUpperCamelCase(c),level:f,level_name:"level_"+f,time_played:v}),y=r.getContextID(),c===Kr&&y&&e(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,r,s,o,h,c,l,u;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=window.game.analytics,t.prev=1,a=window.game.facebook.getContextID(),_u({contextId:a}),r=n(),s=ou(r),o=s.playerId,h=s.score,c=fu(r),l=c.score,!o||o===Hr.playerId){t.next=25;break}if(!(l>h)){t.next=18;break}return t.next=13,Iu(r);case 13:return u=t.sent,t.next=16,Hu(u,r);case 16:t.next=23;break;case 18:return t.next=20,Tu(r);case 20:return u=t.sent,t.next=23,Wu(u,r);case 23:t.next=30;break;case 25:return t.next=27,Tu(r);case 27:return u=t.sent,t.next=30,Wu(u,r);case 30:Lu({imageShare:u}),i.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"InviteGroup",success:!0}),t.next=38;break;case 34:t.prev=34,t.t0=t.catch(1),i.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"InviteGroup",success:!0}),(0,Ht.sendException)(t.t0);case 38:case"end":return t.stop()}}),t,null,[[1,34]])})));return function(e,n){return t.apply(this,arguments)}}()),!y||c!==Xr){t.next=26;break}if(S=iu(h),(A=S.playerId)&&A!==Hr.playerId){t.next=21;break}return t.abrupt("return");case 21:E=pu(h),x=E[A]||{},b=x.score,T=void 0===b?0:b,w=tu(h),C=w._id,M=w.whitePlayerFinish,I=w.blackPlayerFinish,e(M&&I?d>T?Yu(A,{matchId:C,contextId:y}):Vu(A,{matchId:C,contextId:y}):zu(A,{matchId:C,contextId:y,score:d}));case 26:t.next=31;break;case 28:t.prev=28,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 31:return t.prev=31,Ud(300),t.finish(31);case 34:case"end":return t.stop()}}),t,null,[[0,28,31,34]])})));return function(e,n){return t.apply(this,arguments)}}()),this.resetRescued();case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.handleUpdateScore=function(t){if(!this.tutorialManager.isRunning()){var e=this.getCurrentScoreByMode()+t;this.storage.dispatch(Ld({score:e})),this.updateMatchData()}},n.handleAddScoreAnim=function(t){var e,n=this.storage.getState(),i=Ml(n);this.tutorialManager.isRunning()?this.header.mainScoreBlock.animAddScore(t):i&&i!==Wr&&g()(e=[Kr,Xr,jr]).call(e,i)>=0?this.header.myScoreBlock.animAddScore(t):this.header.mainScoreBlock.animAddScore(t)},n.getBestScore=function(){var t=this.storage.getState();return fu(t).bestScore},n.bestScoreReached=function(){if(!this.isBestScoreScreenShowed&&!this.isGameOver){var t=this.getBestScore(),e=this.getCurrentScoreByMode();!t||t>=e||(this.player.setScore(e),this.isBestScoreScreenShowed=!0,this.audio.playSound(Vs.default.CONGRATULATION),this.bestScoreGlareEffect.playEffect())}},n.updateProgressTargetScore=function(t){var e=t/this.header.progressBar.getTargetScore();this.header.progressBar.setPercent(e)},n.checkReachTargetScore=function(){return this.getCurrentScoreByMode()>=this.header.progressBar.getTargetScore()},n.handleNextTargetScore=function(){var t=this;if(!this.isGameOver&&(this.checkReachTargetScore()&&!this.isShowedNextTargetScreen)){this.isShowedNextTargetScreen=!0,this.disableInput();var e=this.getLevelLogInfo(),n=e.level,i=e.score,a=e.levelName;this.analytics.levelComplete(n,i,a),this.screen.open(Ds,{duration:4e3,onClose:function(){var e=(0,Xt.default)(qt().mark((function e(){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.isShowedNextTargetScreen=!1,t.handleShowInterstitialAd(!1).catch(Ht.sendException),t.showNextTargetScreen();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()})}},n.getCurrentScoreByMode=function(){var t,e=this.storage.getState(),n=Ml(e);return n&&n!==Wr&&g()(t=[Kr,Xr,jr]).call(t,n)>=0?this.header.myScoreBlock.score:this.header.mainScoreBlock.score},n.showNextTargetScreen=function(){var t=this.getCurrentScoreByMode();this.levelManager.updateCurrentLevelByScore(t);this.screen.open(Ls)},n.updateMatchData=function(){if(!this.tutorialManager.isRunning()){var t=this.getFen(),e=this.storage.getState(),n=Jl(e).data||{},i=Ml(e),a=Il(e);if(!i||i===Wr){var r,s,o=Ql(e),h=fu(e).score,c=void 0===h?0:h;this.storage.dispatch((r=o,s={score:c,rescued:a,data:(0,wt.default)({},n,{fen:t}),updateAt:Date.now()},function(t,e){try{hd((0,wt.default)({matchId:r},s));var n=e(),i=Ql(n);cd({matchId:r,currentMatchId:i}),t({type:ta,payload:{match:s}});var a=s.data;s.data=md(a),Be(gd.SingleMatchStore,s)}catch(o){if(o instanceof Xu)return;(0,Ht.sendException)(o)}}))}}},n.nextLevel=function(){var t=this.getCurrentScoreByMode(),e=this.levelManager.updateCurrentLevelByScore(t);this.isNextTarget=!0,this.header.progressBar.hideProgressBar(),this.header.progressBar.setTargetScore(e),this.header.progressBar.setPercent(t/e);var n=this.getLevelLogInfo(),i=n.level,a=n.levelName;this.analytics.levelStart(i,t,a)},n.update=function(t){this.input.enabled||this.checkAnimPlaying()?this.lastTimeInputEnabled=t:t-this.lastTimeInputEnabled>=3e3&&(this.enableInput(),this.lastTimeInputEnabled=t)},n.isFenGameOver=function(t,e){for(var n=[],i=0;i<e.length;i++){var a=e[i],r=a.type,s=a.direction,o=a.isReverse;switch(r){case Yo:case zo:case Ho:n.push({data:kf.getData(r,s,o)});break;case Wo:case Xo:case Ko:case jo:n.push({data:Of.getData(r,s)});break;case qo:case Zo:case Jo:n.push({data:Df.getData(r)});break;case $o:n.push({data:Bf.getData(s)});break;case th:n.push({data:Uf.getData(s)});break;case sh:n.push({data:Xf.getData(s)});break;case nh:case ih:case ah:case rh:n.push({data:Hf.getData(r,s)});break;case Qo:n.push({data:Nf.getData(s)});break;case eh:n.push({data:Yf.getData()})}}return df(t,n)},n.handleDynamicFenSize=function(t){var e,n,i=0;if((n=t.length)&&(i=t[0].length),0===n||0===i)return t;var a=et()(e=[]).call(e,t);if(n>bE.rows)ds()(a).call(a,bE.rows,n-bE.rows);else if(i<bE.rows)for(var r=0;r<bE.rows-n;r++){var s;a.push(A()(s=new Array(n)).call(s,{value:0,frame:wE.GEM_TRANSPARENT}))}return i>bE.cols?a.forEach((function(t){ds()(t).call(t,bE.cols,i-bE.cols)})):i<bE.cols&&a.forEach((function(t){for(var e=0;e<bE.cols-i;e++)t.push({value:0,frame:wE.GEM_TRANSPARENT})})),a},n.checkAndAddShortcut=function(){if(!this.game.player.getPlayer().isUserNew){var t=this.storage.getState();Qr(t)!=jr&&this.facebook.attemptToAddShortcut()}},n.getLevelName=function(){var t,e=this.levelManager.getCurrentIndex()+1;return"target_"+fs()(t=GameCore.Utils.Number).call(t,e,4,"0")},n.getLevelLogInfo=function(){return{level:this.levelManager.getCurrentIndex()+1,score:this.getCurrentScoreByMode(),levelName:this.getLevelName()}},n.resetRescued=function(){this.storage.dispatch((function(t){t({type:Ki,payload:{}}),Be(Bd.SingleMatchStore,{rescued:0})}))},e}(Rp.default);for(var ME=CE,IE=function(t){return{type:vi,payload:{sceneKey:t}}},PE=(0,be.createSelector)([function(t){return t.scene.currentSceneKey}],(function(t){return t})),kE=gs.default.DEFAULT,RE=kE.KEY,OE=kE.FRAME,_E=function(t){function e(e){var n;return(n=t.call(this,e,0,0)||this).fps=0,n.fpsString="FPS: %1",n.fpsText=void 0,n.background=void 0,n.lastUpdate=void 0,n.update=function(t){if(!(t-n.lastUpdate<800)){n.lastUpdate=t;var e=Math.floor(n.scene.game.loop.actualFps);n.setFps(e)}},n.createFps(),n.setDepth(zs.default.DEBUG),n.scene.add.existing((0,ls.default)(n)),n.scene.events.on(Phaser.Scenes.Events.UPDATE,n.update),n}(0,Kt.default)(e,t);var n=e.prototype;return n.setFps=function(t){this.fps=t;var e=Phaser.Utils.String.Format(this.fpsString,[t]);this.fpsText.setText(e)},n.createFps=function(){this.background=this.scene.make.image({key:RE,frame:OE.BLANK}),this.background.setName("BG"),this.background.setTint(13801480),this.background.setWorldSize(45,25),this.fpsText=this.scene.make.bitmapText({size:this.scene.fontSize(14),text:this.fpsString,font:Hs.default.PRIMARY.KEY,origin:{x:.5,y:.5}}),this.fpsText.setName("FPS Meter"),Phaser.Display.Align.In.Center(this.fpsText,this.background),this.add([this.background,this.fpsText]),this.setFps(0)},e}(Phaser.GameObjects.Container),DE=_E,LE=function(t){function e(e){var n;if((n=t.call(this,e,0,0)||this).performance=void 0,n.memory=0,n.maxMemoryLimit=void 0,n.maxPercentThreshold=void 0,n.normalColor=3459162,n.warningColor=16768343,n.alarmColor=15812200,n.memoryString="Memory: %1MB / %2MB",n.memoryText=void 0,n.lastUpdate=void 0,n.update=function(t){if(!(t-n.lastUpdate<1e3)){n.lastUpdate=t;var e=n.performance.memory.usedJSHeapSize,i=1048576*n.maxMemoryLimit,a=Math.round(e/1048576);n.setMemory(a),n.memoryText.setTint(n.normalColor),e>n.maxPercentThreshold/100*i&&n.memoryText.setTint(n.warningColor),e>i&&n.memoryText.setTint(n.alarmColor)}},n.performance=window.performance,n.createMemory(),n.setDepth(zs.default.DEBUG),n.scene.add.existing((0,ls.default)(n)),!n.isSupport())return n.memoryText.setText("Memory: not supported!"),(0,ls.default)(n);var i=n.performance.memory.jsHeapSizeLimit;return n.maxPercentThreshold=90,n.setMaxMemory(i/1048576),n.scene.events.on(Phaser.Scenes.Events.UPDATE,n.update),n}(0,Kt.default)(e,t);var n=e.prototype;return n.isSupport=function(){var t;return this.performance&&!(null==(t=this.performance)||!t.memory)},n.setMaxMemory=function(t){this.maxMemoryLimit=Math.round(t)},n.setMemory=function(t){this.memory=t;var e=Phaser.Utils.String.Format(this.memoryString,[t,this.maxMemoryLimit]);this.memoryText.setText(e)},n.createMemory=function(){this.memoryText=this.scene.make.bitmapText({size:this.scene.fontSize(14),text:this.memoryString,font:Hs.default.PRIMARY.KEY,depth:2e3}),this.memoryText.setName("Memory Meter"),this.add(this.memoryText),this.setMemory(0)},e}(Phaser.GameObjects.Container),BE=LE,FE=gs.default.DEFAULT,NE=FE.KEY,GE=FE.FRAME,UE=function(t){function e(e,n,i,a){var r;return(r=t.call(this,e,n,i,a)||this).popup=void 0,r.title=void 0,r.contents=void 0,r.buttonNo=void 0,r.buttonYes=void 0,r.messageText=void 0,r.popupShowUpAnimation=void 0,r.contentShowUpAnimation=void 0,r.popupFadeOutAnimation=void 0,r.onHandleYes=void 0,r.open=function(e){t.prototype.open.call((0,ls.default)(r),e),r.setVisible(!0);var n=r.getData(["message","onHandleYes"]),i=n[0],a=void 0===i?"":i,s=n[1];r.setTextMessage(a),r.onHandleYes=s,r.runOpenAnimation()},r.handleClosePopup=function(){r.runCloseAnimation(),r.popupFadeOutAnimation.next((function(){r.scene.screen.close(r.name)}))},r.handleNo=function(){r.close()},r.handleYes=function(){r.onHandleYes&&r.onHandleYes(),r.close()},r.setVisible(!1),r.setDepth(Gs),r.createPopup(),r.createPopupContent(),r.background.setAlpha(.5),r}(0,Kt.default)(e,t);var n=e.prototype;return n.runAnim=function(){this.messageText.setScale(0).setAlpha(0)},n.createPopup=function(){this.popup=new uo(this.scene,0,0,325,260),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createPopupContent=function(){this.createTitle(),this.createMessage(),this.createButtonNo(),this.createButtonYes(),this.popup.add([this.title]),this.contents=this.scene.make.group({}),this.contents.addMultiple([this.messageText,this.buttonNo,this.buttonYes])},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:NE,frame:GE.TEXT_TUTORIAL});t.setWorldSize(122,19);var e=new Ys.default(this.scene,NE,GE.BUTTON_CLOSE,35,35);e.onClick=this.handleClosePopup,e.setName("Close"),Phaser.Display.Align.In.Center(e,this.title,155,-19),Phaser.Display.Align.In.Center(t,this.title,0,10),this.title.add([t,e]),this.popup.add(this.title),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,-2)},n.createButtonNo=function(){this.buttonNo=new Ys.default(this.scene,NE,GE.BUTTON_DARK_BLUE,120,40),this.buttonNo.setName("No");var t=this.scene.make.image({key:NE,frame:GE.TEXT_NO});t.setWorldSize(36,16.5),this.buttonNo.add(t),Phaser.Display.Align.In.Center(t,this.buttonNo),this.popup.add(this.buttonNo),Phaser.Display.Align.In.Center(this.buttonNo,this.popup,80,60),this.buttonNo.onClick=this.handleNo},n.createButtonYes=function(){this.buttonYes=new Ys.default(this.scene,NE,GE.BUTTON_GREEN_LARGE,120,40),this.buttonYes.setName("Yes");var t=this.scene.make.image({key:NE,frame:GE.TEXT_YES});t.setWorldSize(28.5,20),this.buttonYes.add(t),Phaser.Display.Align.In.Center(t,this.buttonYes),this.popup.add(this.buttonYes),Phaser.Display.Align.In.Center(this.buttonYes,this.popup,-80,60),this.buttonYes.onClick=this.handleYes},n.createMessage=function(){this.messageText=this.scene.make.bitmapText({font:Hs.default.PRIMARY.KEY,size:this.scene.fontSize(45),origin:{x:.5,y:.5}}),this.messageText.align=1,this.popup.add(this.messageText),Phaser.Display.Align.In.Center(this.messageText,this.popup,0,-40),this.messageText.setScale(0).setAlpha(0)},n.runCloseAnimation=function(){this.runPopupExitsAnimation(0,200)},n.runPopupExitsAnimation=function(t,e){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new $s({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){i.popup.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.setTextMessage=function(t){this.messageText.setText(""+t)},n.runOpenAnimation=function(){this.scene.audio.playSound(Vs.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runPopupContentEntrancesAnimation(200,300)},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup,i=(n.y,n.scale);this.popupShowUpAnimation=new so({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){this.contentShowUpAnimation||(this.contentShowUpAnimation=new io({targets:this.contents.getChildren(),duration:e,delay:this.scene.tweens.stagger(80,{start:t}),props:{alpha:{start:0,from:0,to:1}}})),this.contentShowUpAnimation.play()},e}(GameCore.Screen),VE=UE,YE=function(t){function e(e,n,i,a){var r;return(r=t.call(this,e,n,i,a)||this).loadingIcon=void 0,r.messageText=void 0,r.openAnimation=void 0,r.closeTimerEvent=void 0,r.addLoadingIcon(),r.addMessageText(),r.setDepth(Us),r.background.setAlpha(.8),r}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(e){var n,i=this;t.prototype.open.call(this,e);var a=this.getData(["message","duration","loading"]),r=a[0],s=void 0===r?"":r,o=a[1],h=void 0===o?0:o,c=a[2],l=void 0!==c&&c;this.setMessage(s),this.showLoading(l),null==(n=this.closeTimerEvent)||n.remove(),h>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:h,callback:function(){i.visible&&i.scene.screen.close(i.name)}})),this.runOpenAnimation()},n.addLoadingIcon=function(){this.loadingIcon=new El(this.scene),this.add(this.loadingIcon),Phaser.Display.Align.In.Center(this.loadingIcon,this.zone)},n.addMessageText=function(){this.messageText=this.scene.make.bitmapText({size:this.scene.fontSize(50),font:Hs.default.PRIMARY_LIGHT.KEY,origin:{x:.5,y:.5}}),this.messageText.setCenterAlign(),this.add(this.messageText)},n.setMessage=function(t){this.messageText.setText(t)},n.showLoading=function(t){this.loadingIcon.setVisible(t);var e=!1===t?20:80;Phaser.Display.Align.In.Center(this.messageText,this.zone,0,e)},n.runOpenAnimation=function(){var t,e;null==(t=this.openAnimation)||t.stop(),null==(e=this.openAnimation)||e.remove(),this.openAnimation=new io({targets:[this.messageText,this.loadingIcon],props:{scale:{getStart:function(t){return t.scale-.3},getEnd:function(t){return t.scale}}}}),this.openAnimation.play()},n.logPageviewOnOpen=function(){},n.logPageviewOnClose=function(){},e}(GameCore.Screen),zE=YE,HE=gs.default.DEFAULT,WE=HE.KEY,XE=HE.FRAME,KE=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).mask=void 0,n.fadeInAnim=void 0,n.fadeOutAnim=void 0,n.fpsMeter=void 0,n.memoryMeter=void 0,n.switchScene=function(t){n.currentScene.key!==t&&n.currentScene.switch(t)},n.runScene=function(t){n.currentScene.run(t)},n.emitGameEventStartScene=function(t){var e=t.scene.key;n.updateSceneState(),n.runMaskFadeOutAnimation(),n.updateActiveSceneKey(e),n.game.events.emit(Phaser.Scenes.Events.START,e),(0,Ht.addBreadcrumbSentry)("scene","Start scene: "+e)},n.emitGameEventSleepScene=function(t){var e=t.scene.scene.key;e!==is.SceneKeys.LOAD_SCENE&&(n.runMaskFadeInAnimation(),n.game.events.emit(Phaser.Scenes.Events.SLEEP,e))},n.emitGameEventWakeScene=function(t){var e=t.scene.scene.key;e!==is.SceneKeys.LOAD_SCENE&&(n.updateSceneState(),n.runMaskFadeOutAnimation(),n.updateActiveSceneKey(e),n.game.events.emit(Phaser.Scenes.Events.WAKE,e))},n.emitGameEventPauseScene=function(t){var e=t.scene.scene.key;n.game.events.emit(Phaser.Scenes.Events.PAUSE,e)},n.emitGameEventResumeScene=function(t){var e=t.scene.key;n.game.events.emit(Phaser.Scenes.Events.RESUME,e)},n.emitGameEventShutdownScene=function(t){var e=t.scene.scene.key;n.game.events.emit(Phaser.Scenes.Events.SHUTDOWN,e)},n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.listenScenesEvents(),this.game.globalScene=this},n.setup=function(){this.scaleGame(),this.addMask(),this.addNotifyScreen(),this.addAlertScreen(),this.addFPS(),this.addMemory()},n.addNotifyScreen=function(){var t=this.screen.add(vs,zE);Phaser.Display.Align.In.Center(t,this.gameZone)},n.addAlertScreen=function(){var t=this.screen.add(ms,VE);Phaser.Display.Align.In.Center(t,this.gameZone)},n.addMask=function(){this.mask=this.make.image({key:WE,frame:XE.BLANK});var t=this.gameZone,e=t.width,n=t.height;this.mask.setAlpha(0),this.mask.setOrigin(0,0),this.mask.setTint(0),this.mask.setWorldSize(e,n)},n.addFPS=function(){GameCore.Configs.Statistics.ShowFPSInGame&&(this.fpsMeter=new DE(this),Phaser.Display.Align.In.TopLeft(this.fpsMeter,this.gameZone,-20,-10))},n.addMemory=function(){GameCore.Configs.Statistics.ShowMemoryInGame&&(this.memoryMeter=new BE(this),Phaser.Display.Align.In.TopLeft(this.memoryMeter,this.gameZone,-45,-3))},n.updateSceneState=function(){this.setGlobalSceneOnTop()},n.setGlobalSceneOnTop=function(){this.scene.bringToTop(this)},n.runMaskFadeInAnimation=function(){},n.runMaskFadeOutAnimation=function(){},n.listenScenesEvents=function(){var t=this;this.scene.manager.getScenes(!1).forEach((function(e){e.events.on(Phaser.Scenes.Events.CREATE,t.emitGameEventStartScene),e.events.on(Phaser.Scenes.Events.SLEEP,t.emitGameEventSleepScene),e.events.on(Phaser.Scenes.Events.WAKE,t.emitGameEventWakeScene),e.events.on(Phaser.Scenes.Events.PAUSE,t.emitGameEventPauseScene),e.events.on(Phaser.Scenes.Events.RESUME,t.emitGameEventResumeScene),e.events.on(Phaser.Scenes.Events.SHUTDOWN,t.emitGameEventShutdownScene)})),this.events.on(is.SceneEvents.SWITCH,this.switchScene),this.events.on(is.SceneEvents.RUN,this.runScene)},n.getActiveScene=function(){return this.scene.manager.getScenes(!0)[0]},n.updateActiveSceneKey=function(t){t!==is.SceneKeys.GLOBAL_SCENE&&this.storage.dispatch(IE(t))},n.logEventOpen=function(){},n.logPageviewOnOpen=function(){},(0,Se.default)(e,[{key:"currentScene",get:function(){var t=this.storage.getState(),e=PE(t);return(e?this.scene.manager.getScene(e):this.getActiveScene()).scene}}]),e}(Rp.default),jE=KE,qE=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="LoadResourceFail",i.message=e||"Load resource fail",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,se.default)(Error)),ZE=[{id:"pass-levels",title:"PASS_10_LEVELS",require:{level:10},reward:{diamond:100}},{id:"collect-diamonds",title:"COLLECT_300_DIAMONDS",require:{diamond:300},reward:{diamond:100}},{id:"reach-score",title:"REACH_TOTAL_SCORES",require:{score:1e5},reward:{diamond:200}}],JE=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",ZE);case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),QE=(0,be.createSelector)([function(t){var e;return null==(e=t.dailyTasks)?void 0:e.tasks}],(function(t){return t})),$E=(0,be.createSelector)([function(t){var e;return null==(e=t.dailyTasks)?void 0:e.process}],(function(t){return t})),tx=(0,be.createSelector)([function(t){var e;return null==(e=t.dailyTasks)?void 0:e.isRequesting}],(function(t){return t})),ex=((0,be.createSelector)([function(t){var e;return null==(e=t.dailyTasks)?void 0:e.isNotice}],(function(t){return t})),GameCore.Configs.DailyTasks),nx=function(t){return function(e){e({type:Qa,payload:{tasks:t}});var n=window.game.player.getCustomData("dailyTasks")||{},i=n.startedTime,a=void 0===i?0:i,r=n.logTasks,s=void 0===r?{}:r;e((Date.now()-a)/1e3>ex.Duration?ix(t):ax(s))}},ix=function(t){return function(e){var n={};t.forEach((function(t){var e=t.id,i=t.require;n[e]={},Y()(i).forEach((function(t){var i;n[e]=((i={})[t]=0,i.rewarded=!1,i)}))})),window.game.player.setCustomData("dailyTasks",{logTasks:n,startedTime:Date.now()}),e(ax(n)),yu.emit(ql.EVENTS.TASKS_RESET)}},ax=function(t){return{type:$a,payload:{process:t}}},rx=n(322),sx=n.n(rx),ox=function(){var t=(window.game.player.getCustomData("dailyTasks")||{}).logTasks;return GameCore.Utils.Json.clone(t)},hx=function(){function t(t,e){var n=this;this.game=void 0,this.id=void 0,this.taskData=void 0,this.requireTypes=void 0,this.process=function(t,e){var i;void 0===e&&(e=!0);var a=t.type,r=t.value;if(!(r<1)&&(-1!==g()(i=n.requireTypes).call(i,a)&&!n.isPassRequiredTarget(a)&&n.processMore(t))){a=t.type,r=t.value;var s=n.getCorrectValue(a,r);n.game.storage.dispatch(function(t,e,n,i){return void 0===i&&(i=!0),function(a){var r=ox();if(GameCore.Utils.Valid.isObject(r)){var s=r;GameCore.Utils.Object.hasOwn(s,t)&&!s[t].rewarded&&(i&&(s[t][e]+=n,window.game.player.setCustomData("dailyTasks",{logTasks:s})),a({type:tr,payload:{id:t,type:e,value:n}}))}}}(n.id,a,s,e)),n.isTaskFinished(a)&&n.game.storage.dispatch(function(t){return function(e){e({type:ir,payload:{id:t}}),yu.emit(ql.EVENTS.NOTICE_UPDATE)}}(n.id))}},this.game=t,this.id=e,this.init()}var e=t.prototype;return e.init=function(){var t=this,e=this.game.storage.getState(),n=QE(e)||[];if(!((null==n?void 0:n.length)<1)){var i=null==n?void 0:sx()(n).call(n,(function(e){return e.id===t.id}));i&&(this.taskData=i,this.requireTypes=Y()(this.taskData.require),this.initEvents())}},e.getDataByType=function(t){var e=this.game.storage.getState(),n=$E(e),i={value:0,target:0};if(!n)return i;if(!GameCore.Utils.Object.hasOwn(n,this.taskData.id))return i;var a=n[this.taskData.id];if(GameCore.Utils.Valid.isObject(a)&&GameCore.Utils.Object.hasOwn(a,t)){var r=a[t];"number"===typeof r&&(i.value=r)}return i.target=this.taskData.require[t]||0,i},e.getCorrectValue=function(t,e){var n=this.getDataByType(t),i=n.value,a=n.target,r=e;return i+e>a&&(r=a-i),Math.round(r)},e.isPassRequiredTarget=function(t){var e=this.getDataByType(t);return e.value>=e.target},e.isTaskFinished=function(t){var e=this.getDataByType(t);return e.value>=e.target},t}(),cx=hx,lx=ql.COLLECT_DIAMONDS,ux=lx.ID,dx=lx.EVENTS,px=function(t){function e(e){return t.call(this,e,ux)||this}(0,Kt.default)(e,t);var n=e.prototype;return n.initEvents=function(){yu.off(dx.COLLECT_DIAMONDS,this.process),yu.on(dx.COLLECT_DIAMONDS,this.process)},n.processMore=function(){return!0},e}(cx),fx=px,gx=ql.PASS_LEVELS,mx=gx.ID,vx=gx.EVENTS,yx=function(t){function e(e){return t.call(this,e,mx)||this}(0,Kt.default)(e,t);var n=e.prototype;return n.initEvents=function(){yu.off(vx.PASS_LEVEL,this.process),yu.on(vx.PASS_LEVEL,this.process)},n.processMore=function(){return!0},e}(cx),Sx=yx,Ax=ql.REACH_SCORE,Ex=Ax.ID,xx=Ax.EVENTS,bx=function(t){function e(e){var n;return(n=t.call(this,e,Ex)||this).totalScore=void 0,n.lastUpdate=void 0,n.totalScore=0,n.lastUpdate=Date.now(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.initEvents=function(){yu.off(xx.ADD_SCORE,this.process),yu.on(xx.ADD_SCORE,this.process)},n.processMore=function(t){var e=t.value,n=Date.now();return n-this.lastUpdate<3e3?(this.totalScore+=e,!1):(t.value+=this.totalScore,this.totalScore=0,this.lastUpdate=n,!0)},e}(cx),Tx=bx,wx=function(){function t(t){var e=this;this.game=void 0,this.eventsListener=void 0,this.init=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.eventsListener={},t.next=3,e.initData();case 3:e.initEvents();case 4:case"end":return t.stop()}}),t)}))),this.initData=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.game.storage.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n(),!tx(i)){t.next=4;break}return t.abrupt("return");case 4:return e({type:Ja,payload:{}}),t.next=7,JE();case 7:a=t.sent,e(nx(a));case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)}))),this.game=t,this.init()}var e=t.prototype;return e.getEventListener=function(t){return this.eventsListener[t]},e.initEvents=function(){this.eventsListener[ql.PASS_LEVELS.ID]=new Sx(this.game),this.eventsListener[ql.REACH_SCORE.ID]=new Tx(this.game),this.eventsListener[ql.COLLECT_DIAMONDS.ID]=new fx(this.game)},t}(),Cx=wx,Mx=[{name:"collect-red-gems",id:"collect-gems",require:{red:5},reward:50},{name:"collect-blue-gems",id:"collect-gems",require:{blue:5},reward:50},{name:"collect-pink-gems",id:"collect-gems",require:{pink:5},reward:50},{name:"collect-green-gems",id:"collect-gems",require:{green:5},reward:50},{name:"collect-yellow-gems",id:"collect-gems",require:{yellow:5},reward:50},{name:"collect-red-blue-gems",id:"collect-gems",require:{red:5,blue:5},reward:120},{name:"collect-red-pink-gems",id:"collect-gems",require:{red:5,pink:5},reward:120},{name:"collect-red-green-gems",id:"collect-gems",require:{red:5,green:5},reward:120},{name:"collect-red-yellow-gems",id:"collect-gems",require:{red:5,yellow:5},reward:120},{name:"collect-blue-pink-gems",id:"collect-gems",require:{blue:5,pink:5},reward:120},{name:"collect-blue-green-gems",id:"collect-gems",require:{blue:5,green:5},reward:120},{name:"collect-blue-yellow-gems",id:"collect-gems",require:{blue:5,yellow:5},reward:120},{name:"collect-pink-green-gems",id:"collect-gems",require:{pink:5,green:5},reward:120},{name:"collect-pink-yellow-gems",id:"collect-gems",require:{pink:5,yellow:5},reward:120},{name:"collect-green-yellow-gems",id:"collect-gems",require:{green:5,yellow:5},reward:120},{name:"collect-red-blue-pink-gems",id:"collect-gems",require:{red:5,blue:5,pink:5},reward:210},{name:"collect-red-blue-green-gems",id:"collect-gems",require:{red:5,blue:5,green:5},reward:210},{name:"collect-red-blue-yellow-gems",id:"collect-gems",require:{red:5,blue:5,yellow:5},reward:210},{name:"collect-red-pink-green-gems",id:"collect-gems",require:{red:5,pink:5,green:5},reward:210},{name:"collect-red-pink-yellow-gems",id:"collect-gems",require:{red:5,pink:5,yellow:5},reward:210},{name:"collect-red-green-yellow-gems",id:"collect-gems",require:{red:5,green:5,yellow:5},reward:210},{name:"collect-blue-pink-green-gems",id:"collect-gems",require:{blue:5,pink:5,green:5},reward:210},{name:"collect-blue-pink-yellow-gems",id:"collect-gems",require:{blue:5,pink:5,yellow:5},reward:210},{name:"collect-blue-green-yellow-gems",id:"collect-gems",require:{blue:5,green:5,yellow:5},reward:210},{name:"collect-pink-green-yellow-gems",id:"collect-gems",require:{pink:5,green:5,yellow:5},reward:210}],Ix=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Mx);case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Px=(0,be.createSelector)([function(t){var e;return null==(e=t.missions)?void 0:e.missions}],(function(t){return t})),kx=(0,be.createSelector)([function(t){var e;return null==(e=t.missions)?void 0:e.isRequesting}],(function(t){return t})),Rx=((0,be.createSelector)([Px,function(t,e){return e.name}],(function(t,e){return t?"string"!==typeof e?null:GameCore.Utils.Object.hasOwn(t,e)?t[e]:null:null})),function(t){return{type:Wa,payload:{missions:t}}}),Ox={TYPES:{COLLECT_GEMS:"collect-gems",USE_ITEM:"use-item",COMBO:"combo"},EVENTS:{MISSION_START:"mission-start",MISSION_UPDATE:"mission-update",MISSION_FAILED:"mission-failed",MISSION_COMPLETED:"mission-completed"}},_x=(0,be.createSelector)([function(t){var e;return null==(e=t.missions)?void 0:e.mission}],(function(t){return t})),Dx=((0,be.createSelector)([_x],(function(t){return t?t.name:null})),function(){function t(t,e,n){var i=this;this.game=void 0,this.id=void 0,this.name=void 0,this.reward=void 0,this.process=function(t){var e=t.id,n=t.type,a=t.value;a<1||i.id===e&&i.isTypeRequired(n)&&i.processMore(t)&&(i.game.storage.dispatch(function(t,e,n){return{type:Ka,payload:{name:t,type:e,value:n}}}(i.name,n,a)),i.isMissionComplete()&&(yu.emit(Ox.EVENTS.MISSION_COMPLETED,{name:i.name,reward:i.reward}),i.game.storage.dispatch(function(t){return{type:ja,payload:{name:t}}}(i.name))))},this.id=e,this.name=n,this.game=t}var e=t.prototype;return e.start=function(){var t=this.game.storage.getState(),e=_x(t);e&&e.name===this.name&&(this.reward=e.reward,this.initEvents())},e.getMissionData=function(){var t=this.game.storage.getState(),e=_x(t);return e?e.name!==this.name?null:e:null},e.getDataByType=function(t){var e=this.getMissionData();if(!e)return null;var n=e.require[t];return{value:e.process[t],target:n}},e.isTypeRequired=function(t){var e=this.getDataByType(t);return!!e&&e.target>0},e.isMissionComplete=function(){var t=this.getMissionData();if(!t)return!0;var e=t.require,n=t.process,i=!0;return Y()(e).forEach((function(t){if(i){var a=e[t];n[t]<a&&(i=!1)}})),i},t}()),Lx=Dx,Bx=Ox.EVENTS,Fx=Ox.TYPES,Nx=function(t){function e(e,n){return t.call(this,e,Fx.COLLECT_GEMS,n)||this}(0,Kt.default)(e,t);var n=e.prototype;return n.initEvents=function(){yu.off(Bx.MISSION_UPDATE,this.process),yu.on(Bx.MISSION_UPDATE,this.process)},n.processMore=function(){return!0},e}(Lx),Gx=Nx,Ux=Ox.EVENTS,Vx=Ox.TYPES,Yx=function(t){function e(e,n){return t.call(this,e,Vx.COMBO,n)||this}(0,Kt.default)(e,t);var n=e.prototype;return n.initEvents=function(){yu.off(Ux.MISSION_UPDATE,this.process),yu.on(Ux.MISSION_UPDATE,this.process)},n.processMore=function(t){var e=this.getMissionData();if(!e)return!1;var n=t.type;return t.value>=e.require[n]},e}(Lx),zx=Yx,Hx=Ox.EVENTS,Wx=Ox.TYPES,Xx=function(t){function e(e,n){return t.call(this,e,Wx.USE_ITEM,n)||this}(0,Kt.default)(e,t);var n=e.prototype;return n.initEvents=function(){yu.off(Hx.MISSION_UPDATE,this.process),yu.on(Hx.MISSION_UPDATE,this.process)},n.processMore=function(t){return!0},e}(Lx),Kx=Xx,jx=function(){function t(t){var e=this;this.game=void 0,this.listener=void 0,this.init=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.initData();case 2:e.initListeners(),e.initEvents();case 4:case"end":return t.stop()}}),t)}))),this.initData=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.game.storage.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n(),!kx(i)){t.next=4;break}return t.abrupt("return");case 4:return e({type:Ha,payload:{}}),t.next=7,Ix();case 7:a=t.sent,e(Rx(a));case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)}))),this.startListener=function(t){e.listener[t]&&e.listener[t].start()},this.game=t,this.init()}var e=t.prototype;return e.initListeners=function(){var t=this;this.listener={};var e=this.game.storage.getState(),n=Px(e);n&&Y()(n).forEach((function(e){switch(n[e].id){case Ox.TYPES.COLLECT_GEMS:t.listener[e]=new Gx(t.game,e);break;case Ox.TYPES.COMBO:t.listener[e]=new zx(t.game,e);break;case Ox.TYPES.USE_ITEM:t.listener[e]=new Kx(t.game,e)}}))},e.initEvents=function(){yu.off(Ox.EVENTS.MISSION_START,this.startListener),yu.on(Ox.EVENTS.MISSION_START,this.startListener)},t}(),qx=jx,Zx=(GameCore.Configs.Match,function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,r,s,o,h,c,l,u,d,p,f,m,v,y,S,A,E,x,b,T,w,C,M;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n(),a=Jr(i),r=Qr(i),s=window.game,o=s.player,h=s.analytics,c=s.facebook,l=s.globalScene,u=o.getPlayer(),d=a.contextId,p=a.entryPointData,m=(f=p||{}).type,v=f.matchId,y=f.opponentId,S=f.playerId,A=f.playerName,E=f.playerPhoto,x=f.playerScore,b=u.playerId===S,T=Hr,b||"string"!==typeof S||"string"!==typeof A||(T={playerId:S,name:A,photo:"string"===typeof E?E:"",locale:"en_US"}),u.isUserNew&&h.event(ni.AnalyticsEvents.NEW_USER),r!==jr){t.next=25;break}return t.prev=12,t.next=15,c.getTournamentAsync();case 15:w=t.sent,C=w.getID().toString(),e(Ul(C)),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(12),(0,Ht.sendException)(t.t0);case 23:return e(zd()),t.abrupt("return");case 25:if(r!==Xr){t.next=34;break}if(m!==Nr){t.next=30;break}return b||o.updateConnectedPlayers([T]),e(Kd(d,T.playerId,!0)),t.abrupt("return");case 30:if(!(g()(M=[y,S]).call(M,u.playerId)>=0)||m!==Vr){t.next=34;break}return e(Jd(v,b?y:S)),t.abrupt("return");case 34:if(r!==Kr){t.next=39;break}return e(Dd(S,{score:x,level:0})),e(Zd(T)),t.abrupt("return");case 39:if(!u.isUserNew){t.next=42;break}return e(Hd()),t.abrupt("return");case 42:l.events.emit(is.SceneEvents.SWITCH,is.SceneKeys.DASHBOARD_SCENE);case 43:case"end":return t.stop()}}),t,null,[[12,20]])})));return function(e,n){return t.apply(this,arguments)}}()}),Jx={BACKGROUND:{KEY:"background",FILE:"./assets/music/bg_music.mp3"},EFFECTS:{KEY:"effects",FILE:"./assets/sounds/effects.mp3",JSON:"./assets/sounds/effects.json"}},Qx=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).handleFBInstantGameStarted=function(){window.__fbGameReady=!0,n.player.requestConnectedPlayers(),setTimeout(n.subscribebot,500)},n.startGame=function(){n.analytics.event(ni.AnalyticsEvents.APP_READY),n.storage.dispatch(IE(is.SceneKeys.LOAD_SCENE)),n.storage.dispatch(Zx())},n.subscribebot=function(){n.facebook.attemptToSubscribeBot()},n.handleLoadSoundCompleted=function(){n.audio.initSound(Jx.EFFECTS.KEY)},n.handleLoadMusicCompleted=function(){n.audio.initMusic(Jx.BACKGROUND.KEY),n.audio.playMusic()},n}(0,Kt.default)(e,t);var n=e.prototype;return n.preload=function(){var t=this;this.facebook.progressLoading.loadingProgressFbLoadScene(),this.analytics.event(ni.AnalyticsEvents.SCREEN_OPEN,{screen_name:"LoadScene"}),this.load.on("progress",(function(e){t.facebook.progressLoading.onProgress(e)})),this.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,(function(t){var e=new qE("Load resources at LoadScene failed.");(0,Ht.sendExceptionWithScope)(e,{file:null==t?void 0:t.url})})),this.load.multiatlas(gs.default.DEFAULT.KEY,gs.default.DEFAULT.JSON,gs.default.DEFAULT.URL),this.load.bitmapFont(Hs.default.PRIMARY.KEY,Hs.default.PRIMARY.TEXTURE,Hs.default.PRIMARY.DATA),this.load.bitmapFont(Hs.default.PRIMARY_LIGHT.KEY,Hs.default.PRIMARY_LIGHT.TEXTURE,Hs.default.PRIMARY_LIGHT.DATA),this.load.atlas({key:gs.default.EFFECTS.KEY,textureURL:gs.default.EFFECTS.PATH,atlasURL:gs.default.EFFECTS.JSON}),this.load.atlas({key:gs.default.GAMEPLAY_32.KEY,textureURL:gs.default.GAMEPLAY_32.TEXTURE,atlasURL:gs.default.GAMEPLAY_32.JSON}),this.load.bitmapFont(Hs.default.NUMBER_LIGHT.KEY,Hs.default.NUMBER_LIGHT.TEXTURE,Hs.default.NUMBER_LIGHT.DATA),this.load.atlas({key:gs.default.GAMEPLAY.KEY,textureURL:gs.default.GAMEPLAY.TEXTURE,atlasURL:gs.default.GAMEPLAY.JSON}),this.load.bitmapFont(Hs.default.NUMBER_DARK.KEY,Hs.default.NUMBER_DARK.TEXTURE,Hs.default.NUMBER_DARK.DATA),this.load.image(zr.default.BACKGROUND.KEY,zr.default.BACKGROUND.FILE),this.load.image(zr.default.AVATAR.KEY,zr.default.AVATAR.FILE),this.load.spine(Op.BEST_SCORE.KEY,Op.BEST_SCORE.JSON,Op.BEST_SCORE.ATLAS),this.load.spine(Op.LOGO.KEY,Op.LOGO.JSON,[Op.LOGO.ATLAS],!0),this.player.updateData().then().catch(Ht.sendException)},n.create=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.analytics.event(ni.AnalyticsEvents.LOAD_COMPLETE),this.facebook.on("startgame",this.handleFBInstantGameStarted),this.facebook.gameStarted(),this.initModules(),this.setupGlobalScene(),this.lazyLoadResource(),this.startGame();case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.setupGlobalScene=function(){var t=this.scene.get(is.SceneKeys.GLOBAL_SCENE);t instanceof jE&&t.setup()},n.initModules=function(){new qx(this.game),new Cx(this.game)},n.lazyLoadResource=function(){var t=this;setTimeout((function(){t.scene.wake(),t.loadSounds(),t.loadWideframesResource(),t.lazyLoadLevel(),t.lazyLoadLives(),t.load.once(Phaser.Loader.Events.COMPLETE,(function(){t.scene.sleep()}))}),1500)},n.lazyLoadLevel=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=this.storage.getState(),!lu(e)){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,this.storage.dispatch(Rd());case 7:this.loadLevelConfig(),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 13:case"end":return t.stop()}}),t,this,[[0,10]])})));return function(){return t.apply(this,arguments)}}(),n.lazyLoadLives=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.storage.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,r,s,o,h,c,l,u;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=window.game.player,i=n.getPlayer(),a=i.playerId,t.prev=2,e({type:pr,payload:{}}),t.next=6,null==(r=window.FBInstant.player.getDataAsync(["lives"]))?void 0:r.lives;case 6:return s=t.sent,o=Le(kv.LivesStore+"-"+a)||{},h=o.lives,c=void 0===h?Rv.livesCapacity:h,l=o.lastBonusLifeTime,u=void 0===l?0:l,s&&(c=s.lives||0,u=s.lastBonusLifeTime||0),e({type:fr,payload:{data:{lives:c,lastBonusLifeTime:u}}}),e((function(t,e){t(Dv());var n=e(),i=60*Rv.bonusDurationMins*1e3,a=(new Date).getTime(),r=Mv(n);t(a-r<i?Ov(i-(a-r)):_v())})),t.next=15,e(Fv());case 15:t.next=20;break;case 17:t.prev=17,t.t0=t.catch(2),e({type:gr,payload:{}});case 20:case"end":return t.stop()}}),t,null,[[2,17]])})));return function(e){return t.apply(this,arguments)}}());case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 8:case"end":return t.stop()}}),t,this,[[0,5]])})));return function(){return t.apply(this,arguments)}}(),n.loadLevelConfig=function(){try{var t=this.storage.getState(),e=lu(t),n=qu[e];n||(n=qu[qu.length-1]);var i=n,a=i.key,r=i.mapJson;if(this.cache.tilemap.exists(a))return;this.load.tilemapTiledJSON(a,r),this.load.start()}catch(s){(0,Ht.sendException)(s)}},n.loadSounds=function(){var t=Phaser.Loader.Events.FILE_KEY_COMPLETE;this.load.once(t+"audio-"+Jx.EFFECTS.KEY,this.handleLoadSoundCompleted),this.load.audioSprite(Jx.EFFECTS.KEY,Jx.EFFECTS.JSON,Jx.EFFECTS.FILE)},n.loadWideframesResource=function(){this.frameCapture.preload({"wide-frame-share":"./assets/wideframes/wide-frame-share.png","wide-frame-message-win":"./assets/wideframes/wide-frame-message-win.png","wide-frame-game-result":"./assets/wideframes/wide-frame-game-result.png"})},e}(Phaser.Scene),$x=Qx,tb=n(120),eb=n.n(tb),nb=function(){return(0,Xt.default)(qt().mark((function t(){var e,n,i,a,r,s,o,h,c;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=window.game,n=e.player,i=e.analytics,a=e.facebook,r=e.globalScene,t.prev=1,r.screen.open(vs,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",loading:!0}),s=n.getPlayer(),o=s.playerId,h=s.name,c=s.photo,t.next=6,a.inviteAsync({template:Gr,cta:{default:"Play",localizations:{en_US:"Play",vi_VN:"Ch\u01a1i ngay"}},text:{default:"Great! I have a best score!",localizations:{en_US:"Great! I have a best score!",vi_VN:"Th\u1eadt tuy\u1ec7t! M\xecnh v\u1eeba ph\xe1 k\u1ef7 l\u1ee5c n\xe0y!"}},image:"",data:{playerId:o,playerName:h,playerPhoto:c,type:Gr}});case 6:i.event(ni.AnalyticsEvents.INVITE,{invite_content_type:"BestScore",success:!0}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),i.event(ni.AnalyticsEvents.INVITE,{invite_content_type:"BestScore",success:!1}),(0,Ht.sendException)(t.t0);case 13:return t.prev=13,r.screen.close(vs),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,9,13,16]])})))},ib=n(328),ab={targets:[],yoyo:!0,repeat:-1,duration:600,repeatDelay:50,ease:n.n(ib)()(.55,.47,.43,.91),easeParams:[0,.9],props:{scale:{from:1,to:1.2}}},rb=function(t){function e(e){return t.call(this,ab,e)||this}return(0,Kt.default)(e,t),e}(Zs.default),sb=rb,ob=gs.default.DEFAULT,hb=ob.KEY,cb=ob.FRAME,lb=GameCore.Configs.Lives,ub=function(t){function e(e){var n;return(n=t.call(this,e)||this).background=void 0,n.circle=void 0,n.icon=void 0,n.textLives=void 0,n.textTimer=void 0,n.groupHeartBeat=void 0,n.heartBeat=void 0,n.textLivesBeat=void 0,n.iconBeat=void 0,n.intervalTimer=void 0,n.scene.add.existing((0,ls.default)(n)),n.createBackgroundLives(),n.createTextLives(),n.createTextTimer(),n.createIconPlus(),n.createHeartBeatAnimation(),n.setSize(140,27),n.setInteractive().on(Phaser.Input.Events.POINTER_DOWN,(function(){n.scene.screen.open(Ns)})),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createBackgroundLives=function(){this.background=this.scene.make.image({key:hb,frame:cb.LIVES_TIME_BLOCK}),this.background.setWorldSize(111,27),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this)},n.setFrameLivesTimeBlock2=function(){this.background.setFrame(cb.LIVES_TIME_BLOCK_2)},n.createIconPlus=function(){this.icon=this.scene.make.image({key:hb,frame:cb.ICON_PLUS}),this.icon.setWorldSize(14,14),this.add(this.icon),Phaser.Display.Align.In.Center(this.icon,this,-62,11)},n.createTextLives=function(){this.circle=this.scene.make.image({key:hb,frame:cb.LIVES_HEART}),this.circle.setWorldSize(38,31),this.add(this.circle),Phaser.Display.Align.In.Center(this.circle,this,-51,0);var t=this.scene.storage.getState(),e=Cv(t);this.textLives=this.scene.make.text({text:""+e,style:{fontFamily:Hs.default.FONT_FAMILY_ARIAL,fontSize:this.scene.fontSize(40)+"px",fontStyle:"700"},origin:{x:.5,y:.5}}),this.add(this.textLives),Phaser.Display.Align.In.Center(this.textLives,this.circle)},n.createTextTimer=function(){this.textTimer=this.scene.make.bitmapText({font:Hs.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(40),text:"00:00",origin:{x:.2,y:.5}}),this.add(this.textTimer),Phaser.Display.Align.In.Center(this.textTimer,this,8,2)},n.updateTextLives=function(){var t=this.scene.storage.getState(),e=Cv(t);this.textLives.setText(e)},n.startIntervalTimer=function(){var t=this;this.runHeartBeatAnimation();var e=60*lb.bonusDurationMins*1e3;this.intervalTimer=setInterval((function(){var n,i,a=t.scene.storage.getState(),r=Cv(a)||0;if(r===lb.livesCapacity)return t.textTimer.setText("Full"),void t.textLives.setText(String(lb.livesCapacity));var o=Iv(a),h=Mv(a),c=(new Date).getTime();c-h<e&&(o=h);var l=(0,Ge.convertHMS)(e-(c-o)),u=s()(n="0"+l.minutes).call(n,-2),d=s()(i="0"+l.seconds).call(i,-2);eb()(t.textLives.text)!==r&&t.updateTextLives(),t.textTimer.setText(u+":"+d)}),1e3)},n.stopIntervalTimer=function(){clearInterval(this.intervalTimer)},n.setLives=function(t){this.textLives.setText(String(t))},n.runHeartBeatAnimation=function(){this.heartBeat.play(),this.textLivesBeat.play(),this.iconBeat.play()},n.createHeartBeatAnimation=function(){this.heartBeat=new sb({targets:[this.circle],props:{scale:"+=0.005"}}),this.textLivesBeat=new sb({targets:[this.textLives],props:{scale:"+=0.05"}}),this.iconBeat=new sb({targets:[this.icon],props:{scale:"+=0.025"}})},e}(Phaser.GameObjects.Container),db=ub,pb=gs.default.DEFAULT,fb=pb.KEY,gb=pb.FRAME,mb=function(t){function e(e){var n;return(n=t.call(this,e,fb,gb.BUTTON_DARK_BLUE)||this).button.setWorldSize(231,63),n.setName("Invite"),n.createText(),n}return(0,Kt.default)(e,t),e.prototype.createText=function(){var t=this.scene.make.image({key:fb,frame:gb.TEXT_INVITE_FRIENDS});t.setWorldSize(198,21.5),this.add(t),Phaser.Display.Align.In.Center(t,this,0,0)},e}(Ys.default),vb=mb,yb=gs.default.DEFAULT,Sb=yb.KEY,Ab=yb.FRAME,Eb=GameCore.Configs.Lives,xb=function(t){function e(e){var n;return(n=t.call(this,e,Sb,Ab.BUTTON_GREEN)||this).heart=void 0,n.textLives=void 0,n.groupHeartBeat=void 0,n.heartBeat=void 0,n.textLivesBeat=void 0,n.button.setWorldSize(231,63),n.setName("RefillLives"),n.createText(),n.createIcon(),n.createHeart(),n.createHeartBeatAnimation(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createText=function(){var t=this.scene.make.image({key:Sb,frame:Ab.TEXT_REFILL_LIVES});t.setWorldSize(158,13),this.add(t),Phaser.Display.Align.In.Center(t,this,-18,0)},n.createIcon=function(){var t=this.scene.make.image({key:Sb,frame:Ab.ICON_ADS});t.setWorldSize(33,32),this.add(t),Phaser.Display.Align.In.Center(t,this,85,-3)},n.createHeart=function(){this.heart=this.scene.make.image({key:Sb,frame:Ab.LIVES_HEART}),this.heart.setAngle(-30),this.heart.setWorldSize(46,36),this.add(this.heart),Phaser.Display.Align.In.Center(this.heart,this,-105,-20),this.textLives=this.scene.make.text({text:"+"+Eb.livesCapacity,style:{fontFamily:Hs.default.FONT_FAMILY_ARIAL,fontSize:this.scene.fontSize(40)+"px",fontStyle:"700"},origin:{x:.5,y:.5}}),this.textLives.setAngle(-30),this.add(this.textLives),Phaser.Display.Align.In.Center(this.textLives,this.heart)},n.runHeartBeatAnimation=function(){this.heartBeat.play(),this.textLivesBeat.play()},n.createHeartBeatAnimation=function(){this.heartBeat=new sb({targets:[this.heart],props:{scale:"+=0.005"}}),this.textLivesBeat=new sb({targets:[this.textLives],props:{scale:"+=0.025"}})},e}(Ys.default),bb=xb,Tb=gs.default.DEFAULT,wb=Tb.KEY,Cb=Tb.FRAME,Mb=GameCore.Configs,Ib=Mb.Network,Pb=Mb.Lives,kb=function(t){function e(e,n,i,a){var r;return(r=t.call(this,e,n,i,a)||this).popup=void 0,r.title=void 0,r.buttonClose=void 0,r.contents=void 0,r.backgroundContent=void 0,r.currentScreen=void 0,r.refillLivesButton=void 0,r.inviteFriendButton=void 0,r.textTitle=void 0,r.livesContent=void 0,r.textContent=void 0,r.adsTimer=void 0,r.livesTimer=void 0,r.intervalTimer=void 0,r.textBlock=void 0,r.popupShowUpAnimation=void 0,r.popupFadeOutAnimation=void 0,r.contentShowUpAnimation=void 0,r.popupFadeInMaskAnimation=void 0,r.popupFadeOutMaskAnimation=void 0,r.handleClose=function(){r.runCloseAnimation()},r.clickPlayWithFriend=function(){r.scene.storage.dispatch(nb())},r.handleShowRewardedVideoAd=(0,Xt.default)(qt().mark((function t(){var e,n,i,a,s,o;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=r.scene.game,n=e.globalScene,i=e.audio,t.prev=2,e.globalScene.screen.open(vs,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",duration:Ib.Timeout,loading:!0}),i.pauseMusic(),t.next=7,new(mt())((function(t,e){var n;null==(n=r.adsTimer)||n.remove(),r.adsTimer=r.scene.time.delayedCall(Ib.Timeout,e),r.scene.ads.getAdStatus(GameCore.Ads.Types.REWARDED)===GameCore.Ads.Status.LOADING?r.scene.ads.events.once(GameCore.Ads.Events.LOADED,t):r.scene.ads.preloadRewardedVideoAsync().then(t).catch(e)}));case 7:return t.next=9,r.scene.ads.showRewardedVideoAsync();case 9:r.scene.audio.playSound(Vs.default.DAILY_REWARD),r.scene.analytics.showRewardedVideoAd(r.getScreenName()),r.scene.storage.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n={lives:Rv.livesCapacity,lastBonusLifeTime:(new Date).getTime()},t.next=4,e(Nv(n));case 4:t.next=8;break;case 6:t.prev=6,t.t0=t.catch(0);case 8:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}()),r.close(),t.next=23;break;case 15:if(t.prev=15,t.t0=t.catch(2),r.scene.analytics.showAdFail(GameCore.Ads.Types.REWARDED,r.getScreenName(),t.t0),!(t.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(t.t0,"code"))){t.next=22;break}if("USER_INPUT"!==t.t0.code){t.next=22;break}return r.showNotifySkipAds(),t.abrupt("return");case 22:r.showNotifyNoAds();case 23:return t.prev=23,null==(a=r.adsTimer)||a.destroy(),r.scene.audio.playMusic(),n.screen.close(vs),r.scene.ads.preloadRewardedVideoAsync().catch((function(t){})),s=r.getData(["onClose"]),(o=s[0])&&o(),t.finish(23);case 31:case"end":return t.stop()}}),t,null,[[2,15,23,31]])}))),r.showNotifyNoAds=function(t){if(!t||t.name===vs){var e=r.scene.game.globalScene;e.screen.events.off(GameCore.Screens.Events.CLOSE),e.screen.events.once(GameCore.Screens.Events.CLOSE,r.showGameOver),e.screen.open(vs,{message:"\u041d\u0435\u0442 \u0440\u0435\u043a\u043b\u0430\u043c\u044b \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f!",duration:2e3,loading:!1})}},r.showNotifySkipAds=function(){var t=r.scene.game.globalScene;t.screen.events.off(GameCore.Screens.Events.CLOSE),t.screen.events.once(GameCore.Screens.Events.CLOSE,r.showGameOver),t.screen.open(vs,{message:"\u0418\u0437\u0432\u0438\u043d\u0438, \u043d\u0430\u0433\u0440\u0430\u0434 \u043d\u0435\u0442!\n\u0422\u044b \u043e\u0442\u043a\u0430\u0437\u0430\u043b\u0441\u044f \u043e\u0442 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u0440\u0435\u043a\u043b\u0430\u043c\u044b!",duration:3e3,loading:!1})},r.showGameOver=function(t){t&&t.name!==vs||r.scene.screen.close(r.name)},r.createPopup(),r.createLivesTimer(),r.createTitle(),r.createContentBackground(),r.createLiveContent(),r.createTextContent(),r.createButtons(),r.addItem(),r.setDepth(Gs),r.background.setAlpha(.5),r}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(e){t.prototype.open.call(this,e),this.updateIntervalTimer(),this.startIntervalTimer(),this.runOpenAnimation(),null!=e&&e.currentScreen&&(this.currentScreen=e.currentScreen),this.showLivesTimer()},n.showLivesTimer=function(){var t=this.getData(["showLivesTimer"])[0];this.livesTimer.setVisible(t),t&&this.livesTimer.startIntervalTimer()},n.createLivesTimer=function(){this.livesTimer=new db(this.scene),this.popup.add(this.livesTimer),Phaser.Display.Align.In.Center(this.livesTimer,this.popup,0,-270)},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:wb,frame:Cb.LIVES_HEART}),this.backgroundContent.setWorldSize(114,93),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-55)},n.createLiveContent=function(){var t=this.scene.storage.getState(),e=Cv(t);this.livesContent=this.scene.make.text({text:""+e,style:{fontFamily:Hs.default.FONT_FAMILY_ARIAL,fontSize:this.scene.fontSize(150)+"px",fontStyle:"700",align:"center"}}),this.livesContent.setTint(16777215),this.popup.add(this.livesContent),Phaser.Display.Align.In.Center(this.livesContent,this.backgroundContent,0,0)},n.createTextContent=function(){this.textBlock=this.scene.make.image({key:wb,frame:Cb.LIVES_TIME_BLOCK}),this.popup.add(this.textBlock),this.textBlock.setWorldSize(167,30),Phaser.Display.Align.In.Center(this.textBlock,this.backgroundContent,0,80),this.textContent=this.scene.make.bitmapText({font:Hs.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(40),origin:{x:.5,y:.5}}),this.popup.add(this.textContent),Phaser.Display.Align.In.Center(this.textContent,this.textBlock,0,2)},n.startIntervalTimer=function(){var t=this;this.intervalTimer=setInterval((function(){t.updateIntervalTimer()}),1e3)},n.updateIntervalTimer=function(){var t,e,n=60*Pb.bonusDurationMins*1e3,i=this.scene.storage.getState(),a=Cv(i),r=Iv(i),o=Mv(i),h=(new Date).getTime();h-o<n&&(r=o);var c=(0,Ge.convertHMS)(n-(h-r)),l=s()(t="0"+c.minutes).call(t,-2),u=s()(e="0"+c.seconds).call(e,-2);this.setTextContent("Next life: "+l+"m "+u+"s"),a>0?(this.textTitle.setFrame(Cb.TEXT_KEEP_PLAYING),this.textTitle.setWorldSize(261,23.5)):(this.textTitle.setFrame(Cb.TEXT_OUT_OF_LIVE),this.textTitle.setWorldSize(234,19)),eb()(this.livesContent.text)!=a&&(this.livesContent.setText(""+a),Phaser.Display.Align.In.Center(this.livesContent,this.backgroundContent,0,0)),a===Pb.livesCapacity?(this.setTextContent("Full"),this.refillLivesButton.setVisible(!1),this.inviteFriendButton.setVisible(!0)):(this.refillLivesButton.setVisible(!0),this.refillLivesButton.runHeartBeatAnimation(),this.inviteFriendButton.setVisible(!1))},n.stopIntervalTimer=function(){clearInterval(this.intervalTimer)},n.setTextContent=function(t){this.textContent.setText(t),Phaser.Display.Align.In.Center(this.textContent,this.textBlock,0,2)},n.createPopup=function(){this.popup=new uo(this.scene,0,-30,290,323),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,-30)},n.createTitle=function(){this.title=this.scene.add.container(),this.textTitle=this.scene.make.image({key:wb,frame:Cb.TEXT_OUT_OF_LIVE}),this.textTitle.setWorldSize(234,19),this.buttonClose=new Ys.default(this.scene,wb,Cb.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.handleClose,this.title.add([this.textTitle,this.buttonClose]),this.popup.add([this.title]),Phaser.Display.Align.In.Center(this.textTitle,this.title,0,11),Phaser.Display.Align.In.Center(this.buttonClose,this.title,135,-14),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.createButtons=function(){this.createRefillLivesButton(),this.createInviteFriendButton()},n.createRefillLivesButton=function(){this.refillLivesButton=new bb(this.scene),this.popup.add(this.refillLivesButton),this.refillLivesButton.onClick=this.handleShowRewardedVideoAd,Phaser.Display.Align.In.Center(this.refillLivesButton,this.popup,0,85)},n.createInviteFriendButton=function(){this.inviteFriendButton=new vb(this.scene),this.inviteFriendButton.setVisible(!1),this.popup.add(this.inviteFriendButton),this.inviteFriendButton.onClick=this.clickPlayWithFriend,Phaser.Display.Align.In.Center(this.inviteFriendButton,this.popup,0,85)},n.addItem=function(){this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Vs.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.stopIntervalTimer(),this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new so({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new io({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new $s({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Tc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){var n=this;if(!this.popupFadeOutMaskAnimation){var i=this.background.alpha;this.popupFadeOutMaskAnimation=new $s({targets:[this.background],delay:t,duration:e,props:{alpha:{start:i,from:i,to:0}},onComplete:function(){var t=n.getData(["onClose"])[0];t&&t()}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),Rb=kb,Ob=gs.default.DEFAULT,_b=Ob.KEY,Db=Ob.FRAME,Lb=function(t){function e(e){var n;return(n=t.call(this,e)||this).background=void 0,n.createBackground(),n.scene.add.existing((0,ls.default)(n)),n}return(0,Kt.default)(e,t),e.prototype.createBackground=function(){this.background=this.scene.make.image({key:_b,frame:Db.FOOTER,origin:{x:.5,y:1}}),this.background.setWorldSize(375,85),this.add(this.background)},e}(Phaser.GameObjects.Container),Bb=Lb,Fb=gs.default.DEFAULT,Nb=Fb.KEY,Gb=Fb.FRAME,Ub=function(t){function e(e){var n,i=(n=t.call(this,e,0,0,Nb,Gb.LEAF)||this).scene.gameZone.width,a=i*n.height/n.width;return n.setWorldSize(i,a),n.scene.add.existing((0,ls.default)(n)),n}return(0,Kt.default)(e,t),e}(Phaser.GameObjects.Image),Vb=Ub,Yb=function(t){function e(e){var n;return(n=t.call(this,e)||this).leaf=void 0,n.createLeaf(),n.scene.add.existing((0,ls.default)(n)),n}return(0,Kt.default)(e,t),e.prototype.createLeaf=function(){this.leaf=new Vb(this.scene),this.add(this.leaf),Phaser.Display.Align.In.Center(this.leaf,this,0,this.leaf.displayHeight/2)},e}(Phaser.GameObjects.Container),zb=Yb,Hb=gs.default.DEFAULT,Wb=Hb.KEY,Xb=Hb.FRAME,Kb=GameCore.Configs.Match,jb=function(t){function e(e){var n;return(n=t.call(this,e,Wb,Xb.BUTTON_MINOR)||this).suggestDailyMode=void 0,n.button.setWorldSize(62,53),n.setName("DailyChallenge"),n.createIcon(),n.createSuggestDailyMode(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:Wb,frame:Xb.ICON_DAILY});t.setWorldSize(35,35),this.add(t),Phaser.Display.Align.In.Center(t,this,.5,-2.5)},n.createSuggestDailyMode=function(){this.suggestDailyMode=this.scene.make.image({key:Wb,frame:Xb.ICON_DOT_RED}),this.suggestDailyMode.setWorldSize(17,17),this.suggestDailyMode.setVisible(!1),this.add(this.suggestDailyMode),Phaser.Display.Align.In.Center(this.suggestDailyMode,this,28,-25)},n.checkSuggestDailyMode=function(){var t=window.game.player.getPlayer().playerId,e=Le(Kb.JourneyMatchStore+"-"+t)||{},n=Object(e).updateAt||0;(0,Ge.checkIsToday)(n)?this.suggestDailyMode.setVisible(!1):this.suggestDailyMode.setVisible(!0)},e}(Ys.default),qb=jb,Zb=gs.default.DEFAULT,Jb=Zb.KEY,Qb=Zb.FRAME,$b=function(t){function e(e){var n;return(n=t.call(this,e,Jb,Qb.BUTTON_BROWN)||this).button.setWorldSize(242,54),n.setName("Journey"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:Jb,frame:Qb.ICON_JOURNEY});t.setWorldSize(35,29),this.add(t),Phaser.Display.Align.In.Center(t,this,-77,-2)},n.createText=function(){var t=this.scene.make.image({key:Jb,frame:Qb.TEXT_JOURNEY});t.setWorldSize(143.5,16.5),this.add(t),Phaser.Display.Align.In.Center(t,this,20,-2)},e}(Ys.default),tT=$b,eT=gs.default.DEFAULT,nT=eT.KEY,iT=eT.FRAME,aT=function(t){function e(e){var n;return(n=t.call(this,e,nT,iT.BUTTON_MINOR)||this).button.setWorldSize(62,53),n.setName("LeaderBoard"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:nT,frame:iT.ICON_RANK});t.setWorldSize(30,30),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-2)},e}(Ys.default),rT=aT,sT=function(t){function e(e,n,i){var a;return(a=t.call(this,e,n,i)||this).logo=void 0,a.drawLogo(),e.add.existing((0,ls.default)(a)),a}return(0,Kt.default)(e,t),e.prototype.drawLogo=function(){var t=this;this.logo=this.scene.add.spine(0,0,Op.LOGO.KEY,Op.LOGO.ANIMATIONS.START_GROW),this.add(this.logo),this.logo.on("complete",(function(e){e.animation.name===Op.LOGO.ANIMATIONS.START_GROW&&t.logo.play(Op.LOGO.ANIMATIONS.IDLE_GROW,!0)}))},e}(Phaser.GameObjects.Container),oT=sT,hT=gs.default.DEFAULT,cT=hT.KEY,lT=hT.FRAME,uT=function(t){function e(e){var n;return(n=t.call(this,e,cT,lT.BUTTON_GREEN_LARGE)||this).button.setWorldSize(242,70),n.setName("PlaySingle"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:cT,frame:lT.ICON_PLAY_GREEN});t.setWorldSize(31,31),this.add(t),Phaser.Display.Align.In.Center(t,this,-93,-2)},n.createText=function(){var t=this.scene.make.image({key:cT,frame:lT.TEXT_SINGLE});t.setWorldSize(183.5,22),this.add(t),Phaser.Display.Align.In.Center(t,this,20,-2)},e}(Ys.default),dT=uT,pT=gs.default.DEFAULT,fT=pT.KEY,gT=pT.FRAME,mT=function(t){function e(e){var n;return(n=t.call(this,e,fT,gT.BUTTON_MINOR)||this).button.setWorldSize(62,53),n.setName("Setting"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:fT,frame:gT.ICON_SETTING});t.setWorldSize(30,30),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-1.5)},e}(Ys.default),vT=mT,yT=function(t){function e(e){var n;return(n=t.call(this,e)||this).logo=void 0,n.playSingleButton=void 0,n.journeyButton=void 0,n.leaderBoardButton=void 0,n.dailyChallengeButton=void 0,n.settingButton=void 0,n.playSingleButtonAnimation=void 0,n.createLogo(),n.createPlaySingleButton(),n.createJourneyButton(),n.createLeaderBoardButton(),n.createDailyChallengeButton(),n.createSettingButton(),n.alignButton(),n.scene.add.existing((0,ls.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createLogo=function(){this.logo=new oT(this.scene,0,0),this.add(this.logo),Phaser.Display.Align.In.Center(this.logo,this,0,-140)},n.createPlaySingleButton=function(){this.playSingleButton=new dT(this.scene),this.add(this.playSingleButton)},n.runPlaySingleButtonAnimation=function(){this.playSingleButtonAnimation.play()},n.createPlaySingleButtonAnimation=function(){this.playSingleButtonAnimation=new sb({targets:[this.playSingleButton],props:{scale:{from:1,to:1.05}}})},n.createJourneyButton=function(){this.journeyButton=new tT(this.scene),this.add(this.journeyButton)},n.createLeaderBoardButton=function(){this.leaderBoardButton=new rT(this.scene),this.add(this.leaderBoardButton)},n.createDailyChallengeButton=function(){this.dailyChallengeButton=new qb(this.scene),this.add(this.dailyChallengeButton)},n.createSettingButton=function(){this.settingButton=new vT(this.scene),this.add(this.settingButton)},n.alignButton=function(){Phaser.Display.Align.In.Center(this.playSingleButton,this,0,44),Phaser.Display.Align.In.Center(this.journeyButton,this,0,118),Phaser.Display.Align.In.Center(this.leaderBoardButton,this,-90,192),Phaser.Display.Align.In.Center(this.dailyChallengeButton,this,0,192),Phaser.Display.Align.In.Center(this.settingButton,this,90,192)},e}(Phaser.GameObjects.Container),ST=yT,AT=[{key:"daily-level-0",mapJson:"./assets/json/daily-levels/level-0.json"}],ET=1;ET<=57;ET++)AT.push({key:"daily-level-"+ET,mapJson:"./assets/json/daily-levels/level-"+ET+".json"});var xT=function(){var t=new Date("01/01/2022"),e=(new Date).getTime()-t.getTime();return Math.floor(e/864e5)%AT.length},bT=function(){var t=xT();return AT[t]},TT=gs.default.DEFAULT,wT=TT.KEY,CT=TT.FRAME,MT=gs.default.GAMEPLAY,IT=MT.KEY,PT=MT.FRAME,kT=gs.default.GAMEPLAY_32,RT=kT.KEY,OT=kT.FRAME,_T=GameCore.Configs,DT=_T.Network,LT=_T.Board,BT=function(t){function e(e,n,i,a){var r;(r=t.call(this,e,n,i,a)||this).scene=void 0,r.popup=void 0,r.title=void 0,r.buttonClose=void 0,r.contents=void 0,r.buttonPlay=void 0,r.boardCellData=[],r.targetData=[],r.popupShowUpAnimation=void 0,r.popupFadeOutAnimation=void 0,r.contentShowUpAnimation=void 0,r.popupFadeInMaskAnimation=void 0,r.popupFadeOutMaskAnimation=void 0,r.clickClose=function(){r.runCloseAnimation(),r.popupFadeOutAnimation.next((function(){var t=r.getData(["onClose"])[0];r.scene.screen.close(r.name),t&&t()}))},r.decodeMathData=function(t){try{return JSON.parse(GameCore.Utils.Hash.hashToString(t))}catch(e){return""}},r.scene=e;try{r.createPopup(),r.createTitle(),r.createTargetItems(),r.createBoard(),r.createButtonPlay(),r.setDepth(Gs),r.background.setAlpha(.5)}catch(s){}return r}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){var e=(0,Xt.default)(qt().mark((function e(n){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.prototype.open.call(this,n),this.showLoadingScreen(),this.loadLevelConfig();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.startGame=function(){this.runOpenAnimation(),this.updateContent(),this.popup.setVisible(!0)},n.loadLevelConfig=function(){try{var t=bT(),e=t.key,n=t.mapJson;if(this.scene.cache.tilemap.exists(e))return void this.handleLoadCurrentMapComplete();this.scene.load.tilemapTiledJSON(e,n),this.scene.load.start(),this.scene.load.off(Phaser.Loader.Events.COMPLETE),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this))}catch(i){(0,Ht.sendException)(i)}},n.handleLoadCurrentMapComplete=function(){this.startGame(),this.hideLoadingScreen()},n.updateContent=function(){this.resetTarget(),this.drawTargetItems(),this.resetCellBoard(),this.updateCellBoard()},n.checkReceiveLevelFromFb=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=this.scene.storage.getState(),!lu(e)){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,this.scene.storage.dispatch(Rd());case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 12:case"end":return t.stop()}}),t,this,[[0,9]])})));return function(){return t.apply(this,arguments)}}(),n.showLoadingScreen=function(){this.scene.game.globalScene.screen.open(vs,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",duration:DT.Timeout,loading:!0})},n.hideLoadingScreen=function(){this.scene.game.globalScene.screen.close(vs)},n.createPopup=function(){this.popup=new uo(this.scene,0,-7,286,373),this.popup.setVisible(!1),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,10)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:wT,frame:CT.TEXT_DAILY_CHALLENGE});t.setWorldSize(261,20),this.buttonClose=new Ys.default(this.scene,wT,CT.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickClose,this.title.add([t,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title),Phaser.Display.Align.In.Center(this.buttonClose,this.title,138.5,-19.5),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,7)},n.createTargetItems=function(){var t=this.scene.make.image({key:wT,frame:CT.TEXT_COLLECT});t.setWorldSize(85,13);var e=this.scene.make.image({key:wT,frame:CT.WOOD_PANEL});e.setWorldSize(200,37),this.popup.add([t,e]),Phaser.Display.Align.In.Center(t,this.popup,0,-155),Phaser.Display.Align.In.Center(e,this.popup,0,-125)},n.drawTargetItems=function(){var t,e,n=bT().key,i=this.scene.make.tilemap({key:n}).properties;if(i&&(0,Gv.isArray)(i)&&!(i.length<2))for(var a=i[0].value,r=Tv()(t=Tv()(e=Tv()(a).call(a,"{",'{"')).call(e,", ",', "')).call(t,":",'":'),s=JSON.parse(r),o=Y()(s),h=this.calcPosition(o.length),c=0;c<o.length;c++){var l=o[c],u=MS[l],d=s[l],p=this.targetData[c];p||(p=this.spawnTargetItem(u,d));var f=p,g=f.container,m=f.text,v=f.gem;g.setVisible(!0),m.setText("x"+d),v.setFrame(u),this.targetData.push(p),Phaser.Display.Align.In.Center(g,this.popup,h[c],-130)}},n.spawnTargetItem=function(t,e){var n=this.scene.make.container({}),i=this.scene.make.image({key:RT,frame:t});i.setWorldSize(15,15);var a=this.scene.make.bitmapText({font:Hs.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5},text:"x"+e});return n.add([i,a]),Phaser.Display.Align.In.Center(a,n,0,15),this.popup.add(n),{container:n,gem:i,text:a}},n.calcPosition=function(t){for(var e=[],n=150/(t+1),i=n*(t-1)/2,a=0;a<t;a++)e.push(n*a-i);return e},n.createBoard=function(){var t=this.scene.make.image({key:IT,frame:PT.BOARD});t.setWorldSize(200,184),this.popup.add(t),Phaser.Display.Align.In.Center(t,this.popup,0,-12),this.initCellBoard()},n.initCellBoard=function(){for(var t=0;t<LT.rows;t++){this.boardCellData[t]=[];for(var e=0;e<LT.cols;e++){var n=20*e-86.5+1.65*e,i=19*t-92+1*t,a=OT.GEM_TRANSPARENT,r=this.spawnCellBoard(a,n,i);this.boardCellData[t].push(r)}}},n.updateCellBoard=function(){this.drawBoardByMap()},n.resetTarget=function(){for(var t=0;t<this.targetData.length;t++){var e,n;null==(e=this.targetData[t])||null==(n=e.container)||n.setVisible(!1)}},n.resetCellBoard=function(){for(var t=0;t<LT.rows;t++)for(var e=0;e<LT.cols;e++){this.boardCellData[t][e].setFrame(OT.GEM_TRANSPARENT)}},n.drawBoardByFen=function(t){for(var e=$p()(t).call(t).split("/"),n=0;n<e.length;n++)for(var i=e[n].split(","),a=0;a<i.length;a++){var r=i[a];if("x"!==r){var s=HS(r);this.boardCellData[n][a].setFrame(s)}}},n.drawBoardByMap=function(){var t=bT().key,e=this.scene.make.tilemap({key:t}).layers;if((0,Gv.isArray)(e)){var n=e[0].data;if((0,Gv.isArray)(n))for(var i=0;i<n.length;i++)for(var a=n[i],r=0;r<a.length;r++){var s=a[r];if(!(s.index<0)){var o=MS[s.index-1];this.boardCellData[i][r].setFrame(o)}}}},n.spawnCellBoard=function(t,e,n){var i=this.scene.make.image({key:RT,frame:t});return i.setWorldSize(20,19),this.popup.add(i),Phaser.Display.Align.In.Center(i,this.popup,e,n),i},n.createButtonPlay=function(){this.buttonPlay=new Ys.default(this.scene,wT,CT.BUTTON_GREEN_BIG,118,50),this.buttonPlay.setName("Play"),this.buttonPlay.onClick=this.handlePlay.bind(this);var t=this.scene.make.image({key:wT,frame:CT.TEXT_PLAY});t.setWorldSize(65,15);var e=this.scene.make.image({key:wT,frame:CT.ICON_I_PLAY});e.setWorldSize(20,26),this.buttonPlay.add([t,e]),Phaser.Display.Align.In.Center(t,this.buttonPlay,16,-2),Phaser.Display.Align.In.Center(e,this.buttonPlay,-32,-2),this.popup.add(this.buttonPlay),Phaser.Display.Align.In.Center(this.buttonPlay,this.popup,0,111)},n.handlePlay=function(){var t=this;this.runCloseAnimation(),this.popupFadeOutAnimation.next((function(){t.scene.screen.close(t.name);var e=t.scene.storage.getState();lu(e)>qu.length||(t.scene.storage.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e({type:oa,payload:{}});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.scene.storage.dispatch(Wd()),t.scene.analytics.event(ni.AnalyticsEvents.DAILY_CHALLENGE_BEGIN))}))},n.getLevelName=function(t){var e;return"journey_"+fs()(e=GameCore.Utils.Number).call(e,t,4,"0")},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Vs.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new so({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new io({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new $s({targets:[this.popup],delay:t,duration:e,props:{scale:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.popup.setVisible(!1)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Tc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new $s({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),FT=gs.default.DEFAULT,NT=FT.KEY,GT=FT.FRAME,UT=gs.default.GAMEPLAY,VT=UT.KEY,YT=UT.FRAME,zT=gs.default.GAMEPLAY_32,HT=zT.KEY,WT=zT.FRAME,XT=GameCore.Configs,KT=XT.Network,jT=XT.Board,qT=function(t){function e(e,n,i,a){var r;(r=t.call(this,e,n,i,a)||this).popup=void 0,r.title=void 0,r.buttonClose=void 0,r.contents=void 0,r.buttonPlay=void 0,r.boardCellData=[],r.targetData=[],r.popupShowUpAnimation=void 0,r.popupFadeOutAnimation=void 0,r.contentShowUpAnimation=void 0,r.popupFadeInMaskAnimation=void 0,r.popupFadeOutMaskAnimation=void 0,r.clickClose=function(){r.runCloseAnimation(),r.popupFadeOutAnimation.next((function(){var t=r.getData(["onClose"])[0];r.scene.screen.close(r.name),t&&t()}))},r.decodeMathData=function(t){try{return JSON.parse(GameCore.Utils.Hash.hashToString(t))}catch(e){return""}};try{r.createPopup(),r.createTitle(),r.createTargetItems(),r.createBoard(),r.createButtonPlay(),r.setDepth(Gs),r.background.setAlpha(.5)}catch(s){}return r}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){var e=(0,Xt.default)(qt().mark((function e(n){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.prototype.open.call(this,n),e.next=3,this.checkReceiveLevelFromFb();case 3:this.loadLevelConfig();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.startGame=function(){this.runOpenAnimation(),this.updateContent(),this.popup.setVisible(!0)},n.loadLevelConfig=function(){try{var t=this.scene.storage.getState(),e=lu(t),n=qu[e];n||(n=qu[qu.length-1]);var i=n,a=i.key,r=i.mapJson;if(this.scene.cache.tilemap.exists(a))return void this.handleLoadCurrentMapComplete();this.scene.load.tilemapTiledJSON(a,r),this.scene.load.start(),this.scene.load.off(Phaser.Loader.Events.COMPLETE),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this))}catch(s){(0,Ht.sendException)(s)}},n.handleLoadCurrentMapComplete=function(){this.hideLoadingScreen(),this.startGame()},n.updateContent=function(){this.resetTarget(),this.drawTargetItems(),this.resetCellBoard(),this.updateCellBoard()},n.checkReceiveLevelFromFb=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=this.scene.storage.getState(),!lu(e)){t.next=5;break}return t.abrupt("return");case 5:return this.showLoadingScreen(),t.next=8,this.scene.storage.dispatch(Rd());case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 13:case"end":return t.stop()}}),t,this,[[0,10]])})));return function(){return t.apply(this,arguments)}}(),n.showLoadingScreen=function(){this.scene.game.globalScene.screen.open(vs,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",duration:KT.Timeout,loading:!0})},n.hideLoadingScreen=function(){this.scene.game.globalScene.screen.close(vs)},n.createPopup=function(){this.popup=new uo(this.scene,0,-7,286,373),this.popup.setVisible(!1),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,10)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:NT,frame:GT.TEXT_JOURNEY});t.setWorldSize(143.5,16.5),this.buttonClose=new Ys.default(this.scene,NT,GT.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickClose,this.title.add([t,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title),Phaser.Display.Align.In.Center(this.buttonClose,this.title,138.5,-19.5),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,7)},n.createTargetItems=function(){var t=this.scene.make.image({key:NT,frame:GT.TEXT_COLLECT});t.setWorldSize(85,13);var e=this.scene.make.image({key:NT,frame:GT.WOOD_PANEL});e.setWorldSize(200,37),this.popup.add([t,e]),Phaser.Display.Align.In.Center(t,this.popup,0,-155),Phaser.Display.Align.In.Center(e,this.popup,0,-125)},n.drawTargetItems=function(){var t,e,n=this.scene.storage.getState(),i=lu(n),a=qu[i];a||(a=qu[qu.length-1]);var r=this.scene.make.tilemap({key:a.key}).properties;if(r&&(0,Gv.isArray)(r)&&!(r.length<2))for(var s=r[0].value,o=Tv()(t=Tv()(e=Tv()(s).call(s,"{",'{"')).call(e,", ",', "')).call(t,":",'":'),h=JSON.parse(o),c=Y()(h),l=this.calcPosition(c.length),u=0;u<c.length;u++){var d=c[u],p=MS[d],f=h[d],g=this.targetData[u];g||(g=this.spawnTargetItem(p,f));var m=g,v=m.container,y=m.text,S=m.gem;v.setVisible(!0),y.setText("x"+f),S.setFrame(p),this.targetData.push(g),Phaser.Display.Align.In.Center(v,this.popup,l[u],-130)}},n.spawnTargetItem=function(t,e){var n=this.scene.make.container({}),i=this.scene.make.image({key:HT,frame:t});i.setWorldSize(15,15);var a=this.scene.make.bitmapText({font:Hs.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5},text:"x"+e});return n.add([i,a]),Phaser.Display.Align.In.Center(a,n,0,15),this.popup.add(n),{container:n,gem:i,text:a}},n.calcPosition=function(t){for(var e=[],n=150/(t+1),i=n*(t-1)/2,a=0;a<t;a++)e.push(n*a-i);return e},n.createBoard=function(){var t=this.scene.make.image({key:VT,frame:YT.BOARD});t.setWorldSize(200,184),this.popup.add(t),Phaser.Display.Align.In.Center(t,this.popup,0,-12),this.initCellBoard()},n.initCellBoard=function(){for(var t=0;t<jT.rows;t++){this.boardCellData[t]=[];for(var e=0;e<jT.cols;e++){var n=20*e-86.5+1.65*e,i=19*t-92+1*t,a=WT.GEM_TRANSPARENT,r=this.spawnCellBoard(a,n,i);this.boardCellData[t].push(r)}}},n.updateCellBoard=function(){var t=this.scene.storage.getState(),e=hu(t).data.fen;if(e){var n=e.split("l")[0];this.drawBoardByFen(n)}else this.drawBoardByMap()},n.resetTarget=function(){for(var t=0;t<this.targetData.length;t++){var e,n;null==(e=this.targetData[t])||null==(n=e.container)||n.setVisible(!1)}},n.resetCellBoard=function(){for(var t=0;t<jT.rows;t++)for(var e=0;e<jT.cols;e++){this.boardCellData[t][e].setFrame(WT.GEM_TRANSPARENT)}},n.drawBoardByFen=function(t){for(var e=$p()(t).call(t).split("/"),n=0;n<e.length;n++)for(var i=e[n].split(","),a=0;a<i.length;a++){var r=i[a];if("x"!==r){var s=HS(r);this.boardCellData[n][a].setFrame(s)}}},n.drawBoardByMap=function(){var t=this.scene.storage.getState(),e=lu(t),n=qu[e];n||(n=qu[qu.length-1]);var i=this.scene.make.tilemap({key:n.key}).layers;if((0,Gv.isArray)(i)){var a=i[0].data;if((0,Gv.isArray)(a))for(var r=0;r<a.length;r++)for(var s=a[r],o=0;o<s.length;o++){var h=s[o];if(!(h.index<0)){var c=MS[h.index-1];this.boardCellData[r][o].setFrame(c)}}}},n.spawnCellBoard=function(t,e,n){var i=this.scene.make.image({key:HT,frame:t});return i.setWorldSize(20,19),this.popup.add(i),Phaser.Display.Align.In.Center(i,this.popup,e,n),i},n.createButtonPlay=function(){this.buttonPlay=new Ys.default(this.scene,NT,GT.BUTTON_GREEN_BIG,118,50),this.buttonPlay.setName("Play"),this.buttonPlay.onClick=this.handlePlay.bind(this);var t=this.scene.make.image({key:NT,frame:GT.TEXT_PLAY});t.setWorldSize(65,15);var e=this.scene.make.image({key:NT,frame:GT.ICON_I_PLAY});e.setWorldSize(20,26),this.buttonPlay.add([t,e]),Phaser.Display.Align.In.Center(t,this.buttonPlay,16,-2),Phaser.Display.Align.In.Center(e,this.buttonPlay,-28,-2),this.popup.add(this.buttonPlay),Phaser.Display.Align.In.Center(this.buttonPlay,this.popup,0,111)},n.handlePlay=function(){var t=this,e=this.scene.storage.getState();Cv(e)<1?this.scene.screen.open(Ns):(this.scene.storage.dispatch(Bv()),this.runCloseAnimation(),this.popupFadeOutAnimation.next((function(){t.scene.screen.close(t.name);var e=t.scene.storage.getState(),n=lu(e);n>qu.length||(t.scene.analytics.levelStart(n,void 0,t.getLevelName(n)),t.scene.storage.dispatch(Wd()))})))},n.getLevelName=function(t){var e;return"journey_"+fs()(e=GameCore.Utils.Number).call(e,t,4,"0")},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Vs.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new so({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new io({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new $s({targets:[this.popup],delay:t,duration:e,props:{scale:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.popup.setVisible(!1)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Tc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new $s({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),ZT=gs.default.DEFAULT,JT=ZT.KEY,QT=ZT.FRAME,$T=function(t){function e(e,n,i,a){var r;return(r=t.call(this,e,n,i,a)||this).popup=void 0,r.title=void 0,r.buttonClose=void 0,r.contents=void 0,r.settingSound=void 0,r.settingVibrate=void 0,r.settingSoundContainer=void 0,r.settingMusicContainer=void 0,r.settingVibrateContainer=void 0,r.popupShowUpAnimation=void 0,r.popupFadeOutAnimation=void 0,r.contentShowUpAnimation=void 0,r.popupFadeInMaskAnimation=void 0,r.popupFadeOutMaskAnimation=void 0,r.handleClose=function(){r.runCloseAnimation()},r.handleMusicSetting=function(t){r.scene.player.setSetting("music",t),t?r.scene.audio.playMusic():r.scene.audio.pauseMusic()},r.handleSoundSetting=function(t){r.scene.player.setSetting("sound",t)},r.handleVibrateSetting=function(t){t&&rm(199),r.scene.player.setSetting("vibrate",t)},r.createPopup(),r.createContentBackground(),r.createTitle(),r.createButtons(),r.addItem(),r.arrangeItems(),r.createInput(),r.setDepth(Gs),r.background.setAlpha(.5),r}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){var e;t.prototype.open.call(this);var n=this.scene.player.getPlayerSettings(),i=n.sound,a=n.vibrate;this.settingSound.updateStatus(i),null==(e=this.settingVibrate)||e.updateStatus(a),this.runOpenAnimation()},n.createContentBackground=function(){var t=this.scene.make.image({key:JT,frame:QT.POPUP_CONTENT_BACKGROUND});t.setWorldSize(260,145),this.popup.add(t),Phaser.Display.Align.In.Center(t,this.popup,0,-4)},n.createInput=function(){this.buttonClose.onClick=this.handleClose,this.settingSound.onClick=this.handleSoundSetting,this.settingVibrate&&(this.settingVibrate.onClick=this.handleVibrateSetting)},n.createPopup=function(){this.popup=new uo(this.scene,0,0,286,226),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,10)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:JT,frame:QT.TEXT_SETTING});t.setWorldSize(151.5,24),this.buttonClose=new Ys.default(this.scene,JT,QT.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.title.add([t,this.buttonClose]),Phaser.Display.Align.In.Center(t,this.title),Phaser.Display.Align.In.Center(this.buttonClose,this.title,135,-18)},n.createButtons=function(){var t=this.scene.player.getPlayerSettings(),e=t.sound,n=t.vibrate;this.createSoundButton(e),nm()?(this.createVibrateButton(n),Phaser.Display.Align.In.Center(this.settingSoundContainer,this.popup,0,-33),Phaser.Display.Align.In.Center(this.settingVibrateContainer,this.popup,0,28)):Phaser.Display.Align.In.Center(this.settingSoundContainer,this.popup,0,0)},n.createVibrateButton=function(t){this.settingVibrateContainer=this.scene.make.container({});var e=this.scene.make.image({key:JT,frame:QT.ICON_VIBRATE});e.setWorldSize(41,48),this.settingVibrate=new _A(this.scene,{enable:t,width:89,height:31}),this.settingVibrate.setName("Vibrate"),this.settingVibrateContainer.add([e,this.settingVibrate]),Phaser.Display.Align.In.Center(e,this.settingVibrateContainer,-60),Phaser.Display.Align.In.Center(this.settingVibrate,this.settingVibrateContainer,35),this.popup.add(this.settingVibrateContainer)},n.createSoundButton=function(t){this.settingSoundContainer=this.scene.make.container({});var e=this.scene.make.image({key:JT,frame:QT.ICON_SOUND});e.setWorldSize(40,35),this.settingSound=new _A(this.scene,{enable:t,width:89,height:31}),this.settingSound.setName("Sound"),this.settingSoundContainer.add([e,this.settingSound]),Phaser.Display.Align.In.Center(e,this.settingSoundContainer,-58),Phaser.Display.Align.In.Center(this.settingSound,this.settingSoundContainer,35),this.popup.add(this.settingSoundContainer),Phaser.Display.Align.In.Center(this.settingSoundContainer,this.popup,0,-33)},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.arrangeItems=function(){Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Vs.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new so({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new io({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new $s({targets:[this.popup],delay:t,duration:e,props:{scale:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Tc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new $s({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),tw=$T,ew=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).main=void 0,n.header=void 0,n.footer=void 0,n.run=function(){n.checkAndAddShortcut(),n.main.dailyChallengeButton.checkSuggestDailyMode(),n.ads.showBannerAdAsync().catch(Ht.sendException)},n.onCreate=function(){var t=n.storage.getState(),e=Rl(t);null===e?n.storage.dispatch(Yd(!1)):!1===e&&n.showMiniJourneyScreen(),n.run()},n.onResume=function(){n.run()},n.onWake=function(){n.run();var t=n.storage.getState();Rl(t)||n.showMiniJourneyScreen()},n.clickPlayWithFriend=function(){n.storage.dispatch(Kd())},n.clickPlaySolo=function(){n.storage.dispatch(Hd())},n.clickJourney=function(){n.storage.dispatch(Wd())},n.clickLevelScene=function(){n.scene.switch(is.SceneKeys.LEVEL_SCENE)},n.clickLeaderBoard=function(){n.screen.open(Ts)},n.clickJourney1=function(){n.scene.switch(is.SceneKeys.LEVEL_SCENE)},n.clickSetting=function(){n.screen.open(Ss)},n}(0,Kt.default)(e,t);var n=e.prototype;return n.showDailyChallengeScreen=function(){this.storage.dispatch(Yd(!0)),this.screen.open(Cs)},n.checkAndAddShortcut=function(){var t=this.storage.getState();Qr(t)===Wr&&this.facebook.attemptToAddShortcut()},n.preload=function(){this.events.on("wake",this.onWake),this.events.on("resume",this.onResume),this.events.on("create",this.onCreate)},n.create=function(){t.prototype.create.call(this),this.createBackground(zr.default.BACKGROUND.KEY),this.createHeaderBar(),this.createMainContent(),this.createFooterBar(),this.createScreens()},n.createHeaderBar=function(){this.header=new zb(this),this.header.setDepth(zs.default.BUTTON),Phaser.Display.Align.In.TopCenter(this.header,this.gameZone)},n.createMainContent=function(){this.main=new ST(this),this.main.setDepth(zs.default.LOGO),this.main.playSingleButton.onClick=this.clickPlaySolo,this.main.journeyButton.onClick=this.clickLevelScene,this.main.leaderBoardButton.onClick=this.clickLeaderBoard,this.main.dailyChallengeButton.onClick=this.showDailyChallengeScreen.bind(this),this.main.settingButton.onClick=this.clickSetting,Phaser.Display.Align.In.Center(this.main,this.gameZone)},n.createFooterBar=function(){this.footer=new Bb(this),this.footer.setDepth(zs.default.BUTTON),Phaser.Display.Align.In.BottomCenter(this.footer,this.gameZone)},n.createScreens=function(){this.createSettingsScreen(),this.createLeaderBoardScreen(),this.createDailyChallengeScreen(),this.createMiniJourneyScreen(),this.createClaimHeartScreen()},n.createSettingsScreen=function(){this.screen.add(Ss,tw)},n.createLeaderBoardScreen=function(){this.screen.add(Ts,kp)},n.createDailyChallengeScreen=function(){this.screen.add(Cs,BT)},n.createMiniJourneyScreen=function(){this.screen.add(ws,qT)},n.createClaimHeartScreen=function(){this.screen.add(Ns,Rb)},n.showMiniJourneyScreen=function(){this.storage.dispatch(Yd(!0)),this.screen.open(ws)},e}(Rp.default);var nw=ew,iw=gs.default.GAMEPLAY_32,aw=iw.KEY,rw=iw.FRAME,sw=function(t){function e(e,n){var i;return(i=t.call(this,e,n.x+(n.padding||0),n.y+(n.padding||0),aw,rw.GEM)||this).scene=void 0,i.canCapture={direction:"bottom",angle:0},i.status=void 0,i.rateShaking=1,i.t0=0,i.x0=void 0,i.y0=void 0,i.v0=void 0,i.alpha0=void 0,i.scale0=void 0,i.maxScale0=void 0,i.scaleRate0=void 0,i.imageBreak=void 0,i.imageGameOver=void 0,i.imageGameStart=void 0,i.tweenImageGameOver=void 0,i.imageHighlight=void 0,i.tweenImageHighlight=void 0,i.tweenStartMission=void 0,i.tweenScaleDown=void 0,i.tweenAlphaImageBreak=void 0,i.tweenFadeOut=void 0,i.setWorldSize(n.width,n.height),i.x0=n.x+(n.padding||0),i.y0=n.y+(n.padding||0),i.scale0=i.scale,i.alpha0=i.alpha,i.scene=e,i.createTweenFadeOut(),i.createImageGameStart(),i.createImageBreak(),i.createImageGameOver(),i.createTweenImageGameOver(),i.createImageHighlight(),i.createTweenImageGHighlight(),i.createTweenScaleDown(),i.createTweenAlphaImageBreak(),i.createTweenStartMission(),e.add.existing((0,ls.default)(i)),i}(0,Kt.default)(e,t);var n=e.prototype;return n.createTweenFadeOut=function(){this.tweenFadeOut=this.scene.add.tween({targets:[this],duration:300,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:this.alpha,to:0},scale:{from:this.scale,to:0},paused:!0})},n.createImageBreak=function(){this.imageBreak=this.scene.make.image({key:aw,frame:rw.GEM_WHITE}),this.imageBreak.setVisible(!1),this.imageBreak.setScale(this.scale0),this.imageBreak.setPosition(this.x,this.y)},n.createImageGameOver=function(){this.imageGameOver=this.scene.make.image({key:aw,frame:rw.GEM_SILVER}),this.imageGameOver.setDepth(this.depth+1),this.imageGameOver.setVisible(!1),this.imageGameOver.setScale(this.scale0),this.imageGameOver.setPosition(this.x,this.y)},n.createImageGameStart=function(){this.imageGameStart=this.scene.make.image({key:aw,frame:rw.GEM_GLARE}),this.imageGameStart.setDepth(this.depth+1),this.imageGameStart.setVisible(!1),this.imageGameStart.setScale(this.scale0),this.imageGameStart.setPosition(this.x,this.y)},n.createTweenImageGameOver=function(){this.tweenImageGameOver=this.scene.add.tween({targets:[this.imageGameOver],duration:1200,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:0,to:1,start:0},paused:!0})},n.createImageHighlight=function(){this.imageHighlight=this.scene.make.image({key:aw,frame:rw.GEM_LIGHT}),this.imageHighlight.setDepth(this.depth+1),this.imageHighlight.setVisible(!1),this.imageHighlight.setScale(this.scale0),this.imageHighlight.setPosition(this.x,this.y)},n.createTweenImageGHighlight=function(){this.tweenImageHighlight=this.scene.add.tween({targets:[this.imageHighlight],duration:100,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:0,to:1,start:0},paused:!0})},n.createTweenStartMission=function(){this.tweenStartMission=this.scene.add.tween({targets:[this.imageGameStart],duration:200,ease:Phaser.Math.Easing.Quadratic.InOut,scale:{from:0,to:this.scale0,start:0},alpha:{from:0,to:1,start:0},yoyo:!0,paused:!0})},n.createTweenScaleDown=function(){var t=this.imageBreak.scale;this.tweenScaleDown=this.scene.add.tween({delay:100,targets:[this.imageBreak],duration:600,ease:Phaser.Math.Easing.Quadratic.InOut,scale:{from:t,to:0,start:t},paused:!0})},n.createTweenAlphaImageBreak=function(){this.tweenAlphaImageBreak=this.scene.add.tween({targets:[this.imageBreak],duration:150,ease:Phaser.Math.Easing.Sine.InOut,alpha:{from:.2,to:.68},paused:!0})},n.showImageHighlight=function(){var t=this.frame.name+"_light";this.imageHighlight.setFrame(t),this.imageHighlight.setVisible(!0).setAlpha(1)},n.hideImageHighlight=function(){this.imageHighlight.setVisible(!1)},n.isHighlight=function(){return this.imageHighlight.visible},n.isShaking=function(){return"SHAKING"===this.status},n.playAnimShaking=function(){this.status="SHAKING"},n.playTweenBreaking=function(){this.status="BREAKING"},n.setRateShaking=function(t){this.rateShaking=t},n.stopAnimShaking=function(){this.rotation=0,this.status=""},n.reset=function(){this.x=this.x0,this.y=this.y0,this.rotation=0,this.scale=this.scale0,this.alpha=1},n.resetImageBreak=function(){this.imageBreak.x=this.x0,this.imageBreak.y=this.y0,this.imageBreak.rotation=0,this.imageBreak.scale=this.scale0,this.imageBreak.setVisible(!1)},n.resetImageGameOver=function(){this.imageGameOver.x=this.x0,this.imageGameOver.y=this.y0,this.imageGameOver.setVisible(!1)},n.playAnimImageGameOver=function(){this.resetImageGameOver(),this.imageGameOver.setVisible(!0).setAlpha(0),this.tweenImageGameOver.play()},n.playTweenScaleDown=function(){this.resetImageBreak(),this.imageBreak.setVisible(!0).setScale(this.scale0).setAlpha(0),this.tweenAlphaImageBreak.play(),this.tweenScaleDown.play()},n.playTweenStartMission=function(){this.imageGameStart.setVisible(!0).setAlpha(0),this.tweenStartMission.play()},n.preUpdate=function(){if("SHAKING"===this.status)this.rotation+=.015*this.rateShaking,this.rotation>.1&&(this.rateShaking=-1),this.rotation<-.1&&(this.rateShaking=1)},n.handleTweenBreaking=function(){var t=this.alpha0<90?1:-1;this.t0+=3e3/1900;var e=.016*this.t0,n=Wp(this.v0,this.alpha0,e),i=Xp(this.v0,this.alpha0,e);this.imageBreak.x=this.x0+n,this.imageBreak.y=this.y0-i,this.imageBreak.rotation+=.04*t,this.imageBreak.scale>.4?this.imageBreak.scale-=this.scale0:this.imageBreak.scale=.4;var a=this.scene.gameZone,r=a.width,s=a.height;(this.imageBreak.x-this.imageBreak.displayWidth/2<0||this.imageBreak.x+this.imageBreak.displayWidth/2>r||this.imageBreak.y-this.imageBreak.displayHeight/2>s)&&(this.status="")},n.playAnimFadeOut=function(){this.tweenFadeOut.play()},e}(Phaser.GameObjects.Image),ow=sw,hw=n(482),cw=n(458),lw=function(){function t(t){this.scene=void 0,this.tweenScaleUp=void 0,this.tweenScaleDown=void 0,this.tweenMoveTo=void 0,this.target=void 0,this.handleOnComplete=void 0,this.playing=void 0,this.path=void 0,this.scene=t,this.path=new Phaser.Curves.Path}var e=t.prototype;return e.runScaleUpAnimation=function(t,e){var n;null==(n=this.tweenScaleUp)||n.remove(),this.tweenScaleUp||(this.tweenScaleUp=new hw.default({targets:[this.target],delay:t,duration:e,props:{scale:"+=0.05"}})),this.tweenScaleUp.play()},e.runScaleDownAnimation=function(t,e){var n;null==(n=this.tweenScaleDown)||n.remove(),this.tweenScaleDown||(this.tweenScaleDown=new cw.default({targets:[this.target],delay:t,duration:e,props:{scale:"-=0.15"}})),this.tweenScaleDown.play()},e.runAnimMoveToPosition=function(t,e,n,i){var a=this;this.playing=!0,this.target.setDepth(zs.default.ON_TOP);var r=this.target.x,s=this.target.y;this.path.startPoint=new Phaser.Math.Vector2(r,s);for(var o=Math.abs(n-r)/2,h=Math.abs(i-s),c=Phaser.Math.Between(1,2),l=[],u=1;u<4;u++){var d=-1;u%2==0&&(d=1);var p=(o-d*Phaser.Math.Between(o/4,o/3))*c,f=s-u*(h/4);l.push(new Phaser.Math.Vector2(p,f))}l.push(new Phaser.Math.Vector2(n,i)),this.path.splineTo(l),this.path.lineTo(n,i);var g=new Phaser.Curves.Spline(l);this.tweenMoveTo=this.scene.add.tween({delay:t,targets:this.path,t:{from:0,to:1},ease:"Sine.easeInOut",duration:e,onUpdate:function(t){var e=t.getValue(0),n=g.getPoint(e);a.target.setPosition(n.x,n.y)},onComplete:function(){a.playing=!1,a.handleOnComplete&&a.handleOnComplete()}})},e.runGemMoveToPosition=function(t,e,n,i){var a=this;this.playing=!0;var r=this.target.x,s=this.target.y;this.path.startPoint=new Phaser.Math.Vector2(r,s);for(var o=this.scene.gameZone.width/2,h=Math.abs(n-r)+o-50,c=Math.abs(i-s),l=[],u=1;u<4;u++){var d=-1;u%2==0&&(d=1);var p=1.5*(h-d*Phaser.Math.Between(h/8,h/7)),f=s-u*(c/4);l.push(new Phaser.Math.Vector2(p,f))}l.push(new Phaser.Math.Vector2(n,i)),this.path.splineTo(l),this.path.lineTo(n,i);var g=new Phaser.Curves.Spline(l);return this.tweenMoveTo=this.scene.add.tween({delay:t,targets:this.path,t:{from:0,to:1},ease:"Sine.easeInOut",duration:e,onUpdate:function(t){var e=t.getValue(0),n=1-e+.1,i=g.getPoint(e);a.target.setAlpha(n),a.target.setPosition(i.x,i.y)},onComplete:function(){a.playing=!1,a.handleOnComplete&&a.handleOnComplete()}}),this.tweenMoveTo},e.setTarget=function(t){this.target=t},(0,Se.default)(t,[{key:"onComplete",set:function(t){this.handleOnComplete=t}},{key:"isPlaying",get:function(){return this.playing}}]),t}(),uw=function(){function t(t){this.scene=void 0,this.listAnimCollectionItem=[],this.scene=t}var e=t.prototype;return e.handleShowEffect=function(t){var e=this;if(t&&0!==t.length){for(var n=this.scene.header.collectItems.getTargetKeys(),i=this.scene.header.collectItems.getJsonAmount(),a=this.scene.header.collectItems.getJsonTarget(),r=0,s=function(s){var o=n[s],h=c()(t).call(t,(function(t){return t.frame===o}));i[o]+h.length>=a[o]&&r++,e.showEffect(h)},o=0;o<n.length;o++)s(o);r===Y()(a).length&&this.scene.setLevelCompleted(!0),this.scene.time.delayedCall(2e3,(function(){e.scene.handleCollectionItemsComplete()}))}},e.showEffect=function(t){for(var e=this,n=t.length,i=this.scene.main.board.dataBoard,a=function(a){var r=t[a],s=r.x,o=r.y,h=r.frame,c=i[o][s].cell,l=c.imageBreak,u=e.scene.gameZone.width/2,d=e.scene.header.collectItems.getPositionCollectionItem(h),p=u+d.x,f=d.y-24,g=e.getFreeAnim();c.resetImageBreak(),l.setVisible(!0),l.setFrame(h),g.setTarget(l),g.onComplete=function(){(n--,l.setVisible(!1),l.setPosition(c.x,c.y),e.scene.header.collectItems.collectItem(h),n<=0)&&(e.scene.header.collectItems.getCollectItemByKey(h).runAnimCollectionItem(),e.scene.updateMatchData())},g.runScaleUpAnimation(0,300),g.runScaleDownAnimation(450,400),g.runAnimMoveToPosition(700,Phaser.Math.Between(500,1e3),p,f)},r=0;r<t.length;r++)a(r)},e.getFreeAnim=function(){var t=new lw(this.scene);return this.listAnimCollectionItem.push(t),t},t}(),dw=uw,pw=function(){function t(t){this.angle=void 0,this.scene=void 0,this.scaleUpTween=void 0,this.breakingTween=void 0,this.breakingDelay=0,this.captureCells=void 0,this.timerEventRemoveCaptureCells=void 0,this.scene=t,this.init()}var e=t.prototype;return e.init=function(){this.createTweenBreaking()},e.handleShowEffect=function(t){var e=this;t&&0!==t.length&&(this.removeCaptureCell(),this.captureCells=t,this.setValueCaptureCell(),this.breakingTween.resetTweenData(!1),this.breakingTween.restart(),this.timerEventRemoveCaptureCells&&this.timerEventRemoveCaptureCells.remove(),this.timerEventRemoveCaptureCells=this.scene.time.addEvent({delay:500,callback:function(){e.breakingTween.isPlaying()||e.removeCaptureCell()}}))},e.onCaptureCellComplete=function(){if(this.captureCells&&this.scene.main&&this.scene.main.board)for(var t=this.scene.main.board.dataBoard,e=0;e<this.captureCells.length;e++){var n=this.captureCells[e],i=n.x;t[n.y][i].cell.resetImageBreak()}},e.removeCaptureCell=function(){var t=this.scene.main.board.dataBoard;if(this.captureCells)for(var e=0;e<this.captureCells.length;e++){var n=this.captureCells[e],i=n.x;t[n.y][i].cell.resetImageBreak()}},e.setValueCaptureCell=function(){for(var t=this.scene.main.board.dataBoard,e=Math.round(68.25),n=0;n<this.captureCells.length;n++){var i=Phaser.Math.Between(50,e),a=Phaser.Math.Between(82,98)*Math.PI/180,r=Phaser.Math.Between(3,10)/1e3,s=this.captureCells[n],o=s.x,h=t[s.y][o].cell;h.maxScale0=Phaser.Math.FloatBetween(2.5,4)/10,h.imageBreak.setVisible(!0),h.imageBreak.setFrame(gs.default.GAMEPLAY_32.FRAME.GEM),h.v0=i,h.alpha0=a,h.scaleRate0=r}},e.createTweenBreaking=function(){var t=this;this.breakingTween=this.scene.tweens.addCounter({from:0,to:1900,onUpdate:function(e){if(t.captureCells)for(var n=t.scene.main.board.dataBoard,i=0;i<t.captureCells.length;i++){t.angle=Phaser.Math.Between(-15,15);var a=t.captureCells[i],r=a.x,s=n[a.y][r].cell,o=s.imageBreak,h=s.maxScale0,c=s.alpha0<1.57?1:-1,l=.016*e.getValue(),u=Wp(s.v0,s.alpha0,l),d=Xp(s.v0,s.alpha0,l);o.setVisible(!0),o.x=s.x0+u,o.y=s.y0+-d,o.rotation+=.04*c,o.scale>h?o.scale-=s.scaleRate0:o.scale=h}},onComplete:function(){t.onCaptureCellComplete()},delay:this.breakingDelay,duration:2500}).stop()},t}(),fw=pw,gw=gs.default.GAMEPLAY,mw=gw.KEY,vw=gw.FRAME,yw=gs.default.GAMEPLAY_32,Sw=yw.KEY,Aw=yw.FRAME,Ew=GameCore.Configs.Board,xw=Ew.cols,bw=Ew.rows,Tw=gs.default.DEFAULT.FRAME,ww=GameCore.Configs.Gameplay.VibrateValue,Cw=function(t){function e(e,n,i){var a;return(a=t.call(this,e)||this).scene=void 0,a.suggestCells=[],a.pX=void 0,a.pY=void 0,a.borderLeftSize=4.5,a.borderTopSize=3,a.cellSize=void 0,a.cellPadding=void 0,a.diceSize=void 0,a.dataBoard=[],a.cellsHighlight=[],a.cellSharking=[],a.boardFrame=void 0,a.woodenEffect=void 0,a.collectionEffect=void 0,a.canCaptureLines=function(t,e){void 0===e&&(e=5);for(var n=t.length,i=t[0].length,a=[],r=[],s=[],o=0;o<n;o++){for(var h=0,c={x:-1,y:-1},l=0;l<i;l++)0===o&&(s[l]={count:0,x:-1,y:-1}),1===t[o][l].value?(s[l].count++,h++):(c.x=l,c.y=o,s[l].x=l,s[l].y=o);if(h===i-1&&r.push((0,wt.default)({row:o},c)),o===n-1)for(var u=0;u<i;u++)s[u].count===n-1&&a.push((0,wt.default)({col:u},s[u]))}if(r.length>=e)for(var d=0,p={x:-1,y:-1},f=0;f<r.length;f++)if(0!==f){if(r[f].x===p.x&&r[f].y===p.y+1?(p.x=r[f].x,p.y=r[f].y,d++):d=1,d>=e)return{isCapture:!0,direction:"vertical",minLine:e}}else p.x=r[f].x,p.y=r[f].y,d++;if(a.length>=e)for(var g=0,m={x:-1,y:-1},v=0;v<a.length;v++)if(0!==v){if(a[v].x===m.x+1&&a[v].y===m.y?(m.x=a[v].x,m.y=a[v].y,g++):g=1,g>=e)return{isCapture:!0,direction:"horizontal",minLine:e}}else m.x=a[v].x,m.y=a[v].y,g++;return{isCapture:!1,direction:"",minLine:e}},a.scene=e,a.setSize(n,i),a.woodenEffect=new fw(a.scene),a.collectionEffect=new dw(a.scene),a.init(),a}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createBoard(),this.calcCellLength(),this.initDataBoard()},n.createBoard=function(){var t=this.scene.gameZone,e=t.width/2,n=t.height/2-27;this.boardFrame=this.scene.make.image({x:e,y:n,key:mw,frame:vw.BOARD}),this.boardFrame.setWorldSize(this.width,this.height)},n.calcCellLength=function(){this.cellPadding=1.8,this.cellSize=(this.width-2*this.borderLeftSize-this.cellPadding*(xw+1))/xw},n.initDataBoard=function(){for(var t=this.boardFrame.x-this.boardFrame.displayWidth/2+this.cellSize/2+this.borderLeftSize,e=this.boardFrame.y-this.boardFrame.displayHeight/2+this.cellSize/2+this.borderTopSize,n=0;n<bw;n++){this.dataBoard[n]=[];for(var i=0;i<xw;i++){var a=t+i*this.cellSize+this.cellPadding*i,r=e+n*this.cellSize+this.cellPadding*n,s={x:a,y:r,width:this.cellSize,height:this.cellSize,texture:Sw,frame:Aw.GEM_TRANSPARENT,depth:zs.default.PIECE-.1,padding:this.cellPadding,isWoodenEffect:!0},o=new ow(this.scene,s);o.setVisible(!1),this.dataBoard[n][i]={x:a,y:r,width:this.cellSize,height:this.cellSize,frame:Aw.GEM_TRANSPARENT,value:0,cell:o}}}},n.handleHighlight=function(t,e){this.cellsHighlight=t;for(var n=0;n<t.length;n++){var i=t[n],a=i.x,r=i.y,s=i.frame;if(this.dataBoard[r]&&this.dataBoard[r][a]&&0===this.dataBoard[r][a].value){var o=this.dataBoard[r][a].cell;this.dataBoard[r][a].frame=s||Aw.GEM,o.setVisible(!0),o.setFrame(s||Aw.GEM),o.setAlpha(.3)}}this.canCaptureCells(t,e)},n.handleTweenStartMission=function(){for(var t=this,e=100,n=0;n<bw;n++)for(var i=function(i){var a=t.dataBoard[n][i].cell,r=0;r=4==n&&4==i?e:n>=3&&n<=5&&i>=3&&i<=5?200:n>=2&&n<=6&&i>=2&&i<=6?300:n>=1&&n<=7&&i>=1&&i<=7?400:500,t.scene.time.delayedCall(r,(function(){a.playTweenStartMission()}))},a=0;a<xw;a++)i(a)},n.handleCapturePiece=function(t){var e=this;try{!function(){if(!t||t.length<=0)throw VS=0,new Error("Invalid Capture");var n=c()(t).call(t,(function(t){return t.frame!==Aw.GEM}));e.collectionEffect.handleShowEffect(n);for(var i=300,a=0,r=BS(e.dataBoard),s=FS(e.dataBoard),o=RS(),h=function(n){var h=t[n],c=h.x,l=h.y,u=e.dataBoard[l][c].cell,d=0,p=0,f=0;if(r.length>0&&s.length>0){var m=0,v=0;a=i/xw,-1!==g()(r).call(r,l)&&-1===g()(s).call(s,c)&&(m=a*c,v=0,p=g()(r).call(r,l)),-1===g()(r).call(r,l)&&-1!==g()(s).call(s,c)&&(m=0,v=a*l,p=g()(s).call(s,c)),-1!==g()(r).call(r,l)&&-1!==g()(s).call(s,c)&&(m=a*c,v=a*l,p=Math.max(g()(s).call(s,c),g()(r).call(r,l),0)),-1===g()(r).call(r,l)&&-1===g()(s).call(s,c)&&(m=a*c,v=a*l),d=Math.max(m,v,0)}else if(s.length>0)d=(a=i/xw)*l,p=g()(s).call(s,c),f=l;else if(r.length>0)d=(a=i/bw)*c,p=g()(r).call(r,l),f=c;else{a=100;var y=t[0].x;d=a*(c-y),p=0}u.hideImageHighlight(),e.scene.time.delayedCall(d,(function(){if(u.frame.name===Aw.GEM){u.resetImageBreak();var t="";o>2&&(s.length>=3||r.length>=3)?(t=tm[f]||tm[0],u.imageBreak.setFrame(t)):(t=$g[p]||$g[0],u.imageBreak.setFrame(t)),u.playTweenScaleDown()}0==e.dataBoard[l][c].value&&u.setVisible(!1)})),e.dataBoard[l][c].frame=Aw.GEM_TRANSPARENT,e.dataBoard[l][c].value=0},l=0;l<t.length;l++)h(l)}()}catch(n){}},n.checkPositionCellOnCaptureCell=function(t,e){var n=c()(e).call(e,(function(e){return e.x===t.x&&e.y===t.y}));return n&&n.length>0},n.handlePraise=function(t,e){for(var n=[],i=0;i<t.length;i++){var a=t[i];this.checkPositionCellOnCaptureCell(a,e)&&n.push(a)}0!==n.length&&this.playEatSound(1)},n.handleStreakBreak=function(t,e){var n=RS(),i=YS();if(t-75<0&&(t=75),t+75>375&&(t=300),!(i<2||n>=2)){var a=i>6?6:i,r=this.getVibrateByLevel(a);this.scene.player.getPlayerSettings().vibrate&&rm(r),this.playEatSound(a),this.scene.effectManager.streakBreak.setTextStreak(i),this.scene.effectManager.streakBreak.setBgFrame(Tw.BG_STREAK),this.scene.effectManager.streakBreak.playAnim(t,e-20)}},n.getVibrateByLevel=function(t){return ww[t]||0},n.playEatSound=function(t){switch(this.scene.audio.playSound(Vs.default.EAT_BLOCK),t){default:break;case 2:this.scene.audio.playSound(Vs.default.GOOD);break;case 3:this.scene.audio.playSound(Vs.default.COOL);break;case 4:case 5:case 6:this.scene.audio.playSound(Vs.default.EXCELLENT)}},n.handleRemoveHighlight=function(){try{if(!this.cellsHighlight)return;for(var t=0;t<this.cellsHighlight.length;t++){var e=this.cellsHighlight[t],n=e.x,i=e.y;if(this.dataBoard[i]&&this.dataBoard[i][n]&&0===this.dataBoard[i][n].value){var a=this.dataBoard[i][n].cell;this.dataBoard[i][n].frame=Aw.GEM_TRANSPARENT,a.setVisible(!1),a.setFrame(Aw.GEM_TRANSPARENT),a.setAlpha(1)}}this.cellsHighlight=[]}catch(r){}},n.canCaptureCells=function(t,e){for(var n=this,i=this.dataBoard,a=[],r=0;r<i.length;r++){a[r]=[];for(var s=0;s<i[r].length;s++)a[r][s]=(0,wt.default)({},i[r][s])}for(var o=0;o<t.length;o++){var h=t[o],c=h.x;a[h.y][c].value=1}this.removeAnimCanCaptureCells(a,t);var l=OS(a,t);if(!l||l.length<=0)return!1;for(var u=function(e){var i=l[e],a=i.x,r=i.y;t.some((function(t){return t.x===a&&t.y===r}))||n.cellSharking.push((0,wt.default)({},l[e]))},d=0;d<l.length;d++)u(d);for(var p=0;p<this.cellSharking.length;p++){var f=this.cellSharking[p],g=f.x,m=f.y,v=this.dataBoard[m][g].cell;v.isHighlight()||v.showImageHighlight()}e(BS(a),FS(a),LS(a,t),t)},n.removeAnimCanCaptureCells=function(t,e){var n=this;if(0!==this.cellSharking.length){for(var i=BS(t),a=FS(t),r=LS(t,e),s=function(t){var e=n.cellSharking[t],s=e.x,o=e.y,h=n.dataBoard[o][s].cell;if(-1!==g()(i).call(i,o)||-1!==g()(a).call(a,s)||r.some((function(t){return t.x===s&&t.y===o})))return"continue";h.hideImageHighlight()},o=0;o<this.cellSharking.length;o++)s(o);this.cellSharking=[]}},n.removeAllCanCaptureCells=function(){if(0!==this.cellSharking.length){for(var t=0;t<this.cellSharking.length;t++){var e=this.cellSharking[t],n=e.x,i=e.y;this.dataBoard[i][n].cell.hideImageHighlight()}this.cellSharking=[]}},n.handleSuggestMove=function(t){try{this.suggestCells=t;for(var e=0;e<t.length;e++){var n=t[e],i=n.x,a=n.y,r=this.dataBoard[a][i].cell;r.setFrame(Aw.GEM_HIGHT_LIGHT),r.setVisible(!0),r.setAlpha(1)}}catch(s){}},n.handleRemoveSuggestMove=function(){try{for(var t=0;t<this.suggestCells.length;t++){var e=this.suggestCells[t],n=e.x,i=e.y,a=this.dataBoard[i][n].cell;this.isCellHighlight(a)||(a.setFrame(Aw.GEM_TRANSPARENT),a.setVisible(!1))}this.suggestCells=[]}catch(r){}},n.handleMove=function(t,e){try{for(var n=0;n<t.length;n++){var i=t[n],a=i.x,r=i.y,s=i.frame,o=void 0===s?Aw.GEM:s;if(this.dataBoard[r]&&this.dataBoard[r][a]){this.dataBoard[r][a].frame=o,this.dataBoard[r][a].value=1;var h=this.dataBoard[r][a].cell;h.setVisible(!0),h.setFrame(o),h.setAlpha(1)}}var c=OS(this.dataBoard,t);this.handleCapturePiece(c),this.handlePraise(t,c),e&&e(),this.handleResetFrameBoard(),this.scene.updateMatchData(),this.handleGameOver()}catch(l){}},n.handleResetFrameBoard=function(){for(var t=0;t<bw;t++)for(var e=0;e<xw;e++)if(this.dataBoard[t]&&this.dataBoard[t][e]&&1===this.dataBoard[t][e].value){var n=this.dataBoard[t][e],i=n.frame,a=n.cell;a.visible||(0,Ht.sendException)(new Error("Cell is invisible")),a.frame.name!==i&&(0,Ht.sendException)(new Error("Cell is frame not true")),a.setVisible(!0).setFrame(i)}},n.handleGameOver=function(){if(!this.scene.isLevelComplete){for(var t=[],e=this.scene.footer.pieces.piecesActive,n=this.scene.footer.pieces.allPieces,i=0;i<e.length;i++){var a=e[i],r=a.position;if(!a.used){var s=n[r].piece;t.push({data:s.data,type:s.type,direction:s.direction,isReverse:s.isReverse,frame:s.frame})}}NS(this.dataBoard,t)&&(this.scene.disableInput(),this.runAnimationGameOver())}},n.runAnimationGameOver=function(){var t=this;try{this.scene.audio.playSound(Vs.default.BOARD_GAME_OVER);for(var e=[],n=function(n){for(var i=function(i){if(t.dataBoard[n]&&t.dataBoard[n][i]&&1===t.dataBoard[n][i].value){var a=Math.floor(100*(n+1));e.push({delay:a,x:i,y:n}),t.scene.time.delayedCall(a,(function(){t.dataBoard[n][i].cell.playAnimImageGameOver()}))}},a=0;a<xw;a++)i(a)},i=0;i<bw;i++)n(i);this.scene.time.addEvent({delay:e[e.length-1].delay+300,callback:function(){t.scene.handleRequestFinishGame()}})}catch(a){}},n.hasPieceL5=function(){var t=this.scene.footer.pieces.piecesActive;return c()(t).call(t,(function(t){return t.type===fy})).length>0},n.hasPieceCross5=function(){var t=this.scene.footer.pieces.piecesActive;return c()(t).call(t,(function(t){return t.type===wy})).length>0},n.getBoardByFen=function(t){var e=[],n=t.split(" ");if(n.length<2)throw new Error("Invalid fen");for(var i=n[0].split("/"),a=i.length,r=0;r<a;r++){e[r]=[];for(var s=WS(i[r]),o=0;o<s.length;o++)e[r][o]=s[o]}return e},n.getFenByBoard=function(){for(var t="",e=0;e<bw;e++){for(var n="",i=0;i<xw;i++){var a=this.dataBoard[e][i],r=a.value,s=a.frame,o=zS(s)||"g";switch(r){case 0:n+=",x";break;case 1:n+=","+o}}t+="/"+(n=n.substring(1))}return t.substring(1)},n.startGame=function(t,e){if(t){for(var n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++){var a=t[n][i].frame,r=t[n][i].value,s=this.dataBoard[n][i];1===r&&(a&&a!==Aw.GEM_TRANSPARENT||((0,Ht.sendExceptionWithScope)(new Error("MapByBoardError"),{level:this.scene.levelManager.getLevel(),row:n,col:i,frame:a,fen:e}),a=Aw.GEM),s.value=1,s.frame=a,s.cell.setFrame(a),s.cell.setVisible(!0),s.cell.setWorldSize(this.cellSize,this.cellSize),s.cell.setAlpha(0),s.cell.setScale(0))}this.fadeIn()}},n.clearBoard=function(){for(var t=0;t<bw;t++)for(var e=0;e<xw;e++){var n=this.dataBoard[t][e];n.value=0,n.frame=Aw.GEM_TRANSPARENT,n.cell.reset(),n.cell.setFrame(Aw.GEM_TRANSPARENT),n.cell.setVisible(!1),n.cell.resetImageGameOver()}},n.isCellHighlight=function(t){var e,n=c()(e=this.cellsHighlight).call(e,(function(e){return e.x===t.x&&e.y&&t.y}));return!!(n&&n.length>0)},n.setFrameBoardByIndex=function(t,e,n){var i=this.dataBoard[t][e],a=i.cell;a.setFrame(n),a.setVisible(!0),i.frame=n,i.value=1,a.setScale(0),a.setAlpha(0)},n.getFrameByMapItemIndex=function(t){return MS[t]},n.fadeOut=function(){for(var t=[],e=0;e<bw;e++)for(var n=0;n<xw;n++){var i=this.dataBoard[e][n];i.value&&t.push(i.cell)}if(!t||0===t.length)return null;var a=this.scene.add.tween({targets:t,duration:300,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:1,to:0},scale:{from:t[0].scale,to:0},paused:!0});return a.play(),a},n.fadeIn=function(){for(var t=[],e=0;e<bw;e++)for(var n=0;n<xw;n++){var i=this.dataBoard[e][n];i.value&&t.push(i.cell)}t&&0!==t.length&&this.scene.add.tween({targets:t,duration:300,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:0,to:t[0].alpha0},scale:{from:0,to:t[0].scale0},paused:!0}).play()},e}(Phaser.GameObjects.Container),Mw="score",Iw="collect",Pw=GameCore.Configs.Gameplay.VibrateValue,kw=gs.default.EFFECTS,Rw=kw.KEY,Ow=kw.FRAME,_w=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.listScore=[],n.score=void 0,n.startX=void 0,n.startY=void 0,n.scoreText=void 0,n.tweenShowScoreText=void 0,n.tweenHideScoreText=void 0,n.tweenShowPraiseFrame=void 0,n.tweenHidePraiseFrame=void 0,n.praiseFrame=void 0,n.praiseScoreText=void 0,n.particle=void 0,n.emitter=void 0,n.scene=e,e.add.existing((0,ls.default)(n)),n.setVisible(!1).setAlpha(0),n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createScoreText(),this.createTweenScoreText(),this.createPraiseFrame(),this.createPraiseScoreText(),this.createParticle(),this.createEmitter()},n.createParticle=function(){this.particle=this.scene.add.particles(Rw),this.particle.setDepth(zs.default.ON_TOP+1)},n.createEmitter=function(){this.emitter=this.particle.createEmitter({x:0,y:0,scale:{start:.05,end:.2},speed:{min:20,max:70},lifespan:{min:500,max:1e3},quantity:20,on:!1,tint:[16441092,16422659],frame:Ow.FX_STAR,delay:350})},n.createScoreText=function(){this.scoreText=this.scene.make.bitmapText({font:Hs.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(50),text:"+0",origin:{x:.5,y:.5}}),this.scoreText.setScale(0).setAlpha(0),this.scoreText.setDepth(zs.default.ON_TOP),this.scoreText.setVisible(!1)},n.createTweenScoreText=function(){var t,e=this,n=this.scene.storage.getState(),i=Ml(n),a=this.scene.gameZone.width/2;g()(t=[Kr,Xr,jr]).call(t,i)>=0&&(a=105),this.tweenShowScoreText=this.scene.tweens.add({paused:!0,targets:this.scoreText,scale:{from:0,to:1},alpha:{from:0,to:1},duration:300,onComplete:function(){e.tweenHideScoreText=e.scene.tweens.add({targets:e.scoreText,scale:{from:1,to:.5},alpha:{from:1,to:.5},x:a,y:65,delay:1e3,duration:300,onComplete:function(){e.scoreText.setVisible(!1),e.scoreText.setAlpha(0),e.scoreText.setScale(0),e.scene.handleAddScoreAnim(e.score||0)}})}})},n.playAnimShowScoreText=function(){if(this.tweenHideScoreText&&this.tweenHideScoreText.isPlaying()){this.tweenHideScoreText.stop(),this.scoreText.setPosition(this.startX,this.startY);var t=this.scene.storage.getState(),e=0;Ml(t)===Wr&&(e=this.scene.header.mainScoreBlock.score,this.scene.header.mainScoreBlock.setScore(e+(this.score||0)),this.scene.header.mainScoreBlock.setScoreText(e+(this.score||0)))}this.score=this.listScore.shift()||0,this.scene.handleUpdateScore(this.score),this.scoreText.setScale(0).setAlpha(0).setVisible(!0),this.tweenShowScoreText.play()},n.createPraiseFrame=function(){this.praiseFrame=this.scene.make.image({x:0,y:0,key:Rw}),this.praiseFrame.setScale(0),this.praiseFrame.setAlpha(0),this.praiseFrame.setDepth(zs.default.ON_TOP),this.praiseFrame.setVisible(!1)},n.createTweenPraiseFrame=function(){var t=this;if(!this.tweenShowPraiseFrame||!this.tweenHidePraiseFrame){var e=this.praiseFrame.scale;this.tweenShowPraiseFrame=this.scene.tweens.add({paused:!0,targets:this.praiseFrame,scale:{from:0,to:e},alpha:{from:0,to:1},duration:300,delay:100,ease:Phaser.Math.Easing.Back.Out,onComplete:function(){t.tweenHidePraiseFrame.play()}}),this.tweenHidePraiseFrame=this.scene.tweens.add({paused:!0,targets:this.praiseFrame,scale:{from:e,to:0},alpha:{from:1,to:0},duration:300,delay:1e3,onComplete:function(){t.praiseFrame.setScale(0),t.praiseFrame.setAlpha(0),t.praiseFrame.setVisible(!1)}})}},n.playAnimShowPraiseFrame=function(){this.createTweenPraiseFrame(),(this.tweenShowPraiseFrame.isPlaying()||this.tweenHidePraiseFrame.isPlaying())&&(this.tweenShowPraiseFrame.resetTweenData(!1),this.tweenHidePraiseFrame.resetTweenData(!1)),this.praiseFrame.setScale(0).setAlpha(0).setVisible(!0),this.tweenShowPraiseFrame.play()},n.createPraiseScoreText=function(){this.praiseScoreText=this.scene.make.bitmapText({font:Hs.default.PRIMARY.KEY,size:this.scene.fontSize(30),origin:{x:.5,y:.5}}),this.praiseScoreText.setDepth(zs.default.ON_TOP),this.add(this.praiseScoreText),Phaser.Display.Align.In.Center(this.praiseScoreText,this,0,20)},n.handlePraise=function(t,e,n,i){this.startX=t,this.startY=e+15,this.listScore.push(n);var a=t-10,r=this.scene.targetMissionManager.getTargetType()===Mw;this.scoreText.setPosition(a,e+15),this.scoreText.setText("+"+n),this.scoreText.setVisible(r),a-this.scoreText.fontSize/2<0&&(a+=this.scoreText.fontSize/2,this.scoreText.setPosition(a,e+15)),r&&(this.playAnimShowScoreText(),this.handlePraiseFrameText(t,e,i));var s=this.getVibrateByLevel(i);this.scene.player.getPlayerSettings().vibrate&&rm(s),i<=1||this.changeExplode(a,e,i)},n.getVibrateByLevel=function(t){return Pw[t]||0},n.changeExplode=function(t,e,n){var i=this.getExplodeByLevel(n);i&&(this.emitter.setScale({start:.05*i.scale,end:.2*i.scale}),this.emitter.setSpeed({min:30*i.speed,max:80*i.speed}),this.emitter.setQuantity(20*i.quantity)),this.emitter.explode(20*i.quantity,t,e)},n.handlePraiseFrameText=function(t,e,n){var i=this.getMainFrameByLevel(n);if(i){var a=0,r=0,s=this.scene.targetMissionManager.getTargetType()===Mw?-40:0;switch(i){case Ow.TEXT_COOL:a=112,r=31.5;break;case Ow.TEXT_GOOD:a=163.5,r=31.5;break;case Ow.TEXT_EXCELLENT:a=149.5,r=31}this.praiseFrame.setFrame(i),this.praiseFrame.setWorldSize(a,r),this.praiseFrame.setPosition(t-a/2<0?a/2:t,e+s),this.playAnimShowPraiseFrame()}},n.getExplodeByLevel=function(t){return oy[t-1]||oy[0]||null},n.getMainFrameByLevel=function(t){var e=sy[t-1]||sy[0];return Phaser.Utils.Array.GetRandom(e.frames)},n.reset=function(){this.createTweenScoreText()},e}(Phaser.GameObjects.Container),Dw=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.board=void 0,n.praise=void 0,n.scene=e,e.add.existing((0,ls.default)(n)),n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createBoard(),this.createPraise()},n.createBoard=function(){this.board=new Cw(this.scene,354,352)},n.createPraise=function(){this.praise=new _w(this.scene)},e}(Phaser.GameObjects.Container),Lw=Dw,Bw=gs.default.DEFAULT,Fw=Bw.KEY,Nw=Bw.FRAME,Gw=function(t){function e(e){var n;return(n=t.call(this,e)||this).background=void 0,n.bestScoreText=void 0,n.titleText=void 0,n.dayText=void 0,n.titleDayText=void 0,n.setPosition(0,48.5),n.createBackground(),n.createScoreText(),n.createLevelTitleText(),n.createTitleDayText(),n.createDayText(),n.scene.add.existing((0,ls.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createBackground=function(){this.background=this.scene.make.image({key:Fw,frame:Nw.BEST_SCORE_FRAME}),this.background.setWorldSize(55,77),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this)},n.createScoreText=function(){this.bestScoreText=this.scene.make.bitmapText({font:Hs.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(32),origin:{x:.5,y:.5},text:"0"}),this.add(this.bestScoreText),Phaser.Display.Align.In.Center(this.bestScoreText,this.background,0,23)},n.createTitleDayText=function(){this.titleDayText=this.scene.make.bitmapText({font:Hs.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(18),origin:{x:.5,y:.5},text:"dd.mm.yy"}),this.add(this.titleDayText),Phaser.Display.Align.In.Center(this.titleDayText,this.background,0,4)},n.createDayText=function(){this.dayText=this.scene.make.bitmapText({font:Hs.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5},text:"0"}),this.add(this.dayText),Phaser.Display.Align.In.Center(this.dayText,this.background,0,23)},n.createLevelTitleText=function(){this.titleText=this.scene.make.bitmapText({font:Hs.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5},text:"\u0423\u0420\u041e\u0412\u0415\u041d\u042c"}),this.add(this.titleText),Phaser.Display.Align.In.Center(this.titleText,this.background,0,4)},n.setScoreText=function(t){this.bestScoreText.setText(String(t))},n.setDayText=function(t){this.dayText.setText(t)},n.showTextScore=function(){this.titleText.setVisible(!0),this.bestScoreText.setVisible(!0),this.titleDayText.setVisible(!1),this.dayText.setVisible(!1)},n.showTextDay=function(){this.titleText.setVisible(!1),this.bestScoreText.setVisible(!1),this.titleDayText.setVisible(!0),this.dayText.setVisible(!0)},e}(Phaser.GameObjects.Container),Uw=Gw,Vw=gs.default.GAMEPLAY,Yw=Vw.KEY,zw=Vw.FRAME,Hw=gs.default.GAMEPLAY_32.KEY,Ww=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.imageGem=void 0,n.imageCheck=void 0,n.text=void 0,n.particle=void 0,n.emitter=void 0,n.currentPosition=void 0,n.imageGlow=void 0,n.tweenGlow=void 0,n.imageGlowCrop=void 0,n.tweenCropMaskTopDown=void 0,n.tweenCropMaskDownBottom=void 0,n.imageStar=void 0,n.tweenShowStar=void 0,n.tweenHideStar=void 0,n.tweenShowMe=void 0,n.scene=e,n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createImageGem(),this.createImageCheck(),this.createText(),this.createParticle(),this.createEmitter(),this.createGlow(),this.createTweenGlow(),this.createGlowCrop(),this.createStar(),this.createTweenStar(),this.createTweenShowMe()},n.createImageGem=function(){this.imageGem=this.scene.make.image({key:Hw}),this.imageGem.setWorldSize(22,22),this.add(this.imageGem),Phaser.Display.Align.In.Center(this.imageGem,this,0,-7)},n.createImageCheck=function(){this.imageCheck=this.scene.make.image({key:Yw,frame:zw.ICON_CHECK}),this.imageCheck.setWorldSize(22,17),this.imageCheck.setVisible(!1),this.add(this.imageCheck),Phaser.Display.Align.In.Center(this.imageCheck,this.imageGem)},n.createText=function(){this.text=this.scene.make.bitmapText({font:Hs.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5}}),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this.imageGem,0,19)},n.createParticle=function(){this.particle=this.scene.add.particles(Yw).setDepth(zs.default.ON_TOP)},n.createEmitter=function(){var t=1.5/this.scene.world.getPixelRatio();this.emitter=this.particle.createEmitter({on:!1,angle:{start:0,end:360,steps:8},frame:[zw.DUST],lifespan:1e3,quantity:1,scale:{start:t,end:0,ease:"Quart.easeIn"},speed:50})},n.createGlow=function(){this.imageGlow=this.scene.make.image({key:Yw,frame:zw.VIOLET_GLOW}),this.imageGlow.setVisible(!1).setScale(0).setAlpha(0),this.add(this.imageGlow),Phaser.Display.Align.In.Center(this.imageGlow,this.imageGem)},n.createTweenGlow=function(){var t=this;this.tweenGlow=this.scene.tweens.add({targets:[this.imageGlow],paused:!0,scale:{from:0,to:.6},alpha:{from:0,to:1},delay:100,duration:600,onComplete:function(){t.imageGlow.setVisible(!1).setScale(0).setAlpha(0),t.playAnimMaskCrop(),t.playAnimStar()}})},n.createGlowCrop=function(){this.imageGlowCrop=this.scene.make.image({key:Yw,frame:zw.MASK}),this.imageGlowCrop.setVisible(!1),this.imageGlowCrop.setWorldSize(this.imageGem.displayWidth,this.imageGem.displayHeight),this.add(this.imageGlowCrop),Phaser.Display.Align.In.Center(this.imageGlowCrop,this.imageGem)},n.createStar=function(){this.imageStar=this.scene.make.image({key:Yw,frame:zw.ICON_STAR_1}),this.imageStar.setVisible(!1).setScale(0).setAlpha(0),this.imageStar.setWorldSize(27,26),this.add(this.imageStar),Phaser.Display.Align.In.Center(this.imageStar,this.imageGem,-10,-10)},n.createTweenStar=function(){var t=this;this.tweenHideStar=this.scene.add.tween({paused:!0,targets:[this.imageStar],scale:{from:1,to:0},alpha:{from:1,to:0},delay:100,duration:500,onComplete:function(){t.imageStar.setVisible(!1).setScale(0).setAlpha(0)}}),this.tweenShowStar=this.scene.add.tween({paused:!0,targets:[this.imageStar],scale:{from:0,to:1},alpha:{from:0,to:1},delay:100,duration:500,onComplete:function(){t.tweenHideStar.play()}})},n.createTweenShowMe=function(){this.tweenShowMe=this.scene.add.tween({paused:!0,targets:[this],alpha:{from:0,to:1},duration:200})},n.cropTopDownImageGlow=function(){var t=this;if(!this.tweenCropMaskTopDown){var e=this.imageGlowCrop.displayHeight,n=this.imageGlowCrop.displayWidth,i=this.imageGlowCrop.scaleX,a=this.imageGlowCrop.scaleY;this.tweenCropMaskTopDown=this.scene.tweens.addCounter({from:0,to:1,delay:200,duration:300,paused:!0,onUpdate:function(r){var s=r.getValue(0)*e;t.imageGlowCrop.setCrop(0,0,n/i,s/a)},onComplete:function(){t.cropDownBottomImageGlow()}})}this.tweenCropMaskTopDown.play()},n.cropDownBottomImageGlow=function(){var t=this;if(!this.tweenCropMaskDownBottom){var e=this.imageGlowCrop.displayHeight,n=this.imageGlowCrop.displayWidth,i=this.imageGlowCrop.scaleX,a=this.imageGlowCrop.scaleY;this.tweenCropMaskDownBottom=this.scene.tweens.addCounter({from:0,to:1,delay:200,duration:300,paused:!0,onUpdate:function(r){var s=r.getValue(0)*e;t.imageGlowCrop.setCrop(0,s/a,n/i,e/a)}})}this.tweenCropMaskDownBottom.play()},n.playAnimStar=function(){this.imageStar.setVisible(!0),this.tweenShowStar.play()},n.playAnimMaskCrop=function(){this.imageGlowCrop.setVisible(!0).setCrop(0,0,0,0),this.cropTopDownImageGlow()},n.setFrame=function(t){this.imageGem.setFrame(t)},n.getFrame=function(){return this.imageGem.frame.name},n.setText=function(t,e){this.text.setText(t+" / "+e)},n.completeMission=function(){this.imageGem.setAlpha(.3),this.text.setAlpha(.3),this.imageCheck.setVisible(!0)},n.reset=function(){this.imageGem.setAlpha(1),this.text.setAlpha(1),this.imageCheck.setVisible(!1)},n.updateCurrentPosition=function(t){this.currentPosition=t},n.runAnimCollectionItem=function(){var t=this.scene.gameZone.width/2;this.tweenGlow.play(),this.emitter.explode(8,t+this.currentPosition.x,this.currentPosition.y-25)},n.playAnimShowMe=function(){this.setVisible(!0).setAlpha(0),this.tweenShowMe.play()},e}(Phaser.GameObjects.Container),Xw=gs.default.GAMEPLAY,Kw=Xw.KEY,jw=Xw.FRAME,qw=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.target=void 0,n.targetKeys=[],n.jsonPosition={},n.jsonAmount={},n.jsonTarget={},n.jsonCollectItem={},n.textMission=void 0,n.background=void 0,n.listCollectItems=[],n.scene=e,n.createBackground(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createBackground=function(){this.background=this.scene.make.image({key:Kw,frame:jw.BG_MAIN_SCORE}),this.background.setWorldSize(187,48),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this,0,-1)},n.calcPosition=function(t){for(var e=[],n=200/(t+1),i=n*(t-1)/2,a=0;a<t;a++)e.push(n*a-i);return e},n.parseTargetToJson=function(){if(!(0,Gv.isObject)(this.target))for(var t=JSON.parse(this.target),e=Y()(t),n=this.calcPosition(e.length),i=0;i<e.length;i++){var a=e[i],r=MS[a];this.targetKeys.push(r),this.jsonAmount[r]=0,this.jsonTarget[r]=t[a],this.jsonPosition[r]={x:n[i],y:68};var s=this.listCollectItems[i];s||(s=new Ww(this.scene),this.add(s),this.listCollectItems.push(s)),s.updateCurrentPosition(this.jsonPosition[r]),s.setVisible(!0),s.setX(n[i]),s.setFrame(r),s.setText(0,t[a]),this.jsonCollectItem[r]=s}},n.hideListCollectItems=function(){this.listCollectItems.forEach((function(t){t.setVisible(!1),t.reset()}))},n.showListCollectItems=function(){this.listCollectItems.forEach((function(t){t.reset(),t.playAnimShowMe()}))},n.showCollectItemByKey=function(t){var e,n=c()(e=this.listCollectItems).call(e,(function(e){return e.getFrame()===t}));n&&0!==n.length&&(this.jsonAmount[t]>=this.jsonTarget[t]?n[0].completeMission():n[0].reset(),n[0].playAnimShowMe())},n.start=function(){this.parseTargetToJson()},n.setTargets=function(t){var e,n;this.target=Tv()(e=Tv()(n=Tv()(t).call(t,"{",'{"')).call(n,", ",', "')).call(e,":",'":')},n.collectItem=function(t){if(t in this.jsonAmount){this.jsonAmount[t]++;var e=this.jsonAmount[t],n=this.jsonTarget[t];e===n&&this.jsonCollectItem[t].completeMission(),this.jsonCollectItem[t].setText(e,n)}},n.checkCompleteMission=function(){for(var t=Y()(this.jsonTarget),e=0;e<t.length;e++){var n=t[e];if(this.jsonTarget[n]>this.jsonAmount[n])return!1}return!0},n.reset=function(){this.hideListCollectItems(),this.targetKeys=[],this.jsonAmount={},this.jsonTarget={},this.jsonCollectItem={},this.jsonPosition={}},n.getPositionCollectionItem=function(t){return this.jsonPosition[t]},n.getTargetKeys=function(){return this.targetKeys},n.getJsonAmount=function(){return this.jsonAmount},n.getJsonTarget=function(){return this.jsonTarget},n.getCollectItemByKey=function(t){return this.jsonCollectItem[t]},n.updateJsonAmountByFen=function(t){this.jsonAmount=JSON.parse(_()(t));for(var e=Y()(this.jsonTarget),n=0;n<e.length;n++){var i=e[n],a=this.jsonCollectItem[i];this.jsonTarget[i]>this.jsonAmount[i]?a.reset():a.completeMission(),a.setText(this.jsonAmount[i],this.jsonTarget[i])}},n.resetTextAmount=function(){for(var t=Y()(this.jsonTarget),e=0;e<t.length;e++){var n=t[e],i=this.listCollectItems[e];i&&i.setText(0,this.jsonTarget[n])}},e}(Phaser.GameObjects.Container),Zw=gs.default.DEFAULT,Jw=Zw.KEY,Qw=Zw.FRAME,$w=function(t){function e(e){var n,i=(n=t.call(this,e,0,0,Jw,Qw.LEAF)||this).scene.gameZone.width,a=i*n.height/n.width;return n.setWorldSize(i,a),n.setInteractive().on(Phaser.Input.Events.POINTER_MOVE,(function(){n.disableInteractive()})),n.scene.add.existing((0,ls.default)(n)),n}return(0,Kt.default)(e,t),e}(Phaser.GameObjects.Image),tC=$w,eC=gs.default.GAMEPLAY,nC=eC.KEY,iC=eC.FRAME,aC=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.scoreText=void 0,n.background=void 0,n.tweenShow=void 0,n.tweenHide=void 0,n.addScore=void 0,n.score=0,n.scene=e,n.scene.add.existing((0,ls.default)(n)),n.createBackground(),n.createScoreText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createBackground=function(){this.background=this.scene.make.image({key:nC,frame:iC.BG_MAIN_SCORE}),this.background.setWorldSize(187,48),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this)},n.createScoreText=function(){this.scoreText=this.scene.make.bitmapText({font:Hs.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(52),text:"0",origin:{x:.5,y:.5}}),this.add(this.scoreText),Phaser.Display.Align.In.Center(this.scoreText,this.background)},n.setScore=function(t){this.score=t},n.setScoreText=function(t){this.scoreText.setText(String(t))},n.animAddScore=function(t){var e=this;if(this.addScore&&this.addScore.isPlaying()){this.addScore.stop();var n=this.score+t;this.setScore(n),this.setScoreText(n)}this.addScore=this.scene.tweens.addCounter({from:0,to:t,duration:100,onUpdate:function(t){var n=e.score+Math.floor(t.getValue());e.setScoreText(n),e.scene.updateProgressTargetScore(n)},onComplete:function(){var n=e.score+t;e.setScore(n),e.setScoreText(n),e.scene.handleCompleteScoreMission()}})},n.reset=function(){this.setScore(0),this.setScoreText(0)},e}(Phaser.GameObjects.Container),rC=aC,sC=gs.default.GAMEPLAY,oC=sC.KEY,hC=sC.FRAME,cC=function(t){function e(e,n,i){var a;return(a=t.call(this,e)||this).scene=void 0,a.leftBg=void 0,a.midBg=void 0,a.rightBg=void 0,a.leftProgress=void 0,a.midProgress=void 0,a.rightProgress=void 0,a.iconCup=void 0,a.glareCup=void 0,a.tweenRotationGlareCup=void 0,a.targetScore=void 0,a.listPoolMilestoneFrame=[],a.listMilestoneFrame=[],a.particle=void 0,a.emitter=void 0,a.progressBarFull=void 0,a.setSize(n,i),a.scene=e,a.init(),a}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.initBg(),this.initProgressBar(),this.createParticle(),this.createEmitter(),this.createGlareCup(),this.createTweenGlare(),this.createIconCup()},n.initBg=function(){this.leftBg=this.scene.make.image({key:oC,frame:hC.PROGRESS_BG_LEFT}),this.midBg=this.scene.make.image({key:oC,frame:hC.PROGRESS_BG_MID}),this.rightBg=this.scene.make.image({key:oC,frame:hC.PROGRESS_BG_RIGHT});var t=this.leftBg,e=t.width,n=t.height,i=e*this.height/n;this.leftBg.setWorldSize(i,this.height);var a=this.rightBg,r=a.width,s=a.height,o=r*this.height/s;this.rightBg.setWorldSize(o,this.height);var h=this.width-(i+o);this.midBg.setWorldSize(h,this.height),this.add(this.leftBg),this.add(this.midBg),this.add(this.rightBg),Phaser.Display.Align.In.LeftCenter(this.leftBg,this,0,0),Phaser.Display.Align.In.Center(this.midBg,this,0,0),Phaser.Display.Align.In.RightCenter(this.rightBg,this,0,0)},n.initProgressBar=function(){this.leftProgress=this.scene.make.image({key:oC,frame:hC.PROGRESS_BAR_LEFT}),this.midProgress=this.scene.make.image({key:oC,frame:hC.PROGRESS_BAR_MID}),this.rightProgress=this.scene.make.image({key:oC,frame:hC.PROGRESS_BAR_RIGHT});var t=this.leftProgress,e=t.width,n=t.height,i=e*this.height/n;this.leftProgress.setWorldSize(i,this.height);var a=this.rightProgress,r=a.width,s=a.height,o=r*this.height/s;this.rightProgress.setWorldSize(o,this.height);var h=this.width-(i+o)+2;this.midProgress.setWorldSize(h,this.height),this.add(this.leftProgress),this.add(this.midProgress),this.add(this.rightProgress),this.leftProgress.setVisible(!1),this.rightProgress.setVisible(!1),this.midProgress.setVisible(!1),Phaser.Display.Align.In.LeftCenter(this.leftProgress,this,0,0),Phaser.Display.Align.In.Center(this.midProgress,this,0,0),Phaser.Display.Align.In.RightCenter(this.rightProgress,this,0,0)},n.createIconCup=function(){this.iconCup=this.scene.make.image({key:oC,frame:hC.ICON_CUP}),this.iconCup.setWorldSize(25,20),this.add(this.iconCup),Phaser.Display.Align.In.RightCenter(this.iconCup,this.glareCup,-9,1)},n.createGlareCup=function(){this.glareCup=this.scene.make.image({key:oC,frame:hC.CUP_GLARE}),this.glareCup.setWorldSize(44,44),this.glareCup.setVisible(!1),this.add(this.glareCup),Phaser.Display.Align.In.RightCenter(this.glareCup,this.rightBg,42,-3)},n.createTweenGlare=function(){this.tweenRotationGlareCup=new ml({targets:[this.glareCup],repeat:-1,duration:6e3})},n.createParticle=function(){this.particle=this.scene.add.particles(oC),this.add(this.particle)},n.createEmitter=function(){this.emitter=this.particle.createEmitter({x:0,y:0,scale:{min:.3,max:1},speed:{min:10,max:30},lifespan:{min:500,max:1e3},quantity:1,on:!1,frame:hC.DUST}),this.emitter.setPosition(this.scene.gameZone.width/2-10,-3)},n.createMilestoneFrame=function(){var t=this.scene.make.image({key:oC,frame:hC.FLAG});return t.setWorldSize(16,22),t},n.getMilestoneFrame=function(){var t,e=c()(t=this.listPoolMilestoneFrame).call(t,(function(t){return!t.visible}));if(!e||0===e.length){var n=this.createMilestoneFrame();return this.listPoolMilestoneFrame.push(n),this.add(n),n}return e[0]},n.handleSetAlphaListMilestone=function(t){this.listMilestoneFrame.forEach((function(e){e.score<=t?e.frame.setAlpha(1):e.frame.setAlpha(.5)}))},n.handleSetAlphaCup=function(t){t>=this.targetScore?this.iconCup.setAlpha(1):this.iconCup.setAlpha(.5)},n.runEmitter=function(){this.emitter.start()},n.stopEmitter=function(){this.emitter.stop()},n.runAnimGlare=function(){this.glareCup.setVisible(!0),this.tweenRotationGlareCup.play()},n.stopAnimGlare=function(){this.tweenRotationGlareCup.stop(),this.glareCup.setVisible(!1)},n.hideProgressBar=function(){this.leftProgress.setVisible(!1),this.rightProgress.setVisible(!1),this.midProgress.setVisible(!1)},n.hideMilestone=function(){this.listPoolMilestoneFrame.forEach((function(t){t.setVisible(!1)}))},n.resetListMilestone=function(){this.listMilestoneFrame=[]},n.reset=function(){this.hideMilestone(),this.hideProgressBar(),this.setPercent(0),this.resetListMilestone()},n.setTargetScore=function(t){this.targetScore=t},n.getTargetScore=function(){return this.targetScore},n.setPercent=function(t){var e=t*this.width,n=this.leftProgress.displayWidth,i=this.midProgress.displayWidth,a=this.rightProgress.displayWidth;if(t>=1){if(this.progressBarFull)return;return this.progressBarFull=!0,this.leftProgress.setVisible(!0),this.midProgress.setVisible(!0),this.rightProgress.setVisible(!0),this.leftProgress.setCrop(0,0,n/this.leftProgress.scaleX,2*this.height),this.midProgress.setCrop(0,0,i/this.midProgress.scaleX,2*this.height),this.rightProgress.setCrop(0,0,a/this.rightProgress.scaleX,2*this.height),this.runAnimGlare(),void this.runEmitter()}return this.stopAnimGlare(),this.stopEmitter(),this.progressBarFull=!1,e<n?(this.leftProgress.setVisible(!0),void this.leftProgress.setCrop(0,0,e/this.leftProgress.scaleX,2*this.height)):e>n+i?(this.leftProgress.setVisible(!0),this.midProgress.setVisible(!0),this.midProgress.setCrop(0,0,i/this.midProgress.scaleX,2*this.height),this.rightProgress.setVisible(!0),void this.rightProgress.setCrop(0,0,(e-(n+i-2))/this.rightProgress.scaleX,2*this.height)):(this.leftProgress.setVisible(!0),this.leftProgress.setCrop(0,0,n/this.leftProgress.scaleX,2*this.height),this.midProgress.setVisible(!0),void this.midProgress.setCrop(0,0,(e-n)/this.midProgress.scaleX,2*this.height))},e}(Phaser.GameObjects.Container),lC=gs.default.GAMEPLAY,uC=lC.KEY,dC=lC.FRAME,pC=function(t){function e(e){var n;return(n=t.call(this,e,uC,dC.BUTTON_WOOD_SMALL)||this).button.setWorldSize(55,48),n.setName("Setting"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:uC,frame:dC.ICON_SETTING});t.setWorldSize(30,30),this.add(t),Phaser.Display.Align.In.Center(t,this,1,-1.5)},e}(Ys.default),fC=pC,gC=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.buttonSetting=void 0,n.bestScoreBlock=void 0,n.mainScoreBlock=void 0,n.progressBar=void 0,n.collectItems=void 0,n.scene=e,n.setSize(n.scene.gameZone.width,0),e.add.existing((0,ls.default)(n)),n.createSettingButton(),n.createBestScoreBlock(),n.createMainScoreBlock(),n.createProgressBar(),n.createCollectItems(),n.createLeaf(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createLeaf=function(){var t=new tC(this.scene);this.add(t),Phaser.Display.Align.In.Center(t,this,0,t.displayHeight/2)},n.createBestScoreBlock=function(){this.bestScoreBlock=new Uw(this.scene),this.add(this.bestScoreBlock),Phaser.Display.Align.In.Center(this.bestScoreBlock,this,-132,-12.5)},n.createMainScoreBlock=function(){this.mainScoreBlock=new rC(this.scene),this.add(this.mainScoreBlock),Phaser.Display.Align.In.Center(this.mainScoreBlock,this,0,52)},n.createSettingButton=function(){this.buttonSetting=new fC(this.scene),this.add(this.buttonSetting),Phaser.Display.Align.In.Center(this.buttonSetting,this,132,51)},n.createProgressBar=function(){this.progressBar=new cC(this.scene,315,13),this.add(this.progressBar),Phaser.Display.Align.In.Center(this.progressBar,this,-19,92),this.progressBar.setVisible(!1)},n.createCollectItems=function(){this.collectItems=new qw(this.scene),this.add(this.collectItems),Phaser.Display.Align.In.Center(this.collectItems,this,0,52),this.collectItems.setVisible(!1)},n.getScore=function(){return this.mainScoreBlock.score},n.showItemSingleMode=function(){this.mainScoreBlock.setVisible(!0)},n.showItemPlayWithFriendsMode=function(){this.mainScoreBlock.setVisible(!1)},n.start=function(){switch(this.scene.targetMissionManager.getTargetType()){case Mw:this.targetScore();break;case Iw:this.targetCollect()}},n.targetScore=function(){var t=eb()(this.scene.targetMissionManager.getTargetValue()),e=this.scene.storage.getState(),n=du(e)||0;(0,Gv.isArray)(t)||(this.progressBar.reset(),this.progressBar.setVisible(!0),this.progressBar.setTargetScore(t),this.progressBar.setPercent(n/t),this.scene.header.mainScoreBlock.reset(),this.scene.header.mainScoreBlock.setVisible(!0),this.scene.header.mainScoreBlock.setScore(n),this.scene.header.mainScoreBlock.setScoreText(n),this.collectItems.setVisible(!1))},n.targetCollect=function(){this.collectItems.reset(),this.mainScoreBlock.setVisible(!1),this.progressBar.setVisible(!1);var t=this.scene.targetMissionManager.getTargetValue();this.collectItems.setTargets(t),this.collectItems.setVisible(!0),this.collectItems.start()},e}(Phaser.GameObjects.Container),mC=gC,vC=gs.default.GAMEPLAY_32,yC=vC.KEY,SC=vC.FRAME,AC=GameCore.Configs.Board,EC=AC.cols,xC=AC.rows,bC=function(t){function e(n,i,a){var r;return(r=t.call(this,n)||this).scene=void 0,r.type=void 0,r.direction=void 0,r.isReverse=!1,r.data=[],r.matrixData=void 0,r.texture=void 0,r.frame=void 0,r.maxHeight=void 0,r.cellItems=[],r.originalData=void 0,r.isSetDrag=!1,r.isCreateCell=!1,r.wrap=void 0,r.wrapPiece=void 0,r.isDragEnd=!1,r.isActive=!0,r.isVisible=!0,r.pointerY=void 0,r.parentHeight=void 0,r.index=void 0,r.props=void 0,r.cells=[],r.parent=void 0,r.moveTopNumber=30,r.backupPx=void 0,r.backupPy=void 0,r.animMoveTopAndScaleUp=void 0,r.animMoveDownAndScaleDown=void 0,r.animScaleUp=void 0,r.animScaleDown=void 0,r.distancePY=void 0,r.isCanMove=void 0,r.correctAlpha=1,r.props=a,r.type=a.type,r.matrixData=a.matrixData,r.data=e.buildData(r.matrixData),r.direction=a.direction||null,r.parentHeight=a.parentHeight||0,r.isReverse=a.isReverse||!1,r.parent=i,r.scene=n,r.scene.add.existing((0,ls.default)(r)),r.createWrapPiece(),r.listenEvents(),r}(0,Kt.default)(e,t);var n=e.prototype;return n.createWrapPiece=function(){var t=this.scene.gameZone.width/3;this.wrapPiece=this.scene.make.image({key:yC,frame:SC.GEM_TRANSPARENT}),this.wrapPiece.setWorldSize(t,t)},n.updatePosition=function(t,e){var n=this.getContainerSize(),i=n.width,a=n.height,r=this.parent.cellSize,s=this.scene.gameZone.width;this.setPosition(t+s/6-i/2+r/2,e-a/2+r/2),this.backupPx=this.x,this.backupPy=this.y},n.updatePositionWrapPiece=function(t,e){this.wrapPiece.setPosition(t+this.wrapPiece.displayWidth/2,e-20)},n.listenEvents=function(){var t=this;this.setInteractiveContainer(),this.wrapPiece.on(Phaser.Input.Events.POINTER_DOWN,(function(){t.parent.playTweenToEnableMaxFps()})),this.wrapPiece.on(Phaser.Input.Events.DRAG_START,(function(e){t.handleDragStart(e)})),this.wrapPiece.on(Phaser.Input.Events.DRAG,(function(e){t.handleDrag(e)})),this.wrapPiece.on(Phaser.Input.Events.DRAG_END,(function(){t.handleDragEnd(),t.parent.stopTweenToEnableMaxFps()}))},n.setIndex=function(t){this.index=t},n.updateDataPiece=function(t){this.data=t},n.setInteractiveContainer=function(){var t=this.scene.gameZone.width/3;this.wrapPiece.setInteractive().input.hitArea.setTo(0,0,t/this.wrapPiece.scale,180/this.wrapPiece.scale),this.scene.input.setDraggable(this.wrapPiece)},n.handleDragStart=function(t){var e,n,i=this;if(!this.scene.isGameOver&&!this.scene.isLevelComplete&&this.isCanMove){if(this.scene.tutorialManager.isRunning()){if(!this.scene.tutorialManager.validStep(this.index))return;this.scene.tutorialManager.stopAnimHand()}null==(e=this.animScaleUp)||e.stop(),null==(n=this.animScaleDown)||n.stop(),this.setAlpha(this.correctAlpha).setScale(1).setPosition(this.x,this.y),this.isDragEnd=!1,this.isSetDrag=!0,this.setDepth(zs.default.PIECE+1),this.animMoveDownAndScaleDown&&this.animMoveDownAndScaleDown.isPlaying()&&(this.animMoveDownAndScaleDown.stop(),this.setScale(1)),this.scene.audio.playSound(Vs.default.PIECE_PICK);var a=this.scene.main.board.cellSize/this.parent.cellSize,r=this.getContainerSize(),s=r.width,o=r.height,h=t.worldX+this.parent.cellSize*a/2-s*a/2,c=0;if(Yp())c=t.worldY+this.parent.cellSize*a/2-o*a;else{var l=this.scene.gameZone.height/2+this.scene.main.board.width/2-2*this.parent.cellSize+this.moveTopNumber,u=this.y+o*a-l+o;u=this.scene.gameZone.width/this.scene.gameZone.height>=375/619?44+o*a:53+o*a,c=t.worldY-u}this.distancePY=t.worldY-c;var d=41*this.scene.main.board.cellPadding/100;this.updateCellsWithPadding(d),this.animMoveTopAndScaleUp=this.scene.tweens.add({x:h,y:c,scale:a,duration:150,targets:this,ease:"Sine.easeInOut",delay:20,onComplete:function(){if(!i.isDragEnd){i.setPosition(h,c);var t=i.getCellsHighlight();i.scene.main.board.handleRemoveHighlight(),i.scene.main.board.handleHighlight(t,i.highlightCellCanCapture.bind(i))}}}),this.drawSuggestCells()}},n.handleDrag=function(t){if(!this.scene.isGameOver&&!this.scene.isLevelComplete&&this.isCanMove&&this.isSetDrag)try{if(this.animMoveTopAndScaleUp&&this.animMoveTopAndScaleUp.isPlaying()){var e=this.scene.main.board.cellSize/this.parent.cellSize;this.animMoveTopAndScaleUp.complete(),this.animMoveTopAndScaleUp.stop(),this.setScale(e)}this.resetCellItems(),this.scene.game.updateFps(Up.default.max);var n=this.getContainerSize().width,i=t.worldX+this.parent.cellSize*this.scale/2-n/2,a=t.worldY-this.distancePY;this.setPosition(i,a),this.canMove();var r=this.getCellsHighlight();this.scene.main.board.handleRemoveHighlight(),this.scene.main.board.handleHighlight(r,this.highlightCellCanCapture.bind(this))}catch(s){this.handleDragPieceInvalidMove()}},n.highlightCellCanCapture=function(t,e,n,i){for(var a=this,r=EC,s=xC,o=[],h=0;h<i.length;h++){var l=i[h],u=l.x,d=l.y;r>u&&(r=u),s>d&&(s=d)}for(var p=function(e){var n=t[e],r=c()(i).call(i,(function(t){return t.y===n}));if(!r||0===r.length)return"continue";for(var s=0;s<r.length;s++){var h=r[s];a.checkItemInArray(o,h)||o.push(h)}},f=0;f<t.length;f++)p(f);for(var g=function(t){var n=e[t],r=c()(i).call(i,(function(t){return t.x===n}));if(!r||0===r.length)return"continue";for(var s=0;s<r.length;s++){var h=r[s];a.checkItemInArray(o,h)||o.push(h)}},m=0;m<e.length;m++)g(m);for(var v=function(t){var e=n[t],r=c()(i).call(i,(function(t){return t.x===e.x&&t.y===e.y}));if(!r||0===r.length)return"continue";var s=r[0];a.checkItemInArray(o,s)||o.push(s)},y=0;y<n.length;y++)v(y);for(var S=function(t){var e,n=o[t],i=n.x,h=n.y,l=c()(e=a.cellItems).call(e,(function(t){return t.x===i-r&&t.y===h-s}));if(!l||0===l.length)return"continue";var u=a.getFrameLight(l[0].cell.frame.name);l[0].cell.setFrame(u)},A=0;A<o.length;A++)S(A)},n.getFrameLight=function(t){var e=t;switch(t){case SC.GEM:e=SC.GEM_LIGHT;break;case SC.GEM_DIAMOND_10:e=SC.GEM_DIAMOND_10_LIGHT;break;case SC.GEM_DIAMOND_11:e=SC.GEM_DIAMOND_11_LIGHT;break;case SC.GEM_DIAMOND_12:e=SC.GEM_DIAMOND_12_LIGHT;break;case SC.GEM_DIAMOND_13:e=SC.GEM_DIAMOND_13_LIGHT;break;case SC.GEM_DIAMOND_14:e=SC.GEM_DIAMOND_14_LIGHT;break;case SC.GEM_DIAMOND_15:e=SC.GEM_DIAMOND_15_LIGHT}return e},n.resetCellItems=function(){for(var t=0;t<this.cellItems.length;t++){var e=this.cellItems[t].cell.frame.name.replace("_light","");this.cellItems[t].cell.setFrame(e)}},n.checkItemInArray=function(t,e){var n=c()(t).call(t,(function(t){return t.x===e.x&&t.y===e.y}));return!(!n||0===n.length)},n.handleDragPieceInvalidMove=function(){this.scene.main.board.handleRemoveHighlight(),this.scene.main.board.removeAllCanCaptureCells()},n.handleDragEnd=function(){if(!this.isDragEnd&&this.isSetDrag&&this.isCanMove&&(this.isDragEnd=!0,this.isSetDrag=!1,this.setDepth(zs.default.PIECE),this.scene.main.board.handleRemoveSuggestMove(),this.scene.main.board.removeAllCanCaptureCells(),!this.scene.isGameOver&&!this.scene.isLevelComplete)){this.resetCellItems();try{this.canMove(),this.scene.audio.playSound(Vs.default.PIECE_DROP),this.handleBoardMoveCompleted(),this.scene.updateMatchData(),this.wrapPiece.disableInteractive()}catch(t){this.handleInvalidMove()}}},n.cancelDrag=function(){!this.isDragEnd&&this.isSetDrag&&(this.isDragEnd=!0,this.isSetDrag=!1,this.setDepth(zs.default.PIECE),this.scene.main.board.handleRemoveSuggestMove(),this.scene.main.board.removeAllCanCaptureCells(),this.resetCellItems(),this.scene.main.board.handleRemoveHighlight(),this.handleInvalidMove())},n.calculatePY=function(t,e){return 15==t?this.parent.cellSize*e*-2:30==t?0:45==t?this.parent.cellSize*e*2:60==t?this.parent.cellSize*e*4:75==t?this.parent.cellSize*e*6:t},n.handleBoardMoveCompleted=function(){var t=this,e=this.getPositionTopLeftInBoard();if(e){if(this.scene.targetMissionManager.getTargetType()===Mw){var n=this.calcScore();this.scene.handleUpdateScore(n||0),this.scene.handleAddScoreAnim(n||0)}var i=e.x,a=e.y,r=this.scene.main.board.dataBoard[a][i],s=r.x+this.scene.main.board.cellPadding,o=r.y+this.scene.main.board.cellPadding,h=this.getCellsHighlight();this.scene.add.tween({targets:this,x:s,y:o,duration:50,onComplete:function(){t.updateCellsWithPadding(.5),t.scene.main.board.handleRemoveHighlight(),t.hide(),t.setScale(1),t.parent.removeActivePiece(t.index),t.scene.main.board.handleMove(h,t.onBoardHandleMoveCompleted.bind(t))}})}else this.scene.main.board.handleRemoveHighlight()},n.calcScore=function(){var t;if(!this.matrixData)return 0;var e=this.matrixData.length||0;if(0===e)return 0;for(var n=(null==(t=this.matrixData[0])?void 0:t.length)||0,i=0,a=0;a<e;a++)for(var r=0;r<n;r++)1===this.matrixData[a][r]&&i++;return i},n.hide=function(){this.setVisible(!1),this.wrapPiece.setVisible(!1)},n.show=function(){this.setVisible(!0),this.wrapPiece.setVisible(!0)},n.playAnimShow=function(){this.setAlpha(0).setScale(0),this.show(),this.animScaleUp.play()},n.onBoardHandleMoveCompleted=function(){this.parent.setActivePieces(),this.parent.existPiecesActive()||this.parent.showNewPieces(),this.scene.tutorialManager.isRunning()&&this.scene.tutorialManager.nextStep()},n.drawSuggestCells=function(){var t=function(t,e){for(var n=t.length,i=t[0].length,a=0,r=0,s=0,o=0;o<n;o++)for(var h=0;h<i;h++)if(GS(t,h,o,e)&&(r=h,s=o,++a>1))return null;if(0===a)return null;for(var c=[],l=0;l<e.data.length;l++)for(var u=0;u<e.data[l].length;u++)e.data[l][u].texture&&c.push({x:r+u,y:s+l});return c&&c.length>0?c:null}(this.scene.main.board.dataBoard,{data:this.data});t&&this.scene.main.board.handleSuggestMove(t)},n.getPositionFirstCellHighlight=function(){var t=this.scene.main.board.dataBoard,e=this.getPositionTopLeftInBoard();if(!e)return{x:0,y:0};var n=e.x,i=e.y;return e?{x:t[i][n].x,y:-(this.scene.scale.height-this.parentHeight-t[i][n].y)}:{x:0,y:0}},n.handleInvalidMove=function(){var t=this;this.scene.audio.playSound(Vs.default.PIECE_INVALID_MOVE),this.scene.main.board.handleRemoveHighlight(),this.animMoveDownAndScaleDown=this.scene.tweens.add({x:this.backupPx,y:this.backupPy,scaleX:1,scaleY:1,duration:300,targets:this,ease:"Sine.easeInOut",delay:20,onComplete:function(){t.updateCellsWithPadding(.5)}}),this.scene.tutorialManager.isRunning()&&this.scene.tutorialManager.handleStep()},n.canMove=function(){var t=this.scene.main.board.dataBoard,e=this.getCellsHighlight();if(0===e.length)throw new Error("Invalid Move");for(var n=!0,i=0;i<e.length;i++){var a=e[i],r=a.x,s=a.y;if(!t[s]||!t[s][r]||0!==t[s][r].value){n=!1;break}}if(!n||0===e.length)throw new Error("Invalid Move");return n},n.getCellsHighlight=function(){var t=this.scene.main.board.dataBoard,e=[],n=this.getPositionTopLeftInBoard();if(null===n)return e;if(this.scene.tutorialManager.isRunning()&&!this.scene.tutorialManager.validTargetPosition(n))return e;for(var i=0;i<this.data.length;i++)for(var a=0;a<this.data[i].length;a++)if(this.data[i][a].texture){var r=a+n.x,s=i+n.y,o=t[s]&&t[s][r]?t[s][r].x:0,h=t[s]&&t[s][r]?t[s][r].y:0;if(s>=xC||r>=EC||!t[s][r]||1===t[s][r].value)return[];e.push({x:r,y:s,pX:o,pY:h,frame:this.data[i][a].texture})}return e},n.getPositionTopLeftInBoard=function(){for(var t=this.scene.main.board.dataBoard,e=this.x+this.parent.cellSize*this.scale/2,n=this.y+this.parent.cellSize*this.scale/2,i=this.scene.main.board.cellPadding,a=-1,r=-1,s=0;s<xC;s++)for(var o=0;o<EC;o++)if(t[s][o].x-i/2<=e&&t[s][o].x+t[s][o].width+i/2>=e&&t[s][o].y-i/2<=n&&t[s][o].y+t[s][o].height+i/2>=n){a=o,r=s;break}return a<0||a>EC-1||r<0||r>xC-1?null:{x:a,y:r}},e.buildData=function(t){for(var e=[],n=0;n<t.length;n++){e[n]=[];for(var i=0;i<t[n].length;i++){var a=1===t[n][i]?SC.GEM:null;e[n][i]={x:i,y:n,texture:a}}}return e},n.getPaddingCell=function(){return this.height/this.data.length/40},n.drawPiece=function(){return this.isCreateCell?this.updateCells():this.createCells(.5),this.createAnimShow(),this.playAnimShow(),this.wrapPiece.setInteractive(),this},n.createAnimShow=function(){var t=this,e=140*this.index;this.animScaleUp=this.scene.tweens.add({delay:e,paused:!0,duration:163,targets:this,alpha:{from:0,to:this.alpha},scale:{from:0,to:1.2},ease:Phaser.Math.Easing.Linear,onComplete:function(){t.animScaleDown.play()}}),this.animScaleDown=this.scene.tweens.add({delay:83,paused:!0,duration:150,targets:this,scale:1,ease:Phaser.Math.Easing.Linear})},n.createCells=function(t){for(var e=this.parent.cellSize,n=0;n<this.data.length;n++){this.cells[n]=[];for(var i=0;i<this.data[n].length;i++)if(this.data[n][i].texture&&"x"!==this.data[n][i].texture){var a={x:0+i*e+t,y:0+n*e+t,width:e-2*t,height:e-2*t},r=new ow(this.scene,a);r.setFrame(this.data[n][i].texture),r.setVisible(!0),this.cells[n][i]=r,this.cellItems.push({x:i,y:n,cell:r}),this.add(r)}}this.isCreateCell=!0},n.updateCells=function(){for(var t=0;t<this.data.length;t++)for(var e=0;e<this.data[t].length;e++)if(this.data[t][e].texture&&"x"!==this.data[t][e].texture){var n=this.cells[t][e];n.setFrame(this.data[t][e].texture),n.setVisible(!0),this.cells[t][e]=n}},n.updateCellsWithPadding=function(t){for(var e=this.parent.cellSize,n=e-2*t,i=e-2*t,a=0;a<this.data.length;a++)for(var r=0;r<this.data[a].length;r++)if(this.data[a][r].texture){var s=this.cells[a][r],o=r*e+t,h=a*e+t;s.setWorldSize(n,i),s.setPosition(o,h)}},n.getContainerSize=function(){for(var t=0,e=this.data.length,n=0;n<this.data.length;n++)this.data[n].length>t&&(t=this.data[n].length);var i=this.parent.cellSize;return{width:t*i*this.scale,height:e*i*this.scale}},n.setCanMove=function(t){this.isCanMove=t,this.correctAlpha=t?1:.4,this.setAlpha(this.correctAlpha)},n.reset=function(){this.setVisible(!1),this.setScale(1),this.wrapPiece.disableInteractive(),this.data=e.buildData(this.matrixData)},n.getScore=function(){if(!this.matrixData)return 0;for(var t=0,e=0;e<this.matrixData.length;e++)for(var n=0;n<this.matrixData[0].length;n++)1===this.matrixData[e][n]&&t++;return t},e}(Phaser.GameObjects.Container),TC=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.type,a.direction,a.isReverse)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t,e,n){void 0===n&&(n=!1);var i=[];switch(e){case zv:n?i=Yy:(i=Vy,t===cy&&(i=zy),t===ly&&(i=Hy));break;case Hv:n?i=Dy:(i=_y,t===cy&&(i=Ly),t===ly&&(i=By));break;case Wv:if(n){i=ky;break}i=Py,t===cy&&(i=Ry),t===ly&&(i=Oy);break;case Xv:n?i=Ny:(i=Fy,t===cy&&(i=Gy),t===ly&&(i=Uy))}return i},e.getData=function(t,n,i){return void 0===i&&(i=!1),e.buildData(e.getMatrixData(t,n,i))},e}(bC),wC=TC,CC=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.type,a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t,e){var n=[];switch(t){case fy:n=e===Vv?Jy:Qy;break;case py:n=e===Vv?qy:Zy;break;case uy:n=e===Vv?Wy:Xy;break;case dy:n=e===Vv?Ky:jy}return n},e.getData=function(t,n){return e.buildData(e.getMatrixData(t,n))},e}(bC),MC=CC,IC=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.type)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){case gy:e=$y;break;case my:e=tS;break;case vy:e=eS}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(bC),PC=IC,kC=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){default:e=sS;break;case Hv:e=oS;break;case Wv:e=hS;break;case Xv:e=cS}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(bC),RC=kC,OC=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){default:e=nS;break;case jv:e=iS;break;case Zv:e=rS;break;case qv:e=aS}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(bC),_C=OC,DC=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){default:e=lS;break;case Hv:e=uS;break;case Wv:e=dS;break;case Xv:e=pS}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(bC),LC=DC,BC=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData()}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(){return fS},e.getData=function(){return e.buildData(e.getMatrixData())},e}(bC),FC=BC,NC=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.type,a.direction)}))||this}return(0,Kt.default)(e,t),e.getDataByDirectionCross2=function(t){var e=[];if(t===Hv)e=mS;else e=gS;return e},e.getDataByDirectionCross3=function(t){var e=[];if(t===Hv)e=yS;else e=vS;return e},e.getDataByDirectionCross4=function(t){var e=[];if(t===Hv)e=AS;else e=SS;return e},e.getDataByDirectionCross5=function(t){var e=[];if(t===Hv)e=xS;else e=ES;return e},e.getMatrixData=function(t,n){var i=[];switch(t){case xy:i=e.getDataByDirectionCross2(n);break;case by:i=e.getDataByDirectionCross3(n);break;case Ty:i=e.getDataByDirectionCross4(n);break;case wy:i=e.getDataByDirectionCross5(n)}return i},e.getData=function(t,n){return e.buildData(e.getMatrixData(t,n))},e}(bC),GC=NC,UC=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){default:e=bS;break;case Hv:e=TS;break;case Wv:e=wS;break;case Xv:e=CS}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(bC),VC=UC,YC=function(){function t(){}return t.create=function(t,e,n){var i;switch(n.type){case hy:case cy:case ly:i=new wC(t,e,n);break;case uy:case dy:case py:case fy:i=new MC(t,e,n);break;default:i=new PC(t,e,n);break;case Sy:i=new RC(t,e,n);break;case Ay:i=new LC(t,e,n);break;case Cy:i=new VC(t,e,n);break;case Ey:i=new FC(t,e,n);break;case xy:case by:case Ty:case wy:i=new GC(t,e,n);break;case yy:i=new _C(t,e,n)}return i},t}(),zC=YC,HC=gs.default.GAMEPLAY_32,WC=HC.KEY,XC=HC.FRAME,KC=zt.Configs,jC=KC.Gameplay,qC=KC.Match,ZC=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.tweenToEnableMaxFps=void 0,n.cellSize=void 0,n.canCaptureLines=void 0,n.allPieces=[],n.allPiecesGroup=[],n.piecesActive=[],n.listPieceMap=[],n.amountPieceContainGem=0,n.hasPieceContainGem=void 0,n.segmentAmountPiece1Min=0,n.segmentAmountPiece1Max=0,n.segmentAmountPiece1Cur=0,n.segmentAmountPiece5Min=0,n.segmentAmountPiece5Max=0,n.segmentAmountPiece5Cur=0,n.segmentAvgScore=0,n.segmentTotalPieceScore=0,n.segmentTotalPiece=0,n.segmentTotalScore=0,n.segmentPieceDistancePerGem=0,n.segmentPieceRandomGem=!1,e.add.existing((0,ls.default)(n)),n.scene=e,n.canCaptureLines={isCapture:!1,direction:"",minLine:5},n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.initCellSize(),this.createAllPieces(),this.createAllPiecesGroup(),this.createTweenToEnableMaxFps(),this.addDebuggerBtnRandomPieces()},n.initCellSize=function(){this.cellSize=41*this.scene.main.board.cellSize/100},n.setContentPosition=function(t,e){this.setPosition(t,e)},n.createTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps=this.scene.add.tween({targets:[],duration:300,loop:-1,paused:!0})},n.playTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps.play()},n.stopTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps.stop()},n.getDirectionsByType=function(t){if([gy,my,vy].some((function(e){return e===t})))return[];var e=[];switch(t){case hy:case cy:case ly:case Sy:case Ay:case Cy:e=[Wv,zv,Hv,Xv];break;case uy:case dy:case py:case fy:e=[Vv,Yv];break;case yy:e=[Kv,jv,qv,Zv];break;case Ey:e=[];break;case xy:case by:case Ty:case wy:e=[zv,Hv]}return e},n.createAllPieces=function(){for(var t=this.cellSize,e=[],n=0;n<My.length;n++){var i=this.getDirectionsByType(My[n]);if(i.length<=0)e.push({type:My[n]});else{for(var a=0;a<i.length;a++)e.push({type:My[n],direction:i[a]});if(hy===My[n])for(var r=0;r<i.length;r++)e.push({type:My[n],direction:i[r],isReverse:!0})}}for(var s=0;s<e.length;s++){var o=(0,wt.default)({},e[s],{texture:WC,frame:XC.GEM,x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(t/2),height:Math.floor(t/2),cellLength:Math.floor(t/2),parentHeight:this.height,wrap:{x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(t/2),height:Math.floor(t/2)}}),h=zC.create(this.scene,this,o);h.hide(),this.allPieces.push({piece:h,isUsed:!1})}},n.createAllPiecesGroup=function(){for(var t=0;t<this.allPieces.length;t++){var e=this.allPieces[t].piece;this.allPiecesGroup[e.type]||(this.allPiecesGroup[e.type]=[]),this.allPiecesGroup[e.type].push(t)}},n.randomPieces=function(){var t=this;this.scene.game.updateFps(Up.default.max);for(var e=this.buildPieceRates(!1),n=[],i=function(){var i=Math.floor(Math.random()*e.length),a=e[i];if(!t.allPiecesGroup[a])return"continue";var r=Math.floor(Math.random()*t.allPiecesGroup[a].length),s=t.allPiecesGroup[a][r],o=[py,fy].some((function(t){return t===a}));if(t.canCaptureLines.isCapture&&o){for(var h=0;h<t.allPiecesGroup[a].length;h++){var c=t.allPiecesGroup[a][h],l=t.allPieces[c].piece;if(l&&l.direction===t.canCaptureLines.direction){s=c;break}}e=t.buildPieceRates(!1)}n.some((function(t){return t.index===s}))||n.push({index:s,type:a})};n.length<3;)i();for(var a=[],r=0;r<n.length;r++){var s=n[r].index,o=this.allPieces[s].piece;a.push({position:s,texture:WC,frame:XC.GEM,type:o.type,direction:o.direction,isReverse:o.isReverse})}this.piecesActive=a},n.buildPieceRates=function(t){void 0===t&&(t=!0);for(var e=[],n=0;n<Iy.length;n++)e.push((0,wt.default)({},Iy[n]));if(t){var i=this.scene.main.board.dataBoard,a=5;if(this.canCaptureLines=this.scene.main.board.canCaptureLines(i,a),this.canCaptureLines.isCapture)for(var r=0;r<e.length;r++)e[r].type===fy&&(e[r].rate=8);else if(a=4,this.canCaptureLines=this.scene.main.board.canCaptureLines(i,a),this.canCaptureLines.isCapture)for(var s=0;s<e.length;s++)e[s].type===py&&(e[s].rate=8)}for(var o=[],h=0;h<e.length;h++)for(var c=e[h],l=c.type,u=c.rate,d=0;d<u;d++)o.push(l);return o},n.drawPieces=function(){for(var t=this.scene.gameZone,e=t.width,n=t.height,i=[20,e/3,2*e/3-20],a=n/2+176-13,r=a+(n-85-a)/2,s=0;s<this.piecesActive.length;s++){var o=this.piecesActive[s],h=o.position,c=o.fenPiece,l=this.allPieces[h].piece,u=i[s];if(c){var d=this.convertFenPiecesToData(c);d&&l.updateDataPiece(d)}else{if(0===this.listPieceMap.length)if(this.isPieceContainGem()){var p=this.getRandomPieceData(l.data);p&&l.updateDataPiece(p)}}l.updatePosition(u,r),l.updatePositionWrapPiece(u+20*(s-1),r),l.setIndex(s),l.drawPiece(),this.allPieces[h]={piece:l,isUsed:!0}}},n.isPieceContainGem=function(){if(1===Phaser.Math.Between(0,1)&&!this.hasPieceContainGem)return this.amountPieceContainGem++,this.hasPieceContainGem=!0,!0;if(this.amountPieceContainGem<jC.RatePieceContainGem)return this.amountPieceContainGem++,!1;if(this.amountPieceContainGem>=jC.RatePieceContainGem){var t=this.hasPieceContainGem;return this.amountPieceContainGem=0,this.hasPieceContainGem=!1,!t}return!1},n.convertFenPiecesToData=function(t){if(!t)return null;var e=t.split("/");if(0===e.length)return null;for(var n=[],i=0;i<e.length;i++){var a=e[i].split(",");n[i]=[];for(var r=0;r<a.length;r++){var s=HS(a[r]);"null"!==a[r]&&"x"!==a[r]||(s=null),n[i].push({x:i,y:r,texture:s})}}return n},n.getRandomPieceData=function(t){var e=this.scene.header.collectItems.getTargetKeys();if(!e||0===e.length)return null;for(var n=0,i=t.length,a=t[0].length,r=0;r<i;r++)for(var s=0;s<a;s++)if(t[r][s].texture&&Phaser.Math.Between(0,1)){var o=XC.GEM;if(n<jC.MaxGemInPiece)o=e[Phaser.Math.Between(0,e.length-1)];t[r][s]={x:r,y:s,texture:o},n++}return t},n.removeActivePiece=function(t){this.piecesActive[t].used=!0},n.existPiecesActive=function(){var t,e=c()(t=this.piecesActive).call(t,(function(t){return!t.used}));return e&&e.length>0},n.showNewPieces=function(){this.resetAllPieces(),this.listPieceMap.length>0?this.showListPieceMap():(this.randomPieces(),this.setActivePieces(),this.drawPieces())},n.setActivePieces=function(){for(var t=this.scene.main.board.dataBoard,e=0;e<this.piecesActive.length;e++){var n=this.piecesActive[e].position,i=this.allPieces[n].piece,a=US(t,i);i.setCanMove(a)}},n.getPiecesByFen=function(t){var e=[],n=t.split(" ");if(n.length<2)throw new Error("Invalid fen");for(var i=ds()(n).call(n,2),a=0;a<i.length;a++){var r,s;if("l"!==$p()(r=i[a]).call(r)){var o=XS($p()(s=i[a]).call(s));e.push(o)}}return e},n.getFenByPieces=function(){for(var t="l",e=0;e<this.piecesActive.length;e++){var n=this.piecesActive[e],i=n.type,a=n.direction,r=n.isReverse,s=n.used,o=n.position;if(!s){var h=zS(i);a&&""!==a&&(h+="-"+zS(a)),r&&(h+="-r");var c=this.allPieces[o].piece;t+=" "+h+"|"+this.getFenDataPiece(c)}}return t},n.getFenDataPiece=function(t){for(var e=t.data,n=e.length,i=e[0].length,a="",r=0;r<n;r++){for(var s="",o=0;o<i;o++)s+=","+zS(e[r][o].texture);a+="/"+s.substring(1)}return a.substring(1)},n.clearPieces=function(){for(var t=0;t<this.piecesActive.length;t++){var e=this.piecesActive[t].position;this.allPieces[e].isUsed=!1,this.allPieces[e].piece.hide()}this.piecesActive=[],this.listPieceMap=[]},n.resetAllPieces=function(){for(var t=0;t<this.allPieces.length;t++)this.allPieces[t].isUsed=!1,this.allPieces[t].piece.reset()},n.showAvailablePieces=function(t){if(t&&!(t.length<=0)){this.resetAllPieces();for(var e=[],n=0;n<t.length;n++){for(var i=t[n],a=i.type,r=i.direction,s=i.isReverse,o=i.frame,h=!1,c=0;c<this.allPieces.length;c++){var l=this.allPieces[c],u=l.piece,d=l.isUsed;if(a===u.type&&r===u.direction&&s===u.isReverse){if(d){h=!0;continue}h=!1,e.push({position:c,texture:WC,frame:o,type:u.type,direction:u.direction,isReverse:u.isReverse,fenPiece:t[n].fenPiece}),this.allPieces[c].isUsed=!0;break}}if(h){var p=this.spawnPiece(a,r,s),f=p.piece,g=p.index;e.push({position:g,texture:WC,frame:o,type:f.type,direction:f.direction,isReverse:f.isReverse,fenPiece:t[n].fenPiece})}}this.piecesActive=e,this.setActivePieces(),this.drawPieces()}},n.spawnPiece=function(t,e,n){var i=this.cellSize,a={type:t,direction:e,isReverse:n,texture:WC,frame:XC.GEM,x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(i/2),height:Math.floor(i/2),cellLength:Math.floor(i/2),parentHeight:this.height,wrap:{x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(i/2),height:Math.floor(i/2)}},r=zC.create(this.scene,this,a);return r.hide(),this.allPieces.push({piece:r,isUsed:!0}),{piece:r,index:this.allPieces.length-1}},n.showListPieceMap=function(){var t;if(this.piecesActive=ds()(t=this.listPieceMap).call(t,0,3),this.showAvailablePieces(this.piecesActive),this.scene.footer.textExist){var e=this.listPieceMap.length<=0?"Done":"Exits";this.scene.footer.textExist.setText(e)}},n.validItemsPieceMap=function(t){for(var e,n=!0,i=et()(e=[]).call(e,t),a=function(){var t=i.shift(),e=c()(i).call(i,(function(e){return e.type===(null==t?void 0:t.type)&&e.direction===t.direction&&e.isReverse===t.isReverse}));e&&e.length>0&&(n=!1)};i.length>1;)a();return n},n.getPieceDataByType=function(t){return IS[t]},n.addItemPieceMap=function(t){if(t.properties){var e=this.getFenPieceForPropertiesPieceMap(t);e&&(t=(0,wt.default)({},t,{fenPiece:e}))}this.listPieceMap.push(t)},n.getFenPieceForPropertiesPieceMap=function(t){var e,n;if(!t.properties)return"";var i="",a=null==(e=c()(n=this.allPieces).call(n,(function(e){var n=e.piece;return n.direction===t.direction&&n.isReverse===t.isReverse&&n.type===t.type}))[0])?void 0:e.piece,r=t.properties[0].value.split(","),s=t.properties[1].value.split(","),o=0;if(!a)return i;for(var h=a.data,l=h.length,u=h[0].length,d=0;d<l;d++){for(var p="",f=0;f<u;f++){var m=h[d][f].texture,v=m,y=g()(s).call(s,String(o));m&&(-1!==y&&(v=MS[r[y]]),o++);var S=null;v&&(S=zS(v)),p+=","+S}i+="/"+p.substring(1)}return i.substring(1)},n.start=function(){0!==this.listPieceMap.length?this.showListPieceMap():this.showNewPieces()},n.getListPieceMap=function(){return this.listPieceMap},n.setListPieceMap=function(t){var e;this.listPieceMap=et()(e=[]).call(e,t)},n.buildPiecesByMap=function(){var t=this.scene.mapManager.getTileMap().layers[0].properties;if(t&&!(t.length<=0))for(var e=0;e<t.length;e++){var n=t[e].value;if(n){var i=n.avgScore,a=n.score,r=n.pieceDistancePerGem,s=n.piece1,o=n.piece5;s=s.replace("min",'"min"').replace("max",'"max"'),o=o.replace("min",'"min"').replace("max",'"max"');var h=JSON.parse(s),c=JSON.parse(o);this.segmentAvgScore=i,this.segmentAmountPiece1Min=h.min,this.segmentAmountPiece1Max=h.max,this.segmentAmountPiece5Min=c.min,this.segmentAmountPiece5Max=c.max,this.segmentTotalScore=a,this.segmentPieceDistancePerGem=r,this.segmentTotalPieceScore=0,this.segmentTotalPiece=0,this.listPieceMap=[],this.buildObjectPieces()}}},n.buildObjectPieces=function(){for(;this.checkAverageScore();)this.buildObjectPiece()},n.checkAverageScore=function(){return 0===this.segmentTotalPiece||0===this.segmentTotalPieceScore||!(this.segmentTotalPiece>qC.PieceRandoms.maxPiece)&&!(this.segmentTotalPieceScore/this.segmentTotalPiece<=this.segmentAvgScore+qC.PieceRandoms.measureError&&this.segmentTotalPieceScore/this.segmentTotalPiece>=this.segmentAvgScore-qC.PieceRandoms.measureError&&this.segmentTotalPieceScore>=this.segmentTotalScore)},n.buildObjectPiece=function(){var t=this.getPieceByAvgScore();if(t)if(this.checkPieceMaxAmountConfig(t)){var e="";if(Math.floor((this.segmentTotalPiece-1)/3)%this.segmentPieceDistancePerGem===0){if(Phaser.Math.Between(0,1)&&!this.segmentPieceRandomGem||!this.segmentPieceRandomGem&&this.segmentTotalPiece%3===2){var n=this.getRandomPieceData(t.data);n&&(t.updateDataPiece(n),e=this.getFenDataPiece(t)),this.segmentPieceRandomGem=!0}}else this.segmentPieceRandomGem=!1;this.listPieceMap.push({type:t.type,direction:t.direction,isReverse:t.isReverse,fenPiece:e})}else this.buildObjectPiece()},n.checkPieceMaxAmountConfig=function(t){var e=t.getScore();switch(e){case 1:if(this.segmentAmountPiece1Max<=this.segmentAmountPiece1Cur)return!1;this.segmentAmountPiece1Cur++;break;case 5:if(this.segmentAmountPiece5Max<=this.segmentAmountPiece5Cur)return!1;this.segmentAmountPiece5Cur++}return this.segmentTotalPiece++,this.segmentTotalPieceScore+=e,!0},n.getPieceByAvgScore=function(){var t=this;if(this.segmentTotalPieceScore<this.segmentTotalScore){var e=this.buildPieceRates(!1),n=e[Math.floor(Math.random()*e.length)];if(!this.allPiecesGroup[n])return null;var i=Math.floor(Math.random()*this.allPiecesGroup[n].length),a=this.allPiecesGroup[n][i];return this.allPieces[a].piece}if(this.segmentTotalPieceScore/this.segmentTotalPiece<=this.segmentAvgScore){var r,s=c()(r=this.allPieces).call(r,(function(e){return e.piece.getScore()<=t.segmentAvgScore}));return s&&0!==s.length?s[Phaser.Math.Between(0,s.length-1)].piece:null}if(this.segmentTotalPieceScore/this.segmentTotalPiece>this.segmentAvgScore){var o,h=c()(o=this.allPieces).call(o,(function(e){return e.piece.getScore()>t.segmentAvgScore}));return h&&0!==h.length?h[Phaser.Math.Between(0,h.length-1)].piece:null}return null},n.debuggerNextPieces=function(){for(var t=0;t<this.piecesActive.length;t++)this.removeActivePiece(t);for(var e=0;e<this.allPieces.length;e++)this.allPieces[e].piece.wrapPiece.setVisible(!1);this.showNewPieces()},n.addDebuggerBtnRandomPieces=function(){var t=this;if(zt.Utils.Valid.isDebugger())for(var e=[80,187.5,295],n=this.scene.gameZone.height,i=function(i){var a=new Ys.default(t.scene,WC,XC.GEM,50,30);t.add(a),a.onClick=function(){t.debuggerNewPieces(i)},a.setPosition(e[i],n)},a=0;a<3;a++)i(a)},n.debuggerNewPieces=function(t){this.removeActivePiece(t);var e=this.piecesActive[t],n=this.allPieces[e.position].piece;n.setVisible(!1);var i=Phaser.Math.Between(0,this.allPieces.length-1);this.piecesActive[t]={position:i,texture:WC,frame:XC.GEM,type:n.type,direction:n.direction,isReverse:n.isReverse};var a=this.scene.gameZone,r=a.width,s=a.height,o=[20,r/3,2*r/3-20],h=s/2+176-13,c=h+(s-85-h)/2,l=this.piecesActive[t],u=l.position,d=l.fenPiece,p=this.allPieces[u].piece,f=o[t];if(d){var g=this.convertFenPiecesToData(d);g&&p.updateDataPiece(g)}else{if(0===this.listPieceMap.length)if(this.isPieceContainGem()){var m=this.getRandomPieceData(p.data);m&&p.updateDataPiece(m)}}p.updatePosition(f,c),p.updatePositionWrapPiece(f+20*(t-1),c),p.setIndex(t),p.drawPiece()},e}(Phaser.GameObjects.Container),JC=gs.default.GAMEPLAY,QC=JC.KEY,$C=JC.FRAME,tM=gs.default.DEFAULT,eM=tM.KEY,nM=tM.FRAME,iM=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.pieces=void 0,n.debugButton=void 0,n.textExist=void 0,n.scene=e,n.setSize(n.scene.gameZone.width,85),e.add.existing((0,ls.default)(n)),n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createBackground(),this.createPieces(),this.createDebugButton()},n.createBackground=function(){var t=this.scene.make.image({key:eM,frame:nM.FOOTER}),e=this.scene.gameZone.width;t.setWorldSize(e,this.height),this.add(t),Phaser.Display.Align.In.BottomCenter(t,this)},n.createPieces=function(){this.pieces=new ZC(this.scene)},n.createDebugButton=function(){GameCore.Utils.Valid.isDebugger()&&this.createDebugButtonNextPieces()},n.createDebugButtonNextPieces=function(){this.debugButton=new Ys.default(this.scene,QC,$C.BUTTON_WOOD_SMALL,100,30),this.debugButton.setName("Debug");var t=this.scene.make.bitmapText({font:Hs.default.PRIMARY.KEY,size:this.scene.fontSize(30),text:"Next pieces",origin:{x:.5,y:.5}});this.debugButton.add([t]),this.debugButton.onClick=this.clickButtonNextPieces.bind(this),this.add(this.debugButton),Phaser.Display.Align.In.BottomLeft(this.debugButton,this),this.textExist=this.scene.make.bitmapText({font:Hs.default.PRIMARY.KEY,size:this.scene.fontSize(30),text:"Exist",origin:{x:.5,y:.5}}),this.debugButton.add([this.textExist]),Phaser.Display.Align.In.Center(this.textExist,this,80,0)},n.clickButtonNextPieces=function(){this.scene.footer.pieces.debuggerNextPieces()},e}(Phaser.GameObjects.Container),aM=iM,rM=function(){function t(t){this.scene=void 0,this.currentLevel=void 0,this.scene=t,this.init()}var e=t.prototype;return e.init=function(){var t=this.scene.storage.getState(),e=lu(t)||1;this.currentLevel=e},e.setLevel=function(t){this.currentLevel=t},e.getLevel=function(){return this.currentLevel},e.getLevelConfig=function(){var t=this.scene.storage.getState();return uu(t)?bT():qu[this.currentLevel]},e.getNextLevel=function(){return this.currentLevel+1},e.getNextLevelConfig=function(){return qu[this.currentLevel+1]},e.increaseLevel=function(){this.currentLevel++},t}(),sM=function(){function t(t){this.scene=void 0,this.map=void 0,this.scene=t,this.init()}var e=t.prototype;return e.init=function(){this.initMap()},e.initMap=function(){var t=this.scene.levelManager.getLevelConfig();this.map=this.scene.make.tilemap({key:t.key})},e.getTileMap=function(){return De()(this)},e.reloadMap=function(){var t,e=this.scene.levelManager.getLevelConfig();null==(t=De()(this))||t.destroy(),this.map=this.scene.make.tilemap({key:e.key})},t}(),oM=function(){function t(){this.targetType=void 0,this.targetValue=void 0,this.init()}var e=t.prototype;return e.init=function(){},e.setTargetType=function(t){this.targetType=t},e.setTargetValue=function(t){this.targetValue=t},e.getTargetType=function(){return this.targetType},e.getTargetValue=function(){return this.targetValue},t}(),hM=gs.default.GAMEPLAY_32.KEY,cM=function(t){function e(e,n,i,a){var r;return(r=t.call(this,e,n,i,a)||this).scene=void 0,r.textWellDone=void 0,r.listTargetFrame=[],r.listAnim=[],r.closeTimerEvent=void 0,r.tweenBackground=void 0,r.open=function(e){t.prototype.open.call((0,ls.default)(r),e),r.runPopupEntrancesAnimation(0,300)},r.close=function(){t.prototype.close.call((0,ls.default)(r))},r.scene=e,r.setDepth(Gs),r.background.setAlpha(0),r.createContent(),r}(0,Kt.default)(e,t);var n=e.prototype;return n.handleDelegate=function(){var t,e=this,n=this.getData(["duration","onClose"]),i=n[0],a=void 0===i?0:i,r=n[1];null==(t=this.closeTimerEvent)||t.remove(),a>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:a,callback:function(){e.visible&&e.scene.screen.close(e.name),r&&r()}}))},n.runAnim=function(){},n.createContent=function(){this.createText()},n.createText=function(){this.textWellDone=new lA(this.scene,{text:"\u041e\u0422\u041b\u0418\u0427\u041d\u041e!",font:Hs.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(80)}),this.add(this.textWellDone),Phaser.Display.Align.In.Center(this.textWellDone,this)},n.createTargetItems=function(){var t=this.scene.header.collectItems.getTargetKeys();if(t&&0!==t.length){for(var e=0;e<3;e++){var n=this.scene.make.image({key:hM});n.setWorldSize(30,30),n.setFrame(t[e]||t[0]),n.setVisible(!1).setAlpha(0),this.listTargetFrame.push(n)}this.add(this.listTargetFrame)}},n.updateTargetItems=function(){var t=this.scene.header.collectItems.getTargetKeys();if(t&&0!==t.length)for(var e=0;e<3;e++){var n=this.listTargetFrame[e];n.setWorldSize(30,30),n.setFrame(t[e]||t[0]),n.setVisible(!1).setAlpha(0)}},n.createAnimTargetItems=function(){for(var t=[100,500,700],e=[-120,0,120],n=[-100,-150,-100],i=[.7,1,.7],a=0;a<3;a++){this.listTargetFrame[a].setAlpha(0).setVisible(!0);var r=this.scene.add.tween({targets:this.listTargetFrame[a],delay:t[a],x:{from:0,to:e[a]},y:{from:300,to:n[a]},alpha:{from:0,to:1},scale:{from:0,to:i[a]},rotation:{from:-180,to:0},duration:500});this.listAnim.push(r)}},n.playAnimTargetItems=function(){for(var t=0;t<3;t++){this.listTargetFrame[t].setAlpha(0).setVisible(!0),this.listAnim[t].play()}},n.runPopupEntrancesAnimation=function(t,e){var n=this;this.listTargetFrame.forEach((function(t){t.setAlpha(0)})),this.textWellDone.restart(),this.tweenBackground||(this.tweenBackground=this.scene.tweens.addCounter({paused:!0,from:0,to:.6,delay:t,duration:e,onUpdate:function(t){var e=t.getValue();n.background.setAlpha(e)},onComplete:function(){n.textWellDone.start(),0===n.listTargetFrame.length?(n.createTargetItems(),n.createAnimTargetItems()):(n.updateTargetItems(),n.playAnimTargetItems()),n.handleDelegate(),n.runAnim()}})),this.background.setAlpha(0),this.tweenBackground.play()},e}(GameCore.Screen),lM=gs.default.DEFAULT,uM=lM.KEY,dM=lM.FRAME,pM=function(t){function e(e,n,i,a){var r;return(r=t.call(this,e,n,i,a)||this).scene=void 0,r.popup=void 0,r.title=void 0,r.buttonBack=void 0,r.buttonContinue=void 0,r.contents=void 0,r.textLevel=void 0,r.textLevelComplete=void 0,r.backgroundContent=void 0,r.listTargets=[],r.popupShowUpAnimation=void 0,r.popupFadeOutAnimation=void 0,r.contentShowUpAnimation=void 0,r.popupFadeInMaskAnimation=void 0,r.popupFadeOutMaskAnimation=void 0,r.buttonClose=void 0,r.scene=e,r.createPopup(),r.createContentBackground(),r.createTitle(),r.createTexts(),r.createButtons(),r.setDepth(Gs),r.background.setAlpha(.5),r}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){t.prototype.open.call(this),this.updateInfo(),this.runOpenAnimation()},n.updateInfo=function(){var t=this.scene.levelManager.getLevel();this.textLevel.setText("\u0423\u0440\u043e\u0432\u0435\u043d\u044c "+t)},n.createPopup=function(){this.popup=new uo(this.scene,0,0,310,300),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:uM,frame:dM.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(280,200),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-55)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:uM,frame:dM.TEXT_CONGRATULATION});t.setWorldSize(185.5,25),this.buttonClose=new Ys.default(this.scene,uM,dM.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickButtonClose.bind(this),this.title.add([t,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title,0,11),Phaser.Display.Align.In.Center(this.buttonClose,this.title,150,-15),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.clickButtonClose=function(){var t=this;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.header.progressBar.reset(),t.scene.clearFen(),t.scene.scene.switch(is.SceneKeys.LEVEL_SCENE)}))},n.createTexts=function(){this.createTextLevel(),this.createTextLevelComplete()},n.createTextLevel=function(){this.textLevel=this.scene.make.bitmapText({font:Hs.default.PRIMARY.KEY,size:this.scene.fontSize(50),text:"\u0423\u0440\u043e\u0432\u0435\u043d\u044c 1",origin:{x:.5,y:.5}}),this.popup.add(this.textLevel),Phaser.Display.Align.In.Center(this.textLevel,this.popup,0,-60)},n.createTextLevelComplete=function(){this.textLevelComplete=this.scene.make.bitmapText({font:Hs.default.PRIMARY.KEY,size:this.scene.fontSize(60),text:"\u0417\u0410\u0412\u0415\u0420\u0428\u0415\u041d",origin:{x:.5,y:.5}}),this.popup.add(this.textLevelComplete),Phaser.Display.Align.In.Center(this.textLevelComplete,this.popup,0,-20)},n.createTargetItems=function(){var t=this.scene.header.collectItems.getTargetKeys();if(t&&0!==t.length){for(var e=this.calcPosition(t.length),n=0;n<t.length;n++){var i=this.scene.make.image({key:gs.default.GAMEPLAY.KEY});i.setWorldSize(50,50),i.setFrame(t[n]||t[0]),i.setX(e[n]),this.listTargets.push(i)}this.popup.add(this.listTargets)}},n.updateTargetItems=function(){var t=this.scene.header.collectItems.getTargetKeys();if(t&&0!==t.length){this.popup.remove(this.listTargets);for(var e=this.calcPosition(t.length),n=0;n<t.length;n++){var i=this.listTargets[n];i||(i=this.scene.make.image({key:gs.default.GAMEPLAY.KEY}),this.listTargets.push(i)),i.setWorldSize(50,50),i.setFrame(t[n]||t[0]),i.setX(e[n])}this.popup.add(this.listTargets)}},n.calcPosition=function(t){for(var e=[],n=310/(t+1),i=n*(t-1)/2,a=0;a<t;a++)e.push(n*a-i);return e},n.createButtons=function(){this.createButtonBack(),this.createButtonContinue()},n.createButtonBack=function(){var t=this.scene.make.image({key:uM,frame:dM.ICON_BACK});t.setWorldSize(30,30),this.buttonBack=new Ys.default(this.scene,uM,dM.BUTTON_MINOR,70,54),this.buttonBack.setName("Back"),this.buttonBack.add(t),this.popup.add(this.buttonBack),this.buttonBack.onClick=this.clickButtonBack.bind(this),Phaser.Display.Align.In.Center(this.buttonBack,this.popup,-88,55)},n.clickButtonBack=function(){var t=this;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.header.progressBar.reset(),t.scene.clearFen(),t.scene.scene.switch(is.SceneKeys.LEVEL_SCENE)}))},n.createButtonContinue=function(){var t=this.scene.make.image({key:uM,frame:dM.TEXT_NEXT_LEVEL});t.setWorldSize(102,35.5),this.buttonContinue=new Ys.default(this.scene,uM,dM.BUTTON_GREEN,172,54),this.buttonContinue.setName("Continue"),this.buttonContinue.add(t),this.popup.add(this.buttonContinue),this.buttonContinue.onClick=this.clickButtonContinue.bind(this),Phaser.Display.Align.In.Center(this.buttonContinue,this.popup,37,55)},n.clickButtonContinue=function(){var t=this,e=this.scene.storage.getState();if(Cv(e)<1)return this.setVisible(!1),void this.scene.screen.open(Ns);this.scene.storage.dispatch(Bv()),this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.clearFen(),t.scene.startGame()}))},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Vs.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new so({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new io({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new $s({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Tc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new $s({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),fM=gs.default.DEFAULT,gM=fM.KEY,mM=fM.FRAME,vM=function(t){function e(e,n,i,a){var r;return(r=t.call(this,e,n,i,a)||this).scene=void 0,r.popup=void 0,r.title=void 0,r.buttonBack=void 0,r.buttonContinue=void 0,r.contents=void 0,r.textLevel=void 0,r.textLevelComplete=void 0,r.backgroundContent=void 0,r.livesTimer=void 0,r.listTargets=[],r.popupShowUpAnimation=void 0,r.popupFadeOutAnimation=void 0,r.contentShowUpAnimation=void 0,r.popupFadeInMaskAnimation=void 0,r.popupFadeOutMaskAnimation=void 0,r.buttonClose=void 0,r.scene=e,r.createPopup(),r.createContentBackground(),r.createTitle(),r.createTexts(),r.createButtons(),r.createLivesTimer(),r.setDepth(Gs),r.background.setAlpha(.5),r}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){t.prototype.open.call(this),this.updateInfo(),this.runOpenAnimation()},n.updateInfo=function(){var t=this.scene.levelManager.getLevel();t<qu.length-1&&(t-=1),this.textLevel.setText("\u0423\u0440\u043e\u0432\u0435\u043d\u044c "+t)},n.createPopup=function(){this.popup=new uo(this.scene,0,0,290,234),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,-20)},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:gM,frame:mM.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(260,147),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-66)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:gM,frame:mM.TEXT_CONGRATULATION});t.setWorldSize(185.5,25),this.buttonClose=new Ys.default(this.scene,gM,mM.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickButtonClose.bind(this),this.title.add([t,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title,0,30),Phaser.Display.Align.In.Center(this.buttonClose,this.title,135,5),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.createTexts=function(){this.createTextLevel(),this.createTextLevelComplete()},n.createTextLevel=function(){this.textLevel=this.scene.make.bitmapText({font:Hs.default.PRIMARY.KEY,size:this.scene.fontSize(40),text:"\u0423\u0440\u043e\u0432\u0435\u043d\u044c 1",origin:{x:.5,y:.5}}),this.popup.add(this.textLevel),Phaser.Display.Align.In.Center(this.textLevel,this.popup,0,-23)},n.createTextLevelComplete=function(){this.textLevelComplete=this.scene.make.bitmapText({font:Hs.default.PRIMARY.KEY,size:this.scene.fontSize(44),text:"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d",origin:{x:.5,y:.5}}),this.popup.add(this.textLevelComplete),Phaser.Display.Align.In.Center(this.textLevelComplete,this.popup,0,3)},n.createTargetItems=function(){var t=this.scene.header.collectItems.getTargetKeys();if(t&&0!==t.length){for(var e=this.calcPosition(t.length),n=0;n<t.length;n++){var i=this.scene.make.image({key:gs.default.GAMEPLAY.KEY});i.setWorldSize(50,50),i.setFrame(t[n]||t[0]),i.setX(e[n]),this.listTargets.push(i)}this.popup.add(this.listTargets)}},n.clickButtonClose=function(){var t=this;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.header.progressBar.reset(),t.scene.clearFen(),t.scene.scene.switch(is.SceneKeys.LEVEL_SCENE)}))},n.updateTargetItems=function(){var t=this.scene.header.collectItems.getTargetKeys();if(t&&0!==t.length){this.popup.remove(this.listTargets);for(var e=this.calcPosition(t.length),n=0;n<t.length;n++){var i=this.listTargets[n];i||(i=this.scene.make.image({key:gs.default.GAMEPLAY.KEY}),this.listTargets.push(i)),i.setWorldSize(50,50),i.setFrame(t[n]||t[0]),i.setX(e[n])}this.popup.add(this.listTargets)}},n.calcPosition=function(t){for(var e=[],n=310/(t+1),i=n*(t-1)/2,a=0;a<t;a++)e.push(n*a-i);return e},n.createButtons=function(){this.createButtonBack(),this.createButtonContinue()},n.createButtonBack=function(){var t=this.scene.make.image({key:gM,frame:mM.ICON_BACK});t.setWorldSize(30,30),this.buttonBack=new Ys.default(this.scene,gM,mM.BUTTON_MINOR,62,54),this.buttonBack.setName("Back"),this.buttonBack.add(t),this.popup.add(this.buttonBack),this.buttonBack.onClick=this.clickButtonBack.bind(this),Phaser.Display.Align.In.Center(this.buttonBack,this.popup,-90,52)},n.clickButtonBack=function(){var t=this;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.header.progressBar.reset(),t.scene.clearFen(),t.scene.scene.switch(is.SceneKeys.LEVEL_SCENE)}))},n.createButtonContinue=function(){var t=this.scene.make.image({key:gM,frame:mM.TEXT_NEXT_LEVEL});t.setWorldSize(102,35.5),this.buttonContinue=new Ys.default(this.scene,gM,mM.BUTTON_GREEN,178,54),this.buttonContinue.setName("Continue"),this.buttonContinue.add(t),this.popup.add(this.buttonContinue),this.buttonContinue.onClick=this.clickButtonContinue.bind(this),Phaser.Display.Align.In.Center(this.buttonContinue,this.popup,33,52)},n.clickButtonContinue=function(){var t=this,e=this.scene.storage.getState();if(Cv(e)<1)return this.runCloseAnimation(),void this.scene.screen.open(Ns,{onClose:function(){t.scene.screen.open(ks)}});lu(e)>=qu.length-1?this.scene.game.globalScene.screen.open(vs,{message:"\u0412\u044b \u0434\u043e\u0441\u0442\u0438\u0433\u043b\u0438 \u043f\u0440\u0435\u0434\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u0443\u0440\u043e\u0432\u043d\u044f...",duration:3e3}):(this.scene.storage.dispatch(Bv()),this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.analytics.levelStart(t.scene.levelManager.getLevel(),void 0,t.scene.getLevelName());var e=t.scene.main.board.fadeOut();e?e.on("complete",(function(){t.scene.header.progressBar.reset(),t.scene.clearFen(),t.scene.startGame()})):(t.scene.header.progressBar.reset(),t.scene.clearFen(),t.scene.startGame())})))},n.createLivesTimer=function(){this.livesTimer=new db(this.scene),this.livesTimer.startIntervalTimer(),this.livesTimer.setFrameLivesTimeBlock2(),this.add(this.livesTimer),Phaser.Display.Align.In.TopCenter(this.livesTimer,this,0,-62)},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Vs.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new so({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new io({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new $s({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Tc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new $s({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),yM=gs.default.GAMEPLAY,SM=(yM.KEY,yM.FRAME,function(t){function e(e,n,i,a){var r;return(r=t.call(this,e,n,i,a)||this).scene=void 0,r.textNoSpaceLeft=void 0,r.closeTimerEvent=void 0,r.tweenBackground=void 0,r.open=function(e){t.prototype.open.call((0,ls.default)(r),e),r.runPopupEntrancesAnimation(300,300),r.handleDelegate()},r.close=function(){t.prototype.close.call((0,ls.default)(r))},r.scene=e,r.setDepth(Gs),r.background.setAlpha(0),r.createContent(),r}(0,Kt.default)(e,t);var n=e.prototype;return n.handleDelegate=function(){var t,e=this,n=this.getData(["duration","onClose"]),i=n[0],a=void 0===i?0:i,r=n[1];null==(t=this.closeTimerEvent)||t.remove(),a>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:a,callback:function(){e.textNoSpaceLeft.setVisible(!1),e.textNoSpaceLeft.restart(),e.visible&&e.scene.screen.close(e.name),r&&r()}}))},n.runAnim=function(){this.textNoSpaceLeft.setVisible(!0),this.textNoSpaceLeft.start(300)},n.createContent=function(){this.createText()},n.createText=function(){this.textNoSpaceLeft=new lA(this.scene,{text:"\u041c\u0415\u0421\u0422\u0410 \u041d\u0415 \u041e\u0421\u0422\u0410\u041b\u041e\u0421\u042c!",font:Hs.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(76)}),this.add(this.textNoSpaceLeft),Phaser.Display.Align.In.Center(this.textNoSpaceLeft,this)},n.runPopupEntrancesAnimation=function(t,e){var n=this;this.tweenBackground||(this.tweenBackground=this.scene.tweens.addCounter({paused:!0,from:0,to:.6,delay:t,duration:e,onUpdate:function(t){var e=t.getValue();n.background.setAlpha(e)},onComplete:function(){n.runAnim()}})),this.tweenBackground.play()},e}(GameCore.Screen)),AM=gs.default.DEFAULT,EM=AM.KEY,xM=AM.FRAME,bM=function(t){function e(e,n,i,a){var r;return(r=t.call(this,e,n,i,a)||this).scene=void 0,r.popup=void 0,r.title=void 0,r.buttonBack=void 0,r.buttonRetry=void 0,r.contents=void 0,r.backgroundContent=void 0,r.textLevelFail=void 0,r.buttonClose=void 0,r.livesTimer=void 0,r.popupShowUpAnimation=void 0,r.popupFadeOutAnimation=void 0,r.contentShowUpAnimation=void 0,r.popupFadeInMaskAnimation=void 0,r.popupFadeOutMaskAnimation=void 0,r.scene=e,r.createPopup(),r.createContentBackground(),r.createTitle(),r.createTexts(),r.createButtons(),r.createLivesTimer(),r.setDepth(Gs),r.background.setAlpha(.5),r}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){t.prototype.open.call(this),this.scene.enableInput(),this.runOpenAnimation()},n.createPopup=function(){this.popup=new uo(this.scene,0,0,290,234),this.add(this.popup),this.popup.setFrameTop(xM.POPUP_TOP_DARK),Phaser.Display.Align.In.Center(this.popup,this.zone,0,-20)},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:EM,frame:xM.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(260,147),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-66)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:EM,frame:xM.TEXT_LOSE});t.setWorldSize(193.5,20.5),this.buttonClose=new Ys.default(this.scene,EM,xM.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickButtonClose.bind(this),this.title.add([t,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title,0,30),Phaser.Display.Align.In.Center(this.buttonClose,this.title,135,5),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.createTexts=function(){this.createTextLevelFail()},n.createTextLevelFail=function(){this.textLevelFail=this.scene.make.image({key:EM,frame:xM.TEXT_LEVEL_FAIL}),this.textLevelFail.setWorldSize(250,18.5),this.popup.add(this.textLevelFail),Phaser.Display.Align.In.Center(this.textLevelFail,this.popup,0,-10)},n.createButtons=function(){this.createButtonBack(),this.createButtonRetry()},n.createButtonBack=function(){var t=this.scene.make.image({key:EM,frame:xM.ICON_BACK});t.setWorldSize(30,30),this.buttonBack=new Ys.default(this.scene,EM,xM.BUTTON_MINOR,62,54),this.buttonBack.setName("Back"),this.buttonBack.add(t),this.popup.add(this.buttonBack),this.buttonBack.onClick=this.clickButtonBack.bind(this),Phaser.Display.Align.In.Center(this.buttonBack,this.popup,-90,52)},n.clickButtonBack=function(){var t=this;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.clearFen(),t.scene.scene.switch(is.SceneKeys.LEVEL_SCENE)}))},n.createButtonRetry=function(){var t=this.scene.make.image({key:EM,frame:xM.TEXT_RETRY});t.setWorldSize(113,15.5);var e=this.scene.make.image({key:EM,frame:xM.ICON_RETRY});e.setWorldSize(33,35),this.buttonRetry=new Ys.default(this.scene,EM,xM.BUTTON_GREEN,178,54),this.buttonRetry.setName("Retry"),this.buttonRetry.add(t),this.buttonRetry.add(e),Phaser.Display.Align.In.Center(t,this.buttonRetry,22,-3),Phaser.Display.Align.In.Center(e,this.buttonRetry,-58,-3),this.popup.add(this.buttonRetry),this.buttonRetry.onClick=this.clickButtonRetry.bind(this),Phaser.Display.Align.In.Center(this.buttonRetry,this.popup,33,52)},n.clickButtonClose=function(){var t=this;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.clearFen(),t.scene.scene.switch(is.SceneKeys.LEVEL_SCENE)}))},n.clickButtonRetry=function(){var t=this,e=this.scene.storage.getState();Cv(e)<1?this.scene.screen.open(Ns,{currentScreen:this}):(this.scene.storage.dispatch(Bv()),this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.handleRetryLevel()})))},n.createLivesTimer=function(){this.livesTimer=new db(this.scene),this.livesTimer.startIntervalTimer(),this.livesTimer.setFrameLivesTimeBlock2(),this.add(this.livesTimer),Phaser.Display.Align.In.TopCenter(this.livesTimer,this,0,-62)},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Vs.default.POPUP_SHOW),this.livesTimer.startIntervalTimer(),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.livesTimer.stopIntervalTimer(),this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new so({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new io({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new $s({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Tc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new $s({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),TM=gs.default.DEFAULT,wM=TM.KEY,CM=TM.FRAME,MM=function(t){function e(e){var n;return(n=t.call(this,e,wM,CM.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Home"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:wM,frame:CM.ICON_HOME});t.setWorldSize(31,28),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-2)},e}(Ys.default),IM=MM,PM=gs.default.DEFAULT,kM=PM.KEY,RM=PM.FRAME,OM=function(t){function e(e){var n;return(n=t.call(this,e,kM,RM.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Journey"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:kM,frame:RM.ICON_JOURNEY_2});t.setWorldSize(35,28),this.add(t),Phaser.Display.Align.In.Center(t,this,-.25,-1.5)},e}(Ys.default),_M=OM,DM=gs.default.DEFAULT,LM=DM.KEY,BM=DM.FRAME,FM=function(t){function e(e){var n;return(n=t.call(this,e,LM,BM.BUTTON_DARK_BLUE)||this).button.setWorldSize(246,53),n.setName("PlayWithFriends"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:LM,frame:BM.ICON_SWORD_BLUE});t.setWorldSize(31,25),this.add(t),Phaser.Display.Align.In.Center(t,this,-60)},n.createText=function(){var t=this.scene.make.image({key:LM,frame:BM.TEXT_PLAY_WITH_BLUE});t.setWorldSize(159.5,15.5),this.add(t),Phaser.Display.Align.In.Center(t,this,20)},e}(Ys.default),NM=FM,GM=gs.default.DEFAULT,UM=GM.KEY,VM=GM.FRAME,YM=function(t){function e(e){var n;return(n=t.call(this,e,UM,VM.BUTTON_BROWN)||this).button.setWorldSize(246,53),n.setName("Replay"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:UM,frame:VM.ICON_REPLAY});t.setWorldSize(26,31),this.add(t),Phaser.Display.Align.In.Center(t,this,-45,-2)},n.createText=function(){var t=this.scene.make.image({key:UM,frame:VM.TEXT_REPLAY});t.setWorldSize(69.5,14.5),this.add(t),Phaser.Display.Align.In.Center(t,this,20,-1)},e}(Ys.default),zM=YM,HM=gs.default.DEFAULT,WM=HM.KEY,XM=HM.FRAME,KM=function(t){function e(e){var n;return(n=t.call(this,e,WM,XM.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Share"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:WM,frame:XM.ICON_SHARE});t.setWorldSize(24,31),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-2)},e}(Ys.default),jM=KM,qM=gs.default.DEFAULT,ZM=qM.KEY,JM=qM.FRAME,QM=function(t){function e(e,n,i,a){var r;return(r=t.call(this,e,n,i,a)||this).scene=void 0,r.popup=void 0,r.title=void 0,r.buttonClose=void 0,r.contents=void 0,r.backgroundContent=void 0,r.settingMusic=void 0,r.settingSound=void 0,r.settingVibrate=void 0,r.settingSoundContainer=void 0,r.settingMusicContainer=void 0,r.settingVibrateContainer=void 0,r.popupShowUpAnimation=void 0,r.popupFadeOutAnimation=void 0,r.contentShowUpAnimation=void 0,r.popupFadeInMaskAnimation=void 0,r.popupFadeOutMaskAnimation=void 0,r.buttonReplay=void 0,r.buttonPlayWithFriend=void 0,r.buttonHome=void 0,r.buttonJourney=void 0,r.buttonShare=void 0,r.debuggerCurrentLevelText=void 0,r.debuggerCurrentLevel=0,r.handleClose=function(){r.runCloseAnimation()},r.handleMusicSetting=function(t){r.scene.player.setSetting("music",t),t?r.scene.audio.playMusic():r.scene.audio.pauseMusic()},r.handleSoundSetting=function(t){r.scene.player.setSetting("sound",t)},r.handleVibrateSetting=function(t){t&&rm(199),r.scene.player.setSetting("vibrate",t)},r.clickReplay=function(){var t=r.scene.storage.getState();if(Cv(t)<1)return r.setVisible(!1),void r.scene.screen.open(Ns);r.scene.storage.dispatch(Bv()),r.runCloseAnimation(),r.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r.scene.screen.close(r.name),r.scene.handleRetryLevel();case 2:case"end":return t.stop()}}),t)}))))},r.clickButtonPlayWithFriends=function(){r.scene.storage.dispatch(Kd()),r.scene.screen.close(r.name)},r.clickButtonHome=function(){r.runCloseAnimation(),r.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r.scene.scene.switch(is.SceneKeys.DASHBOARD_SCENE);case 1:case"end":return t.stop()}}),t)}))))},r.clickButtonLeaderboard=function(){r.scene.screen.open(Ts)},r.clickButtonShare=function(){r.scene.storage.dispatch(ku())},r.scene=e,r.createPopup(),r.createTitle(),r.createContentBackground(),r.createSwitchButtons(),r.createButtons(),r.addItem(),r.arrangeItems(),r.createInput(),r.createDebuggerInputLevel(),r.setDepth(Gs),r.background.setAlpha(.5),r}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){var e;t.prototype.open.call(this);var n=this.scene.player.getPlayerSettings(),i=n.sound,a=n.vibrate;this.settingSound.updateStatus(i),null==(e=this.settingVibrate)||e.updateStatus(a),this.runOpenAnimation()},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:ZM,frame:JM.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(263,147),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-48)},n.createInput=function(){this.buttonClose.onClick=this.handleClose,this.settingSound.onClick=this.handleSoundSetting,this.settingVibrate&&(this.settingVibrate.onClick=this.handleVibrateSetting)},n.createPopup=function(){this.popup=new uo(this.scene,0,0,290,390),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:ZM,frame:JM.TEXT_SETTING});t.setWorldSize(151.5,24),this.buttonClose=new Ys.default(this.scene,ZM,JM.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.title.add([t,this.buttonClose]),Phaser.Display.Align.In.Center(t,this.title,0,11),Phaser.Display.Align.In.Center(this.buttonClose,this.title,135,-14)},n.createButtons=function(){this.createReplayButton(),this.createHomeButton(),this.createJourneyButton(),this.createShareButton()},n.createReplayButton=function(){this.buttonReplay=new zM(this.scene),this.popup.add(this.buttonReplay),this.buttonReplay.onClick=this.clickReplay,Phaser.Display.Align.In.Center(this.buttonReplay,this.popup,0,43)},n.createPlayWithFriendButton=function(){this.buttonPlayWithFriend=new NM(this.scene),this.popup.add(this.buttonPlayWithFriend),this.buttonPlayWithFriend.onClick=this.clickButtonPlayWithFriends,Phaser.Display.Align.In.Center(this.buttonPlayWithFriend,this.buttonReplay,0,65)},n.createHomeButton=function(){this.buttonHome=new IM(this.scene),this.popup.add(this.buttonHome),this.buttonHome.onClick=this.clickButtonHome,Phaser.Display.Align.In.Center(this.buttonHome,this.buttonReplay,-90,72)},n.createJourneyButton=function(){this.buttonJourney=new _M(this.scene),this.popup.add(this.buttonJourney),this.buttonJourney.onClick=this.clickButtonJourney.bind(this),Phaser.Display.Align.In.Center(this.buttonJourney,this.buttonReplay,0,72)},n.clickButtonJourney=function(){var t=this;this.runCloseAnimation(),this.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function e(){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.scene.scene.switch(is.SceneKeys.LEVEL_SCENE);case 1:case"end":return e.stop()}}),e)}))))},n.createShareButton=function(){this.buttonShare=new jM(this.scene),this.popup.add(this.buttonShare),this.buttonShare.onClick=this.clickButtonShare,Phaser.Display.Align.In.Center(this.buttonShare,this.buttonReplay,90,72)},n.createSwitchButtons=function(){var t=this.scene.player.getPlayerSettings(),e=(t.music,t.sound),n=t.vibrate;this.createSoundButton(e),nm()?(this.createVibrateButton(n),Phaser.Display.Align.In.Center(this.settingSoundContainer,this.backgroundContent,0,-33),Phaser.Display.Align.In.Center(this.settingVibrateContainer,this.backgroundContent,0,28)):Phaser.Display.Align.In.Center(this.settingSoundContainer,this.backgroundContent,0,0)},n.createMusicButton=function(t){this.settingMusicContainer=this.scene.make.container({});var e=this.scene.make.image({key:ZM,frame:JM.ICON_MUSIC});e.setWorldSize(37,40),this.settingMusic=new _A(this.scene,{enable:t,width:89,height:31}),this.settingMusic.setName("Music"),Phaser.Display.Align.In.Center(e,this.settingMusicContainer,-60),Phaser.Display.Align.In.Center(this.settingMusic,this.settingMusicContainer,40),this.settingMusicContainer.add([e,this.settingMusic]),this.popup.add(this.settingMusicContainer),Phaser.Display.Align.In.Center(this.settingMusicContainer,this.backgroundContent,0,60)},n.createVibrateButton=function(t){this.settingVibrateContainer=this.scene.make.container({});var e=this.scene.make.image({key:ZM,frame:JM.ICON_VIBRATE});e.setWorldSize(41,48),this.settingVibrate=new _A(this.scene,{enable:t,width:89,height:31}),this.settingVibrate.setName("Vibrate"),this.settingVibrateContainer.add([e,this.settingVibrate]),Phaser.Display.Align.In.Center(e,this.settingVibrateContainer,-60),Phaser.Display.Align.In.Center(this.settingVibrate,this.settingVibrateContainer,35),this.popup.add(this.settingVibrateContainer)},n.createSoundButton=function(t){this.settingSoundContainer=this.scene.make.container({});var e=this.scene.make.image({key:ZM,frame:JM.ICON_SOUND});e.setWorldSize(41,36),this.settingSound=new _A(this.scene,{enable:t,width:89,height:31}),this.settingSound.setName("Sound"),this.settingSoundContainer.add([e,this.settingSound]),Phaser.Display.Align.In.Center(e,this.settingSoundContainer,-58),Phaser.Display.Align.In.Center(this.settingSound,this.settingSoundContainer,35),this.popup.add(this.settingSoundContainer)},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.arrangeItems=function(){Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Vs.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new so({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new io({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new $s({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Tc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new $s({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},n.createDebuggerInputLevel=function(){var t=this;if(GameCore.Utils.Valid.isDebugger()){for(var e=this.scene.make.container({}),n=function(n){var i=t.scene.make.bitmapText({font:Hs.default.PRIMARY_LIGHT.KEY,size:t.scene.fontSize(34),origin:{x:.5,y:.5},text:""+n});e.add(i),i.setInteractive(),i.on("pointerdown",(function(){t.debuggerHandleClick(n)})),Phaser.Display.Align.In.Center(i,e,20*n)},i=0;i<10;i++)n(i);this.add(e),Phaser.Display.Align.In.Center(e,this.popup,-100,190),this.debuggerCurrentLevelText=this.scene.make.bitmapText({font:Hs.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(34),origin:{x:.5,y:.5},text:"\u0423\u0440\u043e\u0432\u0435\u043d\u044c 0"}),this.add(this.debuggerCurrentLevelText),Phaser.Display.Align.In.Center(this.debuggerCurrentLevelText,this.popup,0,210);var a=this.scene.make.bitmapText({font:Hs.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(34),origin:{x:.5,y:.5},text:"Go"});this.add(a),a.setInteractive(),a.on("pointerdown",(function(){t.close(),t.scene.time.delayedCall(300,(function(){t.scene.levelManager.setLevel(t.debuggerCurrentLevel),t.scene.startGame()}))})),Phaser.Display.Align.In.Center(a,this.popup,0,230);var r=this.scene.make.bitmapText({font:Hs.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(34),origin:{x:.5,y:.5},text:"Clear"});r.setInteractive(),r.on("pointerdown",(function(){t.debuggerCurrentLevel=0,t.debuggerCurrentLevelText.setText("Level "+String(t.debuggerCurrentLevel))})),this.add(r),Phaser.Display.Align.In.Center(r,this.popup,50,230)}},n.debuggerHandleClick=function(t){var e=this.debuggerCurrentLevel+""+t;this.debuggerCurrentLevel=eb()(e),this.debuggerCurrentLevelText.setText("Level "+String(this.debuggerCurrentLevel))},e}(GameCore.Screen),$M=QM,tI=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidTileMap",i.message=e||"This tile is not valid",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,se.default)(Error)),eI=gs.default.DEFAULT,nI=(eI.KEY,eI.FRAME,gs.default.GAMEPLAY_32.KEY),iI=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.imageGem=void 0,n.text=void 0,n.scene=e,n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createImageGem(),this.createText()},n.createImageGem=function(){this.imageGem=this.scene.make.image({key:nI}),this.imageGem.setWorldSize(35,35),this.add(this.imageGem),Phaser.Display.Align.In.Center(this.imageGem,this,0,-10.5)},n.createText=function(){this.text=this.scene.make.bitmapText({font:Hs.default.PRIMARY.KEY,size:this.scene.fontSize(42),origin:{x:.5,y:.5},text:"0"}),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this,0,29)},n.updateGem=function(t){this.imageGem.setFrame(t)},n.updateText=function(t){this.text.setText("x"+t)},n.getFrame=function(){return this.imageGem.frame.name},e}(Phaser.GameObjects.Container),aI=gs.default.DEFAULT,rI=aI.KEY,sI=aI.FRAME,oI=function(t){function e(e,n,i,a){var r;return(r=t.call(this,e,n,i,a)||this).scene=void 0,r.popup=void 0,r.title=void 0,r.contents=void 0,r.backgroundContent=void 0,r.listItems=[],r.targetImages=[],r.popupShowUpAnimation=void 0,r.popupFadeOutAnimation=void 0,r.contentShowUpAnimation=void 0,r.listAnimCollectionItem=[],r.popupFadeInMaskAnimation=void 0,r.popupFadeOutMaskAnimation=void 0,r.handleClose=function(){r.runCloseAnimation()},r.scene=e,r.createPopup(),r.createTitle(),r.createContentBackground(),r.addItem(),r.setDepth(Gs),r.background.setAlpha(.5),r}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(e){var n=this;t.prototype.open.call(this,e);var i=this.getData(["duration"])[0];this.hideAllCollectionItems(),this.createCollectionItems(),this.alginCollectionItems(),this.runOpenAnimation(),this.scene.time.delayedCall(i,(function(){n.handleClose()}))},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:rI,frame:sI.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(263,135),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-24)},n.createCollectionItems=function(){for(var t=this.getData(["jsonTarget"])[0],e=Y()(t),n=0;n<e.length;n++){var i=e[n],a=this.getCollectionItemFree(n);a.updateGem(i),a.updateText(t[i])}},n.getCollectionItemFree=function(t){var e=this.listItems[t];return e||(e=new iI(this.scene),this.popup.add(e),this.listItems.push(e)),e.setVisible(!0),e},n.alginCollectionItems=function(){var t;this.targetImages=[];for(var e=c()(t=this.listItems).call(t,(function(t){return t.visible})),n=e.length,i=263/(n+1)+5,a=-i*(n-1)/2,r=0;r<n;r++){var s=e[r];Phaser.Display.Align.In.Center(s,this.backgroundContent,a+i*r);var o=s.getFrame(),h=this.scene.make.image({key:gs.default.GAMEPLAY_32.KEY,frame:o});h.setWorldSize(22,22),h.setVisible(!1),this.targetImages.push(h),Phaser.Display.Align.In.Center(h,this.backgroundContent,a+i*r+this.scene.gameZone.width/2,this.scene.gameZone.height/2)}},n.hideAllCollectionItems=function(){for(var t=0;t<this.listItems.length;t++){this.listItems[t].setVisible(!1)}},n.moveGemsToCollectItems=function(){var t=this;this.resetPositionTargetImages();for(var e=this.scene.header.collectItems,n=e.getTargetKeys(),i=this.scene.gameZone.width/2,a=function(a){var r=n[a],s=e.getPositionCollectionItem(r),o=i+s.x,h=s.y-23;t.targetImages[a].setAlpha(1),t.targetImages[a].setVisible(!0);var c=t.getFreeAnim(),l=Phaser.Math.Between(500,1e3);c.setTarget(t.targetImages[a]),c.runGemMoveToPosition(0,l,o,h).on(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){t.scene.header.collectItems.showCollectItemByKey(r),t.targetImages[a].setVisible(!1),a==t.targetImages.length-1&&t.scene.main.board.handleTweenStartMission()}))},r=0;r<n.length;r++)a(r)},n.resetPositionTargetImages=function(){for(var t,e=c()(t=this.listItems).call(t,(function(t){return t.visible})),n=263/(e.length+1)+5,i=-n*(e.length-1)/2,a=0;a<e.length;a++){var r;this.targetImages[a]&&(null==(r=this.targetImages[a])||r.setVisible(!1),Phaser.Display.Align.In.Center(this.targetImages[a],this.backgroundContent,i+n*a+this.scene.gameZone.width/2,this.scene.gameZone.height/2))}},n.getFreeAnim=function(){var t=new lw(this.scene);return this.listAnimCollectionItem.push(t),t},n.createPopup=function(){this.popup=new uo(this.scene,0,-19,290,218,{forceHeightTop:55}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:rI,frame:sI.TEXT_MISSION});t.setWorldSize(105,21),this.title.add([t]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title,0,-10),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Vs.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var t,e,n=this;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.scene.time.delayedCall(50,(function(){n.moveGemsToCollectItems()})),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup,i=(n.y,n.scale);this.popupShowUpAnimation=new so({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new io({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new $s({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.scene.startGameAfterCollectionItemsScreenClose()}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Tc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new $s({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),hI=oI,cI=Ws.STATUS,lI=gs.default.GAMEPLAY,uI=lI.KEY,dI=lI.FRAME,pI=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.step=void 0,n.listPositionStart=void 0,n.listPositionTo=void 0,n.positionStart=void 0,n.positionTo=void 0,n.handFrame=void 0,n.tweenHand=void 0,n.validTargetPosition=function(t){var e={x:0,y:0};switch(n.step){case 0:case 1:e={x:3,y:3}}return e.x===t.x&&e.y===t.y},n.scene=e,n.step=0,n.initPosition(),n.createHand(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.start=function(){this.isRunning()||(this.setState(cI.RUNNING),this.handleStep())},n.initPosition=function(){var t=this.scene.gameZone,e=t.width,n=t.height,i=n/2+200,a=i+(n-85-i)/2;this.listPositionStart=[{x:e/2-90,y:a},{x:e/2+30,y:a+10}],this.listPositionTo=[{x:e/2-15,y:n/2-30},{x:e/2+55,y:n/2+30}]},n.createHand=function(){this.handFrame=this.scene.make.image({key:uI,frame:dI.HAND,origin:{x:.5,y:.5}}),this.handFrame.setVisible(!1).setDepth(zs.default.ON_TOP),this.handFrame.setWorldSize(64,55)},n.createTweenHand=function(){this.tweenHand=this.scene.add.tween({paused:!0,repeatDelay:500,targets:this.handFrame,repeat:-1,x:{from:this.positionStart.x,to:this.positionTo.x},y:{from:this.positionStart.y,to:this.positionTo.y},duration:1500,ease:Phaser.Math.Easing.Sine.InOut}),this.tweenHand.play()},n.handleStep=function(){switch(this.positionStart=this.listPositionStart[this.step],this.positionTo=this.listPositionTo[this.step],this.handFrame.setVisible(!0),this.handFrame.setPosition(this.positionStart.x,this.positionStart.y),this.createTweenHand(),this.step){case 0:this.handleStep1();break;case 1:this.handleStep2()}},n.handleStep1=function(){this.scene.main.board.dataBoard[3][3].cell.setFrame(gs.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0),this.scene.main.board.dataBoard[3][4].cell.setFrame(gs.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0),this.scene.main.board.dataBoard[4][3].cell.setFrame(gs.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0)},n.handleStep2=function(){this.scene.main.board.dataBoard[5][3].cell.setFrame(gs.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0),this.scene.main.board.dataBoard[5][4].cell.setFrame(gs.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0),this.scene.main.board.dataBoard[5][5].cell.setFrame(gs.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0),this.scene.main.board.dataBoard[3][5].cell.setFrame(gs.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0),this.scene.main.board.dataBoard[4][5].cell.setFrame(gs.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0)},n.handleCompleteTutorial=function(){this.setState(cI.STOPPED),this.stopAnimHand()},n.nextStep=function(){this.handFrame.setVisible(!1),this.step++,this.step>=2?this.handleCompleteTutorial():this.handleStep()},n.stopAnimHand=function(){var t;this.handFrame.setVisible(!1),null==(t=this.tweenHand)||t.stop()},n.runAnimHand=function(){this.handFrame.setVisible(!0),this.tweenHand.play()},n.validStep=function(t){return this.step===t},n.reset=function(){this.setState(cI.STOPPED),this.stopAnimHand(),this.step=0},e}(qs),fI=pI,gI=function(t){return t.dailyChallenge},mI=(0,be.createSelector)([function(t){return gI(t).isRequesting}],(function(t){return t})),vI=(0,be.createSelector)([function(t){return gI(t).leaders}],(function(t){return t})),yI=(0,be.createSelector)([function(t){return gI(t).time}],(function(t){return t})),SI=gs.default.DEFAULT,AI=SI.KEY,EI=SI.FRAME,xI=function(t){function e(e){var n;return(n=t.call(this,e,AI,EI.BUTTON_DARK_BLUE_BIG)||this).button.setWorldSize(76,31),n.setName("Share"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:AI,frame:EI.ICON_SHARE_BLUE});t.setWorldSize(12,16),this.add(t),Phaser.Display.Align.In.Center(t,this,-26)},n.createText=function(){var t=this.scene.make.image({key:AI,frame:EI.TEXT_SHARE_BLUE});t.setWorldSize(53,9),this.add(t),Phaser.Display.Align.In.Center(t,this,9)},e}(Ys.default),bI=gs.default.DEFAULT,TI=bI.KEY,wI=bI.FRAME,CI=function(t){function e(e){var n;return(n=t.call(this,e,TI,wI.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Home"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:TI,frame:wI.ICON_HOME});t.setWorldSize(31,28),this.add(t),Phaser.Display.Align.In.Center(t,this,.5,-2)},e}(Ys.default),MI=CI,II=gs.default.DEFAULT,PI=II.KEY,kI=II.FRAME,RI=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).payload=void 0,i.background=void 0,i.avatar=void 0,i.rankIcon=void 0,i.rankText=void 0,i.username=void 0,i.textTime=void 0,i.createBackground(),i.updateSize(),i.createRank(),i.createUsername(),i.createTimeBlock(),n&&i.updateInfo(n),i.scene.add.existing((0,ls.default)(i)),i}(0,Kt.default)(e,t);var n=e.prototype;return n.updateInfo=function(t){this.payload=(0,wt.default)({backgroundFrame:""},t),this.updateBackground(),this.updateRank(),this.updateUsername(),this.updateTime()},n.createBackground=function(){this.background=this.scene.make.image({key:PI,frame:kI.DAILY_BG_ITEM_DARK}),this.background.setWorldSize(254,38),this.add(this.background)},n.updateBackground=function(){var t=this.payload.backgroundFrame;this.background.setVisible(!0),this.background.setFrame(t||kI.DAILY_BG_ITEM_DARK),this.background.setWorldSize(254,38)},n.updateSize=function(){var t=this.background,e=t.width,n=t.height;this.setSize(e,n)},n.createRank=function(){this.createRankIcon(1),this.createRankText(1)},n.updateRank=function(){var t=this.payload.rank;if(t<0)return this.rankIcon.setVisible(!1),this.rankText.setVisible(!0),void this.rankText.setText("99+");this.updateRankIcon(t),this.updateRankText(t)},n.createRankIcon=function(t){var e=this.getRankIconFrame(t);this.rankIcon=this.scene.make.image({key:PI,frame:e}),this.rankIcon.setWorldSize(28,24),this.add(this.rankIcon),Phaser.Display.Align.In.LeftCenter(this.rankIcon,this.background,-15)},n.getRankIconFrame=function(t){var e=kI.ICON_CUP_GOLD;switch(t){case 1:e=kI.ICON_CUP_GOLD;break;case 2:e=kI.ICON_CUP_SILVER;break;case 3:e=kI.ICON_CUP_COPPER}return e},n.updateRankIcon=function(t){if(t<=3){this.rankText.setVisible(!1),this.rankIcon.setVisible(!0);var e=this.getRankIconFrame(t);this.rankIcon.setFrame(e)}else this.rankText.setVisible(!0).setText(String(t)),this.rankIcon.setVisible(!1)},n.createRankText=function(t){this.rankText=this.scene.make.bitmapText({font:Hs.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(32),text:""+t,origin:{x:.5,y:.5}}),this.add(this.rankText),Phaser.Display.Align.In.Center(this.rankText,this.rankIcon,0,1)},n.updateRankText=function(t){t<=3?this.rankText.setVisible(!1):(this.rankText.setVisible(!0),this.rankText.setText(""+t),this.rankText.setFont(Hs.default.NUMBER_DARK.KEY))},n.getShortName=function(t){var e=t.substring(0,7);return e.split(" ")[0]||e},n.createUsername=function(){this.username=this.scene.make.text({text:this.getShortName("Sang Le"),style:{fontFamily:Hs.default.FONT_FAMILY_ARIAL,fontSize:this.scene.fontSize(36)+"px",fontStyle:"700"}}),this.username.setTint(7551258),this.add(this.username),Phaser.Display.Align.In.Center(this.username,this.background,-44)},n.updateUsername=function(){var t=this.payload.name;this.username.setText(this.getShortName(t)),this.username.setTint(7551258)},n.createTimeBlock=function(){var t=this.scene.make.container({}),e=this.scene.make.image({key:PI,frame:kI.DAILY_BG_TIME});e.setWorldSize(85,24),t.add(e);var n=this.scene.make.image({key:PI,frame:kI.ICON_CLOCK});n.setWorldSize(17,17),t.add(n),Phaser.Display.Align.In.LeftCenter(n,e,-5),this.textTime=this.scene.make.bitmapText({font:Hs.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(27),text:"0",origin:{x:.5,y:.5}}),t.add(this.textTime),Phaser.Display.Align.In.Center(this.textTime,e,10,1.5),this.add(t),Phaser.Display.Align.In.Center(t,this.background,70)},n.updateTime=function(){var t=this.payload.score;this.textTime.setText(this.secondsToHms(t))},n.secondsToHms=function(t){var e,n,i,a=Math.round(t/1e3%60),r=Math.floor(t/6e4%60),o=Math.floor(t/36e5%24);return s()(e="0"+o).call(e,-2)+":"+s()(n="0"+r).call(n,-2)+":"+s()(i="0"+a).call(i,-2)},e}(Phaser.GameObjects.Container),OI=RI;function _I(t,e){var n="undefined"!==typeof Cc()&&Ic()(t)||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){var n;if(!t)return;if("string"===typeof t)return DI(t,e);var i=s()(n=Object.prototype.toString.call(t)).call(n,8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return a()(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return DI(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function DI(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var LI=gs.default.DEFAULT,BI=LI.KEY,FI=LI.FRAME,NI=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.scroller=void 0,n.scrollerValue=void 0,n.tweenMoveToRank=void 0,n.scene=e,n.createReuseScroller(),n.scene.add.existing((0,ls.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createReuseScroller=function(){this.scroller=new fp(this.scene,{classType:OI,listConfigs:[],width:260,height:190,padding:0,marginTop:0,marginBottom:0}),this.scene.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer&&this.scroller.createBound(BI,FI.BLANK,40,16643027),this.scroller.createMask(),this.scroller.setPosition(0,70),this.add(this.scroller)},n.updateData=function(t,e){var n=[],i=0;if(!(t.length<1)){for(var a,r=Na()(t).call(t,(function(t,e){return+t.score-+e.score})),s=window.game.player.getPlayer().playerId,o=0,h=_I(r);!(a=h()).done;){var c=a.value,l=c.playerId,u=c.score,d=c.name;i++;var p=FI.DAILY_BG_ITEM_LIGHT;i%2==0&&(p=FI.DAILY_BG_ITEM_DARK);var f={playerId:l,name:d,score:u,rank:i,backgroundFrame:p};n.push(f),l==s&&(o=i),e&&e==l&&this.runTweenMoveToRank(i)}if(this.scroller.updateConfig(n),!e){var g=this.scroller.getChildren()[0].height;this.scroller.value=-g*this.showDefaultRank(o)}this.showLeaders()}},n.showDefaultRank=function(t){return t<3?0:t-3},n.runTweenMoveToRank=function(t){var e=this,n=this.scroller.getChildren()[0].height;this.scrollerValue=-n*(t-3),this.tweenMoveToRank=this.scene.tweens.addCounter({from:this.scroller.value,to:this.scrollerValue,duration:1e3,onUpdate:function(t){e.scroller.value=t.getValue()}}),this.scene.time.delayedCall(2500,(function(){1!=t&&2!=t||(e.scroller.value=0)}))},n.removeLeaders=function(){this.scroller.updateConfig([])},n.getLeaders=function(){return this.scroller.getChildren()},n.showLeaders=function(){var t=this,e=this.getLeaders();if(!(e.length<1)){for(var n=Math.min(e.length,6),i=0;i<n;i++){var a=e[i];a&&a.setVisible(!0)}var r=300+100*n+250;this.scene.time.delayedCall(r,(function(){t.scroller.setEnable(!0)}))}},n.getTestData=function(){return[{playerId:"001",name:"A",score:"001",rank:1},{playerId:"002",name:"B",score:"002",rank:2},{playerId:"003",name:"C",score:"003",rank:3},{playerId:"004",name:"D",score:"004",rank:4},{playerId:"005",name:"E",score:"005",rank:5},{playerId:"006",name:"F",score:"006",rank:6},{playerId:"007",name:"G",score:"007",rank:7}]},e}(Phaser.GameObjects.Container),GI=NI;function UI(t,e){var n="undefined"!==typeof Cc()&&Ic()(t)||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){var n;if(!t)return;if("string"===typeof t)return VI(t,e);var i=s()(n=Object.prototype.toString.call(t)).call(n,8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return a()(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return VI(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function VI(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var YI=gs.default.DEFAULT,zI=YI.KEY,HI=YI.FRAME,WI=function(t){function e(e,n,i,a){var r;return(r=t.call(this,e,n,i,a)||this).scene=void 0,r.popup=void 0,r.title=void 0,r.buttonHome=void 0,r.buttonShare=void 0,r.contents=void 0,r.avatar=void 0,r.listLeaderItem=[],r.loading=void 0,r.backgroundContent=void 0,r.popupShowUpAnimation=void 0,r.popupFadeOutAnimation=void 0,r.contentShowUpAnimation=void 0,r.popupFadeInMaskAnimation=void 0,r.popupFadeOutMaskAnimation=void 0,r.buttonClose=void 0,r.leaderItems=void 0,r.scene=e,r.createPopup(),r.createScroller(),r.createContentBackground(),r.createAvatar(),r.createTitle(),r.createButtons(),r.createLeaderBoard(),r.createLoading(),r.handleStateChange(),r.setDepth(Gs),r.background.setAlpha(.5),r}(0,Kt.default)(e,t);var n=e.prototype;return n.createScroller=function(){this.leaderItems=new GI(this.scene),this.popup.add(this.leaderItems),Phaser.Display.Align.In.Center(this.leaderItems,this.popup,0,36)},n.handleStateChange=function(){var t=this;[{selector:mI,callback:function(e){if(t.loading.setVisible(!0),t.leaderItems.setVisible(!1),!1===e){var n=t.getLeadersData();t.loading.setVisible(!1),t.leaderItems.setVisible(!0),t.leaderItems.updateData(n)}}}].forEach((function(e){var n=e.selector,i=e.callback;t.scene.storage.watch(n,i)}))},n.updateLeaderItems=function(){var t=window.game.player.getPlayer(),e=t.playerId,n=t.name,i=this.getLeadersData(),a=sx()(i).call(i,(function(t){return t.playerId===e}));a&&(i=c()(i).call(i,(function(t){return t.playerId!=e})));var r=this.scene.game.storage.getState(),s=yI(r);if(!(s>((null==a?void 0:a.score)||86399e3))){var o=this.checkRankByScore((null==a?void 0:a.score)||86399e3,i),h=this.checkRankByScore(s,i),l={playerId:e,name:n,score:s,rank:-1};i.push(l);var u=new OI(this.scene);u.updateInfo(l),this.popup.add(u),Phaser.Display.Align.In.Center(u,this.popup,0,85),this.leaderItems.updateData(i,e),this.scene.tweens.addCounter({from:o,to:h,duration:1300,onUpdate:function(t){var e=Math.floor(t.getValue());u.payload.rank=e,u.updateRank()}}),this.scene.time.delayedCall(2500,(function(){u.setVisible(!1)}))}},n.checkRankByScore=function(t,e){return c()(e).call(e,(function(e){return e.score<t})).length+1},n.getLeaderDefaultData=function(){var t=[],e=this.scene.game.storage.getState(),n=this.scene.player.getPlayer(),i=yI(e);t.push({playerId:n.playerId,name:n.name,score:i,rank:1});for(var a=0;a<4;a++)t.push({playerId:"???-"+a,name:"???",score:0,rank:a+2});return t},n.getLeadersData=function(){var t=this.scene.game.storage.getState(),e=vI(t),n=[];if(e&&0!==Y()(e).length){var i=Ba()(e)||[];if(i.length<1)return this.getLeaderDefaultData();for(var a,r=UI(Na()(i).call(i,(function(t,e){return+t.score-+e.score})));!(a=r()).done;){var s=a.value;n.push(s)}}else n=this.getLeaderDefaultData();return n},n.open=function(){t.prototype.open.call(this),this.loadAvatar(),this.runOpenAnimation()},n.createPopup=function(){this.popup=new uo(this.scene,0,20,290,515,{forceHeightTop:54}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,-20)},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:zI,frame:HI.DAILY_BACKGROUND}),this.backgroundContent.setWorldSize(258,132),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-86)},n.createAvatar=function(){this.avatar=new bl(this.scene,{key:zI,frame:HI.AVATAR_BORDER,background:HI.AVATAR_BACKGROUND,width:70,height:70,radius:10,borderWidth:10}),this.popup.add(this.avatar),Phaser.Display.Align.In.Center(this.avatar,this.backgroundContent,71,-10)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:zI,frame:HI.TEXT_RESULT});t.setWorldSize(132,21),this.buttonClose=new Ys.default(this.scene,zI,HI.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickButtonClose.bind(this),this.title.add([t,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title,0,20),Phaser.Display.Align.In.Center(this.buttonClose,this.title,135,0),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,-30)},n.clickButtonClose=function(){this.runCloseAnimation(),this.scene.storage.dispatch(Yd(!0)),this.scene.screen.open(ws)},n.createButtons=function(){this.createButtonShare(),this.createButtonHome()},n.createLeaderBoard=function(){this.createLeaderPanel(),this.createLeaderBorder()},n.createLoading=function(){this.loading=new El(this.scene),this.popup.add(this.loading),Phaser.Display.Align.In.Center(this.loading,this.popup,0,110)},n.createLeaderPanel=function(){var t=this.scene.make.container({}),e=this.scene.make.image({key:zI,frame:HI.DAILY_TITLE_PANEL});e.setWorldSize(143,35),t.add(e),Phaser.Display.Align.In.TopCenter(e,t);var n=this.scene.make.image({key:zI,frame:HI.TEXT_RANKING});n.setWorldSize(100,15),t.add(n),Phaser.Display.Align.In.Center(n,e),this.popup.add(t),Phaser.Display.Align.In.Center(t,this.popup,0,-23)},n.createLeaderBorder=function(){var t=this.scene.make.container({}),e=this.scene.make.image({key:zI,frame:HI.DAILY_BORDER_TOP});e.setWorldSize(260,15),t.add(e);var n=this.scene.make.image({key:zI,frame:HI.DAILY_BORDER_MIDDLE});n.setWorldSize(260,180),t.add(n),Phaser.Display.Align.In.Center(n,e,0,90);var i=this.scene.make.image({key:zI,frame:HI.DAILY_BORDER_BOTTOM});i.setWorldSize(260,15),t.add(i),Phaser.Display.Align.In.Center(i,n,0,90),this.popup.add(t),Phaser.Display.Align.In.Center(t,this.popup,0,17)},n.createButtonShare=function(){this.buttonShare=new xI(this.scene),this.buttonShare.onClick=this.clickButtonShare.bind(this),this.popup.add(this.buttonShare),Phaser.Display.Align.In.Center(this.buttonShare,this.backgroundContent,7,43)},n.clickButtonShare=function(){this.scene.storage.dispatch(xu())},n.createButtonHome=function(){this.buttonHome=new MI(this.scene),this.popup.add(this.buttonHome),this.buttonHome.onClick=this.clickButtonHome.bind(this),Phaser.Display.Align.In.BottomCenter(this.buttonHome,this.popup,0,10)},n.clickButtonHome=function(){var t=this;this.runCloseAnimation(),this.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function e(){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.scene.scene.switch(is.SceneKeys.DASHBOARD_SCENE);case 1:case"end":return e.stop()}}),e)}))))},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Vs.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new so({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new io({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new $s({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Tc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new $s({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},n.loadAvatar=function(){var t=this.scene.player.getPlayer(),e=t.playerId,n=t.photo;this.avatar.loadPhoto(e,n)},e}(GameCore.Screen),XI=GameCore.Configs,KI=XI.OtherHost,jI=XI.DailyChallenge,qI=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,je("leaderboards/"+jI.LeaderBoardId+"/players/"+e,{score:n},{},KI);case 2:return i=t.sent,t.abrupt("return",(null==i?void 0:i.data)||{});case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),ZI=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,r,s;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=[],a=jI.Prefix+"/"+jI.LeaderBoardId+"/leaders"){t.next=4;break}return t.abrupt("return",i);case 4:return t.next=6,Ke(a+"?limit="+e+"&offset="+n,{},KI);case 6:if(r=t.sent,!((s=(null==r?void 0:r.data)||[]).length<1)){t.next=10;break}return t.abrupt("return",i);case 10:return i=s,t.abrupt("return",i);case 12:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();function JI(t,e){var n="undefined"!==typeof Cc()&&Ic()(t)||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){var n;if(!t)return;if("string"===typeof t)return QI(t,e);var i=s()(n=Object.prototype.toString.call(t)).call(n,8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return a()(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return QI(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function QI(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var $I,tP=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n){var i,a,r,s,o;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=t.time,a=t.limit,r=t.offset,s=window.game.player,o=s.getPlayerId(),n({type:hr,payload:{}}),n(iP(i)),e.next=8,qI(o,i);case 8:return e.next=10,(0,Ge.sleepAsync)(500);case 10:n(eP({limit:a,offset:r})),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),(0,Ht.sendException)(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}()},eP=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n){var i,a,r,s,o,h,c,l,u,d,p,f,g,m,v,y,S,A,E;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n({type:hr,payload:{}}),i=t.limit,a=t.offset,r=window.game,s=r.player,o=r.profile,h=s.getPlayerId(),s.getConnectedPlayerIds(5,0).push(h),e.next=9,ZI(i,a);case 9:return c=e.sent,l=De()(c).call(c,(function(t){return t.playerId})),l.push(s.getPlayerId()),e.next=14,o.requestProfiles(l);case 14:u=o.getProfiles(),d={},p=JI(c);case 17:if((f=p()).done){e.next=26;break}if(g=f.value,m=g.playerId,v=g.score,y=g.rank,u[m]){e.next=22;break}return e.abrupt("continue",24);case 22:S=u[m],A=S.name,E=S.photo,d[m]={playerId:m,name:A,photo:E,score:v,rank:y};case 24:e.next=17;break;case 26:n(nP(d)),e.next=33;break;case 29:e.prev=29,e.t0=e.catch(0),n(nP([])),(0,Ht.sendException)(e.t0);case 33:case"end":return e.stop()}}),e,null,[[0,29]])})));return function(t){return e.apply(this,arguments)}}()},nP=function(t){return{type:cr,payload:{leaders:t}}},iP=function(t){return{type:lr,payload:{time:t}}},aP=gs.default.DEFAULT,rP=aP.KEY,sP=aP.FRAME,oP=gs.default.GAMEPLAY,hP=oP.KEY,cP=oP.FRAME,lP=gs.default.GAMEPLAY_32,uP=lP.KEY,dP=lP.FRAME,pP=GameCore.Configs,fP=pP.Network,gP=pP.Board,mP=function(t){function e(e,n,i,a){var r;(r=t.call(this,e,n,i,a)||this).scene=void 0,r.popup=void 0,r.title=void 0,r.buttonClose=void 0,r.contents=void 0,r.buttonPlay=void 0,r.boardCellData=[],r.targetData=[],r.popupShowUpAnimation=void 0,r.popupFadeOutAnimation=void 0,r.contentShowUpAnimation=void 0,r.popupFadeInMaskAnimation=void 0,r.popupFadeOutMaskAnimation=void 0,r.clickClose=function(){r.runCloseAnimation(),r.popupFadeOutAnimation.next((function(){var t=r.getData(["onClose"])[0];r.scene.screen.close(r.name),r.scene.scene.switch(is.SceneKeys.DASHBOARD_SCENE),t&&t()}))},r.decodeMathData=function(t){try{return JSON.parse(GameCore.Utils.Hash.hashToString(t))}catch(e){return""}},r.scene=e;try{r.createPopup(),r.createTitle(),r.createTargetItems(),r.createBoard(),r.createButtonPlay(),r.setDepth(Gs),r.background.setAlpha(.5)}catch(s){}return r}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){var e=(0,Xt.default)(qt().mark((function e(n){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.prototype.open.call(this,n),e.next=3,this.checkReceiveLevelFromFb();case 3:this.loadLevelConfig();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.startGame=function(){this.runOpenAnimation(),this.updateContent(),this.popup.setVisible(!0)},n.loadLevelConfig=function(){try{var t=this.scene.storage.getState(),e=lu(t),n=qu[e];if(!n)return void this.handleLoadCurrentMapComplete();var i=n.key,a=n.mapJson;if(this.scene.cache.tilemap.exists(i))return void this.handleLoadCurrentMapComplete();this.scene.load.tilemapTiledJSON(i,a),this.scene.load.start(),this.scene.load.off(Phaser.Loader.Events.COMPLETE),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this))}catch(r){(0,Ht.sendException)(r)}},n.handleLoadCurrentMapComplete=function(){this.hideLoadingScreen(),this.startGame()},n.updateContent=function(){this.resetTarget(),this.drawTargetItems(),this.resetCellBoard(),this.updateCellBoard()},n.checkReceiveLevelFromFb=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=this.scene.storage.getState(),!lu(e)){t.next=5;break}return t.abrupt("return");case 5:return this.showLoadingScreen(),t.next=8,this.scene.storage.dispatch(Rd());case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 13:case"end":return t.stop()}}),t,this,[[0,10]])})));return function(){return t.apply(this,arguments)}}(),n.showLoadingScreen=function(){this.scene.game.globalScene.screen.open(vs,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",duration:fP.Timeout,loading:!0})},n.hideLoadingScreen=function(){this.scene.game.globalScene.screen.close(vs)},n.createPopup=function(){this.popup=new uo(this.scene,0,-7,286,373),this.popup.setVisible(!1),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,10)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:rP,frame:sP.TEXT_JOURNEY});t.setWorldSize(143.5,16.5),this.buttonClose=new Ys.default(this.scene,rP,sP.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickClose,this.title.add([t,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title),Phaser.Display.Align.In.Center(this.buttonClose,this.title,138.5,-19.5),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,7)},n.createTargetItems=function(){var t=this.scene.make.image({key:rP,frame:sP.TEXT_COLLECT});t.setWorldSize(85,13);var e=this.scene.make.image({key:rP,frame:sP.WOOD_PANEL});e.setWorldSize(200,37),this.popup.add([t,e]),Phaser.Display.Align.In.Center(t,this.popup,0,-155),Phaser.Display.Align.In.Center(e,this.popup,0,-125)},n.drawTargetItems=function(){var t,e,n=this.scene.storage.getState(),i=lu(n),a=qu[i],r=this.scene.make.tilemap({key:a.key}).properties;if(r&&(0,Gv.isArray)(r)&&!(r.length<2))for(var s=r[0].value,o=Tv()(t=Tv()(e=Tv()(s).call(s,"{",'{"')).call(e,", ",', "')).call(t,":",'":'),h=JSON.parse(o),c=Y()(h),l=this.calcPosition(c.length),u=0;u<c.length;u++){var d=c[u],p=MS[d],f=h[d],g=this.targetData[u];g||(g=this.spawnTargetItem(p,f));var m=g,v=m.container,y=m.text,S=m.gem;v.setVisible(!0),y.setText("x"+f),S.setFrame(p),this.targetData.push(g),Phaser.Display.Align.In.Center(v,this.popup,l[u],-130)}},n.spawnTargetItem=function(t,e){var n=this.scene.make.container({}),i=this.scene.make.image({key:uP,frame:t});i.setWorldSize(15,15);var a=this.scene.make.bitmapText({font:Hs.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5},text:"x"+e});return n.add([i,a]),Phaser.Display.Align.In.Center(a,n,0,15),this.popup.add(n),{container:n,gem:i,text:a}},n.calcPosition=function(t){for(var e=[],n=150/(t+1),i=n*(t-1)/2,a=0;a<t;a++)e.push(n*a-i);return e},n.createBoard=function(){var t=this.scene.make.image({key:hP,frame:cP.BOARD});t.setWorldSize(200,184),this.popup.add(t),Phaser.Display.Align.In.Center(t,this.popup,0,-12),this.initCellBoard()},n.initCellBoard=function(){for(var t=0;t<gP.rows;t++){this.boardCellData[t]=[];for(var e=0;e<gP.cols;e++){var n=20*e-86.5+1.65*e,i=19*t-92+1*t,a=dP.GEM_TRANSPARENT,r=this.spawnCellBoard(a,n,i);this.boardCellData[t].push(r)}}},n.updateCellBoard=function(){var t=this.scene.storage.getState(),e=hu(t).data.fen;if(e){var n=e.split("l")[0];this.drawBoardByFen(n)}else this.drawBoardByMap()},n.resetTarget=function(){for(var t=0;t<this.targetData.length;t++){var e,n;null==(e=this.targetData[t])||null==(n=e.container)||n.setVisible(!1)}},n.resetCellBoard=function(){for(var t=0;t<gP.rows;t++)for(var e=0;e<gP.cols;e++){this.boardCellData[t][e].setFrame(dP.GEM_TRANSPARENT)}},n.drawBoardByFen=function(t){for(var e=$p()(t).call(t).split("/"),n=0;n<e.length;n++)for(var i=e[n].split(","),a=0;a<i.length;a++){var r=i[a];if("x"!==r){var s=HS(r);this.boardCellData[n][a].setFrame(s)}}},n.drawBoardByMap=function(){var t=this.scene.storage.getState(),e=lu(t),n=qu[e],i=this.scene.make.tilemap({key:n.key}).layers;if((0,Gv.isArray)(i)){var a=i[0].data;if((0,Gv.isArray)(a))for(var r=0;r<a.length;r++)for(var s=a[r],o=0;o<s.length;o++){var h=s[o];if(!(h.index<0)){var c=MS[h.index-1];this.boardCellData[r][o].setFrame(c)}}}},n.spawnCellBoard=function(t,e,n){var i=this.scene.make.image({key:uP,frame:t});return i.setWorldSize(20,19),this.popup.add(i),Phaser.Display.Align.In.Center(i,this.popup,e,n),i},n.createButtonPlay=function(){this.buttonPlay=new Ys.default(this.scene,rP,sP.BUTTON_GREEN_BIG,118,50),this.buttonPlay.setName("Play"),this.buttonPlay.onClick=this.handlePlay.bind(this);var t=this.scene.make.image({key:rP,frame:sP.TEXT_PLAY});t.setWorldSize(65,15);var e=this.scene.make.image({key:rP,frame:sP.ICON_I_PLAY});e.setWorldSize(20,26),this.buttonPlay.add([t,e]),Phaser.Display.Align.In.Center(t,this.buttonPlay,16,-2),Phaser.Display.Align.In.Center(e,this.buttonPlay,-28,-2),this.popup.add(this.buttonPlay),Phaser.Display.Align.In.Center(this.buttonPlay,this.popup,0,111)},n.handlePlay=function(){var t=this;this.runCloseAnimation(),this.popupFadeOutAnimation.next((function(){t.scene.screen.close(t.name);var e=t.scene.storage.getState(),n=lu(e);t.scene.storage.dispatch(Od()),n>qu.length||(t.scene.analytics.levelStart(n,void 0,t.getLevelName(n)),t.scene.storage.dispatch(Wd()),t.scene.handleRetryLevel())}))},n.getLevelName=function(t){var e;return"journey_"+fs()(e=GameCore.Utils.Number).call(e,t,4,"0")},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Vs.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new so({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new io({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new $s({targets:[this.popup],delay:t,duration:e,props:{scale:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.popup.setVisible(!1)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Tc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new $s({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),vP=gs.default.DEFAULT,yP=vP.KEY,SP=vP.FRAME,AP=function(t){function e(e,n,i,a){var r;return(r=t.call(this,e,n,i,a)||this).scene=void 0,r.popup=void 0,r.title=void 0,r.contents=void 0,r.backgroundContent=void 0,r.textTargetScore=void 0,r.textScore=void 0,r.titleFrame=void 0,r.popupShowUpAnimation=void 0,r.popupFadeOutAnimation=void 0,r.contentShowUpAnimation=void 0,r.popupFadeInMaskAnimation=void 0,r.popupFadeOutMaskAnimation=void 0,r.handleClose=function(){r.runCloseAnimation()},r.scene=e,r.createPopup(),r.createTitle(),r.createContentBackground(),r.createTextTargetScore(),r.createTextScore(),r.addItem(),r.setDepth(Gs),r.background.setAlpha(.5),r}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(e){var n=this;t.prototype.open.call(this,e);var i=this.scene.targetMissionManager.getTargetValue();this.textScore.setText(""+i);var a=this.getData(["duration"])[0];this.runOpenAnimation(),this.scene.time.delayedCall(a,(function(){n.handleClose()}))},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:yP,frame:SP.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(263,135),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-24)},n.createTextTargetScore=function(){this.textTargetScore=this.scene.make.bitmapText({font:Hs.default.PRIMARY.KEY,size:this.scene.fontSize(50),text:"\u0426\u0435\u043b\u0435\u0432\u043e\u0439 \u0441\u0447\u0435\u0442",origin:{x:.5,y:.5}}),this.popup.add(this.textTargetScore),Phaser.Display.Align.In.Center(this.textTargetScore,this.backgroundContent,0,-30)},n.createTextScore=function(){this.textScore=this.scene.make.bitmapText({font:Hs.default.PRIMARY.KEY,size:this.scene.fontSize(80),text:"0",origin:{x:.5,y:.5}}),this.popup.add(this.textScore),Phaser.Display.Align.In.Center(this.textScore,this.backgroundContent,0,15)},n.createPopup=function(){this.popup=new uo(this.scene,0,-19,290,218,{forceHeightTop:55}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createTitle=function(){this.title=this.scene.add.container(),this.titleFrame=this.scene.make.image({key:yP,frame:SP.TEXT_MISSION}),this.titleFrame.setWorldSize(105,21),this.title.add([this.titleFrame]),this.popup.add(this.title),Phaser.Display.Align.In.Center(this.titleFrame,this.title,0,-10),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Vs.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new so({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new io({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new $s({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.scene.startGameAfterCollectionItemsScreenClose()}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Tc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new $s({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),EP=AP,xP=gs.default.DEFAULT,bP=xP.KEY,TP=xP.FRAME,wP=function(){function t(t){this.scene=void 0,this.x=void 0,this.y=void 0,this.background=void 0,this.text=void 0,this.tweenStep1=void 0,this.tweenStep2=void 0,this.tweenStep3=void 0,this.tweenStep4=void 0,this.tweenStep5=void 0,this.tweenStep6=void 0,this.tweenTextStep1=void 0,this.tweenTextStep2=void 0,this.tweenTextStep5=void 0,this.tweenTextStep6=void 0,this.scene=t,this.init()}var e=t.prototype;return e.init=function(){this.createBackground(),this.createText(),this.createTween()},e.createBackground=function(){this.background=this.scene.make.image({key:bP,frame:TP.BG_STREAK}),this.background.setWorldSize(106,38),this.background.setVisible(!1)},e.createText=function(){this.text=this.scene.make.bitmapText({font:Hs.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(50),origin:{x:.5,y:.5},text:"3X \u041a\u041e\u041c\u0411\u041e!"}),this.text.setVisible(!1)},e.createTween=function(){var t=this,e=this.background.scale+.3;this.tweenStep1=this.scene.tweens.add({targets:[this.background],duration:100,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{start:0,from:0,to:e}},paused:!0,onComplete:function(){t.tweenStep2.play()}}),this.tweenTextStep1=this.scene.tweens.add({targets:[this.text],duration:200,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{start:.3,from:.3,to:1.4}},paused:!0,onComplete:function(){t.tweenTextStep2.play()}}),this.tweenStep2=this.scene.tweens.add({targets:[this.background],duration:200,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:e,to:e-.3}},paused:!0,onComplete:function(){t.tweenStep3.play()}}),this.tweenTextStep2=this.scene.tweens.add({targets:[this.text],duration:100,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:1.4,to:1}},paused:!0,onComplete:function(){t.tweenTextStep5.play()}}),this.tweenStep3=this.scene.tweens.addCounter({from:0,to:20,paused:!0,duration:533,ease:Phaser.Math.Easing.Sine.InOut,onUpdate:function(e){var n=e.getValue();t.text.setPosition(t.x,t.y-n),t.background.setPosition(t.x,t.y-n)},onComplete:function(){t.y=t.y-20,t.tweenStep4.play()}}),this.tweenStep4=this.scene.tweens.addCounter({from:0,to:5,paused:!0,duration:333,ease:Phaser.Math.Easing.Sine.InOut,onUpdate:function(e){var n=e.getValue();t.text.setPosition(t.x,t.y+n),t.background.setPosition(t.x,t.y+n)},onComplete:function(){t.y=t.y+5,t.tweenStep5.play(),t.tweenTextStep5.play()}}),this.tweenStep5=this.scene.tweens.add({targets:[this.background],delay:567,duration:67,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:e-.3,to:e}},paused:!0,onComplete:function(){t.tweenStep6.play()}}),this.tweenTextStep5=this.scene.tweens.add({targets:[this.text],delay:467,duration:133,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:1,to:.8}},paused:!0,onComplete:function(){t.tweenTextStep6.play()}}),this.tweenStep6=this.scene.tweens.add({targets:[this.background],duration:200,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:e,to:0}},paused:!0,onComplete:function(){t.text.setVisible(!1),t.background.setVisible(!1),t.text.setScale(0),t.background.setScale(0)}}),this.tweenTextStep6=this.scene.tweens.add({targets:[this.text],duration:167,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:.8,to:1.7},alpha:{from:1,to:0}},paused:!0,onComplete:function(){t.text.setVisible(!1),t.text.setScale(0)}})},e.playAnim=function(t,e){(this.tweenTextStep1.isPlaying()||this.tweenTextStep2.isPlaying()||this.tweenTextStep5.isPlaying()||this.tweenTextStep6.isPlaying())&&(this.tweenTextStep1.stop(),this.tweenTextStep2.stop(),this.tweenTextStep5.stop(),this.tweenTextStep6.stop(),this.text.setScale(0),this.text.setVisible(!1),this.background.setScale(0),this.background.setVisible(!1)),this.x=t,this.y=e,this.text.setScale(0).setAlpha(1),this.background.setScale(0),this.text.setPosition(t,e),this.background.setPosition(t,e),this.text.setVisible(!0),this.tweenTextStep1.play()},e.setTextCombo=function(t){this.text.setText(t+"X \u041a\u041e\u041c\u0411\u041e!")},e.setTextStreak=function(t){this.text.setText(t+"X \u041f\u041e\u041b\u041e\u0421\u0410!")},e.setBgFrame=function(t){this.background.setFrame(t)},t}(),CP=function(){function t(t){this.scene=void 0,this.streakBreak=void 0,this.scene=t,this.init()}return t.prototype.init=function(){this.streakBreak=new wP(this.scene)},t}(),MP=GameCore.Configs,IP=MP.Board,PP=MP.Network,kP=gs.default.GAMEPLAY_32.FRAME,RP=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).lastTimeInputEnabled=0,n.tutorialManager=void 0,n.levelManager=void 0,n.mapManager=void 0,n.targetMissionManager=void 0,n.effectManager=void 0,n.header=void 0,n.main=void 0,n.footer=void 0,n.isGameOver=void 0,n.isLevelComplete=void 0,n.restartCurrentLevel=0,n.startGameAt=void 0,n.run=function(){var t=n.storage.getState();!0!==Rl(t)&&n.storage.dispatch(Yd(!0)),n.updateCurrentBestScore(),n.preloadNextLevel(),n.startGame(),n.analytics.levelStart(n.levelManager.getLevel(),void 0,n.getLevelName())},n.create=function(){t.prototype.create.call((0,ls.default)(n)),n.createBackground(zr.default.BACKGROUND.KEY),n.createTutorialManager(),n.createLevelManager(),n.createMapManager(),n.createTargetMissionManager(),n.createHeader(),n.createMain(),n.createFooter(),n.createEffectManager(),n.createScreens(),n.createInput(),n.input.setTopOnly(!0),n.preLoadAds()},n.handlePauseGame=function(){n.isGameOver||n.isLevelComplete||(0,ls.default)(n).screen.open(Ss)},n.handleShowInterstitialAd=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n.audio.pauseMusic(),n.ads.canbeShowInterstitialAd()){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,n.ads.showInterstitialAdAsync();case 6:n.analytics.showInterstitialAd(n.getSceneName()),t.next=12;break;case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return");case 12:return t.prev=12,n.audio.playMusic(),n.ads.preloadInterstitialAdAsync().catch(Ht.sendException),n.audio.playMusic(),t.finish(12);case 17:case"end":return t.stop()}}),t,null,[[0,9,12,17]])}))),n}(0,Kt.default)(e,t);var n=e.prototype;return n.preload=function(){this.events.on(Phaser.Scenes.Events.WAKE,this.run),this.events.on(Phaser.Scenes.Events.CREATE,this.run)},n.preLoadAds=function(){this.ads.preloadInterstitialAdAsync().catch((function(t){})),this.ads.preloadRewardedVideoAsync().catch((function(t){}))},n.createHeader=function(){this.header=new mC(this),Phaser.Display.Align.In.TopCenter(this.header,this.gameZone)},n.createTutorialManager=function(){this.tutorialManager=new fI(this)},n.createLevelManager=function(){this.levelManager=new rM(this)},n.createMapManager=function(){this.mapManager=new sM(this)},n.createEffectManager=function(){this.effectManager=new CP(this)},n.createTargetMissionManager=function(){this.targetMissionManager=new oM},n.createMain=function(){this.main=new Lw(this)},n.createFooter=function(){this.footer=new aM(this),Phaser.Display.Align.In.BottomCenter(this.footer,this.gameZone)},n.createInput=function(){this.isGameOver||(this.header.buttonSetting.onClick=this.handlePauseGame)},n.createScreens=function(){this.createMissionScoreCompleteScreen(),this.createMissionCollectionCompleteScreen(),this.createCollectionCompletedScreen(),this.createNoSpaceLeftScreen(),this.createMissionFailScreen(),this.createSettingScreen(),this.createCollectionItemsScreen(),this.createLeaderboardScreeen(),this.createDailyChallengeModeScreen(),this.createMiniJourneyScreen(),this.createTargetScoreScreen(),this.createClaimHeartScreen()},n.createLeaderboardScreeen=function(){this.screen.add(Ts,kp)},n.createCollectionCompletedScreen=function(){this.screen.add(Os,cM)},n.createMissionScoreCompleteScreen=function(){this.screen.add(Ps,pM)},n.createMissionCollectionCompleteScreen=function(){this.screen.add(ks,vM)},n.createDailyChallengeModeScreen=function(){this.screen.add(Cs,WI)},n.createMissionFailScreen=function(){this.screen.add(Rs,bM)},n.createNoSpaceLeftScreen=function(){this.screen.add(_s,SM)},n.createSettingScreen=function(){this.screen.add(Ss,$M)},n.createCollectionItemsScreen=function(){this.screen.add(Bs,hI)},n.createMiniJourneyScreen=function(){this.screen.add(ws,mP)},n.createTargetScoreScreen=function(){this.screen.add(Fs,EP)},n.createClaimHeartScreen=function(){this.screen.add(Ns,Rb)},n.updateCurrentBestScore=function(){var t=this.player.getBestScore(),e=this.storage.getState(),n=fu(e).bestScore,i=void 0===n?0:n,a=t>i?t:i;this.header.bestScoreBlock.setScoreText(a)},n.openLevelScreen=function(){this.screen.open(Is)},n.handleNextLevel=function(){var t=this.levelManager.getNextLevelConfig();if(t){var e=t.key;this.cache.tilemap.exists(e)?this.handleLoadMapComplete():(this.preloadNextLevel(),this.load.off(Phaser.Loader.Events.COMPLETE),this.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadMapComplete.bind(this)))}},n.handleSwitchJourney=function(){var t=this.levelManager.getLevelConfig();if(t){var e=t.key;this.cache.tilemap.exists(e)?this.handleSwitchMode():(this.preloadCurrentLevel(),this.load.off(Phaser.Loader.Events.COMPLETE),this.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadMapComplete.bind(this)))}},n.handleSwitchMode=function(){var t,e=this.levelManager.getLevel();this.storage.dispatch((t={data:"",level:e,listPieceMap:[]},function(e,n){var i=window.game.player.getPlayerId(),a=n(),r=hu(a),s=(0,wt.default)({},r,t),o=s.data;s.data=md(o),e(xd(s)),Be(gd.JourneyMatchStore+"-"+i,s)})),FBInstant.player.setDataAsync({level:e}),this.mapManager.reloadMap(),this.clearFen()},n.handleLoadMapComplete=function(){this.levelManager.increaseLevel();var t=this.levelManager.getLevel();FBInstant.player.setDataAsync({level:t}),this.mapManager.reloadMap()},n.handleGuideIfLevel1=function(){var t=this.storage.getState();uu(t)||1===this.levelManager.getLevel()&&this.tutorialManager.start()},n.startGame=function(){try{var t;this.isGameOver=!1,this.isLevelComplete=!1,this.mapManager.reloadMap(),null==(t=this.tutorialManager)||t.reset(),this.main.board.clearBoard(),this.footer.pieces.clearPieces(),this.loadTargetByMap(),this.header.start(),this.loadBoardAndPieces(),this.loadTargetAmountByFen(),this.loadTextHeader(),this.restartCurrentLevel=0,this.openMissionScreen()}catch(e){this.handleRestartLevel(),(0,Ht.sendExceptionWithScope)(e,{scene:"Journey scene"})}},n.startGameAfterCollectionItemsScreenClose=function(){var t;this.startGameAt=(new Date).getTime();var e=this.storage.getState(),n=uu(e),i=((null==(t=hu(e))?void 0:t.data)||{}).fen;!i||n?(this.footer.pieces.start(),this.handleGuideIfLevel1()):this.loadPiecesByFen(i)},n.openMissionScreen=function(){switch(this.targetMissionManager.getTargetType()){case Iw:this.openCollectionItemsScreen();break;case Mw:this.openTargetScoreScreen()}},n.openCollectionItemsScreen=function(){var t=this,e=this.header.collectItems.getJsonTarget();this.header.collectItems.hideListCollectItems(),this.disableInput(),this.time.delayedCall(500,(function(){t.enableInput(),t.screen.open(Bs,{jsonTarget:e,duration:1500})}))},n.openTargetScoreScreen=function(){var t=this;this.disableInput(),this.time.delayedCall(500,(function(){t.enableInput(),t.screen.open(Fs,{duration:1500})}))},n.showCollectItems=function(){this.header.collectItems.showListCollectItems()},n.loadBoardAndPieces=function(){var t,e=this.storage.getState(),n=uu(e),i=((null==(t=hu(e))?void 0:t.data)||{}).fen,a=null,r=null;if(i&&!n){var s=this.main.board.getBoardByFen(i);return a=this.handleDynamicFenSize(s),r=this.footer.pieces.getPiecesByFen(i),this.isFenGameOver(a,r)?(this.clearFen(),this.loadBoardByMap(),void this.loadPiecesByMap()):void this.loadBoardByFen(i)}this.loadBoardByMap(),this.loadPiecesByMap()},n.loadBoardByFen=function(t){var e=this.main.board.getBoardByFen(t);this.main.board.startGame(e,t)},n.loadBoardByMap=function(){for(var t=this.mapManager.getTileMap().layers,e=t.length,n=0;n<e;n++)for(var i=t[n].data,a=0;a<i.length;a++)for(var r=i[a],s=0;s<r.length;s++){var o=r[s];if(!(o.index<0)){var h=this.main.board.getFrameByMapItemIndex(o.index-1);h&&h!==kP.GEM_TRANSPARENT||(h=this.main.board.getFrameByMapItemIndex(1),(0,Ht.sendExceptionWithScope)(new Error("MapByBoardError"),{index:o.index,level:this.levelManager.getLevel(),row:a,col:s})),this.main.board.setFrameBoardByIndex(a,s,h)}}this.main.board.fadeIn()},n.loadPiecesByFen=function(t){var e=this.footer.pieces.getPiecesByFen(t);this.footer.pieces.showAvailablePieces(e),this.loadListPieceMapByFen()},n.loadListPieceMapByFen=function(){var t=this.storage.getState(),e=hu(t).listPieceMap;e&&0!==e.length&&this.footer.pieces.setListPieceMap(e)},n.loadPiecesByMap=function(){this.footer.pieces.buildPiecesByMap();var t=this.mapManager.getTileMap().getObjectLayer("spawnOrder");if(t)for(var e=t.objects,n=0;n<e.length;n++){var i=e[n],a=i.type,r=i.properties,s=this.footer.pieces.getPieceDataByType(a);r&&(s=(0,wt.default)({},s,{properties:r})),s&&this.footer.pieces.addItemPieceMap(s)}},n.loadTargetByMap=function(){var t=this.mapManager.getTileMap().properties;if(!t||!(0,Gv.isArray)(t)||t.length<2)throw new tI;var e=t[0].value,n=t[1].value;this.targetMissionManager.setTargetValue(e),this.targetMissionManager.setTargetType(n)},n.loadTargetAmountByFen=function(){var t;this.header.collectItems.resetTextAmount();var e=this.storage.getState();if(!uu(e)){var n=((null==(t=hu(e))?void 0:t.data)||{}).jsonAmount;n&&0!==Y()(n).length&&this.header.collectItems.updateJsonAmountByFen(n)}},n.loadTextHeader=function(){var t=this.storage.getState();if(uu(t))return this.header.bestScoreBlock.showTextDay(),void this.header.bestScoreBlock.setDayText(this.getTextDay());var e=this.levelManager.getLevel();this.header.bestScoreBlock.showTextScore(),this.header.bestScoreBlock.setScoreText(e)},n.getTextDay=function(){var t,e=new Date,n="0"+e.getDate(),i="0"+(e.getMonth()+1),a=s()(t=String(e.getFullYear())).call(t,-2);return s()(n).call(n,-2)+"."+s()(i).call(i,-2)+"."+a},n.getFen=function(){return this.main.board.getFenByBoard()+" "+this.footer.pieces.getFenByPieces()},n.handleRestartLevel=function(){this.restartCurrentLevel>0||(this.game.globalScene.screen.open(vs,{message:"Some thing went wrong. Restart map...",duration:PP.Timeout,loading:!0}),this.restartCurrentLevel++,this.preloadCurrentLevel(),this.load.off(Phaser.Loader.Events.COMPLETE),this.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this)),this.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR),this.load.once(Phaser.Loader.Events.FILE_LOAD_ERROR,this.handleLoadCurrentMapError.bind(this)))},n.handleGameOver=function(){this.isGameOver=!0,this.screen.open(xs)},n.handleRequestFinishGame=function(){var t=this;this.isGameOver=!0,this.clearFen();var e=this.storage.getState();if(uu(e)){var n,i=xT(),a=fs()(n=GameCore.Utils.Number).call(n,i,4,"0");this.analytics.event(ni.AnalyticsEvents.DAILY_CHALLENGE_FAIL,{level:i,levelName:"daily_challenge_"+a})}else this.analytics.levelFail(this.levelManager.getLevel(),void 0,this.getLevelName());this.screen.open(_s,{duration:3e3,onClose:function(){t.handleShowInterstitialAd().catch(Ht.sendException),t.screen.open(Rs)}})},n.checkAnimPlaying=function(){var t=this.tweens.getAllTweens();return!(!t||0===t.length)},n.disableInput=function(){this.input.enabled=!1,this.footer.pieces.allPieces.forEach((function(t){return t.piece.cancelDrag()}))},n.enableInput=function(){this.input.enabled=!0},n.handleUpdateScore=function(t){var e=this.header.mainScoreBlock.score+t;this.storage.dispatch(function(t){return{type:ca,payload:{score:t}}}(e))},n.handleAddScoreAnim=function(t){this.header.mainScoreBlock.animAddScore(t)},n.updateProgressTargetScore=function(t){var e=this.header.progressBar.getTargetScore();this.header.progressBar.setPercent(t/e)},n.handleCompleteScoreMission=function(){this.isGameOver||this.targetMissionManager.getTargetType()!==Mw||(this.header.mainScoreBlock.score<eb()(this.targetMissionManager.getTargetValue())||(this.handleNextLevel(),this.screen.open(Ps)))},n.canUpdateFenMatch=function(){var t=this.storage.getState(),e=uu(t);return!(this.isGameOver||this.isLevelComplete||e)},n.updateMatchData=function(){var t;if(this.canUpdateFenMatch()){var e=this.getFen(),n=this.storage.getState(),i=hu(n).data||{},a=cu(n),r=du(n)||0,s=this.levelManager.getLevel(),o=this.header.collectItems.getJsonAmount(),h=this.footer.pieces.getListPieceMap();this.storage.dispatch(Sd(a,{score:r,data:(0,wt.default)({},i,{fen:e,jsonAmount:(0,wt.default)({},o)}),level:s,updateAt:Date.now(),listPieceMap:et()(t=[]).call(t,h)}))}},n.clearFen=function(){var t=this.storage.getState(),e=cu(t),n=fu(t).score,i=void 0===n?0:n,a=this.levelManager.getLevel();this.storage.dispatch(Sd(e,{score:i,data:{fen:"",jsonAmount:{}},level:a,listPieceMap:[],updateAt:Date.now()}))},n.update=function(t){this.input.enabled||this.checkAnimPlaying()?this.lastTimeInputEnabled=t:t-this.lastTimeInputEnabled>=3e3&&(this.enableInput(),this.lastTimeInputEnabled=t)},n.isFenGameOver=function(t,e){for(var n=[],i=0;i<e.length;i++){var a=e[i],r=a.type,s=a.direction,o=a.isReverse;switch(r){case hy:case cy:case ly:n.push({data:wC.getData(r,s,o)});break;case uy:case dy:case py:case fy:n.push({data:MC.getData(r,s)});break;case gy:case my:case vy:n.push({data:PC.getData(r)});break;case Sy:n.push({data:RC.getData(s)});break;case Ay:n.push({data:LC.getData(s)});break;case Cy:n.push({data:VC.getData(s)});break;case xy:case by:case Ty:case wy:n.push({data:GC.getData(r,s)});break;case yy:n.push({data:_C.getData(s)});break;case Ey:n.push({data:FC.getData()})}}return NS(t,n)},n.handleDynamicFenSize=function(t){var e,n,i=0;if((n=t.length)&&(i=t[0].length),0===n||0===i)return t;var a=et()(e=[]).call(e,t);if(n>IP.rows)ds()(a).call(a,IP.rows,n-IP.rows);else if(i<IP.rows)for(var r=0;r<IP.rows-n;r++){var s;a.push(A()(s=new Array(n)).call(s,{value:0,frame:kP.GEM_TRANSPARENT}))}return i>IP.cols?a.forEach((function(t){ds()(t).call(t,IP.cols,i-IP.cols)})):i<IP.cols&&a.forEach((function(t){for(var e=0;e<IP.cols-i;e++)t.push({value:0,frame:kP.GEM_TRANSPARENT})})),a},n.handleCollectionItemsComplete=function(){var t=this;if(this.targetMissionManager.getTargetType()!==Mw&&this.header.collectItems.checkCompleteMission()){this.clearFen(),this.audio.playSound(Vs.default.TARGET_REACHED);var e=this.levelManager.getLevel(),n=this.storage.getState();if(hu(n).challengeMode){var i,a=xT(),r=fs()(i=GameCore.Utils.Number).call(i,a,4,"0");this.handleSwitchJourney(),this.analytics.event(ni.AnalyticsEvents.DAILY_CHALLENGE_END,{level:a,levelName:"daily_challenge_"+r})}else this.handleNextLevel(),this.analytics.levelComplete(e,void 0,this.getLevelName());e>qu.length-1&&this.time.delayedCall(2e3,(function(){t.game.globalScene.screen.open(vs,{message:"\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043d\u043e\u0432\u044b\u0445 \u0443\u0440\u043e\u0432\u043d\u0435\u0439...",duration:1e3}),t.time.delayedCall(1e3,(function(){t.scene.switch(is.SceneKeys.LEVEL_SCENE)}))})),this.screen.open(Os,{duration:3e3,onClose:function(){var e=(0,Xt.default)(qt().mark((function e(){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.isLevelComplete=!1,t.handleShowInterstitialAd().catch(Ht.sendException),t.showPopupCompleteScreenAfterCollectionCompleted();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()})}},n.showPopupCompleteScreenAfterCollectionCompleted=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.storage.getState(),!uu(e)){t.next=8;break}return n=(new Date).getTime()-this.startGameAt,this.storage.dispatch(tP({time:n,limit:100,offset:0})),this.storage.dispatch(Od()),this.screen.open(Cs),t.abrupt("return");case 8:this.screen.open(ks);case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.setLevelCompleted=function(t){this.targetMissionManager.getTargetType()!==Mw&&(this.isLevelComplete=t)},n.handleRetryLevel=function(){var t=this.storage.getState();if(hu(t).challengeMode){var e,n=xT(),i=fs()(e=GameCore.Utils.Number).call(e,n,4,"0");this.analytics.event(ni.AnalyticsEvents.DAILY_CHALLENGE_BEGIN,{level:n,levelName:"daily_challenge_"+i})}else this.analytics.levelStart(this.levelManager.getLevel(),void 0,this.getLevelName());this.header.progressBar.reset(),this.clearFen(),this.startGame()},n.preloadNextLevel=function(){var t=this.levelManager.getNextLevelConfig();if(t){var e=t.key,n=t.mapJson;"level-from-json"!==e&&(this.cache.tilemap.exists(e)||(this.load.tilemapTiledJSON(e,n),this.load.start()))}},n.preloadCurrentLevel=function(){var t=this.levelManager.getLevelConfig();if(t){var e=t.key,n=t.mapJson;this.cache.tilemap.exists(e)?this.handleLoadCurrentMapComplete():(this.load.tilemapTiledJSON(e,n),this.load.start())}},n.handleLoadCurrentMapComplete=function(){var t=this.game.globalScene;this.mapManager.reloadMap(),this.clearFen(),this.startGame(),t.screen.close(vs)},n.handleLoadCurrentMapError=function(t){var e=this.game.globalScene,n=new qE("Load resources at LoadScene failed.");(0,Ht.sendExceptionWithScope)(n,{file:null==t?void 0:t.url}),e.screen.close(vs)},n.getLevelName=function(){var t,e=this.levelManager.getLevel();return"journey_"+fs()(t=GameCore.Utils.Number).call(t,e,4,"0")},e}(Rp.default),OP=RP;null==($I=void 0)||$I.accept(GameCore.LiveUpdate.Scene(is.SceneKeys.JOURNEY_SCENE));var _P,DP=OP,LP=gs.default.GAMEPLAY,BP=LP.KEY,FP=LP.FRAME,NP=function(t){function e(e){var n;return(n=t.call(this,e,BP,FP.BUTTON_WOOD_SMALL)||this).button.setWorldSize(64,55),n.setName("AddFriends"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:BP,frame:FP.ICON_ADD_FRIEND});t.setWorldSize(31,28),this.add(t),Phaser.Display.Align.In.Center(t,this,.25,-2.5)},e}(Ys.default),GP=NP,UP=gs.default.GAMEPLAY,VP=UP.KEY,YP=UP.FRAME,zP=function(t){function e(e){var n;return(n=t.call(this,e,VP,YP.BUTTON_WOOD_SMALL)||this).button.setWorldSize(64,55),n.setName("Home"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:VP,frame:YP.ICON_HOME});t.setWorldSize(34,31),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-2)},e}(Ys.default),HP=zP,WP=gs.default.DEFAULT,XP=WP.KEY,KP=WP.FRAME,jP=function(t){function e(e){var n;return(n=t.call(this,e,XP,KP.BUTTON_GREEN)||this).nextLevel=void 0,n.button.setWorldSize(182,55),n.setName("Play Level"),n.createText(),n}return(0,Kt.default)(e,t),e.prototype.createText=function(){this.nextLevel=this.scene.make.image({key:XP,frame:KP.TEXT_NEXT_LEVEL}),this.nextLevel.setWorldSize(102,35.5),this.add(this.nextLevel),Phaser.Display.Align.In.Center(this.nextLevel,this,0,-1)},e}(Ys.default),qP=jP,ZP=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.buttonPlay=void 0,n.buttonHome=void 0,n.buttonInviteFriends=void 0,n.scene=e,n.init(),n.scene.add.existing((0,ls.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createButton()},n.createButton=function(){this.createButtonPlay(),this.createButtonHome(),this.createButtonAddFriends()},n.createButtonPlay=function(){this.buttonPlay=new qP(this.scene),this.add(this.buttonPlay),Phaser.Display.Align.In.Center(this.buttonPlay,this,0,1)},n.createButtonHome=function(){this.buttonHome=new HP(this.scene),this.add(this.buttonHome),Phaser.Display.Align.In.Center(this.buttonHome,this,-131,1)},n.createButtonAddFriends=function(){this.buttonInviteFriends=new GP(this.scene),this.add(this.buttonInviteFriends),Phaser.Display.Align.In.Center(this.buttonInviteFriends,this,131,1)},n.updateTextButtonPlay=function(){var t=this.scene.storage.getState();1===lu(t)?(this.buttonPlay.nextLevel.setFrame(gs.default.DEFAULT.FRAME.TEXT_PLAY),this.buttonPlay.nextLevel.setWorldSize(83,19)):(this.buttonPlay.nextLevel.setFrame(gs.default.DEFAULT.FRAME.TEXT_NEXT_LEVEL),this.buttonPlay.nextLevel.setWorldSize(102,35.5))},e}(Phaser.GameObjects.Container),JP=ZP,QP=gs.default.DEFAULT,$P=QP.KEY,tk=QP.FRAME,ek=function(t){function e(e){var n,i=(n=t.call(this,e,0,0,$P,tk.LEAF)||this).scene.gameZone.width,a=i*n.height/n.width;return n.setWorldSize(i,a),n.scene.add.existing((0,ls.default)(n)),n}return(0,Kt.default)(e,t),e}(Phaser.GameObjects.Image),nk=ek,ik=gs.default.DEFAULT,ak=ik.KEY,rk=ik.FRAME,sk=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.livesTimer=void 0,n.scene=e,e.add.existing((0,ls.default)(n)),n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createText(),this.createLeaf(),this.createLivesTimer()},n.createText=function(){var t=this.scene.make.image({key:ak,frame:rk.TEXT_JOURNEY});t.setWorldSize(143.5,16.5),this.add(t),Phaser.Display.Align.In.Center(t,this,0,14)},n.createLeaf=function(){var t=new nk(this.scene);this.add(t),Phaser.Display.Align.In.TopCenter(t,this,0,t.displayHeight/2-30)},n.createLivesTimer=function(){this.livesTimer=new db(this.scene),this.livesTimer.startIntervalTimer(),this.add(this.livesTimer),Phaser.Display.Align.In.Center(this.livesTimer,this,0,50)},n.updateTextLives=function(){var t=this.scene.storage.getState(),e=Cv(t);this.livesTimer.setLives(e)},e}(Phaser.GameObjects.Container),ok=sk;!function(t){t.PASSED="passed",t.READY="ready",t.WAITING="waiting"}(_P||(_P={}));var hk,ck=gs.default.DEFAULT,lk=ck.KEY,uk=ck.FRAME,dk=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).scene=void 0,i.levelBackground=void 0,i.tick=void 0,i.levelNumber=void 0,i.level=void 0,i.tweenClick=void 0,i.payload=void 0,i.scene=e,i.init(),n&&i.updateInfo(n),i.scene.add.existing((0,ls.default)(i)),i}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){var t=this;this.createLevelBackground(),this.createImageCheck(),this.createText(),this.updateSize(),this.alignLevelItem(),this.setInteractive(),this.on(Phaser.Input.Events.POINTER_DOWN,(function(){t.scene.audio.playSound(Vs.default.BUTTON_CLICK),t.tweenClick?t.tweenClick.play():t.scene.handlePlay()}))},n.createLevelBackground=function(){this.levelBackground=this.scene.make.image({key:lk,frame:uk.LEVEL_PLAYING}),this.levelBackground.setWorldSize(75,60),this.levelBackground.setVisible(!1),this.add(this.levelBackground)},n.updateSize=function(){var t=this.levelBackground,e=t.width,n=t.height;this.setSize(e,n)},n.createImageCheck=function(){this.tick=this.scene.make.image({key:lk,frame:uk.ICON_CHECK}),this.tick.setWorldSize(30,23),this.tick.setVisible(!1),this.add(this.tick)},n.createText=function(){this.levelNumber=this.scene.make.bitmapText({font:Hs.default.PRIMARY.KEY,size:this.scene.fontSize(40),text:""+this.level,origin:{x:.2,y:.5}}),this.levelNumber.setAlpha(.7),this.levelNumber.setTint(7813671),this.add(this.levelNumber)},n.getLevel=function(){return this.level},n.updateInfoLevel=function(){switch(this.disableInteractive(),this.payload.status){case _P.PASSED:this.levelNumber.setAlpha(.7),this.levelBackground.setFrame(uk.LEVEL_PLAYED),this.tick.setVisible(!0);break;case _P.READY:this.levelNumber.setAlpha(.7),this.setInteractive(),this.createTweenClick(),this.levelBackground.setFrame(uk.LEVEL_PLAYING),this.tick.setVisible(!1);break;case _P.WAITING:this.levelNumber.setAlpha(.5),this.levelBackground.setFrame(uk.LEVEL_LOCKED),this.tick.setVisible(!1)}},n.updateInfo=function(t){this.payload=(0,wt.default)({},t),this.updateInfoLevel(),this.updateText(),this.updateBackground(),this.alignLevelItem()},n.createTweenClick=function(){var t=this,e=this.scale;this.tweenClick=this.scene.tweens.add({targets:[this],duration:100,paused:!0,yoyo:!0,scale:{from:e,to:e-.1},onComplete:function(){t.scene.handlePlay()}})},n.updateBackground=function(){this.levelBackground.setVisible(!0)},n.updateText=function(){this.levelNumber.setText(""+this.payload.level),Phaser.Display.Align.In.Center(this.levelNumber,this.levelBackground,0,0)},n.alignLevelItem=function(){Phaser.Display.Align.In.Center(this.tick,this.levelBackground,25,10),Phaser.Display.Align.In.Center(this.levelNumber,this.levelBackground,0,0)},n.setStatus=function(t){this.payload.status=t},n.setTextLevel=function(t){this.payload.level=t},e}(Phaser.GameObjects.Container),pk=gs.default.DEFAULT,fk=pk.KEY,gk=pk.FRAME,mk=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).scene=void 0,i.background=void 0,i.levelItem1=void 0,i.levelItem2=void 0,i.levelItem3=void 0,i.levelItem4=void 0,i.payload=void 0,i.scene=e,i.init(),n&&i.updateInfo(n),i.scene.add.existing((0,ls.default)(i)),i}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createBackground(),this.updateSize(),this.createLevelItem()},n.createBackground=function(){this.background=this.scene.make.image({key:fk,frame:gk.BG_DARK}),this.background.setWorldSize(325,64),this.background.setVisible(!1),this.add(this.background)},n.updateSize=function(){var t=this.background,e=t.width,n=t.height;this.setSize(e,n)},n.updateInfo=function(t){this.payload=(0,wt.default)({levelItem2:{level:0,status:""},levelItem3:{level:0,status:""},levelItem4:{level:0,status:""}},t),this.updateLevelItem()},n.createLevelItem=function(){this.levelItem1=new dk(this.scene,{level:1,status:_P.WAITING}),this.add(this.levelItem1),Phaser.Display.Align.In.Center(this.levelItem1,this,-120,0),this.levelItem2=new dk(this.scene,{level:2,status:_P.WAITING}),this.add(this.levelItem2),this.levelItem2.setVisible(!1),Phaser.Display.Align.In.Center(this.levelItem2,this,-40,0),this.levelItem3=new dk(this.scene,{level:3,status:_P.WAITING}),this.add(this.levelItem3),this.levelItem3.setVisible(!1),Phaser.Display.Align.In.Center(this.levelItem3,this,40,0),this.levelItem4=new dk(this.scene,{level:4,status:_P.WAITING}),this.add(this.levelItem4),this.levelItem4.setVisible(!1),Phaser.Display.Align.In.Center(this.levelItem4,this,120,0)},n.updateLevelItem=function(){if(this.levelItem1.setStatus(this.payload.levelItem1.status),this.levelItem1.updateInfoLevel(),this.levelItem1.setTextLevel(this.payload.levelItem1.level),this.levelItem1.updateText(),this.levelItem2){if(""==this.payload.levelItem2.status)return this.levelItem2.setVisible(!1),this.levelItem3&&this.levelItem3.setVisible(!1),void(this.levelItem4&&this.levelItem4.setVisible(!1));this.levelItem2.setStatus(this.payload.levelItem2.status),this.levelItem2.updateInfoLevel(),this.levelItem2.setVisible(!0),this.levelItem2.setTextLevel(this.payload.levelItem2.level),this.levelItem2.updateText()}if(this.levelItem3){if(""==this.payload.levelItem3.status)return this.levelItem3.setVisible(!1),void(this.levelItem4&&this.levelItem4.setVisible(!1));this.levelItem3.setStatus(this.payload.levelItem3.status),this.levelItem3.updateInfoLevel(),this.levelItem3.setVisible(!0),this.levelItem3.setTextLevel(this.payload.levelItem3.level),this.levelItem3.updateText()}if(this.levelItem4){if(""==this.payload.levelItem4.status)return void this.levelItem4.setVisible(!1);this.levelItem4.setStatus(this.payload.levelItem4.status),this.levelItem4.updateInfoLevel(),this.levelItem4.setVisible(!0),this.levelItem4.setTextLevel(this.payload.levelItem4.level),this.levelItem4.updateText()}},e}(Phaser.GameObjects.Container),vk=gs.default.DEFAULT,yk=vk.KEY,Sk=vk.FRAME,Ak=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.backgroundContent=void 0,n.scroller=void 0,n.scene=e,n.init(),n.createReuseScroller(),n.scene.add.existing((0,ls.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createBackgroundContent()},n.createReuseScroller=function(){this.scroller=new fp(this.scene,{classType:mk,listConfigs:[],width:325,height:385,padding:0,marginTop:0,marginBottom:0,maxScrollOver:.3,scrollingBackRate:5,useMask:!1}),this.scroller.setVisible(!1),this.scene.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer&&this.scroller.createBound(gs.default.DEFAULT.KEY,gs.default.DEFAULT.FRAME.BLANK,40,1528359),this.scroller.createMask(),this.scroller.setPosition(0,0),this.add(this.scroller)},n.setSizeBackground=function(t){var e=t*this.backgroundContent.displayWidth/this.backgroundContent.displayHeight;this.backgroundContent.setWorldSize(e,t)},n.updateData=function(){for(var t=this.scene.storage.getState(),e=lu(t),n=[],i={levelItem1:{status:"",level:0}},a={levelItem1:{status:"",level:0}},r=1;r<qu.length;r++){var s="";s=r>e?_P.WAITING:r<e?_P.PASSED:_P.READY;var o="";switch(r%4){case 1:o="levelItem1";break;case 2:o="levelItem2";break;case 3:o="levelItem3";break;case 0:o="levelItem4"}i[o]={level:r,status:s},a[o]={level:r,status:s},r%4===0&&(n.push((0,wt.default)({},i)),a={levelItem1:{status:"",level:0}})}(qu.length-1)%4>0&&n.push((0,wt.default)({},a)),this.scroller.updateConfig(n);var h=this.scroller.getChildren()[0].height;if(this.scroller.value=-h*this.showDefaultLevel(e),e>qu.length)return this.scene.game.globalScene.screen.open(vs,{message:"\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043d\u043e\u0432\u044b\u0445 \u0443\u0440\u043e\u0432\u043d\u0435\u0439...",duration:3e3});this.showLeaders()},n.showDefaultLevel=function(t){var e=Math.floor((t-1)/4),n=Math.floor((qu.length-1)/4);return n-e<3?n-5:e<3?0:e-2},n.removeLevelItems=function(){this.scroller.updateConfig([])},n.getLevelItems=function(){return this.scroller.getChildren()},n.showLeaders=function(){var t=this.getLevelItems();if(!(t.length<1)){for(var e=t.length>8?8:t.length,n=0;n<e;n++){var i=t[n];if(!i)return;i.setVisible(!0)}this.scroller.setEnable(!0)}},n.createBackgroundContent=function(){this.backgroundContent=this.scene.make.image({key:yk,frame:Sk.BG_DARK}),this.backgroundContent.setWorldSize(340,399),this.add(this.backgroundContent)},e}(Phaser.GameObjects.Container),Ek=Ak,xk=GameCore.Configs.Network,bk=gs.default.DEFAULT,Tk=bk.KEY,wk=bk.FRAME,Ck=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).header=void 0,n.mainContent=void 0,n.footer=void 0,n.run=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.checkReceiveLevelFromFb();case 2:n.header.updateTextLives(),n.loadLevelConfig();case 4:case"end":return t.stop()}}),t)}))),n.create=function(){t.prototype.create.call((0,ls.default)(n)),n.createMainContent(),n.createBackground1(),n.createHeader(),n.createFooter(),n.createClaimHeartScreen()},n.createMainContent=function(){n.mainContent=new Ek((0,ls.default)(n)),Phaser.Display.Align.In.Center(n.mainContent,n.gameZone,0,-24)},n.createBackground1=function(){var t=n.make.container({}),e=(n.gameZone.height-385)/2+20,i=n.make.image({key:Tk,frame:wk.BG_TOP});i.setWorldSize(375,e);var a=n.make.image({key:Tk,frame:wk.BG_BOTTOM});a.setWorldSize(375,e);var r=n.make.image({key:Tk,frame:wk.BG_MIDDLE});r.setWorldSize(375,415),t.add([i,r,a]),Phaser.Display.Align.In.Center(r,t,0,0),Phaser.Display.Align.In.Center(i,r,0,-r.displayHeight/2-i.displayHeight/2),Phaser.Display.Align.In.Center(a,r,0,r.displayHeight/2+a.displayHeight/2),Phaser.Display.Align.In.Center(t,n.gameZone,0,-24),n.mainContent.setSizeBackground(i.displayHeight+r.displayHeight+a.displayHeight)},n.clickButtonHome=function(){n.scene.switch(is.SceneKeys.DASHBOARD_SCENE)},n}(0,Kt.default)(e,t);var n=e.prototype;return n.preload=function(){this.events.on(Phaser.Scenes.Events.WAKE,this.run),this.events.on(Phaser.Scenes.Events.CREATE,this.run)},n.startGame=function(){this.mainContent.updateData(),this.footer.updateTextButtonPlay(),this.mainContent.scroller.setVisible(!0)},n.createClaimHeartScreen=function(){this.screen.add(Ns,Rb)},n.createHeader=function(){this.header=new ok(this),Phaser.Display.Align.In.TopCenter(this.header,this.gameZone,0,-15)},n.createFooter=function(){this.footer=new JP(this),Phaser.Display.Align.In.BottomCenter(this.footer,this.gameZone,0,-90),this.footer.buttonHome.onClick=this.clickButtonHome.bind(this),this.footer.buttonPlay.onClick=this.handlePlay.bind(this),this.footer.buttonInviteFriends.onClick=this.handleInviteFriends.bind(this)},n.handlePlay=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.storage.getState(),!(Cv(e)<1)){t.next=5;break}return this.screen.open(Ns),t.abrupt("return");case 5:if(this.storage.dispatch(Bv()),n=lu(e),this.storage.dispatch(Od()),!(n>qu.length)){t.next=12;break}return this.game.globalScene.screen.open(vs,{message:"\u0412\u044b \u0434\u043e\u0441\u0442\u0438\u0433\u043b\u0438 \u043f\u0440\u0435\u0434\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u0443\u0440\u043e\u0432\u043d\u044f...",duration:3e3}),t.abrupt("return");case 12:this.analytics.levelStart(n,void 0,this.getLevelName(n)),this.storage.dispatch(Wd());case 14:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.checkReceiveLevelFromFb=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=this.storage.getState(),!lu(e)){t.next=5;break}return t.abrupt("return");case 5:return this.showLoadingScreen(),t.next=8,this.storage.dispatch(Rd());case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 13:case"end":return t.stop()}}),t,this,[[0,10]])})));return function(){return t.apply(this,arguments)}}(),n.showLoadingScreen=function(){this.game.globalScene.screen.open(vs,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",duration:xk.Timeout,loading:!0})},n.hideLoadingScreen=function(){this.game.globalScene.screen.close(vs)},n.loadLevelConfig=function(){try{var t=this.storage.getState(),e=lu(t),n=qu[e];n||(n=qu[qu.length-1]);var i=n,a=i.key,r=i.mapJson;if(this.cache.tilemap.exists(a))return void this.handleLoadCurrentMapComplete();this.load.tilemapTiledJSON(a,r),this.load.start(),this.load.off(Phaser.Loader.Events.COMPLETE),this.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this))}catch(s){(0,Ht.sendException)(s)}},n.handleLoadCurrentMapComplete=function(){this.hideLoadingScreen(),this.startGame()},n.handleInviteFriends=function(){this.storage.dispatch(nb())},n.getLevelName=function(t){var e;return"journey_"+fs()(e=GameCore.Utils.Number).call(e,t,4,"0")},e}(Rp.default),Mk=Ck;null==(hk=void 0)||hk.accept(GameCore.LiveUpdate.Scene(is.SceneKeys.LEVEL_SCENE));var Ik=Mk,Pk=function(t){function e(e,n,i){var a;return(a=t.call(this)||this).game=void 0,a.options=void 0,a.performance=void 0,a.isRunning=!1,a.checkTimer=void 0,a.fpsHistory=void 0,a.start=function(){if(!a.isRunning){a.isRunning=!0;var t=a.options.checkInterval;a.checkTimer=t,a.fpsHistory=[],a.game.events.on(Phaser.Core.Events.POST_STEP,a.onPostStep)}},a.stop=function(){a.isRunning&&(a.isRunning=!1,a.game.events.off(Phaser.Core.Events.POST_STEP,a.onPostStep),a.options.onlyUpdateWhenSwitchScene&&a.checkFps())},a.onPostStep=function(t,e){if(a.checkTimer-=e,!(a.checkTimer>0)){var n=a.options,i=n.checkInterval,r=n.onlyUpdateWhenSwitchScene;a.checkTimer+=i,a.fpsHistory.push(a.game.loop.actualFps),!1===r&&a.fpsHistory.length>=5&&a.checkFps()}},a.game=e,a.options=i,a.performance=n,a}(0,Kt.default)(e,t);var n=e.prototype;return n.checkFps=function(){if(0!==this.fpsHistory.length){var t=this.options.autoUpgradeQuality,e=!1;this.isLowFps()?e=this.performance.downgradeGraphicsQuality():t&&this.isHighFps()&&(e=this.performance.upgradeGraphicsQuality()),e&&(this.fpsHistory=[])}},n.getFpsMedian=function(){return Phaser.Math.Median(this.fpsHistory)},n.isLowFps=function(){return this.getFpsMedian()<this.options.fpsThreshold},n.isHighFps=function(){return this.getFpsMedian()>1.2*this.options.fpsThreshold},e}(Phaser.Events.EventEmitter),kk=Pk,Rk=["pixelRatio","minQuality","maxQuality","qualityAdjustStep","trackingSceneKeys"],Ok=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).fpsTracker=void 0,n.pixelRatio=void 0,n.minQuality=void 0,n.maxQuality=void 0,n.qualityAdjustStep=void 0,n.trackingSceneKeys=[],n.trackingScene=function(t){var e;if(u()(e=n.trackingSceneKeys).call(e,t)){var i=n.game.scene.getScene(t);i.events.once(Phaser.Scenes.Events.UPDATE,n.fpsTracker.start),i.events.once(Phaser.Scenes.Events.SLEEP,n.fpsTracker.stop)}},n}(0,Kt.default)(e,t);var n=e.prototype;return n.configure=function(t){var e=t.pixelRatio,n=t.minQuality,i=t.maxQuality,a=t.qualityAdjustStep,r=t.trackingSceneKeys,s=(0,Wt.default)(t,Rk);this.pixelRatio=e,this.minQuality=n,this.maxQuality=i,this.qualityAdjustStep=a,this.trackingSceneKeys=r,this.fpsTracker=new kk(this.game,this,s)},n.active=function(){this.game.events.on(Phaser.Scenes.Events.WAKE,this.trackingScene),this.game.events.on(Phaser.Scenes.Events.START,this.trackingScene)},n.downgradeGraphicsQuality=function(){var t=this.pixelRatio;if(t<=this.minQuality)return!1;var e=+(t-this.qualityAdjustStep).toFixed(2);return!(e<this.minQuality)&&(this.pixelRatio=e,this.game.world.resize(this.pixelRatio),!0)},n.upgradeGraphicsQuality=function(){var t=this.pixelRatio;if(t>=this.maxQuality)return!1;var e=+(t+this.qualityAdjustStep).toFixed(2);return!(e>this.maxQuality)&&(this.pixelRatio=e,this.game.world.resize(this.pixelRatio),!0)},e}(Phaser.Plugins.BasePlugin),_k=Ok,Dk=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).instance=void 0,i.placementId=void 0,i.instance=null,i.placementId=n,i}(0,Kt.default)(e,t),e.setGame=function(t){self.game=t};var n=e.prototype;return n.loadAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.status===GameCore.Ads.Status.IDLE){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,this.status=GameCore.Ads.Status.LOADING,t.next=6,this.createInstanceByType(this.type);case 6:if(this.instance=t.sent,null!==this.instance){t.next=9;break}throw new GameCore.Ads.AdError("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");case 9:return t.next=11,this.instance.loadAsync();case 11:this.status=GameCore.Ads.Status.FILLED,t.next=19;break;case 14:throw t.prev=14,t.t0=t.catch(2),this.status=GameCore.Ads.Status.IDLE,this.instance=null,t.t0;case 19:case"end":return t.stop()}}),t,this,[[2,14]])})));return function(){return t.apply(this,arguments)}}(),n.showAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this.status===GameCore.Ads.Status.FILLED){t.next=3;break}throw new GameCore.Ads.AdError("AD_NOT_FILLED","Ads no fill.");case 3:if(this.status=GameCore.Ads.Status.SHOWING,null!==this.instance){t.next=6;break}throw new GameCore.Ads.AdError("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");case 6:return t.next=8,this.instance.showAsync();case 8:this.status=GameCore.Ads.Status.IDLE,this.instance=null,t.next=16;break;case 12:throw t.prev=12,t.t0=t.catch(0),t.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(t.t0,"code")&&"ADS_NOT_LOADED"===t.t0.code?this.status=GameCore.Ads.Status.FILLED:(this.status=GameCore.Ads.Status.IDLE,this.instance=null),t.t0;case 16:case"end":return t.stop()}}),t,this,[[0,12]])})));return function(){return t.apply(this,arguments)}}(),n.getStatus=function(){return this.status},n.createInstanceByType=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=self.game.facebook,t.t0=e,t.next=t.t0===GameCore.Ads.Types.REWARDED?4:t.t0===GameCore.Ads.Types.INTERSTITIAL?7:10;break;case 4:return t.next=6,n.getRewardedVideoAsync(this.placementId);case 6:case 9:return t.abrupt("return",t.sent);case 7:return t.next=9,n.getInterstitialAdAsync(this.placementId);case 10:return t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),e}(GameCore.Ads.AdInstance),Lk=Dk,Bk='<div id="mockads"> <div style="color:#fff;display:flex;align-content:space-between;justify-content:space-between;flex-direction:column;flex-wrap:nowrap;position:absolute;width:100vw;height:100vh;top:0;left:0;font-family:sans-serif;background:#063b4d;background:linear-gradient(0deg,#063b4d 30%,#0e6171 100%)"> <div style="display:flex;height:6vh;background-color:#0b4d5b;flex-direction:row;justify-content:space-between;align-items:center;align-content:center;font-size:larger" id="ad-header"> <div style="width:80px;display:flex;align-items:center;justify-content:center;margin:0 10px;cursor:pointer" id="close-btn"> Close </div> <div style="width:80px;display:flex;align-items:center;justify-content:center;margin:0 10px;cursor:pointer" id="reward-btn"> Reward </div> </div> <div style="display:flex;flex-direction:column;flex-wrap:nowrap;align-content:center;justify-content:center;height:100%;align-items:center" id="ad-content"> <div style="display:flex;width:200px;height:50px;background-color:#1f7888;align-items:center;justify-content:center;border-radius:100vw;margin:10px;text-transform:uppercase"> <span>AD {AD_TYPE}</span> </div> <div style="background-color:#1f7888;display:flex;align-items:center;justify-content:center;width:80vw;border-radius:16px"> <img src="{AD_CONTENT}" style="position:relative;width:inherit;border-radius:6px"/> </div> </div> <div style="display:flex;height:3vh;flex-direction:row;justify-content:flex-start;align-items:center;background-color:#063f51" id="ad-footer"></div> </div> </div>',Fk=GameCore.Configs.Ads.Mockup,Nk=Fk.ErrorRate,Gk=Fk.GiphyApiKey,Uk=function(t){return function(e){e.preventDefault();var n=document.getElementById("popup-ads");null==n||n.remove(),t()}},Vk=function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new(mt())((function(t,n){var i=new Image;i.onload=function(){return t()},i.onerror=function(){return n()},i.src=e})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Yk=function(){var t=(0,Xt.default)(qt().mark((function t(e,n,i,a){var r,s,o,h;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=Bk.markup||Bk,(s=document.createElement("div")).id="popup-ads",s.innerHTML=r.replace("{AD_TYPE}",e).replace("{AD_CONTENT}",n),document.body.appendChild(s),(o=document.getElementById("close-btn"))&&(e===GameCore.Ads.Types.REWARDED?(o.innerHTML="Skip",o.onclick=Uk((function(){a({code:"USER_INPUT",message:"Skip ads mock error"})}))):o.onclick=Uk(i)),(h=document.getElementById("reward-btn"))&&(e===GameCore.Ads.Types.REWARDED?h.onclick=Uk(i):h.remove());case 9:case"end":return t.stop()}}),t)})));return function(e,n,i,a){return t.apply(this,arguments)}}(),zk=function(){function t(t){this.type=void 0,this.adContent=void 0,this.apiAdContent=void 0,this.loadTimer=void 0,this.showTimer=void 0,this.type=t,this.adContent="",this.apiAdContent="https://api.giphy.com/v1/gifs/random?api_key="+Gk+"&rate=pg"}var e=t.prototype;return e.loadAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n=this;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=Phaser.Math.RND.between(0,100)<=Nk){t.next=13;break}return t.next=4,this.getAdContentAsync();case 4:return this.adContent=t.sent,t.prev=5,t.next=8,Vk(this.adContent);case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(5);case 13:return t.abrupt("return",new(mt())((function(t,i){clearTimeout(n.loadTimer),e?i({code:"NETWORK_FAILURE",message:"Load ads mock error"}):t()})));case 14:case"end":return t.stop()}}),t,this,[[5,10]])})));return function(){return t.apply(this,arguments)}}(),e.showAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n=this;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Phaser.Math.RND.between(0,100)<=Nk,t.abrupt("return",new(mt())((function(t,i){e?i({code:"RATE_LIMITED",message:"Show ads mock error"}):Yk(n.type,n.adContent,t,i)})));case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),e.getPlacementID=function(){return"123"},e.getAdContentAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(this.apiAdContent,{method:"GET"});case 2:return e=t.sent,t.next=5,e.json();case 5:if(n=t.sent,GameCore.Utils.Valid.isObject(n)){t.next=8;break}return t.abrupt("return","");case 8:return i=n.data,t.abrupt("return",null==i?void 0:i.images.downsized.url);case 10:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),t}(),Hk=function(t){function e(){return t.apply(this,arguments)||this}return(0,Kt.default)(e,t),e.prototype.createInstanceByType=function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new zk(e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}(Lk),Wk=Hk,Xk=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).Text=void 0,n.Texture=void 0,n.currentLocale=void 0,n.supportedLanguages=void 0,n.data=void 0,n.options=void 0,n}(0,Kt.default)(e,t);var n=e.prototype;return n.configure=function(t){this.applyOptions(t)},n.getCurrentLanguage=function(){return this.currentLocale},n.switchLanguage=function(t){void 0===t&&(t="en");var e=this.getCorrectLocale(t);this.currentLocale=e,this.Text=this.data[e].Text,this.Texture=this.data[e].Texture},n.getText=function(t){if("object"==typeof t){var e=t.key,n=t.variables,i=void 0===n?[]:n,a=t.locale,r=void 0===a?this.currentLocale:a,s=this.getCorrectLocale(r),o=this.data[s].Text[e];return this.replaceVariables(o,i)}return this.Text[t]},n.getTexture=function(t){if("object"==typeof t){var e=t.key,n=t.variables,i=void 0===n?[]:n,a=t.locale,r=void 0===a?this.currentLocale:a,s=this.getCorrectLocale(r),o=this.data[s].Texture[e];return this.replaceVariables(o,i)}return this.Texture[t]},n.isSupportLanguage=function(t){var e;return g()(e=this.supportedLanguages).call(e,t)>=0},n.applyOptions=function(t){this.options=(0,wt.default)({},t);var e=t.data,n=t.locale,i=void 0===n?"en":n,a=t.upperCaseText,r=void 0!==a&&a;this.data=e,this.supportedLanguages=Y()(e);var s=this.getCorrectLocale(i);if(this.currentLocale=s,this.Text=e[s].Text,this.Texture=e[s].Texture,r)for(var o in this.Text)this.Text[o]=this.Text[o].toUpperCase()},n.replaceVariables=function(t,e){var n=e.length;if(0==n)return t;var i=0;return t.replace(/{.*}/,(function(){return String(e[Math.min(i++,n-1)])}))},n.getCorrectLocale=function(t){var e=t;return this.isSupportLanguage(t)||(e="en"),e},e}(Phaser.Plugins.BasePlugin),Kk={ru:JSON.parse('{"Text":{"POP JEWELS":"POP JEWELS","DAILY_REWARDS":"DAILY REWARDS","CLAIM":"CLAIM","CLAIM_X2":"CLAIM X2","DAY_{X}":"DAY {X}","PLAY_NOW":"PLAY NOW","PLAY_WITH_FRIENDS":"PLAY WITH FRIENDS","RANK":"RANK","DAILY":"DAILY","GIFT":"GIFT","SETTINGS":"SETTINGS","LEADERBOARDS":"LEADERBOARDS","PLAY":"PLAY","WITH_FRIENDS":"WITH FRIENDS","FRIENDS":"FRIENDS","WORLD":"WORLD","DAILY_MISSION":"DAILY MISSIONS","PASS_10_LEVELS":"PASS 10 LEVELS","COLLECT_300_DIAMONDS":"COLLECT 300 DIAMONDS","INVITE_2_FRIENDS":"INVITE 2 FRIENDS","REACH_TOTAL_SCORES":"REACH TOTAL SCORES","WATCH_A_VIDEO_TO_GET_{X}_DIAMONDS!":"WATCH A VIDEO TO GET\\\\n{X} DIAMONDS!","GET_NOW":"GET NOW!","TARGET":"TARGET","MISSION":"MISSION","YOUR_SCORE":"YOUR SCORE","LEVEL":"LEVEL","REQUESTING":"REQUESTING...","LOADING_INTERSTITIAL_AD":"LOADING INTERSTITIAL AD...","HAMMER":"HAMMER","HAMMER_DESCRIPTION":"USE HAMMER TO SMASH ANY GEM","MAGIC_BOTTLE":"MAGIC BOTTLE","MAGIC_BOTTLE_DESCRIPTION":"USE MAGIC BOTTLE TO CHANGE A GEM COLOR","LEVEL_FAILED":"LEVEL FAILED","FAILED_TEXT":"YOU DID NOT REACH THE TARGET SCORE","CONTINUE":"CONTINUE","BEST_SCORE":"BEST SCORE","GLOBAL":"GLOBAL","JOIN":"JOIN","REPLAY":"REPLAY","HOME":"HOME","TODAY_RECORD":"TODAY RECORD","SHARE":"SHARE","WAITING":"WAITING","WAITING_FOR_OPPONENT":"WAITING FOR OPPONENT","RESTART":"RESTART","DRAW":"DRAW","YOU_LOSE":"YOU LOSE","YOU_WIN":"YOU WIN","VS":"VS","GUIDE_TEXT_GEM":"TAP ON TWO OR MORE GEMS OF THE SAME COLOR TO DESTROY THEM","GUIDE_TEXT_CURRENT_SCORE":"THIS IS YOUR CURRENT SCORE","GUIDE_TEXT_TARGET_SCORE":"THIS IS THE TARGET SCORE FOR EACH LEVEL YOU NEED TO PASS","GUIDE_TEXT_RAINBOW_GEM":"RAINBOW GEM CAN CLEAR THE GEMS SURROUNDING IT","GUIDE_TEXT_HAMMER":"THIS IS A HAMMER, USE IT TO SMASH ANY GEM!","GUIDE_TEXT_SHUFFLE":"THIS IS A SHUFFLE TILE, USE IT TO SHUFFLE ALL GEMS","GUIDE_TEXT_MAGIC_BOTTLE":"THIS IS A MAGIC BOTTLE, USE IT TO CHANGE A GEM COLOUR","NO_ADS_TO_DISPLAY":"NO ADS TO DISPLAY!","NO_REWARDS":"SORRY, NO REWARDS!","CANCELLED_AD":"YOU HAVE CANCELLED THE AD!","LOADING":"LOADING...","LOADING_AD":"LOADING AD ...","YOU_HAVE_JUST_RECEIVED_{X}_DIAMONDS":"YOU HAVE JUST RECEIVED\\\\n{X} DIAMONDS","CLOSE":"CLOSE","LEADERBOARD_EMPTY":"Leaderboard is empty!","MESSAGE_INVITE":"{playerName} challenges you","MESSAGE_FINISH_MATCH":"{playerName} just finished. Check them now.","MESSAGE_BEST_SCORE":"{playerName} beat your high score. Their score: {playerScore}","MESSAGE_FINISH_TURN":"{playerName} got {score} scores. So easy! Can you?","SHARE_LEADERBOARDS":"A ha, I\'m the best!","SHARE_GAME_RESULTS":"Pheww, a great match!","SHARE_BEST_SCORE":"Great! I have a best score!"},"Texture":{"NO_THANKS":"texts/no-thank","COOL":"texts/cool","CONGRATULATIONS":"texts/congratulation","EXCELLENT":"texts/excellent","GOOD":"texts/good","GREAT":"texts/great","LOGO":"logo","CONTINUE":"texts/continue"}}')},jk=function(t){function e(){return t.apply(this,arguments)||this}return(0,Kt.default)(e,t),e.prototype.configure=function(e){t.prototype.configure.call(this,(0,wt.default)({data:Kk,locale:"en",upperCaseText:!1},e))},e}(Xk),qk=jk,Zk=0,Jk=0,Qk=function(){function t(t){this.game=void 0,this.progressFbTimeEvent=void 0,this.game=t}var e=t.prototype;return e.loadingProgressFbBootScene=function(){var t=this,e=100;Jk=30;!function n(){e<=0?clearTimeout(t.progressFbTimeEvent):t.progressFbTimeEvent=setTimeout((function(){t.game.facebook.setLoadingProgress(Math.round(Jk)),Jk+=30/e,e--,n()}),50)}()},e.finishLoadingProgressFbBootScene=function(){clearTimeout(this.progressFbTimeEvent)},e.loadingProgressFbLoadScene=function(){var t=this;(!Jk||Jk<30)&&(Jk=60),Zk=Jk;!function e(){t.progressFbTimeEvent=setTimeout((function(){t.game.facebook.setLoadingProgress(Math.round(Jk)),Jk+=.1,e()}),50)}()},e.onProgress=function(t){var e=100-Jk,n=Math.round(t*e+Jk);n>Zk&&clearTimeout(this.progressFbTimeEvent),this.game.facebook.setLoadingProgress(n)},t}(),$k=Qk,tR=n(252),eR=n.n(tR),nR=n(413),iR=n.n(nR),aR=n(323),rR=n.n(aR),sR=n(319),oR=n.n(sR),hR=n(305),cR=n.n(hR),lR=n(306),uR=n.n(lR),dR=n(308),pR=n.n(dR),fR=n(303),gR=n.n(fR),mR=n(416),vR=n.n(mR),yR=n(421),SR=n.n(yR),AR=n(164),ER=n.n(AR),xR=n(250),bR=n.n(xR);window.SpinePlugin=function(t){var e={};function n(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||eR()(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Cc()&&iR()&&eR()(t,iR(),{value:"Module"}),eR()(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),eR()(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(i,a,function(e){return t[e]}.bind(null,a));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=63)}([function(t,e){function n(t,e,n,i){for(var r in e)if(e.hasOwnProperty(r)){var s=(l=e,u=r,f=p=void 0,f=(d=n)?l[u]:rR()(l,u),!d&&f.value&&"object"==typeof f.value&&(f=f.value),!(!f||!((p=f).get&&"function"==typeof p.get||p.set&&"function"==typeof p.set))&&(void 0===f.enumerable&&(f.enumerable=!0),void 0===f.configurable&&(f.configurable=!0),f));if(!1!==s){if(o=(i||t).prototype,h=r,c=void 0,(c=rR()(o,h))&&(c.value&&"object"==typeof c.value&&(c=c.value),!1===c.configurable)){if(a.ignoreFinals)continue;throw new Error("cannot override final property '"+r+"', set Class.ignoreFinals = true to skip")}eR()(t.prototype,r,s)}else t.prototype[r]=e[r]}var o,h,c,l,u,d,p,f}function i(t,e){if(e){Array.isArray(e)||(e=[e]);for(var i=0;i<e.length;i++)n(t,e[i].prototype||e[i])}}function a(t){var e,a,r;if((t=t||{}).initialize){if("function"!=typeof t.initialize)throw new Error("initialize must be a function");r=t.initialize,delete t.initialize}else r=t.Extends?(a=t.Extends,function(){a.apply(this,arguments)}):function(){};t.Extends?(r.prototype=Object.create(t.Extends.prototype),r.prototype.constructor=r,e=t.Extends,delete t.Extends):r.prototype.constructor=r;var s=null;return t.Mixins&&(s=t.Mixins,delete t.Mixins),i(r,s),n(r,t,!0,e),r}a.extend=n,a.mixin=i,a.ignoreFinals=!1,t.exports=a},function(t,e){t.exports=function(){}},function(t,e,n){var i=n(0),a=n(32),r=new i({initialize:function(t,e){this.x=0,this.y=0,"object"==typeof t?(this.x=t.x||0,this.y=t.y||0):(void 0===e&&(e=t),this.x=t||0,this.y=e||0)},clone:function(){return new r(this.x,this.y)},copy:function(t){return this.x=t.x||0,this.y=t.y||0,this},setFromObject:function(t){return this.x=t.x||0,this.y=t.y||0,this},set:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setTo:function(t,e){return this.set(t,e)},setToPolar:function(t,e){return null==e&&(e=1),this.x=Math.cos(t)*e,this.y=Math.sin(t)*e,this},equals:function(t){return this.x===t.x&&this.y===t.y},fuzzyEquals:function(t,e){return a(this.x,t.x,e)&&a(this.y,t.y,e)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},setAngle:function(t){return this.setToPolar(t,this.length())},add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},scale:function(t){return isFinite(t)?(this.x*=t,this.y*=t):(this.x=0,this.y=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},negate:function(){return this.x=-this.x,this.y=-this.y,this},distance:function(t){var e=t.x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},distanceSq:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},length:function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},setLength:function(t){return this.normalize().scale(t)},lengthSq:function(){var t=this.x,e=this.y;return t*t+e*e},normalize:function(){var t=this.x,e=this.y,n=t*t+e*e;return 0<n&&(n=1/Math.sqrt(n),this.x=t*n,this.y=e*n),this},normalizeRightHand:function(){var t=this.x;return this.x=-1*this.y,this.y=t,this},normalizeLeftHand:function(){var t=this.x;return this.x=this.y,this.y=-1*t,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lerp:function(t,e){void 0===e&&(e=0);var n=this.x,i=this.y;return this.x=n+e*(t.x-n),this.y=i+e*(t.y-i),this},transformMat3:function(t){var e=this.x,n=this.y,i=t.val;return this.x=i[0]*e+i[3]*n+i[6],this.y=i[1]*e+i[4]*n+i[7],this},transformMat4:function(t){var e=this.x,n=this.y,i=t.val;return this.x=i[0]*e+i[4]*n+i[12],this.y=i[1]*e+i[5]*n+i[13],this},reset:function(){return this.x=0,this.y=0,this},limit:function(t){var e=this.length();return e&&t<e&&this.scale(t/e),this},reflect:function(t){return t=t.clone().normalize(),this.subtract(t.scale(2*this.dot(t)))},mirror:function(t){return this.reflect(t).negate()},rotate:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e*this.x-n*this.y,n*this.x+e*this.y)}});r.ZERO=new r,r.RIGHT=new r(1,0),r.LEFT=new r(-1,0),r.UP=new r(0,-1),r.DOWN=new r(0,1),r.ONE=new r(1,1),t.exports=r},function(t,e){t.exports=function(t,e,n){return Math.max(e,Math.min(n,t))}},function(t,e){var n={PI2:2*Math.PI,TAU:.5*Math.PI,EPSILON:1e-6,DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,RND:null,MIN_SAFE_INTEGER:oR()||-9007199254740991,MAX_SAFE_INTEGER:cR()||9007199254740991};t.exports=n},function(t,e){t.exports=function(t,e,n,i){var a=t.length;if(e<0||a<e||n<=e||a<n||a<e+n){if(i)throw new Error("Range Error: Values outside acceptable range");return!1}return!0}},function(t,e){t.exports=function(t,e,n){var i=n-e;return e+((t-e)%i+i)%i}},function(t,e){t.exports=function(t){if("object"!=typeof t||t.nodeType||t===t.window)return!1;try{if(t.constructor&&!{}.hasOwnProperty.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0}},function(t,e,n){var i=n(4);t.exports=function(t){return t>Math.PI&&(t-=i.PI2),Math.abs(((t+i.TAU)%i.PI2-i.PI2)%i.PI2)}},function(t,e,n){var i=n(4);t.exports=function(t){return t*i.RAD_TO_DEG}},function(t,e){t.exports=function(t,e,n){if(t&&"number"!=typeof t){if(t.hasOwnProperty(e))return t[e];if(-1===g()(e).call(e,"."))return n;for(var i=e.split("."),a=t,r=n,s=0;s<i.length;s++){if(!a.hasOwnProperty(i[s])){r=n;break}r=a[i[s]],a=a[i[s]]}return r}return n}},function(t,e){t.exports=function(t,e,n){var i=typeof t;return t&&"number"!=i&&"string"!=i&&t.hasOwnProperty(e)&&void 0!==t[e]?t[e]:n}},function(t,e){t.exports=function(t,e){if(!(e>=t.length)){for(var n=t.length-1,i=t[e],a=e;a<n;a++)t[a]=t[a+1];return t.length=n,i}}},function(t,e,n){var i=n(0),a=n(26),r=new i({initialize:function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.type=a.POINT,this.x=t,this.y=e},setTo:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this}});t.exports=r},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n){this.x=0,this.y=0,this.z=0,"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0):(this.x=t||0,this.y=e||0,this.z=n||0)},up:function(){return this.x=0,this.y=1,this.z=0,this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clone:function(){return new i(this.x,this.y,this.z)},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},crossVectors:function(t,e){var n=t.x,i=t.y,a=t.z,r=e.x,s=e.y,o=e.z;return this.x=i*o-a*s,this.y=a*r-n*o,this.z=n*s-i*r,this},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z||0,this},set:function(t,e,n){return"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0):(this.x=t||0,this.y=e||0,this.z=n||0),this},setFromMatrixPosition:function(t){return this.fromArray(t.val,12)},setFromMatrixColumn:function(t,e){return this.fromArray(t.val,4*e)},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z||0,this},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addScale:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e||0,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z||0,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z||1,this},scale:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z||1,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},distance:function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z||0;return Math.sqrt(e*e+n*n+i*i)},distanceSq:function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z||0;return e*e+n*n+i*i},length:function(){var t=this.x,e=this.y,n=this.z;return Math.sqrt(t*t+e*e+n*n)},lengthSq:function(){var t=this.x,e=this.y,n=this.z;return t*t+e*e+n*n},normalize:function(){var t=this.x,e=this.y,n=this.z,i=t*t+e*e+n*n;return 0<i&&(i=1/Math.sqrt(i),this.x=t*i,this.y=e*i,this.z=n*i),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},cross:function(t){var e=this.x,n=this.y,i=this.z,a=t.x,r=t.y,s=t.z;return this.x=n*s-i*r,this.y=i*a-e*s,this.z=e*r-n*a,this},lerp:function(t,e){void 0===e&&(e=0);var n=this.x,i=this.y,a=this.z;return this.x=n+e*(t.x-n),this.y=i+e*(t.y-i),this.z=a+e*(t.z-a),this},applyMatrix3:function(t){var e=this.x,n=this.y,i=this.z,a=t.val;return this.x=a[0]*e+a[3]*n+a[6]*i,this.y=a[1]*e+a[4]*n+a[7]*i,this.z=a[2]*e+a[5]*n+a[8]*i,this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,a=t.val,r=1/(a[3]*e+a[7]*n+a[11]*i+a[15]);return this.x=(a[0]*e+a[4]*n+a[8]*i+a[12])*r,this.y=(a[1]*e+a[5]*n+a[9]*i+a[13])*r,this.z=(a[2]*e+a[6]*n+a[10]*i+a[14])*r,this},transformMat3:function(t){var e=this.x,n=this.y,i=this.z,a=t.val;return this.x=e*a[0]+n*a[3]+i*a[6],this.y=e*a[1]+n*a[4]+i*a[7],this.z=e*a[2]+n*a[5]+i*a[8],this},transformMat4:function(t){var e=this.x,n=this.y,i=this.z,a=t.val;return this.x=a[0]*e+a[4]*n+a[8]*i+a[12],this.y=a[1]*e+a[5]*n+a[9]*i+a[13],this.z=a[2]*e+a[6]*n+a[10]*i+a[14],this},transformCoordinates:function(t){var e=this.x,n=this.y,i=this.z,a=t.val,r=e*a[0]+n*a[4]+i*a[8]+a[12],s=e*a[1]+n*a[5]+i*a[9]+a[13],o=e*a[2]+n*a[6]+i*a[10]+a[14],h=e*a[3]+n*a[7]+i*a[11]+a[15];return this.x=r/h,this.y=s/h,this.z=o/h,this},transformQuat:function(t){var e=this.x,n=this.y,i=this.z,a=t.x,r=t.y,s=t.z,o=t.w,h=o*e+r*i-s*n,c=o*n+s*e-a*i,l=o*i+a*n-r*e,u=-a*e-r*n-s*i;return this.x=h*o+u*-a+c*-s-l*-r,this.y=c*o+u*-r+l*-a-h*-s,this.z=l*o+u*-s+h*-r-c*-a,this},project:function(t){var e=this.x,n=this.y,i=this.z,a=t.val,r=a[0],s=a[1],o=a[2],h=a[3],c=a[4],l=a[5],u=a[6],d=a[7],p=a[8],f=a[9],g=a[10],m=a[11],v=a[12],y=a[13],S=a[14],A=1/(e*h+n*d+i*m+a[15]);return this.x=(e*r+n*c+i*p+v)*A,this.y=(e*s+n*l+i*f+y)*A,this.z=(e*o+n*u+i*g+S)*A,this},projectViewMatrix:function(t,e){return this.applyMatrix4(t).applyMatrix4(e)},unprojectViewMatrix:function(t,e){return this.applyMatrix4(t).applyMatrix4(e)},unproject:function(t,e){var n=t.x,i=t.y,a=t.z,r=t.w,s=this.x-n,o=r-this.y-1-i,h=this.z;return this.x=2*s/a-1,this.y=2*o/r-1,this.z=2*h-1,this.project(e)},reset:function(){return this.x=0,this.y=0,this.z=0,this}});i.ZERO=new i,i.RIGHT=new i(1,0,0),i.LEFT=new i(-1,0,0),i.UP=new i(0,-1,0),i.DOWN=new i(0,1,0),i.FORWARD=new i(0,0,1),i.BACK=new i(0,0,-1),i.ONE=new i(1,1,1),t.exports=i},function(t,e){t.exports={LOADER_IDLE:0,LOADER_LOADING:1,LOADER_PROCESSING:2,LOADER_COMPLETE:3,LOADER_SHUTDOWN:4,LOADER_DESTROYED:5,FILE_PENDING:10,FILE_LOADING:11,FILE_LOADED:12,FILE_FAILED:13,FILE_PROCESSING:14,FILE_ERRORED:16,FILE_COMPLETE:17,FILE_DESTROYED:18,FILE_POPULATED:19}},function(t,e,n){var i=n(24),a=n(57);t.exports=function(t,e){var n;if(void 0===e&&(e=90),!i(t))return null;if("string"!=typeof e&&(e=(e%360+360)%360),90===e||-270===e||"rotateLeft"===e)uR()(n=t=a(t)).call(n);else if(-90===e||270===e||"rotateRight"===e)uR()(t).call(t),t=a(t);else if(180===Math.abs(e)||"rotate180"===e){for(var r=0;r<t.length;r++){var s;uR()(s=t[r]).call(s)}uR()(t).call(t)}return t}},function(t,e){t.exports={SKIP_CHECK:-1,NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,ERASE:17,SOURCE_IN:18,SOURCE_OUT:19,SOURCE_ATOP:20,DESTINATION_OVER:21,DESTINATION_IN:22,DESTINATION_OUT:23,DESTINATION_ATOP:24,LIGHTER:25,COPY:26,XOR:27}},function(t,e){t.exports=function(t,e){return Math.random()*(e-t)+t}},function(t,e,n){var i=n(4);t.exports=function(t){return t*i.DEG_TO_RAD}},function(t,e,n){var i=n(0),a=n(14),r=new i({initialize:function(t){this.val=new Float32Array(16),t?this.copy(t):this.identity()},clone:function(){return new r(this)},set:function(t){return this.copy(t)},setValues:function(t,e,n,i,a,r,s,o,h,c,l,u,d,p,f,g){var m=this.val;return m[0]=t,m[1]=e,m[2]=n,m[3]=i,m[4]=a,m[5]=r,m[6]=s,m[7]=o,m[8]=h,m[9]=c,m[10]=l,m[11]=u,m[12]=d,m[13]=p,m[14]=f,m[15]=g,this},copy:function(t){var e=t.val;return this.setValues(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},fromArray:function(t){return this.setValues(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},zero:function(){return this.setValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)},transform:function(t,e,n){var i=s.fromQuat(n).val,a=e.x,r=e.y,o=e.z;return this.setValues(i[0]*a,i[1]*a,i[2]*a,0,i[4]*r,i[5]*r,i[6]*r,0,i[8]*o,i[9]*o,i[10]*o,0,t.x,t.y,t.z,1)},xyz:function(t,e,n){this.identity();var i=this.val;return i[12]=t,i[13]=e,i[14]=n,this},scaling:function(t,e,n){this.zero();var i=this.val;return i[0]=t,i[5]=e,i[10]=n,i[15]=1,this},identity:function(){return this.setValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},transpose:function(){var t=this.val,e=t[1],n=t[2],i=t[3],a=t[6],r=t[7],s=t[11];return t[1]=t[4],t[2]=t[8],t[3]=t[12],t[4]=e,t[6]=t[9],t[7]=t[13],t[8]=n,t[9]=a,t[11]=t[14],t[12]=i,t[13]=r,t[14]=s,this},getInverse:function(t){return this.copy(t),this.invert()},invert:function(){var t=this.val,e=t[0],n=t[1],i=t[2],a=t[3],r=t[4],s=t[5],o=t[6],h=t[7],c=t[8],l=t[9],u=t[10],d=t[11],p=t[12],f=t[13],g=t[14],m=t[15],v=e*s-n*r,y=e*o-i*r,S=e*h-a*r,A=n*o-i*s,E=n*h-a*s,x=i*h-a*o,b=c*f-l*p,T=c*g-u*p,w=c*m-d*p,C=l*g-u*f,M=l*m-d*f,I=u*m-d*g,P=v*I-y*M+S*C+A*w-E*T+x*b;return P?(P=1/P,this.setValues((s*I-o*M+h*C)*P,(i*M-n*I-a*C)*P,(f*x-g*E+m*A)*P,(u*E-l*x-d*A)*P,(o*w-r*I-h*T)*P,(e*I-i*w+a*T)*P,(g*S-p*x-m*y)*P,(c*x-u*S+d*y)*P,(r*M-s*w+h*b)*P,(n*w-e*M-a*b)*P,(p*E-f*S+m*v)*P,(l*S-c*E-d*v)*P,(s*T-r*C-o*b)*P,(e*C-n*T+i*b)*P,(f*y-p*A-g*v)*P,(c*A-l*y+u*v)*P)):this},adjoint:function(){var t=this.val,e=t[0],n=t[1],i=t[2],a=t[3],r=t[4],s=t[5],o=t[6],h=t[7],c=t[8],l=t[9],u=t[10],d=t[11],p=t[12],f=t[13],g=t[14],m=t[15];return this.setValues(s*(u*m-d*g)-l*(o*m-h*g)+f*(o*d-h*u),-(n*(u*m-d*g)-l*(i*m-a*g)+f*(i*d-a*u)),n*(o*m-h*g)-s*(i*m-a*g)+f*(i*h-a*o),-(n*(o*d-h*u)-s*(i*d-a*u)+l*(i*h-a*o)),-(r*(u*m-d*g)-c*(o*m-h*g)+p*(o*d-h*u)),e*(u*m-d*g)-c*(i*m-a*g)+p*(i*d-a*u),-(e*(o*m-h*g)-r*(i*m-a*g)+p*(i*h-a*o)),e*(o*d-h*u)-r*(i*d-a*u)+c*(i*h-a*o),r*(l*m-d*f)-c*(s*m-h*f)+p*(s*d-h*l),-(e*(l*m-d*f)-c*(n*m-a*f)+p*(n*d-a*l)),e*(s*m-h*f)-r*(n*m-a*f)+p*(n*h-a*s),-(e*(s*d-h*l)-r*(n*d-a*l)+c*(n*h-a*s)),-(r*(l*g-u*f)-c*(s*g-o*f)+p*(s*u-o*l)),e*(l*g-u*f)-c*(n*g-i*f)+p*(n*u-i*l),-(e*(s*g-o*f)-r*(n*g-i*f)+p*(n*o-i*s)),e*(s*u-o*l)-r*(n*u-i*l)+c*(n*o-i*s))},determinant:function(){var t=this.val,e=t[0],n=t[1],i=t[2],a=t[3],r=t[4],s=t[5],o=t[6],h=t[7],c=t[8],l=t[9],u=t[10],d=t[11],p=t[12],f=t[13],g=t[14],m=t[15];return(e*s-n*r)*(u*m-d*g)-(e*o-i*r)*(l*m-d*f)+(e*h-a*r)*(l*g-u*f)+(n*o-i*s)*(c*m-d*p)-(n*h-a*s)*(c*g-u*p)+(i*h-a*o)*(c*f-l*p)},multiply:function(t){var e=this.val,n=e[0],i=e[1],a=e[2],r=e[3],s=e[4],o=e[5],h=e[6],c=e[7],l=e[8],u=e[9],d=e[10],p=e[11],f=e[12],g=e[13],m=e[14],v=e[15],y=t.val,S=y[0],A=y[1],E=y[2],x=y[3];return e[0]=S*n+A*s+E*l+x*f,e[1]=S*i+A*o+E*u+x*g,e[2]=S*a+A*h+E*d+x*m,e[3]=S*r+A*c+E*p+x*v,S=y[4],A=y[5],E=y[6],x=y[7],e[4]=S*n+A*s+E*l+x*f,e[5]=S*i+A*o+E*u+x*g,e[6]=S*a+A*h+E*d+x*m,e[7]=S*r+A*c+E*p+x*v,S=y[8],A=y[9],E=y[10],x=y[11],e[8]=S*n+A*s+E*l+x*f,e[9]=S*i+A*o+E*u+x*g,e[10]=S*a+A*h+E*d+x*m,e[11]=S*r+A*c+E*p+x*v,S=y[12],A=y[13],E=y[14],x=y[15],e[12]=S*n+A*s+E*l+x*f,e[13]=S*i+A*o+E*u+x*g,e[14]=S*a+A*h+E*d+x*m,e[15]=S*r+A*c+E*p+x*v,this},multiplyLocal:function(t){var e=this.val,n=t.val;return this.setValues(e[0]*n[0]+e[1]*n[4]+e[2]*n[8]+e[3]*n[12],e[0]*n[1]+e[1]*n[5]+e[2]*n[9]+e[3]*n[13],e[0]*n[2]+e[1]*n[6]+e[2]*n[10]+e[3]*n[14],e[0]*n[3]+e[1]*n[7]+e[2]*n[11]+e[3]*n[15],e[4]*n[0]+e[5]*n[4]+e[6]*n[8]+e[7]*n[12],e[4]*n[1]+e[5]*n[5]+e[6]*n[9]+e[7]*n[13],e[4]*n[2]+e[5]*n[6]+e[6]*n[10]+e[7]*n[14],e[4]*n[3]+e[5]*n[7]+e[6]*n[11]+e[7]*n[15],e[8]*n[0]+e[9]*n[4]+e[10]*n[8]+e[11]*n[12],e[8]*n[1]+e[9]*n[5]+e[10]*n[9]+e[11]*n[13],e[8]*n[2]+e[9]*n[6]+e[10]*n[10]+e[11]*n[14],e[8]*n[3]+e[9]*n[7]+e[10]*n[11]+e[11]*n[15],e[12]*n[0]+e[13]*n[4]+e[14]*n[8]+e[15]*n[12],e[12]*n[1]+e[13]*n[5]+e[14]*n[9]+e[15]*n[13],e[12]*n[2]+e[13]*n[6]+e[14]*n[10]+e[15]*n[14],e[12]*n[3]+e[13]*n[7]+e[14]*n[11]+e[15]*n[15])},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.val,i=e.val,a=n[0],r=n[4],s=n[8],o=n[12],h=n[1],c=n[5],l=n[9],u=n[13],d=n[2],p=n[6],f=n[10],g=n[14],m=n[3],v=n[7],y=n[11],S=n[15],A=i[0],E=i[4],x=i[8],b=i[12],T=i[1],w=i[5],C=i[9],M=i[13],I=i[2],P=i[6],k=i[10],R=i[14],O=i[3],_=i[7],D=i[11],L=i[15];return this.setValues(a*A+r*T+s*I+o*O,h*A+c*T+l*I+u*O,d*A+p*T+f*I+g*O,m*A+v*T+y*I+S*O,a*E+r*w+s*P+o*_,h*E+c*w+l*P+u*_,d*E+p*w+f*P+g*_,m*E+v*w+y*P+S*_,a*x+r*C+s*k+o*D,h*x+c*C+l*k+u*D,d*x+p*C+f*k+g*D,m*x+v*C+y*k+S*D,a*b+r*M+s*R+o*L,h*b+c*M+l*R+u*L,d*b+p*M+f*R+g*L,m*b+v*M+y*R+S*L)},translate:function(t){return this.translateXYZ(t.x,t.y,t.z)},translateXYZ:function(t,e,n){var i=this.val;return i[12]=i[0]*t+i[4]*e+i[8]*n+i[12],i[13]=i[1]*t+i[5]*e+i[9]*n+i[13],i[14]=i[2]*t+i[6]*e+i[10]*n+i[14],i[15]=i[3]*t+i[7]*e+i[11]*n+i[15],this},scale:function(t){return this.scaleXYZ(t.x,t.y,t.z)},scaleXYZ:function(t,e,n){var i=this.val;return i[0]=i[0]*t,i[1]=i[1]*t,i[2]=i[2]*t,i[3]=i[3]*t,i[4]=i[4]*e,i[5]=i[5]*e,i[6]=i[6]*e,i[7]=i[7]*e,i[8]=i[8]*n,i[9]=i[9]*n,i[10]=i[10]*n,i[11]=i[11]*n,this},makeRotationAxis:function(t,e){var n=Math.cos(e),i=Math.sin(e),a=1-n,r=t.x,s=t.y,o=t.z,h=a*r,c=a*s;return this.setValues(h*r+n,h*s-i*o,h*o+i*s,0,h*s+i*o,c*s+n,c*o-i*r,0,h*o-i*s,c*o+i*r,a*o*o+n,0,0,0,0,1)},rotate:function(t,e){var n=this.val,i=e.x,a=e.y,r=e.z,s=Math.sqrt(i*i+a*a+r*r);if(Math.abs(s)<1e-6)return this;i*=s=1/s,a*=s,r*=s;var o=Math.sin(t),h=Math.cos(t),c=1-h,l=n[0],u=n[1],d=n[2],p=n[3],f=n[4],g=n[5],m=n[6],v=n[7],y=n[8],S=n[9],A=n[10],E=n[11],x=n[12],b=n[13],T=n[14],w=n[15],C=i*i*c+h,M=a*i*c+r*o,I=r*i*c-a*o,P=i*a*c-r*o,k=a*a*c+h,R=r*a*c+i*o,O=i*r*c+a*o,_=a*r*c-i*o,D=r*r*c+h;return this.setValues(l*C+f*M+y*I,u*C+g*M+S*I,d*C+m*M+A*I,p*C+v*M+E*I,l*P+f*k+y*R,u*P+g*k+S*R,d*P+m*k+A*R,p*P+v*k+E*R,l*O+f*_+y*D,u*O+g*_+S*D,d*O+m*_+A*D,p*O+v*_+E*D,x,b,T,w)},rotateX:function(t){var e=this.val,n=Math.sin(t),i=Math.cos(t),a=e[4],r=e[5],s=e[6],o=e[7],h=e[8],c=e[9],l=e[10],u=e[11];return e[4]=a*i+h*n,e[5]=r*i+c*n,e[6]=s*i+l*n,e[7]=o*i+u*n,e[8]=h*i-a*n,e[9]=c*i-r*n,e[10]=l*i-s*n,e[11]=u*i-o*n,this},rotateY:function(t){var e=this.val,n=Math.sin(t),i=Math.cos(t),a=e[0],r=e[1],s=e[2],o=e[3],h=e[8],c=e[9],l=e[10],u=e[11];return e[0]=a*i-h*n,e[1]=r*i-c*n,e[2]=s*i-l*n,e[3]=o*i-u*n,e[8]=a*n+h*i,e[9]=r*n+c*i,e[10]=s*n+l*i,e[11]=o*n+u*i,this},rotateZ:function(t){var e=this.val,n=Math.sin(t),i=Math.cos(t),a=e[0],r=e[1],s=e[2],o=e[3],h=e[4],c=e[5],l=e[6],u=e[7];return e[0]=a*i+h*n,e[1]=r*i+c*n,e[2]=s*i+l*n,e[3]=o*i+u*n,e[4]=h*i-a*n,e[5]=c*i-r*n,e[6]=l*i-s*n,e[7]=u*i-o*n,this},fromRotationTranslation:function(t,e){var n=t.x,i=t.y,a=t.z,r=t.w,s=n+n,o=i+i,h=a+a,c=n*s,l=n*o,u=n*h,d=i*o,p=i*h,f=a*h,g=r*s,m=r*o,v=r*h;return this.setValues(1-(d+f),l+v,u-m,0,l-v,1-(c+f),p+g,0,u+m,p-g,1-(c+d),0,e.x,e.y,e.z,1)},fromQuat:function(t){var e=t.x,n=t.y,i=t.z,a=t.w,r=e+e,s=n+n,o=i+i,h=e*r,c=e*s,l=e*o,u=n*s,d=n*o,p=i*o,f=a*r,g=a*s,m=a*o;return this.setValues(1-(u+p),c+m,l-g,0,c-m,1-(h+p),d+f,0,l+g,d-f,1-(h+u),0,0,0,0,1)},frustum:function(t,e,n,i,a,r){var s=1/(e-t),o=1/(i-n),h=1/(a-r);return this.setValues(2*a*s,0,0,0,0,2*a*o,0,0,(e+t)*s,(i+n)*o,(r+a)*h,-1,0,0,r*a*2*h,0)},perspective:function(t,e,n,i){var a=1/Math.tan(t/2),r=1/(n-i);return this.setValues(a/e,0,0,0,0,a,0,0,0,0,(i+n)*r,-1,0,0,2*i*n*r,0)},perspectiveLH:function(t,e,n,i){return this.setValues(2*n/t,0,0,0,0,2*n/e,0,0,0,0,-i/(n-i),1,0,0,n*i/(n-i),0)},ortho:function(t,e,n,i,a,r){var s=0===(s=t-e)?s:1/s,o=0===(o=n-i)?o:1/o,h=0===(h=a-r)?h:1/h;return this.setValues(-2*s,0,0,0,0,-2*o,0,0,0,0,2*h,0,(t+e)*s,(i+n)*o,(r+a)*h,1)},lookAtRH:function(t,e,n){var i=this.val;return l.subVectors(t,e),0===l.getLengthSquared()&&(l.z=1),l.normalize(),h.crossVectors(n,l),0===h.getLengthSquared()&&(1===Math.abs(n.z)?l.x+=1e-4:l.z+=1e-4,l.normalize(),h.crossVectors(n,l)),h.normalize(),c.crossVectors(l,h),i[0]=h.x,i[1]=h.y,i[2]=h.z,i[4]=c.x,i[5]=c.y,i[6]=c.z,i[8]=l.x,i[9]=l.y,i[10]=l.z,this},lookAt:function(t,e,n){var i=t.x,a=t.y,r=t.z,s=n.x,o=n.y,h=n.z,c=e.x,l=e.y,u=e.z;if(Math.abs(i-c)<1e-6&&Math.abs(a-l)<1e-6&&Math.abs(r-u)<1e-6)return this.identity();var d=i-c,p=a-l,f=r-u,g=1/Math.sqrt(d*d+p*p+f*f),m=o*(f*=g)-h*(p*=g),v=h*(d*=g)-s*f,y=s*p-o*d;(g=Math.sqrt(m*m+v*v+y*y))?(m*=g=1/g,v*=g,y*=g):y=v=m=0;var S=p*y-f*v,A=f*m-d*y,E=d*v-p*m;return(g=Math.sqrt(S*S+A*A+E*E))?(S*=g=1/g,A*=g,E*=g):E=A=S=0,this.setValues(m,S,d,0,v,A,p,0,y,E,f,0,-(m*i+v*a+y*r),-(S*i+A*a+E*r),-(d*i+p*a+f*r),1)},yawPitchRoll:function(t,e,n){this.zero(),s.zero(),o.zero();var i=this.val,a=s.val,r=o.val,h=Math.sin(n),c=Math.cos(n);return i[10]=1,i[15]=1,i[0]=c,i[1]=h,i[4]=-h,i[5]=c,h=Math.sin(e),c=Math.cos(e),a[0]=1,a[15]=1,a[5]=c,a[10]=c,a[9]=-h,a[6]=h,h=Math.sin(t),c=Math.cos(t),r[5]=1,r[15]=1,r[0]=c,r[2]=-h,r[8]=h,r[10]=c,this.multiplyLocal(s),this.multiplyLocal(o),this},setWorldMatrix:function(t,e,n,i,a){return this.yawPitchRoll(t.y,t.x,t.z),s.scaling(n.x,n.y,n.z),o.xyz(e.x,e.y,e.z),this.multiplyLocal(s),this.multiplyLocal(o),i&&this.multiplyLocal(i),a&&this.multiplyLocal(a),this},multiplyToMat4:function(t,e){var n=this.val,i=t.val,a=n[0],r=n[1],s=n[2],o=n[3],h=n[4],c=n[5],l=n[6],u=n[7],d=n[8],p=n[9],f=n[10],g=n[11],m=n[12],v=n[13],y=n[14],S=n[15],A=i[0],E=i[1],x=i[2],b=i[3],T=i[4],w=i[5],C=i[6],M=i[7],I=i[8],P=i[9],k=i[10],R=i[11],O=i[12],_=i[13],D=i[14],L=i[15];return e.setValues(A*a+E*h+x*d+b*m,E*r+E*c+x*p+b*v,x*s+E*l+x*f+b*y,b*o+E*u+x*g+b*S,T*a+w*h+C*d+M*m,T*r+w*c+C*p+M*v,T*s+w*l+C*f+M*y,T*o+w*u+C*g+M*S,I*a+P*h+k*d+R*m,I*r+P*c+k*p+R*v,I*s+P*l+k*f+R*y,I*o+P*u+k*g+R*S,O*a+_*h+D*d+L*m,O*r+_*c+D*p+L*v,O*s+_*l+D*f+L*y,O*o+_*u+D*g+L*S)},fromRotationXYTranslation:function(t,e,n){var i=e.x,a=e.y,r=e.z,s=Math.sin(t.x),o=Math.cos(t.x),h=Math.sin(t.y),c=Math.cos(t.y),l=i,u=a,d=r,p=-s,f=0-p*h,g=0-o*h,m=p*c,v=o*c;return n||(l=c*i+h*r,u=f*i+o*a+m*r,d=g*i+s*a+v*r),this.setValues(c,f,g,0,0,o,s,0,h,m,v,0,l,u,d,1)},getMaxScaleOnAxis:function(){var t=this.val,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,i))}}),s=new r,o=new r,h=new a,c=new a,l=new a;t.exports=r},function(t,e,n){var i=n(0),a=n(15),r=n(205),s=n(11),o=n(216),h=n(45),c=n(217),l=n(46),u=new i({initialize:function(t,e){this.loader=t,this.cache=s(e,"cache",!1),this.type=s(e,"type",!1),this.key=s(e,"key",!1);var n=this.key;if(t.prefix&&""!==t.prefix&&(this.key=t.prefix+n),!this.type||!this.key)throw new Error("Invalid Loader."+this.type+" key");var i=s(e,"url");void 0===i?i=t.path+n+"."+s(e,"extension",""):"string"!=typeof i||i.match(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/)||(i=t.path+i),this.url=i,this.src="",this.xhrSettings=l(s(e,"responseType",void 0)),s(e,"xhrSettings",!1)&&(this.xhrSettings=h(this.xhrSettings,s(e,"xhrSettings",{}))),this.xhrLoader=null,this.state="function"==typeof this.url?a.FILE_POPULATED:a.FILE_PENDING,this.bytesTotal=0,this.bytesLoaded=-1,this.percentComplete=-1,this.crossOrigin=void 0,this.data=void 0,this.config=s(e,"config",{}),this.multiFile,this.linkFile},setLink:function(t){(this.linkFile=t).linkFile=this},resetXHR:function(){this.xhrLoader&&(this.xhrLoader.onload=void 0,this.xhrLoader.onerror=void 0,this.xhrLoader.onprogress=void 0)},load:function(){var t;this.state===a.FILE_POPULATED?this.loader.nextFile(this,!0):(this.state=a.FILE_LOADING,this.src=o(this,this.loader.baseURL),0===g()(t=this.src).call(t,"data:")||(this.xhrLoader=c(this,this.loader.xhr)))},onLoad:function(t,e){var n,i=t.responseURL&&0===g()(n=t.responseURL).call(n,"file://")&&0===e.target.status,r=!(e.target&&200!==e.target.status)||i;4===t.readyState&&400<=t.status&&t.status<=599&&(r=!1),this.state=a.FILE_LOADED,this.resetXHR(),this.loader.nextFile(this,r)},onError:function(){this.resetXHR(),this.loader.nextFile(this,!1)},onProgress:function(t){t.lengthComputable&&(this.bytesLoaded=t.loaded,this.bytesTotal=t.total,this.percentComplete=Math.min(this.bytesLoaded/this.bytesTotal,1),this.loader.emit(r.FILE_PROGRESS,this,this.percentComplete))},onProcess:function(){this.state=a.FILE_PROCESSING,this.onProcessComplete()},onProcessComplete:function(){this.state=a.FILE_COMPLETE,this.multiFile&&this.multiFile.onFileComplete(this),this.loader.fileProcessComplete(this)},onProcessError:function(){this.state=a.FILE_ERRORED,this.multiFile&&this.multiFile.onFileFailed(this),this.loader.fileProcessComplete(this)},hasCacheConflict:function(){return this.cache&&this.cache.exists(this.key)},addToCache:function(){this.cache&&this.cache.add(this.key,this.data),this.pendingDestroy()},pendingDestroy:function(t){void 0===t&&(t=this.data);var e=this.key,n=this.type;this.loader.emit(r.FILE_COMPLETE,e,n,t),this.loader.emit(r.FILE_KEY_COMPLETE+n+"-"+e,e,n,t),this.loader.flagForRemoval(this)},destroy:function(){this.loader=null,this.cache=null,this.xhrSettings=null,this.multiFile=null,this.linkFile=null,this.data=null}});u.createObjectURL=function(t,e,n){var i;"function"==typeof pR()?t.src=pR().createObjectURL(e):((i=new FileReader).onload=function(){t.removeAttribute("crossOrigin"),t.src="data:"+(e.type||n)+";base64,"+i.result.split(",")[1]},i.onerror=t.onerror,i.readAsDataURL(e))},u.revokeObjectURL=function(t){"function"==typeof pR()&&pR().revokeObjectURL(t.src)},t.exports=u},function(t,e){var n={},i={install:function(t){for(var e in n)t[e]=n[e]},register:function(t,e){n[t]=e},destroy:function(){n={}}};t.exports=i},function(t,e,n){var i=n(0),a=n(4),r=n(2),s=new i({initialize:function(t,e,n,i,a,r){void 0===t&&(t=1),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=1),void 0===a&&(a=0),void 0===r&&(r=0),this.matrix=new Float32Array([t,e,n,i,a,r,0,0,1]),this.decomposedMatrix={translateX:0,translateY:0,scaleX:1,scaleY:1,rotation:0}},a:{get:function(){return this.matrix[0]},set:function(t){this.matrix[0]=t}},b:{get:function(){return this.matrix[1]},set:function(t){this.matrix[1]=t}},c:{get:function(){return this.matrix[2]},set:function(t){this.matrix[2]=t}},d:{get:function(){return this.matrix[3]},set:function(t){this.matrix[3]=t}},e:{get:function(){return this.matrix[4]},set:function(t){this.matrix[4]=t}},f:{get:function(){return this.matrix[5]},set:function(t){this.matrix[5]=t}},tx:{get:function(){return this.matrix[4]},set:function(t){this.matrix[4]=t}},ty:{get:function(){return this.matrix[5]},set:function(t){this.matrix[5]=t}},rotation:{get:function(){return Math.acos(this.a/this.scaleX)*(Math.atan(-this.c/this.a)<0?-1:1)}},rotationNormalized:{get:function(){var t=this.matrix,e=t[0],n=t[1],i=t[2],r=t[3];return e||n?0<n?Math.acos(e/this.scaleX):-Math.acos(e/this.scaleX):i||r?a.TAU-(0<r?Math.acos(-i/this.scaleY):-Math.acos(i/this.scaleY)):0}},scaleX:{get:function(){return Math.sqrt(this.a*this.a+this.b*this.b)}},scaleY:{get:function(){return Math.sqrt(this.c*this.c+this.d*this.d)}},loadIdentity:function(){var t=this.matrix;return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,this},translate:function(t,e){var n=this.matrix;return n[4]=n[0]*t+n[2]*e+n[4],n[5]=n[1]*t+n[3]*e+n[5],this},scale:function(t,e){var n=this.matrix;return n[0]*=t,n[1]*=t,n[2]*=e,n[3]*=e,this},rotate:function(t){var e=Math.sin(t),n=Math.cos(t),i=this.matrix,a=i[0],r=i[1],s=i[2],o=i[3];return i[0]=a*n+s*e,i[1]=r*n+o*e,i[2]=a*-e+s*n,i[3]=r*-e+o*n,this},multiply:function(t,e){var n=this.matrix,i=t.matrix,a=n[0],r=n[1],s=n[2],o=n[3],h=n[4],c=n[5],l=i[0],u=i[1],d=i[2],p=i[3],f=i[4],g=i[5],m=void 0===e?this:e;return m.a=l*a+u*s,m.b=l*r+u*o,m.c=d*a+p*s,m.d=d*r+p*o,m.e=f*a+g*s+h,m.f=f*r+g*o+c,m},multiplyWithOffset:function(t,e,n){var i=this.matrix,a=t.matrix,r=i[0],s=i[1],o=i[2],h=i[3],c=e*r+n*o+i[4],l=e*s+n*h+i[5],u=a[0],d=a[1],p=a[2],f=a[3],g=a[4],m=a[5];return i[0]=u*r+d*o,i[1]=u*s+d*h,i[2]=p*r+f*o,i[3]=p*s+f*h,i[4]=g*r+m*o+c,i[5]=g*s+m*h+l,this},transform:function(t,e,n,i,a,r){var s=this.matrix,o=s[0],h=s[1],c=s[2],l=s[3],u=s[4],d=s[5];return s[0]=t*o+e*c,s[1]=t*h+e*l,s[2]=n*o+i*c,s[3]=n*h+i*l,s[4]=a*o+r*c+u,s[5]=a*h+r*l+d,this},transformPoint:function(t,e,n){void 0===n&&(n={x:0,y:0});var i=this.matrix,a=i[0],r=i[1],s=i[2],o=i[3],h=i[4],c=i[5];return n.x=t*a+e*s+h,n.y=t*r+e*o+c,n},invert:function(){var t=this.matrix,e=t[0],n=t[1],i=t[2],a=t[3],r=t[4],s=t[5],o=e*a-n*i;return t[0]=a/o,t[1]=-n/o,t[2]=-i/o,t[3]=e/o,t[4]=(i*s-a*r)/o,t[5]=-(e*s-n*r)/o,this},copyFrom:function(t){var e=this.matrix;return e[0]=t.a,e[1]=t.b,e[2]=t.c,e[3]=t.d,e[4]=t.e,e[5]=t.f,this},copyFromArray:function(t){var e=this.matrix;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],this},copyToContext:function(t){var e=this.matrix;return t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t},setToContext:function(t){var e=this.matrix;return t.setTransform(e[0],e[1],e[2],e[3],e[4],e[5]),t},copyToArray:function(t){var e=this.matrix;return void 0===t?t=[e[0],e[1],e[2],e[3],e[4],e[5]]:(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5]),t},setTransform:function(t,e,n,i,a,r){var s=this.matrix;return s[0]=t,s[1]=e,s[2]=n,s[3]=i,s[4]=a,s[5]=r,this},decomposeMatrix:function(){var t,e,n=this.decomposedMatrix,i=this.matrix,a=i[0],r=i[1],s=i[2],o=i[3],h=a*o-r*s;return n.translateX=i[4],n.translateY=i[5],a||r?(t=Math.sqrt(a*a+r*r),n.rotation=0<r?Math.acos(a/t):-Math.acos(a/t),n.scaleX=t,n.scaleY=h/t):s||o?(e=Math.sqrt(s*s+o*o),n.rotation=.5*Math.PI-(0<o?Math.acos(-s/e):-Math.acos(s/e)),n.scaleX=h/e,n.scaleY=e):(n.rotation=0,n.scaleX=0,n.scaleY=0),n},applyITRS:function(t,e,n,i,a){var r=this.matrix,s=Math.sin(n),o=Math.cos(n);return r[4]=t,r[5]=e,r[0]=o*i,r[1]=s*i,r[2]=-s*a,r[3]=o*a,this},applyInverse:function(t,e,n){void 0===n&&(n=new r);var i=this.matrix,a=i[0],s=i[1],o=i[2],h=i[3],c=i[4],l=i[5],u=1/(a*h+o*-s);return n.x=h*u*t+-o*u*e+(l*o-c*h)*u,n.y=a*u*e+-s*u*t+(-l*a+c*s)*u,n},getX:function(t,e){return t*this.a+e*this.c+this.e},getY:function(t,e){return t*this.b+e*this.d+this.f},getXRound:function(t,e,n){var i=this.getX(t,e);return n&&(i=Math.round(i)),i},getYRound:function(t,e,n){var i=this.getY(t,e);return n&&(i=Math.round(i)),i},getCSSMatrix:function(){var t=this.matrix;return"matrix("+t[0]+","+t[1]+","+t[2]+","+t[3]+","+t[4]+","+t[5]+")"},destroy:function(){this.matrix=null,this.decomposedMatrix=null}});t.exports=s},function(t,e){t.exports=function(t){if(!Array.isArray(t)||t.length<2||!Array.isArray(t[0]))return!1;for(var e=t[0].length,n=1;n<t.length;n++)if(t[n].length!==e)return!1;return!0}},function(t,e,n){var i=n(0),a=n(299),r=n(61),s=n(300),o=n(26),h=n(301),c=n(306),l=new i({initialize:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.type=o.RECTANGLE,this.x=t,this.y=e,this.width=n,this.height=i},contains:function(t,e){return a(this,t,e)},getPoint:function(t,e){return r(this,t,e)},getPoints:function(t,e,n){return s(this,t,e,n)},getRandomPoint:function(t){return c(this,t)},setTo:function(t,e,n,i){return this.x=t,this.y=e,this.width=n,this.height=i,this},setEmpty:function(){return this.setTo(0,0,0,0)},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setSize:function(t,e){return void 0===e&&(e=t),this.width=t,this.height=e,this},isEmpty:function(){return this.width<=0||this.height<=0},getLineA:function(t){return void 0===t&&(t=new h),t.setTo(this.x,this.y,this.right,this.y),t},getLineB:function(t){return void 0===t&&(t=new h),t.setTo(this.right,this.y,this.right,this.bottom),t},getLineC:function(t){return void 0===t&&(t=new h),t.setTo(this.right,this.bottom,this.x,this.bottom),t},getLineD:function(t){return void 0===t&&(t=new h),t.setTo(this.x,this.bottom,this.x,this.y),t},left:{get:function(){return this.x},set:function(t){t>=this.right?this.width=0:this.width=this.right-t,this.x=t}},right:{get:function(){return this.x+this.width},set:function(t){t<=this.x?this.width=0:this.width=t-this.x}},top:{get:function(){return this.y},set:function(t){t>=this.bottom?this.height=0:this.height=this.bottom-t,this.y=t}},bottom:{get:function(){return this.y+this.height},set:function(t){t<=this.y?this.height=0:this.height=t-this.y}},centerX:{get:function(){return this.x+this.width/2},set:function(t){this.x=t-this.width/2}},centerY:{get:function(){return this.y+this.height/2},set:function(t){this.y=t-this.height/2}}});t.exports=l},function(t,e){t.exports={CIRCLE:0,ELLIPSE:1,LINE:2,POINT:3,POLYGON:4,RECTANGLE:5,TRIANGLE:6}},function(t,e,n){var i=n(7);t.exports=function t(){var e,n,a,r,s,o,h=arguments[0]||{},c=1,l=arguments.length,u=!1;for("boolean"==typeof h&&(u=h,h=arguments[1]||{},c=2),l===c&&(h=this,--c);c<l;c++)if(null!=(e=arguments[c]))for(n in e)a=h[n],h!==(r=e[n])&&(u&&r&&(i(r)||(s=Array.isArray(r)))?(o=s?(s=!1,a&&Array.isArray(a)?a:[]):a&&i(a)?a:{},h[n]=t(u,o,r)):void 0!==r&&(h[n]=r));return h}},function(t,e){t.exports=function(t,e,n,i){return Math.atan2(i-e,n-t)}},function(t,e){t.exports=function(t){return 0<=(t%=2*Math.PI)?t:t+2*Math.PI}},function(t,e,n){var i=n(6);t.exports=function(t){return i(t,-Math.PI,Math.PI)}},function(t,e,n){var i=n(6);t.exports=function(t){return i(t,-180,180)}},function(t,e){t.exports=function(t,e,n){return void 0===n&&(n=1e-4),Math.abs(t-e)<n}},function(t,e,n){var i=n(34);t.exports=function(t,e){return i(t)/i(e)/i(t-e)}},function(t,e){t.exports=function(t){if(0===t)return 1;for(var e=t;--t;)e*=t;return e}},function(t,e){t.exports=function(t,e,n,i,a){var r=.5*(i-e),s=.5*(a-n),o=t*t;return(2*n-2*i+r+s)*(t*o)+(-3*n+3*i-2*r-s)*o+r*t+n}},function(t,e){t.exports=function(t,e,n){return(e-t)*n+t}},function(t,e){t.exports=function(t,e,n){return t<=e?0:n<=t?1:(t=(t-e)/(n-e))*t*(3-2*t)}},function(t,e){t.exports=function(t,e,n){return(t=Math.max(0,Math.min(1,(t-e)/(n-e))))*t*t*(t*(6*t-15)+10)}},function(t,e){t.exports=function(t,e,n,i){var a=Math.cos(i),r=Math.sin(i),s=t.x-e,o=t.y-n;return t.x=s*a-o*r+e,t.y=s*r+o*a+n,t}},function(t,e){t.exports=function(t){return 0<t?Math.ceil(t):Math.floor(t)}},function(t,e,n){var i=n(2);t.exports=function(t,e,n,a,r,s,o,h){void 0===h&&(h=new i);var c=Math.sin(r),l=Math.cos(r),u=l*s,d=c*s,p=-c*o,f=l*o,g=1/(u*f+p*-d);return h.x=f*g*t+-p*g*e+(a*p-n*f)*g,h.y=u*g*e+-d*g*t+(-a*u+n*d)*g,h}},function(t,e,n){var i=new(n(0))({initialize:function(t){this.val=new Float32Array(9),t?this.copy(t):this.identity()},clone:function(){return new i(this)},set:function(t){return this.copy(t)},copy:function(t){var e=this.val,n=t.val;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},fromMat4:function(t){var e=t.val,n=this.val;return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[4],n[4]=e[5],n[5]=e[6],n[6]=e[8],n[7]=e[9],n[8]=e[10],this},fromArray:function(t){var e=this.val;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this},identity:function(){var t=this.val;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,this},transpose:function(){var t=this.val,e=t[1],n=t[2],i=t[5];return t[1]=t[3],t[2]=t[6],t[3]=e,t[5]=t[7],t[6]=n,t[7]=i,this},invert:function(){var t=this.val,e=t[0],n=t[1],i=t[2],a=t[3],r=t[4],s=t[5],o=t[6],h=t[7],c=t[8],l=c*r-s*h,u=-c*a+s*o,d=h*a-r*o,p=e*l+n*u+i*d;return p?(p=1/p,t[0]=l*p,t[1]=(-c*n+i*h)*p,t[2]=(s*n-i*r)*p,t[3]=u*p,t[4]=(c*e-i*o)*p,t[5]=(-s*e+i*a)*p,t[6]=d*p,t[7]=(-h*e+n*o)*p,t[8]=(r*e-n*a)*p,this):null},adjoint:function(){var t=this.val,e=t[0],n=t[1],i=t[2],a=t[3],r=t[4],s=t[5],o=t[6],h=t[7],c=t[8];return t[0]=r*c-s*h,t[1]=i*h-n*c,t[2]=n*s-i*r,t[3]=s*o-a*c,t[4]=e*c-i*o,t[5]=i*a-e*s,t[6]=a*h-r*o,t[7]=n*o-e*h,t[8]=e*r-n*a,this},determinant:function(){var t=this.val,e=t[0],n=t[1],i=t[2],a=t[3],r=t[4],s=t[5],o=t[6],h=t[7],c=t[8];return e*(c*r-s*h)+n*(-c*a+s*o)+i*(h*a-r*o)},multiply:function(t){var e=this.val,n=e[0],i=e[1],a=e[2],r=e[3],s=e[4],o=e[5],h=e[6],c=e[7],l=e[8],u=t.val,d=u[0],p=u[1],f=u[2],g=u[3],m=u[4],v=u[5],y=u[6],S=u[7],A=u[8];return e[0]=d*n+p*r+f*h,e[1]=d*i+p*s+f*c,e[2]=d*a+p*o+f*l,e[3]=g*n+m*r+v*h,e[4]=g*i+m*s+v*c,e[5]=g*a+m*o+v*l,e[6]=y*n+S*r+A*h,e[7]=y*i+S*s+A*c,e[8]=y*a+S*o+A*l,this},translate:function(t){var e=this.val,n=t.x,i=t.y;return e[6]=n*e[0]+i*e[3]+e[6],e[7]=n*e[1]+i*e[4]+e[7],e[8]=n*e[2]+i*e[5]+e[8],this},rotate:function(t){var e=this.val,n=e[0],i=e[1],a=e[2],r=e[3],s=e[4],o=e[5],h=Math.sin(t),c=Math.cos(t);return e[0]=c*n+h*r,e[1]=c*i+h*s,e[2]=c*a+h*o,e[3]=c*r-h*n,e[4]=c*s-h*i,e[5]=c*o-h*a,this},scale:function(t){var e=this.val,n=t.x,i=t.y;return e[0]=n*e[0],e[1]=n*e[1],e[2]=n*e[2],e[3]=i*e[3],e[4]=i*e[4],e[5]=i*e[5],this},fromQuat:function(t){var e=t.x,n=t.y,i=t.z,a=t.w,r=e+e,s=n+n,o=i+i,h=e*r,c=e*s,l=e*o,u=n*s,d=n*o,p=i*o,f=a*r,g=a*s,m=a*o,v=this.val;return v[0]=1-(u+p),v[3]=c+m,v[6]=l-g,v[1]=c-m,v[4]=1-(h+p),v[7]=d+f,v[2]=l+g,v[5]=d-f,v[8]=1-(h+u),this},normalFromMat4:function(t){var e=t.val,n=this.val,i=e[0],a=e[1],r=e[2],s=e[3],o=e[4],h=e[5],c=e[6],l=e[7],u=e[8],d=e[9],p=e[10],f=e[11],g=e[12],m=e[13],v=e[14],y=e[15],S=i*h-a*o,A=i*c-r*o,E=i*l-s*o,x=a*c-r*h,b=a*l-s*h,T=r*l-s*c,w=u*m-d*g,C=u*v-p*g,M=u*y-f*g,I=d*v-p*m,P=d*y-f*m,k=p*y-f*v,R=S*k-A*P+E*I+x*M-b*C+T*w;return R?(R=1/R,n[0]=(h*k-c*P+l*I)*R,n[1]=(c*M-o*k-l*C)*R,n[2]=(o*P-h*M+l*w)*R,n[3]=(r*P-a*k-s*I)*R,n[4]=(i*k-r*M+s*C)*R,n[5]=(a*M-i*P-s*w)*R,n[6]=(m*T-v*b+y*x)*R,n[7]=(v*E-g*T-y*A)*R,n[8]=(g*b-m*E+y*S)*R,this):null}});t.exports=i},function(t,e,n){var i=n(0),a=n(42),r=n(1),s=n(14),o=new Int8Array([1,2,0]),h=new Float32Array([0,0,0]),c=new s(1,0,0),l=new s(0,1,0),u=new s,d=new a,p=new i({initialize:function(t,e,n,i){this.onChangeCallback=r,this.set(t,e,n,i)},x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback(this)}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback(this)}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback(this)}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback(this)}},copy:function(t){return this.set(t)},set:function(t,e,n,i,a){return void 0===a&&(a=!0),"object"==typeof t?(this._x=t.x||0,this._y=t.y||0,this._z=t.z||0,this._w=t.w||0):(this._x=t||0,this._y=e||0,this._z=n||0,this._w=i||0),a&&this.onChangeCallback(this),this},add:function(t){return this._x+=t.x,this._y+=t.y,this._z+=t.z,this._w+=t.w,this.onChangeCallback(this),this},subtract:function(t){return this._x-=t.x,this._y-=t.y,this._z-=t.z,this._w-=t.w,this.onChangeCallback(this),this},scale:function(t){return this._x*=t,this._y*=t,this._z*=t,this._w*=t,this.onChangeCallback(this),this},length:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return Math.sqrt(t*t+e*e+n*n+i*i)},lengthSq:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return t*t+e*e+n*n+i*i},normalize:function(){var t=this.x,e=this.y,n=this.z,i=this.w,a=t*t+e*e+n*n+i*i;return 0<a&&(a=1/Math.sqrt(a),this._x=t*a,this._y=e*a,this._z=n*a,this._w=i*a),this.onChangeCallback(this),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lerp:function(t,e){void 0===e&&(e=0);var n=this.x,i=this.y,a=this.z,r=this.w;return this.set(n+e*(t.x-n),i+e*(t.y-i),a+e*(t.z-a),r+e*(t.w-r))},rotationTo:function(t,e){var n=t.x*e.x+t.y*e.y+t.z*e.z;return n<-.999999?(u.copy(c).cross(t).length()<1e-6&&u.copy(l).cross(t),u.normalize(),this.setAxisAngle(u,Math.PI)):.999999<n?this.set(0,0,0,1):(u.copy(t).cross(e),this._x=u.x,this._y=u.y,this._z=u.z,this._w=1+n,this.normalize())},setAxes:function(t,e,n){var i=d.val;return i[0]=e.x,i[3]=e.y,i[6]=e.z,i[1]=n.x,i[4]=n.y,i[7]=n.z,i[2]=-t.x,i[5]=-t.y,i[8]=-t.z,this.fromMat3(d).normalize()},identity:function(){return this.set(0,0,0,1)},setAxisAngle:function(t,e){e*=.5;var n=Math.sin(e);return this.set(n*t.x,n*t.y,n*t.z,Math.cos(e))},multiply:function(t){var e=this.x,n=this.y,i=this.z,a=this.w,r=t.x,s=t.y,o=t.z,h=t.w;return this.set(e*h+a*r+n*o-i*s,n*h+a*s+i*r-e*o,i*h+a*o+e*s-n*r,a*h-e*r-n*s-i*o)},slerp:function(t,e){var n=this.x,i=this.y,a=this.z,r=this.w,s=t.x,o=t.y,h=t.z,c=t.w,l=n*s+i*o+a*h+r*c;l<0&&(l=-l,s=-s,o=-o,h=-h,c=-c);var u,d,p=1-e,f=e;return 1e-6<1-l&&(u=Math.acos(l),d=Math.sin(u),p=Math.sin((1-e)*u)/d,f=Math.sin(e*u)/d),this.set(p*n+f*s,p*i+f*o,p*a+f*h,p*r+f*c)},invert:function(){var t=this.x,e=this.y,n=this.z,i=this.w,a=t*t+e*e+n*n+i*i,r=a?1/a:0;return this.set(-t*r,-e*r,-n*r,i*r)},conjugate:function(){return this._x=-this.x,this._y=-this.y,this._z=-this.z,this.onChangeCallback(this),this},rotateX:function(t){t*=.5;var e=this.x,n=this.y,i=this.z,a=this.w,r=Math.sin(t),s=Math.cos(t);return this.set(e*s+a*r,n*s+i*r,i*s-n*r,a*s-e*r)},rotateY:function(t){t*=.5;var e=this.x,n=this.y,i=this.z,a=this.w,r=Math.sin(t),s=Math.cos(t);return this.set(e*s-i*r,n*s+a*r,i*s+e*r,a*s-n*r)},rotateZ:function(t){t*=.5;var e=this.x,n=this.y,i=this.z,a=this.w,r=Math.sin(t),s=Math.cos(t);return this.set(e*s+n*r,n*s-e*r,i*s+a*r,a*s-i*r)},calculateW:function(){var t=this.x,e=this.y,n=this.z;return this.w=-Math.sqrt(1-t*t-e*e-n*n),this},setFromEuler:function(t,e){var n=t.x/2,i=t.y/2,a=t.z/2,r=Math.cos(n),s=Math.cos(i),o=Math.cos(a),h=Math.sin(n),c=Math.sin(i),l=Math.sin(a);switch(t.order){case"XYZ":this.set(h*s*o+r*c*l,r*c*o-h*s*l,r*s*l+h*c*o,r*s*o-h*c*l,e);break;case"YXZ":this.set(h*s*o+r*c*l,r*c*o-h*s*l,r*s*l-h*c*o,r*s*o+h*c*l,e);break;case"ZXY":this.set(h*s*o-r*c*l,r*c*o+h*s*l,r*s*l+h*c*o,r*s*o-h*c*l,e);break;case"ZYX":this.set(h*s*o-r*c*l,r*c*o+h*s*l,r*s*l-h*c*o,r*s*o+h*c*l,e);break;case"YZX":this.set(h*s*o+r*c*l,r*c*o+h*s*l,r*s*l-h*c*o,r*s*o-h*c*l,e);break;case"XZY":this.set(h*s*o-r*c*l,r*c*o-h*s*l,r*s*l+h*c*o,r*s*o+h*c*l,e)}return this},setFromRotationMatrix:function(t){var e,n=t.val,i=n[0],a=n[4],r=n[8],s=n[1],o=n[5],h=n[9],c=n[2],l=n[6],u=n[10],d=i+o+u;return 0<d?(e=.5/Math.sqrt(d+1),this.set((l-h)*e,(r-c)*e,(s-a)*e,.25/e)):o<i&&u<i?(e=2*Math.sqrt(1+i-o-u),this.set(.25*e,(a+s)/e,(r+c)/e,(l-h)/e)):u<o?(e=2*Math.sqrt(1+o-i-u),this.set((a+s)/e,.25*e,(h+l)/e,(r-c)/e)):(e=2*Math.sqrt(1+u-i-o),this.set((r+c)/e,(h+l)/e,.25*e,(s-a)/e)),this},fromMat3:function(t){var e,n,i,a,r=t.val,s=r[0]+r[4]+r[8];return 0<s?(a=Math.sqrt(s+1),this.w=.5*a,a=.5/a,this._x=(r[7]-r[5])*a,this._y=(r[2]-r[6])*a,this._z=(r[3]-r[1])*a):(e=0,r[4]>r[0]&&(e=1),r[8]>r[3*e+e]&&(e=2),n=o[e],i=o[n],a=Math.sqrt(r[3*e+e]-r[3*n+n]-r[3*i+i]+1),h[e]=.5*a,a=.5/a,h[n]=(r[3*n+e]+r[3*e+n])*a,h[i]=(r[3*i+e]+r[3*e+i])*a,this._x=h[0],this._y=h[1],this._z=h[2],this._w=(r[3*i+n]-r[3*n+i])*a),this.onChangeCallback(this),this}});t.exports=p},function(t,e,n){t.exports={ADDED_TO_SCENE:n(180),BOOT:n(181),CREATE:n(182),DESTROY:n(183),PAUSE:n(184),POST_UPDATE:n(185),PRE_RENDER:n(186),PRE_UPDATE:n(187),READY:n(188),REMOVED_FROM_SCENE:n(189),RENDER:n(190),RESUME:n(191),SHUTDOWN:n(192),SLEEP:n(193),START:n(194),TRANSITION_COMPLETE:n(195),TRANSITION_INIT:n(196),TRANSITION_OUT:n(197),TRANSITION_START:n(198),TRANSITION_WAKE:n(199),UPDATE:n(200),WAKE:n(201)}},function(t,e,n){var i=n(27),a=n(46);t.exports=function(t,e){var n=void 0===t?a():i({},t);if(e)for(var r in e)void 0!==e[r]&&(n[r]=e[r]);return n}},function(t,e){t.exports=function(t,e,n,i,a,r){return void 0===t&&(t=""),void 0===e&&(e=!0),void 0===n&&(n=""),void 0===i&&(i=""),void 0===a&&(a=0),void 0===r&&(r=!1),{responseType:t,async:e,user:n,password:i,timeout:a,headers:void 0,header:void 0,headerValue:void 0,requestedWith:!1,overrideMimeType:void 0,withCredentials:r}}},function(t,e){t.exports={width:0,height:0,displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this}}},function(t,e){t.exports={_depth:0,depth:{get:function(){return this._depth},set:function(t){this.displayList&&this.displayList.queueDepthSort(),this._depth=t}},setDepth:function(t){return void 0===t&&(t=0),this.depth=t,this}}},function(t,e){t.exports={flipX:!1,flipY:!1,toggleFlipX:function(){return this.flipX=!this.flipX,this},toggleFlipY:function(){return this.flipY=!this.flipY,this},setFlipX:function(t){return this.flipX=t,this},setFlipY:function(t){return this.flipY=t,this},setFlip:function(t,e){return this.flipX=t,this.flipY=e,this},resetFlip:function(){return this.flipX=!1,this.flipY=!1,this}}},function(t,e){t.exports={scrollFactorX:1,scrollFactorY:1,setScrollFactor:function(t,e){return void 0===e&&(e=t),this.scrollFactorX=t,this.scrollFactorY=e,this}}},function(t,e,n){var i=n(4),a=n(23),r=n(41),s=n(30),o=n(31),h=n(2),c={_scaleX:1,_scaleY:1,_rotation:0,x:0,y:0,z:0,w:0,scale:{get:function(){return(this._scaleX+this._scaleY)/2},set:function(t){this._scaleX=t,0===(this._scaleY=t)?this.renderFlags&=-5:this.renderFlags|=4}},scaleX:{get:function(){return this._scaleX},set:function(t){0===(this._scaleX=t)?this.renderFlags&=-5:this.renderFlags|=4}},scaleY:{get:function(){return this._scaleY},set:function(t){0===(this._scaleY=t)?this.renderFlags&=-5:this.renderFlags|=4}},angle:{get:function(){return o(this._rotation*i.RAD_TO_DEG)},set:function(t){this.rotation=o(t)*i.DEG_TO_RAD}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation=s(t)}},setPosition:function(t,e,n,i){return void 0===t&&(t=0),void 0===e&&(e=t),void 0===n&&(n=0),void 0===i&&(i=0),this.x=t,this.y=e,this.z=n,this.w=i,this},copyPosition:function(t){return void 0!==t.x&&(this.x=t.x),void 0!==t.y&&(this.y=t.y),void 0!==t.z&&(this.z=t.z),void 0!==t.w&&(this.w=t.w),this},setRandomPosition:function(t,e,n,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.scene.sys.scale.width),void 0===i&&(i=this.scene.sys.scale.height),this.x=t+Math.random()*n,this.y=e+Math.random()*i,this},setRotation:function(t){return void 0===t&&(t=0),this.rotation=t,this},setAngle:function(t){return void 0===t&&(t=0),this.angle=t,this},setScale:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=t),this.scaleX=t,this.scaleY=e,this},setX:function(t){return void 0===t&&(t=0),this.x=t,this},setY:function(t){return void 0===t&&(t=0),this.y=t,this},setZ:function(t){return void 0===t&&(t=0),this.z=t,this},setW:function(t){return void 0===t&&(t=0),this.w=t,this},getLocalTransformMatrix:function(t){return void 0===t&&(t=new a),t.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY)},getWorldTransformMatrix:function(t,e){void 0===t&&(t=new a),void 0===e&&(e=new a);var n=this.parentContainer;if(!n)return this.getLocalTransformMatrix(t);for(t.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY);n;)e.applyITRS(n.x,n.y,n._rotation,n._scaleX,n._scaleY),e.multiply(t,t),n=n.parentContainer;return t},getLocalPoint:function(t,e,n,i){n=n||new h;var a=(i=i||this.scene.sys.cameras.main).scrollX,s=i.scrollY,o=t+a*this.scrollFactorX-a,c=e+s*this.scrollFactorY-s;return this.parentContainer?this.getWorldTransformMatrix().applyInverse(o,c,n):r(o,c,this.x,this.y,this.rotation,this.scaleX,this.scaleY,n),this._originComponent&&(n.x+=this._displayOriginX,n.y+=this._displayOriginY),n},getParentRotation:function(){for(var t=0,e=this.parentContainer;e;)t+=e.rotation,e=e.parentContainer;return t}};t.exports=c},function(t,e){t.exports={_visible:!0,visible:{get:function(){return this._visible},set:function(t){t?(this._visible=!0,this.renderFlags|=1):(this._visible=!1,this.renderFlags&=-2)}},setVisible:function(t){return this.visible=t,this}}},function(t,e,n){var i=n(0),a=n(54),r=n(222),s=n(229),o=n(55),h=n(44),c=new i({Extends:s,initialize:function(t,e){s.call(this),this.scene=t,this.displayList=null,this.type=e,this.state=0,this.parentContainer=null,this.name="",this.active=!0,this.tabIndex=-1,this.data=null,this.renderFlags=15,this.cameraFilter=0,this.input=null,this.body=null,this.ignoreDestroy=!1,this.on(o.ADDED_TO_SCENE,this.addedToScene,this),this.on(o.REMOVED_FROM_SCENE,this.removedFromScene,this),t.sys.queueDepthSort()},setActive:function(t){return this.active=t,this},setName:function(t){return this.name=t,this},setState:function(t){return this.state=t,this},setDataEnabled:function(){return this.data||(this.data=new r(this)),this},setData:function(t,e){return this.data||(this.data=new r(this)),this.data.set(t,e),this},incData:function(t,e){return this.data||(this.data=new r(this)),this.data.inc(t,e),this},toggleData:function(t){return this.data||(this.data=new r(this)),this.data.toggle(t),this},getData:function(t){return this.data||(this.data=new r(this)),this.data.get(t)},setInteractive:function(t,e,n){return this.scene.sys.input.enable(this,t,e,n),this},disableInteractive:function(){return this.input&&(this.input.enabled=!1),this},removeInteractive:function(){return this.scene.sys.input.clear(this),this.input=void 0,this},addedToScene:function(){},removedFromScene:function(){},update:function(){},toJSON:function(){return a(this)},willRender:function(t){return!(c.RENDER_MASK!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&t.id)},getIndexList:function(){for(var t=this,e=this.parentContainer,n=[];e&&(n.unshift(e.getIndex(t)),(t=e).parentContainer);)e=e.parentContainer;return this.displayList?n.unshift(this.displayList.getIndex(t)):n.unshift(this.scene.sys.displayList.getIndex(t)),n},addToDisplayList:function(t){return void 0===t&&(t=this.scene.sys.displayList),this.displayList&&this.displayList!==t&&this.removeFromDisplayList(),t.exists(this)||((this.displayList=t).add(this,!0),t.queueDepthSort(),this.emit(o.ADDED_TO_SCENE,this,this.scene),t.events.emit(h.ADDED_TO_SCENE,this,this.scene)),this},addToUpdateList:function(){return this.scene&&this.preUpdate&&this.scene.sys.updateList.add(this),this},removeFromDisplayList:function(){var t=this.displayList||this.scene.sys.displayList;return t.exists(this)&&(t.remove(this,!0),t.queueDepthSort(),this.displayList=null,this.emit(o.REMOVED_FROM_SCENE,this,this.scene),t.events.emit(h.REMOVED_FROM_SCENE,this,this.scene)),this},removeFromUpdateList:function(){return this.scene&&this.preUpdate&&this.scene.sys.updateList.remove(this),this},destroy:function(){this.scene&&!this.ignoreDestroy&&(this.preDestroy&&this.preDestroy.call(this),this.emit(o.DESTROY,this),this.removeAllListeners(),this.postPipelines&&this.resetPostPipeline(!0),this.removeFromDisplayList(),this.removeFromUpdateList(),this.input&&(this.scene.sys.input.clear(this),this.input=void 0),this.data&&(this.data.destroy(),this.data=void 0),this.body&&(this.body.destroy(),this.body=void 0),this.active=!1,this.visible=!1,this.scene=void 0,this.parentContainer=void 0)}});c.RENDER_MASK=15,t.exports=c},function(t,e){t.exports=function(t){var e={name:t.name,type:t.type,x:t.x,y:t.y,depth:t.depth,scale:{x:t.scaleX,y:t.scaleY},origin:{x:t.originX,y:t.originY},flipX:t.flipX,flipY:t.flipY,rotation:t.rotation,alpha:t.alpha,visible:t.visible,blendMode:t.blendMode,textureKey:"",frameKey:"",data:{}};return t.texture&&(e.textureKey=t.texture.key,e.frameKey=t.frame.name),e}},function(t,e,n){t.exports={ADDED_TO_SCENE:n(230),DESTROY:n(231),REMOVED_FROM_SCENE:n(232),VIDEO_COMPLETE:n(233),VIDEO_CREATED:n(234),VIDEO_ERROR:n(235),VIDEO_LOOP:n(236),VIDEO_PLAY:n(237),VIDEO_SEEKED:n(238),VIDEO_SEEKING:n(239),VIDEO_STOP:n(240),VIDEO_TIMEOUT:n(241),VIDEO_UNLOCKED:n(242)}},function(t,e,n){var i=n(23),a=new i,r=new i,s=new i,o={camera:a,sprite:r,calc:s};t.exports=function(t,e,n){var i=a,h=r,c=s;return h.applyITRS(t.x,t.y,t.rotation,t.scaleX,t.scaleY),i.copyFrom(e.matrix),n?(i.multiplyWithOffset(n,-e.scrollX*t.scrollFactorX,-e.scrollY*t.scrollFactorY),h.e=t.x,h.f=t.y):(h.e-=e.scrollX*t.scrollFactorX,h.f-=e.scrollY*t.scrollFactorY),i.multiply(h,c),o}},function(t,e){t.exports=function(t){for(var e=t.length,n=t[0].length,i=new Array(n),a=0;a<n;a++){i[a]=new Array(e);for(var r=e-1;-1<r;r--)i[a][r]=t[r][a]}return i}},function(t,e){t.exports=function(t,e){void 0===e&&(e=1);for(var n=null,i=0;i<e;i++)n=t.shift(),t.push(n);return n}},function(t,e){t.exports=function(t,e){void 0===e&&(e=1);for(var n=null,i=0;i<e;i++)n=t.pop(),t.unshift(n);return n}},function(t,e){t.exports=function(t){for(var e=t.length-1;0<e;e--){var n=Math.floor(Math.random()*(e+1)),i=t[e];t[e]=t[n],t[n]=i}return t}},function(t,e,n){var i=n(62),a=n(13);t.exports=function(t,e,n){if(void 0===n&&(n=new a),e<=0||1<=e)return n.x=t.x,n.y=t.y,n;var r=i(t)*e;return.5<e?(r-=t.width+t.height)<=t.width?(n.x=t.right-r,n.y=t.bottom):(n.x=t.x,n.y=t.bottom-(r-t.width)):r<=t.width?(n.x=t.x+r,n.y=t.y):(n.x=t.right,n.y=t.y+(r-t.width)),n}},function(t,e){t.exports=function(t){return 2*(t.width+t.height)}},function(t,e,n){var i,a=n(64),r=n(0),s=n(10),o=n(177),h=n(178),c=n(202),l=n(203),u=n(221),d=n(254),p=n(1),f=new r({Extends:h,initialize:function(t,e,n){h.call(this,t,e,n);var i=e.game;this.isWebGL=2===i.config.renderType,this.cache=i.cache.addCustom("spine"),this.spineTextures=i.cache.addCustom("spineTextures"),this.json=i.cache.json,this.textures=i.textures,this.drawDebug=!1,this.gl,this.renderer,this.sceneRenderer,this.skeletonRenderer,this.skeletonDebugRenderer,this.plugin=c,this.temp1,this.temp2,this.isWebGL?(this.runtime=c.webgl,this.renderer=i.renderer,this.gl=i.renderer.gl,this.getAtlas=this.getAtlasWebGL):(this.runtime=c.canvas,this.renderer=i.renderer,this.getAtlas=this.getAtlasCanvas),this.renderer||(this.renderer={width:i.scale.width,height:i.scale.height,preRender:p,postRender:p,render:p,destroy:p}),e.registerFileType("spine",this.spineFileCallback,t),e.registerGameObject("spine",(function(t,e,i,a,r){var s=this.scene.sys[n],o=new u(this.scene,s,t,e,i,a,r);return this.displayList.add(o),this.updateList.add(o),o}),(function(t,e){void 0===t&&(t={});var i=s(t,"key",null),r=s(t,"animationName",null),o=s(t,"loop",!1),h=this.scene.sys[n],c=new u(this.scene,h,0,0,i,r,o);void 0!==e&&(t.add=e),a(this.scene,c,t);var l=s(t,"skinName",!1);l&&c.setSkinByName(l);var d=s(t,"slotName",!1),p=s(t,"attachmentName",null);return d&&c.setAttachment(d,p),c.refresh()})),e.registerGameObject("spineContainer",(function(t,e,i){var a=this.scene.sys[n],r=new d(this.scene,a,t,e,i);return this.displayList.add(r),r}),(function(t,e){void 0===t&&(t={});var i=s(t,"x",0),r=s(t,"y",0),o=s(t,"children",null),h=this.scene.sys[n],c=new d(this.scene,h,i,r,o);return void 0!==e&&(t.add=e),a(this.scene,c,t),c}))},boot:function(){this.isWebGL?(this.bootWebGL(),this.onResize(),this.game.scale.on(o,this.onResize,this)):this.bootCanvas();var t=this.systems.events;t.once("shutdown",this.shutdown,this),t.once("destroy",this.destroy,this),this.game.events.once("destroy",this.gameDestroy,this)},bootCanvas:function(){this.skeletonRenderer=new c.canvas.SkeletonRenderer(this.scene.sys.context)},bootWebGL:function(){function t(t,e){var n;t===this.srcBlend&&e===this.dstBlend||(n=this.context.gl,this.srcBlend=t,this.dstBlend=e,this.isDrawing&&(this.flush(),n.blendFunc(this.srcBlend,this.dstBlend)))}i||((i=new c.webgl.SceneRenderer(this.renderer.canvas,this.gl,!0)).batcher.setBlendMode=t,i.shapes.setBlendMode=t),this.sceneRenderer=i,this.skeletonRenderer=i.skeletonRenderer,this.skeletonDebugRenderer=i.skeletonDebugRenderer,this.temp1=new c.webgl.Vector3(0,0,0),this.temp2=new c.webgl.Vector3(0,0,0)},getAtlasCanvas:function(t){var e=this.cache.get(t);if(e){var n,i=this.spineTextures;return i.has(t)?i.get(t):(n=this.textures,new c.TextureAtlas(e.data,(function(t){return new c.canvas.CanvasTexture(n.get(e.prefix+t).getSourceImage())})))}},getAtlasWebGL:function(t){var e=this.cache.get(t);if(e){var n,i,a=this.spineTextures,r=a.has(t)?a.get(t):(n=this.textures,(i=this.sceneRenderer.context.gl).pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),new c.TextureAtlas(e.data,(function(t){return new c.webgl.GLTexture(i,n.get(e.prefix+t).getSourceImage(),!1)})));return r}},spineFileCallback:function(t,e,n,i,a,r){var s;if(Array.isArray(t))for(var o=0;o<t.length;o++)s=new l(this,t[o]),this.addFile(s.files);else s=new l(this,t,e,n,i,a,r),this.addFile(s.files);return this},worldToLocal:function(t,e,n,i){var a=this.temp1,r=this.temp2,s=this.sceneRenderer.camera;a.set(t+n.x,e-n.y,0);var o=s.viewportWidth,h=s.viewportHeight;return s.screenToWorld(a,o,h),i&&null!==i.parent?(i.parent.worldToLocal(r.set(a.x-n.x,a.y-n.y,0)),new c.Vector2(r.x,r.y)):i?new c.Vector2(a.x-n.x,a.y-n.y):new c.Vector2(a.x,a.y)},getVector2:function(t,e){return new c.Vector2(t,e)},getVector3:function(t,e,n){return new c.webgl.Vector3(t,e,n)},setDebugBones:function(t){return void 0===t&&(t=!0),this.skeletonDebugRenderer.drawBones=t,this},setDebugRegionAttachments:function(t){return void 0===t&&(t=!0),this.skeletonDebugRenderer.drawRegionAttachments=t,this},setDebugBoundingBoxes:function(t){return void 0===t&&(t=!0),this.skeletonDebugRenderer.drawBoundingBoxes=t,this},setDebugMeshHull:function(t){return void 0===t&&(t=!0),this.skeletonDebugRenderer.drawMeshHull=t,this},setDebugMeshTriangles:function(t){return void 0===t&&(t=!0),this.skeletonDebugRenderer.drawMeshTriangles=t,this},setDebugPaths:function(t){return void 0===t&&(t=!0),this.skeletonDebugRenderer.drawPaths=t,this},setDebugSkeletonXY:function(t){return void 0===t&&(t=!0),this.skeletonDebugRenderer.drawSkeletonXY=t,this},setDebugClipping:function(t){return void 0===t&&(t=!0),this.skeletonDebugRenderer.drawClipping=t,this},setEffect:function(t){return this.sceneRenderer.skeletonRenderer.vertexEffect=t,this},createSkeleton:function(t,e){var n,i=t,a=t,r=-1!==g()(t).call(t,".");r&&(i=(n=t.split(".")).shift(),a=n.join("."));var o=this.cache.get(i),h=this.getAtlas(i);if(!h)return null;this.spineTextures.has(i)||this.spineTextures.add(i,h);var l,u,d=o.preMultipliedAlpha,p=new c.AtlasAttachmentLoader(h),f=new c.SkeletonJson(p);if(u=e||(l=this.json.get(i),r?s(l,a):l)){var m=f.readSkeletonData(u);return{skeletonData:m,skeleton:new c.Skeleton(m),preMultipliedAlpha:d}}return null},createAnimationState:function(t){var e=new c.AnimationStateData(t.data);return{stateData:e,state:new c.AnimationState(e)}},getBounds:function(t){var e=new c.Vector2,n=new c.Vector2;return t.getBounds(e,n,[]),{offset:e,size:n}},onResize:function(){var t=this.renderer,e=this.sceneRenderer,n=t.width,i=t.height;e.camera.position.x=n/2,e.camera.position.y=i/2,e.camera.setViewport(n,i)},shutdown:function(){this.systems.events.off("shutdown",this.shutdown,this),this.isWebGL&&this.game.scale.off(o,this.onResize,this)},destroy:function(){this.shutdown(),this.game=null,this.scene=null,this.systems=null,this.cache=null,this.spineTextures=null,this.json=null,this.textures=null,this.skeletonRenderer=null,this.gl=null},gameDestroy:function(){this.pluginManager.removeGameObject("spine",!0,!0),this.pluginManager.removeGameObject("spineContainer",!0,!0),this.pluginManager=null,i&&(i.dispose(),i=null),this.sceneRenderer=null}});f.SpineGameObject=u,f.SpineContainer=d,t.exports=f},function(t,e,n){var i=n(17),a=n(65);t.exports=function(t,e,n){e.x=a(n,"x",0),e.y=a(n,"y",0),e.depth=a(n,"depth",0),e.flipX=a(n,"flipX",!1),e.flipY=a(n,"flipY",!1);var r=a(n,"scale",null);"number"==typeof r?e.setScale(r):null!==r&&(e.scaleX=a(r,"x",1),e.scaleY=a(r,"y",1));var s=a(n,"scrollFactor",null);"number"==typeof s?e.setScrollFactor(s):null!==s&&(e.scrollFactorX=a(s,"x",1),e.scrollFactorY=a(s,"y",1)),e.rotation=a(n,"rotation",0);var o=a(n,"angle",null);null!==o&&(e.angle=o),e.alpha=a(n,"alpha",1);var h,c,l=a(n,"origin",null);return"number"==typeof l?e.setOrigin(l):null!==l&&(h=a(l,"x",.5),c=a(l,"y",.5),e.setOrigin(h,c)),e.blendMode=a(n,"blendMode",i.NORMAL),e.visible=a(n,"visible",!0),a(n,"add",!0)&&t.sys.displayList.add(e),e.preUpdate&&t.sys.updateList.add(e),e}},function(t,e,n){var i=n(66),a=n(10);t.exports=function(t,e,n){var r=a(t,e,null);if(null===r)return n;if(Array.isArray(r))return i.RND.pick(r);if("object"==typeof r){if(r.hasOwnProperty("randInt"))return i.RND.integerInRange(r.randInt[0],r.randInt[1]);if(r.hasOwnProperty("randFloat"))return i.RND.realInRange(r.randFloat[0],r.randFloat[1])}else if("function"==typeof r)return r(e);return r}},function(t,e,n){var i=n(4),a=n(27)(!1,a={Angle:n(67),Distance:n(76),Easing:n(84),Fuzzy:n(129),Interpolation:n(134),Pow2:n(142),Snap:n(146),RandomDataGenerator:n(150),Average:n(151),Bernstein:n(33),Between:n(152),CatmullRom:n(35),CeilTo:n(153),Clamp:n(3),DegToRad:n(19),Difference:n(154),Euler:n(155),Factorial:n(34),FloatBetween:n(18),FloorTo:n(156),FromPercent:n(157),GetSpeed:n(158),IsEven:n(159),IsEvenStrict:n(160),Linear:n(36),MaxAdd:n(161),Median:n(162),MinSub:n(163),Percent:n(164),RadToDeg:n(9),RandomXY:n(165),RandomXYZ:n(166),RandomXYZW:n(167),Rotate:n(168),RotateAround:n(39),RotateAroundDistance:n(169),RotateTo:n(170),RoundAwayFromZero:n(40),RoundTo:n(171),SinCosTableGenerator:n(172),SmootherStep:n(38),SmoothStep:n(37),ToXY:n(173),TransformXY:n(41),Within:n(174),Wrap:n(6),Vector2:n(2),Vector3:n(14),Vector4:n(175),Matrix3:n(42),Matrix4:n(20),Quaternion:n(43),RotateVec3:n(176)},i);t.exports=a},function(t,e,n){t.exports={Between:n(28),BetweenPoints:n(68),BetweenPointsY:n(69),BetweenY:n(70),CounterClockwise:n(8),Normalize:n(29),Random:n(71),RandomDegrees:n(72),Reverse:n(73),RotateTo:n(74),ShortestBetween:n(75),Wrap:n(30),WrapDegrees:n(31)}},function(t,e){t.exports=function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}},function(t,e){t.exports=function(t,e){return Math.atan2(e.x-t.x,e.y-t.y)}},function(t,e){t.exports=function(t,e,n,i){return Math.atan2(n-t,i-e)}},function(t,e,n){var i=n(18);t.exports=function(){return i(-Math.PI,Math.PI)}},function(t,e,n){var i=n(18);t.exports=function(){return i(-180,180)}},function(t,e,n){var i=n(29);t.exports=function(t){return i(t+Math.PI)}},function(t,e,n){var i=n(4);t.exports=function(t,e,n){return void 0===n&&(n=.05),t===e||(Math.abs(e-t)<=n||Math.abs(e-t)>=i.PI2-n?t=e:(Math.abs(e-t)>Math.PI&&(e<t?e+=i.PI2:e-=i.PI2),t<e?t+=n:e<t&&(t-=n))),t}},function(t,e){t.exports=function(t,e){var n=e-t;return 0==n?0:n-360*Math.floor((n+180)/360)}},function(t,e,n){t.exports={Between:n(77),BetweenPoints:n(78),BetweenPointsSquared:n(79),Chebyshev:n(80),Power:n(81),Snake:n(82),Squared:n(83)}},function(t,e){t.exports=function(t,e,n,i){var a=t-n,r=e-i;return Math.sqrt(a*a+r*r)}},function(t,e){t.exports=function(t,e){var n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)}},function(t,e){t.exports=function(t,e){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i}},function(t,e){t.exports=function(t,e,n,i){return Math.max(Math.abs(t-n),Math.abs(e-i))}},function(t,e){t.exports=function(t,e,n,i,a){return void 0===a&&(a=2),Math.sqrt(Math.pow(n-t,a)+Math.pow(i-e,a))}},function(t,e){t.exports=function(t,e,n,i){return Math.abs(t-n)+Math.abs(e-i)}},function(t,e){t.exports=function(t,e,n,i){var a=t-n,r=e-i;return a*a+r*r}},function(t,e,n){t.exports={Back:n(85),Bounce:n(89),Circular:n(93),Cubic:n(97),Elastic:n(101),Expo:n(105),Linear:n(109),Quadratic:n(111),Quartic:n(115),Quintic:n(119),Sine:n(123),Stepped:n(127)}},function(t,e,n){t.exports={In:n(86),Out:n(87),InOut:n(88)}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1.70158),t*t*((e+1)*t-e)}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1.70158),--t*t*((e+1)*t+e)+1}},function(t,e){t.exports=function(t,e){void 0===e&&(e=1.70158);var n=1.525*e;return(t*=2)<1?t*t*((1+n)*t-n)*.5:.5*((t-=2)*t*((1+n)*t+n)+2)}},function(t,e,n){t.exports={In:n(90),Out:n(91),InOut:n(92)}},function(t,e){t.exports=function(t){return(t=1-t)<1/2.75?1-7.5625*t*t:t<2/2.75?1-(7.5625*(t-=1.5/2.75)*t+.75):t<2.5/2.75?1-(7.5625*(t-=2.25/2.75)*t+.9375):1-(7.5625*(t-=2.625/2.75)*t+.984375)}},function(t,e){t.exports=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}},function(t,e){t.exports=function(t){var e=!1;return t<.5?(t=1-2*t,e=!0):t=2*t-1,t<1/2.75?t*=7.5625*t:t=t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,e?.5*(1-t):.5*t+.5}},function(t,e,n){t.exports={In:n(94),Out:n(95),InOut:n(96)}},function(t,e){t.exports=function(t){return 1-Math.sqrt(1-t*t)}},function(t,e){t.exports=function(t){return Math.sqrt(1- --t*t)}},function(t,e){t.exports=function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},function(t,e,n){t.exports={In:n(98),Out:n(99),InOut:n(100)}},function(t,e){t.exports=function(t){return t*t*t}},function(t,e){t.exports=function(t){return--t*t*t+1}},function(t,e){t.exports=function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},function(t,e,n){t.exports={In:n(102),Out:n(103),InOut:n(104)}},function(t,e){t.exports=function(t,e,n){if(void 0===e&&(e=.1),void 0===n&&(n=.1),0===t)return 0;if(1===t)return 1;var i=n/4;return e<1?e=1:i=n*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*--t)*Math.sin((t-i)*(2*Math.PI)/n)}},function(t,e){t.exports=function(t,e,n){if(void 0===e&&(e=.1),void 0===n&&(n=.1),0===t)return 0;if(1===t)return 1;var i=n/4;return e<1?e=1:i=n*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/n)+1}},function(t,e){t.exports=function(t,e,n){if(void 0===e&&(e=.1),void 0===n&&(n=.1),0===t)return 0;if(1===t)return 1;var i=n/4;return e<1?e=1:i=n*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*--t)*Math.sin((t-i)*(2*Math.PI)/n)*-.5:e*Math.pow(2,-10*--t)*Math.sin((t-i)*(2*Math.PI)/n)*.5+1}},function(t,e,n){t.exports={In:n(106),Out:n(107),InOut:n(108)}},function(t,e){t.exports=function(t){return Math.pow(2,10*(t-1))-.001}},function(t,e){t.exports=function(t){return 1-Math.pow(2,-10*t)}},function(t,e){t.exports=function(t){return(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))}},function(t,e,n){t.exports=n(110)},function(t,e){t.exports=function(t){return t}},function(t,e,n){t.exports={In:n(112),Out:n(113),InOut:n(114)}},function(t,e){t.exports=function(t){return t*t}},function(t,e){t.exports=function(t){return t*(2-t)}},function(t,e){t.exports=function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},function(t,e,n){t.exports={In:n(116),Out:n(117),InOut:n(118)}},function(t,e){t.exports=function(t){return t*t*t*t}},function(t,e){t.exports=function(t){return 1- --t*t*t*t}},function(t,e){t.exports=function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},function(t,e,n){t.exports={In:n(120),Out:n(121),InOut:n(122)}},function(t,e){t.exports=function(t){return t*t*t*t*t}},function(t,e){t.exports=function(t){return--t*t*t*t*t+1}},function(t,e){t.exports=function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},function(t,e,n){t.exports={In:n(124),Out:n(125),InOut:n(126)}},function(t,e){t.exports=function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)}},function(t,e){t.exports=function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)}},function(t,e){t.exports=function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))}},function(t,e,n){t.exports=n(128)},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1),t<=0?0:1<=t?1:1/e*(1+(e*t|0))}},function(t,e,n){t.exports={Ceil:n(130),Equal:n(32),Floor:n(131),GreaterThan:n(132),LessThan:n(133)}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1e-4),Math.ceil(t-e)}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1e-4),Math.floor(t+e)}},function(t,e){t.exports=function(t,e,n){return void 0===n&&(n=1e-4),e-n<t}},function(t,e){t.exports=function(t,e,n){return void 0===n&&(n=1e-4),t<e+n}},function(t,e,n){t.exports={Bezier:n(135),CatmullRom:n(136),CubicBezier:n(137),Linear:n(138),QuadraticBezier:n(139),SmoothStep:n(140),SmootherStep:n(141)}},function(t,e,n){var i=n(33);t.exports=function(t,e){for(var n=0,a=t.length-1,r=0;r<=a;r++)n+=Math.pow(1-e,a-r)*Math.pow(e,r)*t[r]*i(a,r);return n}},function(t,e,n){var i=n(35);t.exports=function(t,e){var n=t.length-1,a=n*e,r=Math.floor(a);return t[0]===t[n]?(e<0&&(r=Math.floor(a=n*(1+e))),i(a-r,t[(r-1+n)%n],t[r],t[(r+1)%n],t[(r+2)%n])):e<0?t[0]-(i(-a,t[0],t[0],t[1],t[1])-t[0]):1<e?t[n]-(i(a-n,t[n],t[n],t[n-1],t[n-1])-t[n]):i(a-r,t[r?r-1:0],t[r],t[n<r+1?n:r+1],t[n<r+2?n:r+2])}},function(t,e){t.exports=function(t,e,n,i,a){return(c=1-t)*c*c*e+3*(h=1-(o=t))*h*o*n+3*(1-(s=t))*s*s*i+(r=t)*r*r*a;var r,s,o,h,c}},function(t,e,n){var i=n(36);t.exports=function(t,e){var n=t.length-1,a=n*e,r=Math.floor(a);return e<0?i(t[0],t[1],a):1<e?i(t[n],t[n-1],n-a):i(t[r],t[n<r+1?n:r+1],a-r)}},function(t,e){t.exports=function(t,e,n,i){return(s=1-t)*s*e+2*(1-(r=t))*r*n+(a=t)*a*i;var a,r,s}},function(t,e,n){var i=n(37);t.exports=function(t,e,n){return e+(n-e)*i(t,0,1)}},function(t,e,n){var i=n(38);t.exports=function(t,e,n){return e+(n-e)*i(t,0,1)}},function(t,e,n){t.exports={GetNext:n(143),IsSize:n(144),IsValue:n(145)}},function(t,e){t.exports=function(t){var e=Math.log(t)/.6931471805599453;return 1<<Math.ceil(e)}},function(t,e){t.exports=function(t,e){return 0<t&&0==(t&t-1)&&0<e&&0==(e&e-1)}},function(t,e){t.exports=function(t){return 0<t&&0==(t&t-1)}},function(t,e,n){t.exports={Ceil:n(147),Floor:n(148),To:n(149)}},function(t,e){t.exports=function(t,e,n,i){return void 0===n&&(n=0),0===e?t:(t-=n,t=e*Math.ceil(t/e),i?(n+t)/e:n+t)}},function(t,e){t.exports=function(t,e,n,i){return void 0===n&&(n=0),0===e?t:(t-=n,t=e*Math.floor(t/e),i?(n+t)/e:n+t)}},function(t,e){t.exports=function(t,e,n,i){return void 0===n&&(n=0),0===e?t:(t-=n,t=e*Math.round(t/e),i?(n+t)/e:n+t)}},function(t,e,n){var i=new(n(0))({initialize:function(t){void 0===t&&(t=[(Date.now()*Math.random()).toString()]),this.c=1,this.s0=0,this.s1=0,this.s2=0,this.n=0,this.signs=[-1,1],t&&this.init(t)},rnd:function(){var t=2091639*this.s0+2.3283064365386963e-10*this.c;return this.c=0|t,this.s0=this.s1,this.s1=this.s2,this.s2=t-this.c,this.s2},hash:function(t){var e,n=this.n;t=t.toString();for(var i=0;i<t.length;i++)e=.02519603282416938*(n+=t.charCodeAt(i)),e-=n=e>>>0,n=(e*=n)>>>0,n+=4294967296*(e-=n);return 2.3283064365386963e-10*((this.n=n)>>>0)},init:function(t){"string"==typeof t?this.state(t):this.sow(t)},sow:function(t){if(this.n=4022871197,this.s0=this.hash(" "),this.s1=this.hash(" "),this.s2=this.hash(" "),this.c=1,t)for(var e=0;e<t.length&&null!=t[e];e++){var n=t[e];this.s0-=this.hash(n),this.s0+=~~(this.s0<0),this.s1-=this.hash(n),this.s1+=~~(this.s1<0),this.s2-=this.hash(n),this.s2+=~~(this.s2<0)}},integer:function(){return 4294967296*this.rnd()},frac:function(){return this.rnd()+11102230246251565e-32*(2097152*this.rnd()|0)},real:function(){return this.integer()+this.frac()},integerInRange:function(t,e){return Math.floor(this.realInRange(0,e-t+1)+t)},between:function(t,e){return Math.floor(this.realInRange(0,e-t+1)+t)},realInRange:function(t,e){return this.frac()*(e-t)+t},normal:function(){return 1-2*this.frac()},uuid:function(){var t="",e="";for(e=t="";t++<36;e+=~t%5|3*t&4?(15^t?8^this.frac()*(20^t?16:4):4).toString(16):"-");return e},pick:function(t){return t[this.integerInRange(0,t.length-1)]},sign:function(){return this.pick(this.signs)},weightedPick:function(t){return t[~~(Math.pow(this.frac(),2)*(t.length-1)+.5)]},timestamp:function(t,e){return this.realInRange(t||9466848e5,e||1577862e6)},angle:function(){return this.integerInRange(-180,180)},rotation:function(){return this.realInRange(-3.1415926,3.1415926)},state:function(t){return"string"==typeof t&&t.match(/^!rnd/)&&(t=t.split(","),this.c=gR()(t[1]),this.s0=gR()(t[2]),this.s1=gR()(t[3]),this.s2=gR()(t[4])),["!rnd",this.c,this.s0,this.s1,this.s2].join(",")},shuffle:function(t){for(var e=t.length-1;0<e;e--){var n=Math.floor(this.frac()*(e+1)),i=t[n];t[n]=t[e],t[e]=i}return t}});t.exports=i},function(t,e){t.exports=function(t){for(var e=0,n=0;n<t.length;n++)e+=+t[n];return e/t.length}},function(t,e){t.exports=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)}},function(t,e){t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=10);var i=Math.pow(n,-e);return Math.ceil(t*i)/i}},function(t,e){t.exports=function(t,e){return Math.abs(t-e)}},function(t,e,n){var i=n(3),a=n(0),r=n(20),s=n(1),o=new r,h=new a({initialize:function t(e,n,i,a){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===a&&(a=t.DefaultOrder),this._x=e,this._y=n,this._z=i,this._order=a,this.onChangeCallback=s},x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback(this)}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback(this)}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback(this)}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback(this)}},set:function(t,e,n,i){return void 0===i&&(i=this._order),this._x=t,this._y=e,this._z=n,this._order=i,this.onChangeCallback(this),this},copy:function(t){return this.set(t.x,t.y,t.z,t.order)},setFromQuaternion:function(t,e,n){return void 0===e&&(e=this._order),void 0===n&&(n=!1),o.fromQuat(t),this.setFromRotationMatrix(o,e,n)},setFromRotationMatrix:function(t,e,n){void 0===e&&(e=this._order),void 0===n&&(n=!1);var a=t.val,r=a[0],s=a[4],o=a[8],h=a[1],c=a[5],l=a[9],u=a[2],d=a[6],p=a[10],f=0,g=0,m=0,v=.99999;switch(e){case"XYZ":g=Math.asin(i(o,-1,1)),Math.abs(o)<v?(f=Math.atan2(-l,p),m=Math.atan2(-s,r)):f=Math.atan2(d,c);break;case"YXZ":f=Math.asin(-i(l,-1,1)),Math.abs(l)<v?(g=Math.atan2(o,p),m=Math.atan2(h,c)):g=Math.atan2(-u,r);break;case"ZXY":f=Math.asin(i(d,-1,1)),m=Math.abs(d)<v?(g=Math.atan2(-u,p),Math.atan2(-s,c)):Math.atan2(h,r);break;case"ZYX":g=Math.asin(-i(u,-1,1)),m=Math.abs(u)<v?(f=Math.atan2(d,p),Math.atan2(h,r)):Math.atan2(-s,c);break;case"YZX":m=Math.asin(i(h,-1,1)),g=Math.abs(h)<v?(f=Math.atan2(-l,c),Math.atan2(-u,r)):Math.atan2(o,p);break;case"XZY":m=Math.asin(-i(s,-1,1)),Math.abs(s)<v?(f=Math.atan2(d,c),g=Math.atan2(o,r)):f=Math.atan2(-l,p)}return this._x=f,this._y=g,this._z=m,this._order=e,n&&this.onChangeCallback(this),this}});h.RotationOrders=["XYZ","YXZ","ZXY","ZYX","YZX","XZY"],h.DefaultOrder="XYZ",t.exports=h},function(t,e){t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=10);var i=Math.pow(n,-e);return Math.floor(t*i)/i}},function(t,e,n){var i=n(3);t.exports=function(t,e,n){return(n-e)*(t=i(t,0,1))+e}},function(t,e){t.exports=function(t,e){return t/e/1e3}},function(t,e){t.exports=function(t){return t==gR()(t)?!(t%2):void 0}},function(t,e){t.exports=function(t){return t===gR()(t)?!(t%2):void 0}},function(t,e){t.exports=function(t,e,n){return Math.min(t+e,n)}},function(t,e){t.exports=function(t){var e=t.length;if(0===e)return 0;Na()(t).call(t,(function(t,e){return t-e}));var n=Math.floor(e/2);return e%2==0?(t[n]+t[n-1])/2:t[n]}},function(t,e){t.exports=function(t,e,n){return Math.max(t-e,n)}},function(t,e){t.exports=function(t,e,n,i){void 0===n&&(n=e+1);var a=(t-e)/(n-e);return 1<a?void 0!==i?(a=(i-t)/(i-n))<0&&(a=0):a=1:a<0&&(a=0),a}},function(t,e){t.exports=function(t,e){void 0===e&&(e=1);var n=2*Math.random()*Math.PI;return t.x=Math.cos(n)*e,t.y=Math.sin(n)*e,t}},function(t,e){t.exports=function(t,e){void 0===e&&(e=1);var n=2*Math.random()*Math.PI,i=2*Math.random()-1,a=Math.sqrt(1-i*i)*e;return t.x=Math.cos(n)*a,t.y=Math.sin(n)*a,t.z=i*e,t}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1),t.x=(2*Math.random()-1)*e,t.y=(2*Math.random()-1)*e,t.z=(2*Math.random()-1)*e,t.w=(2*Math.random()-1)*e,t}},function(t,e){t.exports=function(t,e){var n=t.x,i=t.y;return t.x=n*Math.cos(e)-i*Math.sin(e),t.y=n*Math.sin(e)+i*Math.cos(e),t}},function(t,e){t.exports=function(t,e,n,i,a){var r=i+Math.atan2(t.y-n,t.x-e);return t.x=e+a*Math.cos(r),t.y=n+a*Math.sin(r),t}},function(t,e){t.exports=function(t,e,n,i,a){return t.x=e+a*Math.cos(i),t.y=n+a*Math.sin(i),t}},function(t,e){t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=10);var i=Math.pow(n,-e);return Math.round(t*i)/i}},function(t,e){t.exports=function(t,e,n,i){void 0===e&&(e=1),void 0===n&&(n=1),void 0===i&&(i=1),i*=Math.PI/t;for(var a=[],r=[],s=0;s<t;s++)e+=(n-=e*i)*i,a[s]=n,r[s]=e;return{sin:r,cos:a,length:t}}},function(t,e,n){var i=n(2);t.exports=function(t,e,n,a){void 0===a&&(a=new i);var r=0,s=0;return 0<t&&t<=e*n&&(r=e-1<t?t-(s=Math.floor(t/e))*e:t,a.set(r,s)),a}},function(t,e){t.exports=function(t,e,n){return Math.abs(t-e)<=n}},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n,i){this.x=0,this.y=0,this.z=0,this.w=0,"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0):(this.x=t||0,this.y=e||0,this.z=n||0,this.w=i||0)},clone:function(){return new i(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z||0,this.w=t.w||0,this},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},set:function(t,e,n,i){return"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0):(this.x=t||0,this.y=e||0,this.z=n||0,this.w=i||0),this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z||0,this.w+=t.w||0,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z||0,this.w-=t.w||0,this},scale:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},length:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return Math.sqrt(t*t+e*e+n*n+i*i)},lengthSq:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return t*t+e*e+n*n+i*i},normalize:function(){var t=this.x,e=this.y,n=this.z,i=this.w,a=t*t+e*e+n*n+i*i;return 0<a&&(a=1/Math.sqrt(a),this.x=t*a,this.y=e*a,this.z=n*a,this.w=i*a),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lerp:function(t,e){void 0===e&&(e=0);var n=this.x,i=this.y,a=this.z,r=this.w;return this.x=n+e*(t.x-n),this.y=i+e*(t.y-i),this.z=a+e*(t.z-a),this.w=r+e*(t.w-r),this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z||1,this.w*=t.w||1,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z||1,this.w/=t.w||1,this},distance:function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z||0,a=t.w-this.w||0;return Math.sqrt(e*e+n*n+i*i+a*a)},distanceSq:function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z||0,a=t.w-this.w||0;return e*e+n*n+i*i+a*a},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},transformMat4:function(t){var e=this.x,n=this.y,i=this.z,a=this.w,r=t.val;return this.x=r[0]*e+r[4]*n+r[8]*i+r[12]*a,this.y=r[1]*e+r[5]*n+r[9]*i+r[13]*a,this.z=r[2]*e+r[6]*n+r[10]*i+r[14]*a,this.w=r[3]*e+r[7]*n+r[11]*i+r[15]*a,this},transformQuat:function(t){var e=this.x,n=this.y,i=this.z,a=t.x,r=t.y,s=t.z,o=t.w,h=o*e+r*i-s*n,c=o*n+s*e-a*i,l=o*i+a*n-r*e,u=-a*e-r*n-s*i;return this.x=h*o+u*-a+c*-s-l*-r,this.y=c*o+u*-r+l*-a-h*-s,this.z=l*o+u*-s+h*-r-c*-a,this},reset:function(){return this.x=0,this.y=0,this.z=0,this.w=0,this}});i.prototype.sub=i.prototype.subtract,i.prototype.mul=i.prototype.multiply,i.prototype.div=i.prototype.divide,i.prototype.dist=i.prototype.distance,i.prototype.distSq=i.prototype.distanceSq,i.prototype.len=i.prototype.length,i.prototype.lenSq=i.prototype.lengthSq,t.exports=i},function(t,e,n){var i=n(14),a=n(20),r=n(43),s=new a,o=new r,h=new i;t.exports=function(t,e,n){return o.setAxisAngle(e,n),s.fromRotationTranslation(o,h.set(0,0,0)),t.transformMat4(s)}},function(t,e){t.exports="resize"},function(t,e,n){var i=n(179),a=n(0),r=n(44),s=new a({Extends:i,initialize:function(t,e,n){i.call(this,e),this.scene=t,this.systems=t.sys,this.pluginKey=n,t.sys.events.once(r.BOOT,this.boot,this)},boot:function(){},destroy:function(){this.pluginManager=null,this.game=null,this.scene=null,this.systems=null}});t.exports=s},function(t,e,n){var i=new(n(0))({initialize:function(t){this.pluginManager=t,this.game=t.game},init:function(){},start:function(){},stop:function(){},destroy:function(){this.pluginManager=null,this.game=null,this.scene=null,this.systems=null}});t.exports=i},function(t,e){t.exports="addedtoscene"},function(t,e){t.exports="boot"},function(t,e){t.exports="create"},function(t,e){t.exports="destroy"},function(t,e){t.exports="pause"},function(t,e){t.exports="postupdate"},function(t,e){t.exports="prerender"},function(t,e){t.exports="preupdate"},function(t,e){t.exports="ready"},function(t,e){t.exports="removedfromscene"},function(t,e){t.exports="render"},function(t,e){t.exports="resume"},function(t,e){t.exports="shutdown"},function(t,e){t.exports="sleep"},function(t,e){t.exports="start"},function(t,e){t.exports="transitioncomplete"},function(t,e){t.exports="transitioninit"},function(t,e){t.exports="transitionout"},function(t,e){t.exports="transitionstart"},function(t,e){t.exports="transitionwake"},function(t,e){t.exports="update"},function(t,e){t.exports="wake"},function(t,e){(function(){var e,n,i,a,r,s,o,h,c,l,u,d,p,f,m,v,y,S,A,E,x,b,T,w,C,M,I,P,k,R,O,_,D,L,B,F,N,G,U,V,z,H,W,X,K,j,q,Z,J,Q,$,tt,et,nt,at,rt,st,ot,ht,ct,lt,ut,dt,pt,ft,gt,mt,vt,yt,St,At,Et,xt,bt,Tt,wt,Ct,Mt,It,Pt,kt,Rt,Ot,_t,Dt,Lt,Bt,Ft,Nt,Gt,Ut,Vt,Yt,zt,Ht,Wt,Xt,Kt,jt,qt,Zt,Jt,Qt,$t,te,ee,ne,ie,ae,re,se,oe,he,ce,le,ue,de,pe,fe,ge,me,ve,ye,Se,Ae,Ee=this&&this.__extends||(e=function(t,n){return(e=vR()||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,n)},function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)});function xe(t){if(this.animationToMixTime={},this.defaultMix=0,null==t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}function be(t,e){void 0===e&&(e=""),this.assets={},this.errors={},this.toLoad=0,this.loaded=0,this.rawDataUris={},this.textureLoader=t,this.pathPrefix=e}function Te(t){this.atlas=t}function we(t,e,n){if(this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.a=0,this.b=0,this.c=0,this.d=0,this.worldY=0,this.worldX=0,this.sorted=!1,this.active=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=n,this.setToSetupPose()}function Ce(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(var n=0;n<t.bones.length;n++)this.bones.push(e.findBone(t.bones[n].name));this.target=e.findBone(t.target.name)}function Me(t){var e=S.call(this,t,0,!1)||this;return e.bones=new Array,e.bendDirection=1,e.compress=!1,e.stretch=!1,e.uniform=!1,e.mix=1,e.softness=0,e}function Ie(t,e){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(var n=0,i=t.bones.length;n<i;n++)this.bones.push(e.findBone(t.bones[n].name));this.target=e.findSlot(t.target.name),this.position=t.position,this.spacing=t.spacing,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix}function Pe(t){var e=T.call(this,t,0,!1)||this;return e.bones=new Array,e}function ke(t){this.toLoad=new Array,this.assets={},this.clientId=t}function Re(t){void 0===t&&(t=""),this.clientAssets={},this.queuedAssets={},this.rawAssets={},this.errors={},this.pathPrefix=t}function Oe(t){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,null==t)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(var e=0;e<t.bones.length;e++){var n,i=t.bones[e],a=void 0;null==i.parent?a=new O.Bone(i,this,null):(n=this.bones[i.parent.index],a=new O.Bone(i,this,n),n.children.push(a)),this.bones.push(a)}for(this.slots=new Array,this.drawOrder=new Array,e=0;e<t.slots.length;e++){var r=t.slots[e],s=(a=this.bones[r.boneData.index],new O.Slot(r,a));this.slots.push(s),this.drawOrder.push(s)}for(this.ikConstraints=new Array,e=0;e<t.ikConstraints.length;e++){var o=t.ikConstraints[e];this.ikConstraints.push(new O.IkConstraint(o,this))}for(this.transformConstraints=new Array,e=0;e<t.transformConstraints.length;e++){var h=t.transformConstraints[e];this.transformConstraints.push(new O.TransformConstraint(h,this))}for(this.pathConstraints=new Array,e=0;e<t.pathConstraints.length;e++){var c=t.pathConstraints[e];this.pathConstraints.push(new O.PathConstraint(c,this))}this.color=new O.Color(1,1,1,1),this.updateCache()}function _e(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.boundingBoxes=new Array,this.polygons=new Array,this.polygonPool=new D.Pool((function(){return D.Utils.newFloatArray(16)}))}function De(){this.triangulator=new B.Triangulator,this.clippingPolygon=new Array,this.clipOutput=new Array,this.clippedVertices=new Array,this.clippedTriangles=new Array,this.scratch=new Array}function Le(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}function Be(t,e){if(this.deform=new Array,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new U.Color,this.darkColor=null==t.darkColor?null:new U.Color,this.setToSetupPose()}function Fe(t,e){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new H.Vector2,this.active=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix,this.scaleMix=t.scaleMix,this.shearMix=t.shearMix,this.bones=new Array;for(var n=0;n<t.bones.length;n++)this.bones.push(e.findBone(t.bones[n].name));this.target=e.findBone(t.target.name)}function Ne(t){var e=K.call(this,t,0,!1)||this;return e.bones=new Array,e.rotateMix=0,e.translateMix=0,e.scaleMix=0,e.shearMix=0,e.offsetRotation=0,e.offsetX=0,e.offsetY=0,e.offsetScaleX=0,e.offsetScaleY=0,e.offsetShearY=0,e.relative=!1,e.local=!1,e}function Ge(){this.convexPolygons=new Array,this.convexPolygonsIndices=new Array,this.indicesArray=new Array,this.isConcaveArray=new Array,this.triangles=new Array,this.polygonPool=new q.Pool((function(){return new Array})),this.polygonIndicesPool=new q.Pool((function(){return new Array}))}function Ue(t){var e=et.call(this,t)||this;return e.color=new tt.Color(1,1,1,1),e}function Ve(t){var e=rt.call(this,t)||this;return e.color=new at.Color(.2275,.2275,.8078,1),e}function Ye(t){var e=ht.call(this,t)||this;return e.color=new ot.Color(1,1,1,1),e.tempColor=new ot.Color(0,0,0,0),e}function ze(t){var e=ut.call(this,t)||this;return e.closed=!1,e.constantSpeed=!1,e.color=new lt.Color(1,1,1,1),e}function He(t){var e=ft.call(this,t)||this;return e.color=new pt.Color(.38,.94,0,1),e}function We(t){var e=vt.call(this,t)||this;return e.x=0,e.y=0,e.scaleX=1,e.scaleY=1,e.rotation=0,e.width=0,e.height=0,e.color=new mt.Color(1,1,1,1),e.offset=mt.Utils.newFloatArray(8),e.uvs=mt.Utils.newFloatArray(8),e.tempColor=new mt.Color(1,1,1,1),e}function Xe(t,e){this.jitterX=0,this.jitterY=0,this.jitterX=t,this.jitterY=e}function Ke(t){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=t}function je(t){return void 0===t&&(t=""),wt.call(this,(function(t){return new bt.canvas.CanvasTexture(t)}),t)||this}function qe(t){return Pt.call(this,t)||this}function Ze(t){this.triangleRendering=!1,this.debugRendering=!1,this.vertices=Rt.Utils.newFloatArray(8192),this.tempColor=new Rt.Color,this.ctx=t}function Je(t,e){return void 0===e&&(e=""),Bt.call(this,(function(e){return new Dt.webgl.GLTexture(t,e)}),e)||this}function Qe(t,e){this.position=new Gt.Vector3(0,0,0),this.direction=new Gt.Vector3(0,0,-1),this.up=new Gt.Vector3(0,1,0),this.near=0,this.far=100,this.zoom=1,this.viewportWidth=0,this.viewportHeight=0,this.projectionView=new Gt.Matrix4,this.inverseProjectionView=new Gt.Matrix4,this.projection=new Gt.Matrix4,this.view=new Gt.Matrix4,this.tmp=new Gt.Vector3,this.viewportWidth=t,this.viewportHeight=e,this.update()}function $e(t,e,n){void 0===n&&(n=!1);var i=zt.call(this,e)||this;return i.texture=null,i.boundUnit=0,i.useMipMaps=!1,i.context=t instanceof Yt.ManagedWebGLRenderingContext?t:new Yt.ManagedWebGLRenderingContext(t),i.useMipMaps=n,i.restore(),i.context.addRestorable(i),i}function tn(t,e,n){if(void 0===e&&(e=!0),void 0===n&&(n=10920),this.isDrawing=!1,this.shader=null,this.lastTexture=null,this.verticesLength=0,this.indicesLength=0,10920<n)throw new Error("Can't have more than 10920 triangles per batch: "+n);this.context=t instanceof jt.ManagedWebGLRenderingContext?t:new jt.ManagedWebGLRenderingContext(t);var i=e?[new jt.Position2Attribute,new jt.ColorAttribute,new jt.TexCoordAttribute,new jt.Color2Attribute]:[new jt.Position2Attribute,new jt.ColorAttribute,new jt.TexCoordAttribute];this.mesh=new jt.Mesh(t,i,n,3*n),this.srcBlend=this.context.gl.SRC_ALPHA,this.dstBlend=this.context.gl.ONE_MINUS_SRC_ALPHA}function en(t,e,n){void 0===n&&(n=!0),this.twoColorTint=!1,this.activeRenderer=null,this.QUAD=[0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0],this.QUAD_TRIANGLES=[0,1,2,2,3,0],this.WHITE=new Zt.Color(1,1,1,1),this.canvas=t,this.context=e instanceof Jt.ManagedWebGLRenderingContext?e:new Jt.ManagedWebGLRenderingContext(e),this.twoColorTint=n,this.camera=new Jt.OrthoCamera(t.width,t.height),this.batcherShader=n?Jt.Shader.newTwoColoredTextured(this.context):Jt.Shader.newColoredTextured(this.context),this.batcher=new Jt.PolygonBatcher(this.context,n),this.shapesShader=Jt.Shader.newColored(this.context),this.shapes=new Jt.ShapeRenderer(this.context),this.skeletonRenderer=new Jt.SkeletonRenderer(this.context,n),this.skeletonDebugRenderer=new Jt.SkeletonDebugRenderer(this.context)}function nn(t,e,n){this.vertexShader=e,this.fragmentShader=n,this.vs=null,this.fs=null,this.program=null,this.tmp2x2=new Float32Array(4),this.tmp3x3=new Float32Array(9),this.tmp4x4=new Float32Array(16),this.vsSource=e,this.fsSource=n,this.context=t instanceof ne.ManagedWebGLRenderingContext?t:new ne.ManagedWebGLRenderingContext(t),this.context.addRestorable(this),this.compile()}function an(t,e){if(void 0===e&&(e=10920),this.isDrawing=!1,this.shapeType=se.Filled,this.color=new ae.Color(1,1,1,1),this.vertexIndex=0,this.tmp=new ae.Vector2,10920<e)throw new Error("Can't have more than 10920 triangles per batch: "+e);this.context=t instanceof re.ManagedWebGLRenderingContext?t:new re.ManagedWebGLRenderingContext(t),this.mesh=new re.Mesh(t,[new re.Position2Attribute,new re.ColorAttribute],e,0),this.srcBlend=this.context.gl.SRC_ALPHA,this.dstBlend=this.context.gl.ONE_MINUS_SRC_ALPHA}function rn(t){this.boneLineColor=new ce.Color(1,0,0,1),this.boneOriginColor=new ce.Color(0,1,0,1),this.attachmentLineColor=new ce.Color(0,0,1,.5),this.triangleLineColor=new ce.Color(1,.64,0,.5),this.pathColor=(new ce.Color).setFromString("FF7F00"),this.clipColor=new ce.Color(.8,0,0,2),this.aabbColor=new ce.Color(0,1,0,.5),this.drawBones=!0,this.drawRegionAttachments=!0,this.drawBoundingBoxes=!0,this.drawMeshHull=!0,this.drawMeshTriangles=!0,this.drawPaths=!0,this.drawSkeletonXY=!1,this.drawClipping=!0,this.premultipliedAlpha=!1,this.scale=1,this.boneWidth=2,this.bounds=new ce.SkeletonBounds,this.temp=new Array,this.vertices=ce.Utils.newFloatArray(2048),this.context=t instanceof le.ManagedWebGLRenderingContext?t:new le.ManagedWebGLRenderingContext(t)}function sn(t,e){void 0===e&&(e=!0),this.premultipliedAlpha=!1,this.vertexEffect=null,this.tempColor=new de.Color,this.tempColor2=new de.Color,this.vertexSize=8,this.twoColorTint=!1,this.renderable=new fe(null,0,0),this.clipper=new de.SkeletonClipping,this.temp=new de.Vector2,this.temp2=new de.Vector2,this.temp3=new de.Color,this.temp4=new de.Color,(this.twoColorTint=e)&&(this.vertexSize+=4),this.vertices=de.Utils.newFloatArray(1024*this.vertexSize)}function on(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.x=0,this.y=0,this.z=0,this.x=t,this.y=e,this.z=n}!function(t){var e,n,i,a,r,s,o=(h.prototype.hasTimeline=function(t){return 1==this.timelineIds[t]},h.prototype.apply=function(t,e,n,i,a,r,s,o){if(null==t)throw new Error("skeleton cannot be null.");i&&0!=this.duration&&(n%=this.duration,0<e&&(e%=this.duration));for(var h=this.timelines,c=0,l=h.length;c<l;c++)h[c].apply(t,e,n,a,r,s,o)},h.binarySearch=function(t,e,n){void 0===n&&(n=1);var i=0,a=t.length/n-2;if(0==a)return n;for(var r=a>>>1;;){if(t[(r+1)*n]<=e?i=r+1:a=r,i==a)return(i+1)*n;r=i+a>>>1}},h.linearSearch=function(t,e,n){for(var i=0,a=t.length-n;i<=a;i+=n)if(t[i]>e)return i;return-1},h);function h(t,e,n){if(null==t)throw new Error("name cannot be null.");if(null==e)throw new Error("timelines cannot be null.");this.name=t,this.timelines=e,this.timelineIds=[];for(var i=0;i<e.length;i++)this.timelineIds[e[i].getPropertyId()]=!0;this.duration=n}t.Animation=o,(n=e=t.MixBlend||(t.MixBlend={}))[n.setup=0]="setup",n[n.first=1]="first",n[n.replace=2]="replace",n[n.add=3]="add",(a=i=t.MixDirection||(t.MixDirection={}))[a.mixIn=0]="mixIn",a[a.mixOut=1]="mixOut",(s=r=t.TimelineType||(t.TimelineType={}))[s.rotate=0]="rotate",s[s.translate=1]="translate",s[s.scale=2]="scale",s[s.shear=3]="shear",s[s.attachment=4]="attachment",s[s.color=5]="color",s[s.deform=6]="deform",s[s.event=7]="event",s[s.drawOrder=8]="drawOrder",s[s.ikConstraint=9]="ikConstraint",s[s.transformConstraint=10]="transformConstraint",s[s.pathConstraintPosition=11]="pathConstraintPosition",s[s.pathConstraintSpacing=12]="pathConstraintSpacing",s[s.pathConstraintMix=13]="pathConstraintMix",s[s.twoColor=14]="twoColor";var c=(l.prototype.getFrameCount=function(){return this.curves.length/l.BEZIER_SIZE+1},l.prototype.setLinear=function(t){this.curves[t*l.BEZIER_SIZE]=l.LINEAR},l.prototype.setStepped=function(t){this.curves[t*l.BEZIER_SIZE]=l.STEPPED},l.prototype.getCurveType=function(t){var e=t*l.BEZIER_SIZE;if(e==this.curves.length)return l.LINEAR;var n=this.curves[e];return n==l.LINEAR?l.LINEAR:n==l.STEPPED?l.STEPPED:l.BEZIER},l.prototype.setCurve=function(t,e,n,i,a){var r=.03*(2*-e+i),s=.03*(2*-n+a),o=.006*(3*(e-i)+1),h=.006*(3*(n-a)+1),c=2*r+o,u=2*s+h,d=.3*e+r+.16666667*o,p=.3*n+s+.16666667*h,f=t*l.BEZIER_SIZE,g=this.curves;g[f++]=l.BEZIER;for(var m=d,v=p,y=f+l.BEZIER_SIZE-1;f<y;f+=2)g[f]=m,g[f+1]=v,d+=c,p+=u,c+=o,u+=h,m+=d,v+=p},l.prototype.getCurvePercent=function(e,n){n=t.MathUtils.clamp(n,0,1);var i=this.curves,a=e*l.BEZIER_SIZE,r=i[a];if(r==l.LINEAR)return n;if(r==l.STEPPED)return 0;for(var s=0,o=++a,h=a+l.BEZIER_SIZE-1;a<h;a+=2)if(n<=(s=i[a])){var c,u=void 0;return(c=a==o?u=0:(u=i[a-2],i[a-1]))+(i[a+1]-c)*(n-u)/(s-u)}var d=i[a-1];return d+(1-d)*(n-s)/(1-s)},l.LINEAR=0,l.STEPPED=1,l.BEZIER=2,l.BEZIER_SIZE=19,l);function l(e){if(e<=0)throw new Error("frameCount must be > 0: "+e);this.curves=t.Utils.newFloatArray((e-1)*l.BEZIER_SIZE)}t.CurveTimeline=c;var u,d=(Ee(p,u=c),p.prototype.getPropertyId=function(){return(r.rotate<<24)+this.boneIndex},p.prototype.setFrame=function(t,e,n){t<<=1,this.frames[t]=e,this.frames[t+p.ROTATION]=n},p.prototype.apply=function(t,n,i,a,r,s,h){var c=this.frames,l=t.bones[this.boneIndex];if(l.active)if(i<c[0])switch(s){case e.setup:return void(l.rotation=l.data.rotation);case e.first:var u=l.data.rotation-l.rotation;l.rotation+=(u-360*(16384-(16384.499999999996-u/360|0)))*r}else if(i>=c[c.length-p.ENTRIES]){var d=c[c.length+p.PREV_ROTATION];switch(s){case e.setup:l.rotation=l.data.rotation+d*r;break;case e.first:case e.replace:d+=l.data.rotation-l.rotation,d-=360*(16384-(16384.499999999996-d/360|0));case e.add:l.rotation+=d*r}}else{var f=o.binarySearch(c,i,p.ENTRIES),g=c[f+p.PREV_ROTATION],m=c[f],v=this.getCurvePercent((f>>1)-1,1-(i-m)/(c[f+p.PREV_TIME]-m)),y=g+((y=c[f+p.ROTATION]-g)-360*(16384-(16384.499999999996-y/360|0)))*v;switch(s){case e.setup:l.rotation=l.data.rotation+(y-360*(16384-(16384.499999999996-y/360|0)))*r;break;case e.first:case e.replace:y+=l.data.rotation-l.rotation;case e.add:l.rotation+=(y-360*(16384-(16384.499999999996-y/360|0)))*r}}},p.ENTRIES=2,p.PREV_TIME=-2,p.PREV_ROTATION=-1,p.ROTATION=1,p);function p(e){var n=u.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e<<1),n}t.RotateTimeline=d;var f,g=(Ee(m,f=c),m.prototype.getPropertyId=function(){return(r.translate<<24)+this.boneIndex},m.prototype.setFrame=function(t,e,n,i){t*=m.ENTRIES,this.frames[t]=e,this.frames[t+m.X]=n,this.frames[t+m.Y]=i},m.prototype.apply=function(t,n,i,a,r,s,h){var c=this.frames,l=t.bones[this.boneIndex];if(l.active)if(i<c[0])switch(s){case e.setup:return l.x=l.data.x,void(l.y=l.data.y);case e.first:l.x+=(l.data.x-l.x)*r,l.y+=(l.data.y-l.y)*r}else{var u,d,p,f=0,g=0;switch(i>=c[c.length-m.ENTRIES]?(f=c[c.length+m.PREV_X],g=c[c.length+m.PREV_Y]):(f=c[(u=o.binarySearch(c,i,m.ENTRIES))+m.PREV_X],g=c[u+m.PREV_Y],d=c[u],p=this.getCurvePercent(u/m.ENTRIES-1,1-(i-d)/(c[u+m.PREV_TIME]-d)),f+=(c[u+m.X]-f)*p,g+=(c[u+m.Y]-g)*p),s){case e.setup:l.x=l.data.x+f*r,l.y=l.data.y+g*r;break;case e.first:case e.replace:l.x+=(l.data.x+f-l.x)*r,l.y+=(l.data.y+g-l.y)*r;break;case e.add:l.x+=f*r,l.y+=g*r}}},m.ENTRIES=3,m.PREV_TIME=-3,m.PREV_X=-2,m.PREV_Y=-1,m.X=1,m.Y=2,m);function m(e){var n=f.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*m.ENTRIES),n}t.TranslateTimeline=g;var v,y=(Ee(S,v=g),S.prototype.getPropertyId=function(){return(r.scale<<24)+this.boneIndex},S.prototype.apply=function(n,a,r,s,h,c,l){var u=this.frames,d=n.bones[this.boneIndex];if(d.active)if(r<u[0])switch(c){case e.setup:return d.scaleX=d.data.scaleX,void(d.scaleY=d.data.scaleY);case e.first:d.scaleX+=(d.data.scaleX-d.scaleX)*h,d.scaleY+=(d.data.scaleY-d.scaleY)*h}else{var p,f,g,m=0,v=0;if(v=r>=u[u.length-S.ENTRIES]?(m=u[u.length+S.PREV_X]*d.data.scaleX,u[u.length+S.PREV_Y]*d.data.scaleY):(m=u[(p=o.binarySearch(u,r,S.ENTRIES))+S.PREV_X],v=u[p+S.PREV_Y],f=u[p],g=this.getCurvePercent(p/S.ENTRIES-1,1-(r-f)/(u[p+S.PREV_TIME]-f)),m=(m+(u[p+S.X]-m)*g)*d.data.scaleX,(v+(u[p+S.Y]-v)*g)*d.data.scaleY),1==h)c==e.add?(d.scaleX+=m-d.data.scaleX,d.scaleY+=v-d.data.scaleY):(d.scaleX=m,d.scaleY=v);else{var y=0,A=0;if(l==i.mixOut)switch(c){case e.setup:y=d.data.scaleX,A=d.data.scaleY,d.scaleX=y+(Math.abs(m)*t.MathUtils.signum(y)-y)*h,d.scaleY=A+(Math.abs(v)*t.MathUtils.signum(A)-A)*h;break;case e.first:case e.replace:y=d.scaleX,A=d.scaleY,d.scaleX=y+(Math.abs(m)*t.MathUtils.signum(y)-y)*h,d.scaleY=A+(Math.abs(v)*t.MathUtils.signum(A)-A)*h;break;case e.add:y=d.scaleX,A=d.scaleY,d.scaleX=y+(Math.abs(m)*t.MathUtils.signum(y)-d.data.scaleX)*h,d.scaleY=A+(Math.abs(v)*t.MathUtils.signum(A)-d.data.scaleY)*h}else switch(c){case e.setup:y=Math.abs(d.data.scaleX)*t.MathUtils.signum(m),A=Math.abs(d.data.scaleY)*t.MathUtils.signum(v),d.scaleX=y+(m-y)*h,d.scaleY=A+(v-A)*h;break;case e.first:case e.replace:y=Math.abs(d.scaleX)*t.MathUtils.signum(m),A=Math.abs(d.scaleY)*t.MathUtils.signum(v),d.scaleX=y+(m-y)*h,d.scaleY=A+(v-A)*h;break;case e.add:y=t.MathUtils.signum(m),A=t.MathUtils.signum(v),d.scaleX=Math.abs(d.scaleX)*y+(m-Math.abs(d.data.scaleX)*y)*h,d.scaleY=Math.abs(d.scaleY)*A+(v-Math.abs(d.data.scaleY)*A)*h}}}},S);function S(t){return v.call(this,t)||this}t.ScaleTimeline=y;var A,E=(Ee(x,A=g),x.prototype.getPropertyId=function(){return(r.shear<<24)+this.boneIndex},x.prototype.apply=function(t,n,i,a,r,s,h){var c=this.frames,l=t.bones[this.boneIndex];if(l.active)if(i<c[0])switch(s){case e.setup:return l.shearX=l.data.shearX,void(l.shearY=l.data.shearY);case e.first:l.shearX+=(l.data.shearX-l.shearX)*r,l.shearY+=(l.data.shearY-l.shearY)*r}else{var u,d,p,f=0,g=0;switch(i>=c[c.length-x.ENTRIES]?(f=c[c.length+x.PREV_X],g=c[c.length+x.PREV_Y]):(f=c[(u=o.binarySearch(c,i,x.ENTRIES))+x.PREV_X],g=c[u+x.PREV_Y],d=c[u],p=this.getCurvePercent(u/x.ENTRIES-1,1-(i-d)/(c[u+x.PREV_TIME]-d)),f+=(c[u+x.X]-f)*p,g+=(c[u+x.Y]-g)*p),s){case e.setup:l.shearX=l.data.shearX+f*r,l.shearY=l.data.shearY+g*r;break;case e.first:case e.replace:l.shearX+=(l.data.shearX+f-l.shearX)*r,l.shearY+=(l.data.shearY+g-l.shearY)*r;break;case e.add:l.shearX+=f*r,l.shearY+=g*r}}},x);function x(t){return A.call(this,t)||this}t.ShearTimeline=E;var b,T=(Ee(w,b=c),w.prototype.getPropertyId=function(){return(r.color<<24)+this.slotIndex},w.prototype.setFrame=function(t,e,n,i,a,r){t*=w.ENTRIES,this.frames[t]=e,this.frames[t+w.R]=n,this.frames[t+w.G]=i,this.frames[t+w.B]=a,this.frames[t+w.A]=r},w.prototype.apply=function(t,n,i,a,r,s,h){var c=t.slots[this.slotIndex];if(c.bone.active){var l=this.frames;if(i<l[0])switch(s){case e.setup:return void c.color.setFromColor(c.data.color);case e.first:var u=c.color,d=c.data.color;u.add((d.r-u.r)*r,(d.g-u.g)*r,(d.b-u.b)*r,(d.a-u.a)*r)}else{var p,f,g,m,v=0,y=0,S=0,A=0;i>=l[l.length-w.ENTRIES]?(v=l[(p=l.length)+w.PREV_R],y=l[p+w.PREV_G],S=l[p+w.PREV_B],A=l[p+w.PREV_A]):(v=l[(f=o.binarySearch(l,i,w.ENTRIES))+w.PREV_R],y=l[f+w.PREV_G],S=l[f+w.PREV_B],A=l[f+w.PREV_A],g=l[f],m=this.getCurvePercent(f/w.ENTRIES-1,1-(i-g)/(l[f+w.PREV_TIME]-g)),v+=(l[f+w.R]-v)*m,y+=(l[f+w.G]-y)*m,S+=(l[f+w.B]-S)*m,A+=(l[f+w.A]-A)*m),1==r?c.color.set(v,y,S,A):(u=c.color,s==e.setup&&u.setFromColor(c.data.color),u.add((v-u.r)*r,(y-u.g)*r,(S-u.b)*r,(A-u.a)*r))}}},w.ENTRIES=5,w.PREV_TIME=-5,w.PREV_R=-4,w.PREV_G=-3,w.PREV_B=-2,w.PREV_A=-1,w.R=1,w.G=2,w.B=3,w.A=4,w);function w(e){var n=b.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*w.ENTRIES),n}t.ColorTimeline=T;var C,M=(Ee(I,C=c),I.prototype.getPropertyId=function(){return(r.twoColor<<24)+this.slotIndex},I.prototype.setFrame=function(t,e,n,i,a,r,s,o,h){t*=I.ENTRIES,this.frames[t]=e,this.frames[t+I.R]=n,this.frames[t+I.G]=i,this.frames[t+I.B]=a,this.frames[t+I.A]=r,this.frames[t+I.R2]=s,this.frames[t+I.G2]=o,this.frames[t+I.B2]=h},I.prototype.apply=function(t,n,i,a,r,s,h){var c=t.slots[this.slotIndex];if(c.bone.active){var l=this.frames;if(i<l[0])switch(s){case e.setup:return c.color.setFromColor(c.data.color),void c.darkColor.setFromColor(c.data.darkColor);case e.first:var u=c.color,d=c.darkColor,p=c.data.color,f=c.data.darkColor;u.add((p.r-u.r)*r,(p.g-u.g)*r,(p.b-u.b)*r,(p.a-u.a)*r),d.add((f.r-d.r)*r,(f.g-d.g)*r,(f.b-d.b)*r,0)}else{var g,m,v,y,S=0,A=0,E=0,x=0,b=0,T=0,w=0;i>=l[l.length-I.ENTRIES]?(S=l[(g=l.length)+I.PREV_R],A=l[g+I.PREV_G],E=l[g+I.PREV_B],x=l[g+I.PREV_A],b=l[g+I.PREV_R2],T=l[g+I.PREV_G2],w=l[g+I.PREV_B2]):(S=l[(m=o.binarySearch(l,i,I.ENTRIES))+I.PREV_R],A=l[m+I.PREV_G],E=l[m+I.PREV_B],x=l[m+I.PREV_A],b=l[m+I.PREV_R2],T=l[m+I.PREV_G2],w=l[m+I.PREV_B2],v=l[m],y=this.getCurvePercent(m/I.ENTRIES-1,1-(i-v)/(l[m+I.PREV_TIME]-v)),S+=(l[m+I.R]-S)*y,A+=(l[m+I.G]-A)*y,E+=(l[m+I.B]-E)*y,x+=(l[m+I.A]-x)*y,b+=(l[m+I.R2]-b)*y,T+=(l[m+I.G2]-T)*y,w+=(l[m+I.B2]-w)*y),1==r?(c.color.set(S,A,E,x),c.darkColor.set(b,T,w,1)):(u=c.color,d=c.darkColor,s==e.setup&&(u.setFromColor(c.data.color),d.setFromColor(c.data.darkColor)),u.add((S-u.r)*r,(A-u.g)*r,(E-u.b)*r,(x-u.a)*r),d.add((b-d.r)*r,(T-d.g)*r,(w-d.b)*r,0))}}},I.ENTRIES=8,I.PREV_TIME=-8,I.PREV_R=-7,I.PREV_G=-6,I.PREV_B=-5,I.PREV_A=-4,I.PREV_R2=-3,I.PREV_G2=-2,I.PREV_B2=-1,I.R=1,I.G=2,I.B=3,I.A=4,I.R2=5,I.G2=6,I.B2=7,I);function I(e){var n=C.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*I.ENTRIES),n}t.TwoColorTimeline=M;var P=(k.prototype.getPropertyId=function(){return(r.attachment<<24)+this.slotIndex},k.prototype.getFrameCount=function(){return this.frames.length},k.prototype.setFrame=function(t,e,n){this.frames[t]=e,this.attachmentNames[t]=n},k.prototype.apply=function(t,n,a,r,s,h,c){var l,u,d,p=t.slots[this.slotIndex];p.bone.active&&(c!=i.mixOut?a<(l=this.frames)[0]?h!=e.setup&&h!=e.first||this.setAttachment(t,p,p.data.attachmentName):(0,u=a>=l[l.length-1]?l.length-1:o.binarySearch(l,a,1)-1,d=this.attachmentNames[u],t.slots[this.slotIndex].setAttachment(null==d?null:t.getAttachment(this.slotIndex,d))):h==e.setup&&this.setAttachment(t,p,p.data.attachmentName))},k.prototype.setAttachment=function(t,e,n){e.attachment=null==n?null:t.getAttachment(this.slotIndex,n)},k);function k(e){this.frames=t.Utils.newFloatArray(e),this.attachmentNames=new Array(e)}t.AttachmentTimeline=P;var R,O=null,_=(Ee(D,R=c),D.prototype.getPropertyId=function(){return(r.deform<<27)+ +this.attachment.id+this.slotIndex},D.prototype.setFrame=function(t,e,n){this.frames[t]=e,this.frameVertices[t]=n},D.prototype.apply=function(n,i,a,r,s,h,c){var l=n.slots[this.slotIndex];if(l.bone.active){var u=l.getAttachment();if(u instanceof t.VertexAttachment&&u.deformAttachment==this.attachment){var d=l.deform;0==d.length&&(h=e.setup);var p=this.frameVertices,f=p[0].length,g=this.frames;if(a<g[0]){var m=u;switch(h){case e.setup:return void(d.length=0);case e.first:if(1==s){d.length=0;break}var v=t.Utils.setArraySize(d,f);if(null==m.bones)for(var y=m.vertices,S=0;S<f;S++)v[S]+=(y[S]-v[S])*s;else for(s=1-s,S=0;S<f;S++)v[S]*=s}}else{var A=t.Utils.setArraySize(d,f);if(a>=g[g.length-1]){var E=p[g.length-1];if(1==s)if(h==e.add)if(null==(m=u).bones){y=m.vertices;for(var x=0;x<f;x++)A[x]+=E[x]-y[x]}else for(var b=0;b<f;b++)A[b]+=E[b];else t.Utils.arrayCopy(E,0,A,0,f);else switch(h){case e.setup:if(null==u.bones){y=u.vertices;for(var T=0;T<f;T++){var w=y[T];A[T]=w+(E[T]-w)*s}}else for(var C=0;C<f;C++)A[C]=E[C]*s;break;case e.first:case e.replace:for(var M=0;M<f;M++)A[M]+=(E[M]-A[M])*s;break;case e.add:if(null==(m=u).bones){y=m.vertices;for(var I=0;I<f;I++)A[I]+=(E[I]-y[I])*s}else for(var P=0;P<f;P++)A[P]+=E[P]*s}}else{var k=o.binarySearch(g,a),R=p[k-1],O=p[k],_=g[k],D=this.getCurvePercent(k-1,1-(a-_)/(g[k-1]-_));if(1==s)if(h==e.add)if(null==(m=u).bones){y=m.vertices;for(var L=0;L<f;L++){var B=R[L];A[L]+=B+(O[L]-B)*D-y[L]}}else for(var F=0;F<f;F++)B=R[F],A[F]+=B+(O[F]-B)*D;else for(var N=0;N<f;N++)B=R[N],A[N]=B+(O[N]-B)*D;else switch(h){case e.setup:if(null==u.bones){y=u.vertices;for(var G=0;G<f;G++)B=R[G],w=y[G],A[G]=w+(B+(O[G]-B)*D-w)*s}else for(var U=0;U<f;U++)B=R[U],A[U]=(B+(O[U]-B)*D)*s;break;case e.first:case e.replace:for(var V=0;V<f;V++)B=R[V],A[V]+=(B+(O[V]-B)*D-A[V])*s;break;case e.add:if(null==(m=u).bones){y=m.vertices;for(var Y=0;Y<f;Y++)B=R[Y],A[Y]+=(B+(O[Y]-B)*D-y[Y])*s}else for(var z=0;z<f;z++)B=R[z],A[z]+=(B+(O[z]-B)*D)*s}}}}}},D);function D(e){var n=R.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e),n.frameVertices=new Array(e),null==O&&(O=t.Utils.newFloatArray(64)),n}t.DeformTimeline=_;var L=(B.prototype.getPropertyId=function(){return r.event<<24},B.prototype.getFrameCount=function(){return this.frames.length},B.prototype.setFrame=function(t,e){this.frames[t]=e.time,this.events[t]=e},B.prototype.apply=function(t,e,n,i,a,r,s){if(null!=i){var h=this.frames,c=this.frames.length;if(n<e)this.apply(t,e,Number.MAX_VALUE,i,a,r,s),e=-1;else if(e>=h[c-1])return;if(!(n<h[0])){var l=0;if(e<h[0])l=0;else for(var u=h[l=o.binarySearch(h,e)];0<l&&h[l-1]==u;)l--;for(;l<c&&n>=h[l];l++)i.push(this.events[l])}}},B);function B(e){this.frames=t.Utils.newFloatArray(e),this.events=new Array(e)}t.EventTimeline=L;var F=(N.prototype.getPropertyId=function(){return r.drawOrder<<24},N.prototype.getFrameCount=function(){return this.frames.length},N.prototype.setFrame=function(t,e,n){this.frames[t]=e,this.drawOrders[t]=n},N.prototype.apply=function(n,a,r,s,h,c,l){var u=n.drawOrder,d=n.slots;if(l!=i.mixOut){var p=this.frames;if(r<p[0])c!=e.setup&&c!=e.first||t.Utils.arrayCopy(n.slots,0,n.drawOrder,0,n.slots.length);else{var f=r>=p[p.length-1]?p.length-1:o.binarySearch(p,r)-1,g=this.drawOrders[f];if(null==g)t.Utils.arrayCopy(d,0,u,0,d.length);else for(var m=0,v=g.length;m<v;m++)u[m]=d[g[m]]}}else c==e.setup&&t.Utils.arrayCopy(n.slots,0,n.drawOrder,0,n.slots.length)},N);function N(e){this.frames=t.Utils.newFloatArray(e),this.drawOrders=new Array(e)}t.DrawOrderTimeline=F;var G,U=(Ee(V,G=c),V.prototype.getPropertyId=function(){return(r.ikConstraint<<24)+this.ikConstraintIndex},V.prototype.setFrame=function(t,e,n,i,a,r,s){t*=V.ENTRIES,this.frames[t]=e,this.frames[t+V.MIX]=n,this.frames[t+V.SOFTNESS]=i,this.frames[t+V.BEND_DIRECTION]=a,this.frames[t+V.COMPRESS]=r?1:0,this.frames[t+V.STRETCH]=s?1:0},V.prototype.apply=function(t,n,a,r,s,h,c){var l,u,d,p,f,g=this.frames,m=t.ikConstraints[this.ikConstraintIndex];if(m.active)if(a<g[0])switch(h){case e.setup:return m.mix=m.data.mix,m.softness=m.data.softness,m.bendDirection=m.data.bendDirection,m.compress=m.data.compress,void(m.stretch=m.data.stretch);case e.first:m.mix+=(m.data.mix-m.mix)*s,m.softness+=(m.data.softness-m.softness)*s,m.bendDirection=m.data.bendDirection,m.compress=m.data.compress,m.stretch=m.data.stretch}else a>=g[g.length-V.ENTRIES]?h==e.setup?(m.mix=m.data.mix+(g[g.length+V.PREV_MIX]-m.data.mix)*s,m.softness=m.data.softness+(g[g.length+V.PREV_SOFTNESS]-m.data.softness)*s,c==i.mixOut?(m.bendDirection=m.data.bendDirection,m.compress=m.data.compress,m.stretch=m.data.stretch):(m.bendDirection=g[g.length+V.PREV_BEND_DIRECTION],m.compress=0!=g[g.length+V.PREV_COMPRESS],m.stretch=0!=g[g.length+V.PREV_STRETCH])):(m.mix+=(g[g.length+V.PREV_MIX]-m.mix)*s,m.softness+=(g[g.length+V.PREV_SOFTNESS]-m.softness)*s,c==i.mixIn&&(m.bendDirection=g[g.length+V.PREV_BEND_DIRECTION],m.compress=0!=g[g.length+V.PREV_COMPRESS],m.stretch=0!=g[g.length+V.PREV_STRETCH])):(u=g[(l=o.binarySearch(g,a,V.ENTRIES))+V.PREV_MIX],d=g[l+V.PREV_SOFTNESS],p=g[l],f=this.getCurvePercent(l/V.ENTRIES-1,1-(a-p)/(g[l+V.PREV_TIME]-p)),h==e.setup?(m.mix=m.data.mix+(u+(g[l+V.MIX]-u)*f-m.data.mix)*s,m.softness=m.data.softness+(d+(g[l+V.SOFTNESS]-d)*f-m.data.softness)*s,c==i.mixOut?(m.bendDirection=m.data.bendDirection,m.compress=m.data.compress,m.stretch=m.data.stretch):(m.bendDirection=g[l+V.PREV_BEND_DIRECTION],m.compress=0!=g[l+V.PREV_COMPRESS],m.stretch=0!=g[l+V.PREV_STRETCH])):(m.mix+=(u+(g[l+V.MIX]-u)*f-m.mix)*s,m.softness+=(d+(g[l+V.SOFTNESS]-d)*f-m.softness)*s,c==i.mixIn&&(m.bendDirection=g[l+V.PREV_BEND_DIRECTION],m.compress=0!=g[l+V.PREV_COMPRESS],m.stretch=0!=g[l+V.PREV_STRETCH])))},V.ENTRIES=6,V.PREV_TIME=-6,V.PREV_MIX=-5,V.PREV_SOFTNESS=-4,V.PREV_BEND_DIRECTION=-3,V.PREV_COMPRESS=-2,V.PREV_STRETCH=-1,V.MIX=1,V.SOFTNESS=2,V.BEND_DIRECTION=3,V.COMPRESS=4,V.STRETCH=5,V);function V(e){var n=G.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*V.ENTRIES),n}t.IkConstraintTimeline=U;var Y,z=(Ee(H,Y=c),H.prototype.getPropertyId=function(){return(r.transformConstraint<<24)+this.transformConstraintIndex},H.prototype.setFrame=function(t,e,n,i,a,r){t*=H.ENTRIES,this.frames[t]=e,this.frames[t+H.ROTATE]=n,this.frames[t+H.TRANSLATE]=i,this.frames[t+H.SCALE]=a,this.frames[t+H.SHEAR]=r},H.prototype.apply=function(t,n,i,a,r,s,h){var c=this.frames,l=t.transformConstraints[this.transformConstraintIndex];if(l.active)if(i<c[0]){var u=l.data;switch(s){case e.setup:return l.rotateMix=u.rotateMix,l.translateMix=u.translateMix,l.scaleMix=u.scaleMix,void(l.shearMix=u.shearMix);case e.first:l.rotateMix+=(u.rotateMix-l.rotateMix)*r,l.translateMix+=(u.translateMix-l.translateMix)*r,l.scaleMix+=(u.scaleMix-l.scaleMix)*r,l.shearMix+=(u.shearMix-l.shearMix)*r}}else{var d,p,f,g,m=0,v=0,y=0,S=0;i>=c[c.length-H.ENTRIES]?(m=c[(d=c.length)+H.PREV_ROTATE],v=c[d+H.PREV_TRANSLATE],y=c[d+H.PREV_SCALE],S=c[d+H.PREV_SHEAR]):(m=c[(p=o.binarySearch(c,i,H.ENTRIES))+H.PREV_ROTATE],v=c[p+H.PREV_TRANSLATE],y=c[p+H.PREV_SCALE],S=c[p+H.PREV_SHEAR],f=c[p],g=this.getCurvePercent(p/H.ENTRIES-1,1-(i-f)/(c[p+H.PREV_TIME]-f)),m+=(c[p+H.ROTATE]-m)*g,v+=(c[p+H.TRANSLATE]-v)*g,y+=(c[p+H.SCALE]-y)*g,S+=(c[p+H.SHEAR]-S)*g),s==e.setup?(u=l.data,l.rotateMix=u.rotateMix+(m-u.rotateMix)*r,l.translateMix=u.translateMix+(v-u.translateMix)*r,l.scaleMix=u.scaleMix+(y-u.scaleMix)*r,l.shearMix=u.shearMix+(S-u.shearMix)*r):(l.rotateMix+=(m-l.rotateMix)*r,l.translateMix+=(v-l.translateMix)*r,l.scaleMix+=(y-l.scaleMix)*r,l.shearMix+=(S-l.shearMix)*r)}},H.ENTRIES=5,H.PREV_TIME=-5,H.PREV_ROTATE=-4,H.PREV_TRANSLATE=-3,H.PREV_SCALE=-2,H.PREV_SHEAR=-1,H.ROTATE=1,H.TRANSLATE=2,H.SCALE=3,H.SHEAR=4,H);function H(e){var n=Y.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*H.ENTRIES),n}t.TransformConstraintTimeline=z;var W,X=(Ee(K,W=c),K.prototype.getPropertyId=function(){return(r.pathConstraintPosition<<24)+this.pathConstraintIndex},K.prototype.setFrame=function(t,e,n){t*=K.ENTRIES,this.frames[t]=e,this.frames[t+K.VALUE]=n},K.prototype.apply=function(t,n,i,a,r,s,h){var c=this.frames,l=t.pathConstraints[this.pathConstraintIndex];if(l.active)if(i<c[0])switch(s){case e.setup:return void(l.position=l.data.position);case e.first:l.position+=(l.data.position-l.position)*r}else{var u,d,p,f=0;i>=c[c.length-K.ENTRIES]?f=c[c.length+K.PREV_VALUE]:(f=c[(u=o.binarySearch(c,i,K.ENTRIES))+K.PREV_VALUE],d=c[u],p=this.getCurvePercent(u/K.ENTRIES-1,1-(i-d)/(c[u+K.PREV_TIME]-d)),f+=(c[u+K.VALUE]-f)*p),s==e.setup?l.position=l.data.position+(f-l.data.position)*r:l.position+=(f-l.position)*r}},K.ENTRIES=2,K.PREV_TIME=-2,K.PREV_VALUE=-1,K.VALUE=1,K);function K(e){var n=W.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*K.ENTRIES),n}t.PathConstraintPositionTimeline=X;var j,q=(Ee(Z,j=X),Z.prototype.getPropertyId=function(){return(r.pathConstraintSpacing<<24)+this.pathConstraintIndex},Z.prototype.apply=function(t,n,i,a,r,s,h){var c=this.frames,l=t.pathConstraints[this.pathConstraintIndex];if(l.active)if(i<c[0])switch(s){case e.setup:return void(l.spacing=l.data.spacing);case e.first:l.spacing+=(l.data.spacing-l.spacing)*r}else{var u,d,p,f=0;i>=c[c.length-Z.ENTRIES]?f=c[c.length+Z.PREV_VALUE]:(f=c[(u=o.binarySearch(c,i,Z.ENTRIES))+Z.PREV_VALUE],d=c[u],p=this.getCurvePercent(u/Z.ENTRIES-1,1-(i-d)/(c[u+Z.PREV_TIME]-d)),f+=(c[u+Z.VALUE]-f)*p),s==e.setup?l.spacing=l.data.spacing+(f-l.data.spacing)*r:l.spacing+=(f-l.spacing)*r}},Z);function Z(t){return j.call(this,t)||this}t.PathConstraintSpacingTimeline=q;var J,Q=(Ee($,J=c),$.prototype.getPropertyId=function(){return(r.pathConstraintMix<<24)+this.pathConstraintIndex},$.prototype.setFrame=function(t,e,n,i){t*=$.ENTRIES,this.frames[t]=e,this.frames[t+$.ROTATE]=n,this.frames[t+$.TRANSLATE]=i},$.prototype.apply=function(t,n,i,a,r,s,h){var c=this.frames,l=t.pathConstraints[this.pathConstraintIndex];if(l.active)if(i<c[0])switch(s){case e.setup:return l.rotateMix=l.data.rotateMix,void(l.translateMix=l.data.translateMix);case e.first:l.rotateMix+=(l.data.rotateMix-l.rotateMix)*r,l.translateMix+=(l.data.translateMix-l.translateMix)*r}else{var u,d,p,f=0,g=0;i>=c[c.length-$.ENTRIES]?(f=c[c.length+$.PREV_ROTATE],g=c[c.length+$.PREV_TRANSLATE]):(f=c[(u=o.binarySearch(c,i,$.ENTRIES))+$.PREV_ROTATE],g=c[u+$.PREV_TRANSLATE],d=c[u],p=this.getCurvePercent(u/$.ENTRIES-1,1-(i-d)/(c[u+$.PREV_TIME]-d)),f+=(c[u+$.ROTATE]-f)*p,g+=(c[u+$.TRANSLATE]-g)*p),s==e.setup?(l.rotateMix=l.data.rotateMix+(f-l.data.rotateMix)*r,l.translateMix=l.data.translateMix+(g-l.data.translateMix)*r):(l.rotateMix+=(f-l.rotateMix)*r,l.translateMix+=(g-l.translateMix)*r)}},$.ENTRIES=3,$.PREV_TIME=-3,$.PREV_ROTATE=-2,$.PREV_TRANSLATE=-1,$.ROTATE=1,$.TRANSLATE=2,$);function $(e){var n=J.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*$.ENTRIES),n}t.PathConstraintMixTimeline=Q}(Se=Se||{}),function(t){var e=(n.prototype.update=function(t){t*=this.timeScale;for(var e=this.tracks,n=0,i=e.length;n<i;n++){var a=e[n];if(null!=a){a.animationLast=a.nextAnimationLast,a.trackLast=a.nextTrackLast;var r=t*a.timeScale;if(0<a.delay){if(a.delay-=r,0<a.delay)continue;r=-a.delay,a.delay=0}var s=a.next;if(null!=s){var o=a.trackLast-s.delay;if(0<=o){for(s.delay=0,s.trackTime+=0==a.timeScale?0:(o/a.timeScale+t)*s.timeScale,a.trackTime+=r,this.setCurrent(n,s,!0);null!=s.mixingFrom;)s.mixTime+=t,s=s.mixingFrom;continue}}else if(a.trackLast>=a.trackEnd&&null==a.mixingFrom){e[n]=null,this.queue.end(a),this.disposeNext(a);continue}if(null!=a.mixingFrom&&this.updateMixingFrom(a,t)){var h=a.mixingFrom;for((a.mixingFrom=null)!=h&&(h.mixingTo=null);null!=h;)this.queue.end(h),h=h.mixingFrom}a.trackTime+=r}}this.queue.drain()},n.prototype.updateMixingFrom=function(t,e){var n=t.mixingFrom;if(null==n)return!0;var i=this.updateMixingFrom(n,e);return n.animationLast=n.nextAnimationLast,n.trackLast=n.nextTrackLast,0<t.mixTime&&t.mixTime>=t.mixDuration?(0!=n.totalAlpha&&0!=t.mixDuration||(t.mixingFrom=n.mixingFrom,null!=n.mixingFrom&&(n.mixingFrom.mixingTo=t),t.interruptAlpha=n.interruptAlpha,this.queue.end(n)),i):(n.trackTime+=e*n.timeScale,t.mixTime+=e,!1)},n.prototype.apply=function(e){if(null==e)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();for(var i=this.events,a=this.tracks,r=!1,s=0,o=a.length;s<o;s++){var h=a[s];if(!(null==h||0<h.delay)){r=!0;var c=0==s?t.MixBlend.first:h.mixBlend,l=h.alpha;null!=h.mixingFrom?l*=this.applyMixingFrom(h,e,c):h.trackTime>=h.trackEnd&&null==h.next&&(l=0);var u=h.animationLast,d=h.getAnimationTime(),p=h.animation.timelines.length,f=h.animation.timelines;if(0==s&&1==l||c==t.MixBlend.add)for(var g=0;g<p;g++){t.Utils.webkit602BugfixHelper(l,c);var m=f[g];m instanceof t.AttachmentTimeline?this.applyAttachmentTimeline(m,e,d,c,!0):m.apply(e,u,d,i,l,c,t.MixDirection.mixIn)}else{var v=h.timelineMode,y=0==h.timelinesRotation.length;y&&t.Utils.setArraySize(h.timelinesRotation,p<<1,null);var S=h.timelinesRotation;for(g=0;g<p;g++){var A=f[g],E=v[g]==n.SUBSEQUENT?c:t.MixBlend.setup;A instanceof t.RotateTimeline?this.applyRotateTimeline(A,e,d,l,E,S,g<<1,y):A instanceof t.AttachmentTimeline?this.applyAttachmentTimeline(A,e,d,c,!0):(t.Utils.webkit602BugfixHelper(l,c),A.apply(e,u,d,i,l,E,t.MixDirection.mixIn))}}this.queueEvents(h,d),i.length=0,h.nextAnimationLast=d,h.nextTrackLast=h.trackTime}}for(var x=this.unkeyedState+n.SETUP,b=e.slots,T=0,w=e.slots.length;T<w;T++){var C,M=b[T];M.attachmentState==x&&(C=M.data.attachmentName,M.attachment=null==C?null:e.getAttachment(M.data.index,C))}return this.unkeyedState+=2,this.queue.drain(),r},n.prototype.applyMixingFrom=function(e,i,a){var r=e.mixingFrom;null!=r.mixingFrom&&this.applyMixingFrom(r,i,a);var s=0;0==e.mixDuration?(s=1,a==t.MixBlend.first&&(a=t.MixBlend.setup)):(1<(s=e.mixTime/e.mixDuration)&&(s=1),a!=t.MixBlend.first&&(a=r.mixBlend));var o=s<r.eventThreshold?this.events:null,h=s<r.attachmentThreshold,c=s<r.drawOrderThreshold,l=r.animationLast,u=r.getAnimationTime(),d=r.animation.timelines.length,p=r.animation.timelines,f=r.alpha*e.interruptAlpha,g=f*(1-s);if(a==t.MixBlend.add)for(var m=0;m<d;m++)p[m].apply(i,l,u,o,g,a,t.MixDirection.mixOut);else{var v=r.timelineMode,y=r.timelineHoldMix,S=0==r.timelinesRotation.length;S&&t.Utils.setArraySize(r.timelinesRotation,d<<1,null);var A=r.timelinesRotation;for(m=r.totalAlpha=0;m<d;m++){var E=p[m],x=t.MixDirection.mixOut,b=void 0,T=0;switch(v[m]){case n.SUBSEQUENT:if(!c&&E instanceof t.DrawOrderTimeline)continue;b=a,T=g;break;case n.FIRST:b=t.MixBlend.setup,T=g;break;case n.HOLD_SUBSEQUENT:b=a,T=f;break;case n.HOLD_FIRST:b=t.MixBlend.setup,T=f;break;default:b=t.MixBlend.setup;var w=y[m];T=f*Math.max(0,1-w.mixTime/w.mixDuration)}r.totalAlpha+=T,E instanceof t.RotateTimeline?this.applyRotateTimeline(E,i,u,T,b,A,m<<1,S):E instanceof t.AttachmentTimeline?this.applyAttachmentTimeline(E,i,u,b,h):(t.Utils.webkit602BugfixHelper(T,a),c&&E instanceof t.DrawOrderTimeline&&b==t.MixBlend.setup&&(x=t.MixDirection.mixIn),E.apply(i,l,u,o,T,b,x))}}return 0<e.mixDuration&&this.queueEvents(r,u),this.events.length=0,r.nextAnimationLast=u,r.nextTrackLast=r.trackTime,s},n.prototype.applyAttachmentTimeline=function(e,i,a,r,s){var o,h,c=i.slots[e.slotIndex];c.bone.active&&(a<(o=e.frames)[0]?r!=t.MixBlend.setup&&r!=t.MixBlend.first||this.setAttachment(i,c,c.data.attachmentName,s):(h=a>=o[o.length-1]?o.length-1:t.Animation.binarySearch(o,a)-1,this.setAttachment(i,c,e.attachmentNames[h],s)),c.attachmentState<=this.unkeyedState&&(c.attachmentState=this.unkeyedState+n.SETUP))},n.prototype.setAttachment=function(t,e,i,a){e.attachment=null==i?null:t.getAttachment(e.data.index,i),a&&(e.attachmentState=this.unkeyedState+n.CURRENT)},n.prototype.applyRotateTimeline=function(e,n,i,a,r,s,o,h){if(h&&(s[o]=0),1!=a){var c=e,l=c.frames,u=n.bones[c.boneIndex];if(u.active){var d=0,p=0;if(i<l[0])switch(r){case t.MixBlend.setup:u.rotation=u.data.rotation;default:return;case t.MixBlend.first:d=u.rotation,p=u.data.rotation}else{var f,g,m,v;d=r==t.MixBlend.setup?u.data.rotation:u.rotation;i>=l[l.length-t.RotateTimeline.ENTRIES]?p=u.data.rotation+l[l.length+t.RotateTimeline.PREV_ROTATION]:(g=l[(f=t.Animation.binarySearch(l,i,t.RotateTimeline.ENTRIES))+t.RotateTimeline.PREV_ROTATION],m=l[f],v=c.getCurvePercent((f>>1)-1,1-(i-m)/(l[f+t.RotateTimeline.PREV_TIME]-m)),p=l[f+t.RotateTimeline.ROTATION]-g,p=g+(p-=360*(16384-(16384.499999999996-p/360|0)))*v+u.data.rotation,p-=360*(16384-(16384.499999999996-p/360|0)))}var y,S,A,E,x=0,b=p-d;0==(b-=360*(16384-(16384.499999999996-b/360|0)))?x=s[o]:(y=0,S=h?(y=0,b):(y=s[o],s[o+1]),A=0<b,E=0<=y,t.MathUtils.signum(S)!=t.MathUtils.signum(b)&&Math.abs(S)<=90&&(180<Math.abs(y)&&(y+=360*t.MathUtils.signum(y)),E=A),x=b+y-y%360,E!=A&&(x+=360*t.MathUtils.signum(y)),s[o]=x),s[o+1]=b,d+=x*a,u.rotation=d-360*(16384-(16384.499999999996-d/360|0))}}else e.apply(n,0,i,null,1,r,t.MixDirection.mixIn)},n.prototype.queueEvents=function(t,e){for(var n=t.animationStart,i=t.animationEnd,a=i-n,r=t.trackLast%a,s=this.events,o=0,h=s.length;o<h;o++){var c=s[o];if(c.time<r)break;c.time>i||this.queue.event(t,c)}for((t.loop?0==a||r>t.trackTime%a:i<=e&&t.animationLast<i)&&this.queue.complete(t);o<h;o++)s[o].time<n||this.queue.event(t,s[o])},n.prototype.clearTracks=function(){var t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var e=0,n=this.tracks.length;e<n;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()},n.prototype.clearTrack=function(t){if(!(t>=this.tracks.length)){var e=this.tracks[t];if(null!=e){this.queue.end(e),this.disposeNext(e);for(var n=e;;){var i=n.mixingFrom;if(null==i)break;this.queue.end(i),n.mixingFrom=null,n.mixingTo=null,n=i}this.tracks[e.trackIndex]=null,this.queue.drain()}}},n.prototype.setCurrent=function(t,e,n){var i=this.expandToIndex(t);this.tracks[t]=e,null!=i&&(n&&this.queue.interrupt(i),((e.mixingFrom=i).mixingTo=e).mixTime=0,null!=i.mixingFrom&&0<i.mixDuration&&(e.interruptAlpha*=Math.min(1,i.mixTime/i.mixDuration)),i.timelinesRotation.length=0),this.queue.start(e)},n.prototype.setAnimation=function(t,e,n){var i=this.data.skeletonData.findAnimation(e);if(null==i)throw new Error("Animation not found: "+e);return this.setAnimationWith(t,i,n)},n.prototype.setAnimationWith=function(t,e,n){if(null==e)throw new Error("animation cannot be null.");var i=!0,a=this.expandToIndex(t);null!=a&&(-1==a.nextTrackLast?(this.tracks[t]=a.mixingFrom,this.queue.interrupt(a),this.queue.end(a),this.disposeNext(a),a=a.mixingFrom,i=!1):this.disposeNext(a));var r=this.trackEntry(t,e,n,a);return this.setCurrent(t,r,i),this.queue.drain(),r},n.prototype.addAnimation=function(t,e,n,i){var a=this.data.skeletonData.findAnimation(e);if(null==a)throw new Error("Animation not found: "+e);return this.addAnimationWith(t,a,n,i)},n.prototype.addAnimationWith=function(t,e,n,i){if(null==e)throw new Error("animation cannot be null.");var a=this.expandToIndex(t);if(null!=a)for(;null!=a.next;)a=a.next;var r,s=this.trackEntry(t,e,n,a);return null==a?(this.setCurrent(t,s,!0),this.queue.drain()):(a.next=s,i<=0&&(0!=(r=a.animationEnd-a.animationStart)?(a.loop?i+=r*(1+(a.trackTime/r|0)):i+=Math.max(r,a.trackTime),i-=this.data.getMix(a.animation,e)):i=a.trackTime)),s.delay=i,s},n.prototype.setEmptyAnimation=function(t,e){var i=this.setAnimationWith(t,n.emptyAnimation,!1);return i.mixDuration=e,i.trackEnd=e,i},n.prototype.addEmptyAnimation=function(t,e,i){i<=0&&(i-=e);var a=this.addAnimationWith(t,n.emptyAnimation,!1,i);return a.mixDuration=e,a.trackEnd=e,a},n.prototype.setEmptyAnimations=function(t){var e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var n=0,i=this.tracks.length;n<i;n++){var a=this.tracks[n];null!=a&&this.setEmptyAnimation(a.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()},n.prototype.expandToIndex=function(e){return e<this.tracks.length?this.tracks[e]:(t.Utils.ensureArrayCapacity(this.tracks,e+1,null),this.tracks.length=e+1,null)},n.prototype.trackEntry=function(e,n,i,a){var r=this.trackEntryPool.obtain();return r.trackIndex=e,r.animation=n,r.loop=i,r.holdPrevious=!1,r.eventThreshold=0,r.attachmentThreshold=0,r.drawOrderThreshold=0,r.animationStart=0,r.animationEnd=n.duration,r.animationLast=-1,r.nextAnimationLast=-1,r.delay=0,r.trackTime=0,r.trackLast=-1,r.nextTrackLast=-1,r.trackEnd=Number.MAX_VALUE,r.timeScale=1,r.alpha=1,r.interruptAlpha=1,r.mixTime=0,r.mixDuration=null==a?0:this.data.getMix(a.animation,n),r.mixBlend=t.MixBlend.replace,r},n.prototype.disposeNext=function(t){for(var e=t.next;null!=e;)this.queue.dispose(e),e=e.next;t.next=null},n.prototype._animationsChanged=function(){this.animationsChanged=!1,this.propertyIDs.clear();for(var e=0,n=this.tracks.length;e<n;e++){var i=this.tracks[e];if(null!=i){for(;null!=i.mixingFrom;)i=i.mixingFrom;for(;null!=i.mixingFrom&&i.mixBlend==t.MixBlend.add||this.computeHold(i),null!=(i=i.mixingTo););}}},n.prototype.computeHold=function(e){var i=e.mixingTo,a=e.animation.timelines,r=e.animation.timelines.length,s=t.Utils.setArraySize(e.timelineMode,r);e.timelineHoldMix.length=0;var o=t.Utils.setArraySize(e.timelineHoldMix,r),h=this.propertyIDs;if(null!=i&&i.holdPrevious)for(var c=0;c<r;c++)s[c]=h.add(a[c].getPropertyId())?n.HOLD_FIRST:n.HOLD_SUBSEQUENT;else t:for(c=0;c<r;c++){var l=a[c],u=l.getPropertyId();if(h.add(u))if(null==i||l instanceof t.AttachmentTimeline||l instanceof t.DrawOrderTimeline||l instanceof t.EventTimeline||!i.animation.hasTimeline(u))s[c]=n.FIRST;else{for(var d=i.mixingTo;null!=d;d=d.mixingTo)if(!d.animation.hasTimeline(u)){if(0<e.mixDuration){s[c]=n.HOLD_MIX,o[c]=d;continue t}break}s[c]=n.HOLD_FIRST}else s[c]=n.SUBSEQUENT}},n.prototype.getCurrent=function(t){return t>=this.tracks.length?null:this.tracks[t]},n.prototype.addListener=function(t){if(null==t)throw new Error("listener cannot be null.");this.listeners.push(t)},n.prototype.removeListener=function(t){var e,n,i=g()(e=this.listeners).call(e,t);0<=i&&ds()(n=this.listeners).call(n,i,1)},n.prototype.clearListeners=function(){this.listeners.length=0},n.prototype.clearListenerNotifications=function(){this.queue.clear()},n.emptyAnimation=new t.Animation("<empty>",[],0),n.SUBSEQUENT=0,n.FIRST=1,n.HOLD_SUBSEQUENT=2,n.HOLD_FIRST=3,n.HOLD_MIX=4,n.SETUP=1,n.CURRENT=2,n);function n(e){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new o(this),this.propertyIDs=new t.IntSet,this.animationsChanged=!1,this.trackEntryPool=new t.Pool((function(){return new i})),this.data=e}t.AnimationState=e;var i=(a.prototype.reset=function(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0},a.prototype.getAnimationTime=function(){if(this.loop){var t=this.animationEnd-this.animationStart;return 0==t?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)},a.prototype.setAnimationLast=function(t){this.animationLast=t,this.nextAnimationLast=t},a.prototype.isComplete=function(){return this.trackTime>=this.animationEnd-this.animationStart},a.prototype.resetRotationDirections=function(){this.timelinesRotation.length=0},a);function a(){this.mixBlend=t.MixBlend.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}t.TrackEntry=i;var r,s,o=(h.prototype.start=function(t){this.objects.push(r.start),this.objects.push(t),this.animState.animationsChanged=!0},h.prototype.interrupt=function(t){this.objects.push(r.interrupt),this.objects.push(t)},h.prototype.end=function(t){this.objects.push(r.end),this.objects.push(t),this.animState.animationsChanged=!0},h.prototype.dispose=function(t){this.objects.push(r.dispose),this.objects.push(t)},h.prototype.complete=function(t){this.objects.push(r.complete),this.objects.push(t)},h.prototype.event=function(t,e){this.objects.push(r.event),this.objects.push(t),this.objects.push(e)},h.prototype.drain=function(){if(!this.drainDisabled){this.drainDisabled=!0;for(var t=this.objects,e=this.animState.listeners,n=0;n<t.length;n+=2){var i=t[n],a=t[n+1];switch(i){case r.start:null!=a.listener&&a.listener.start&&a.listener.start(a);for(var s=0;s<e.length;s++)e[s].start&&e[s].start(a);break;case r.interrupt:for(null!=a.listener&&a.listener.interrupt&&a.listener.interrupt(a),s=0;s<e.length;s++)e[s].interrupt&&e[s].interrupt(a);break;case r.end:for(null!=a.listener&&a.listener.end&&a.listener.end(a),s=0;s<e.length;s++)e[s].end&&e[s].end(a);case r.dispose:for(null!=a.listener&&a.listener.dispose&&a.listener.dispose(a),s=0;s<e.length;s++)e[s].dispose&&e[s].dispose(a);this.animState.trackEntryPool.free(a);break;case r.complete:for(null!=a.listener&&a.listener.complete&&a.listener.complete(a),s=0;s<e.length;s++)e[s].complete&&e[s].complete(a);break;case r.event:var o=t[2+n++];for(null!=a.listener&&a.listener.event&&a.listener.event(a,o),s=0;s<e.length;s++)e[s].event&&e[s].event(a,o)}}this.clear(),this.drainDisabled=!1}},h.prototype.clear=function(){this.objects.length=0},h);function h(t){this.objects=[],this.drainDisabled=!1,this.animState=t}t.EventQueue=o,(s=r=t.EventType||(t.EventType={}))[s.start=0]="start",s[s.interrupt=1]="interrupt",s[s.end=2]="end",s[s.dispose=3]="dispose",s[s.complete=4]="complete",s[s.event=5]="event";var c=(l.prototype.start=function(t){},l.prototype.interrupt=function(t){},l.prototype.end=function(t){},l.prototype.dispose=function(t){},l.prototype.complete=function(t){},l.prototype.event=function(t,e){},l);function l(){}t.AnimationStateAdapter=c}(Se=Se||{}),n=Se=Se||{},xe.prototype.setMix=function(t,e,n){var i=this.skeletonData.findAnimation(t);if(null==i)throw new Error("Animation not found: "+t);var a=this.skeletonData.findAnimation(e);if(null==a)throw new Error("Animation not found: "+e);this.setMixWith(i,a,n)},xe.prototype.setMixWith=function(t,e,n){if(null==t)throw new Error("from cannot be null.");if(null==e)throw new Error("to cannot be null.");var i=t.name+"."+e.name;this.animationToMixTime[i]=n},xe.prototype.getMix=function(t,e){var n=t.name+"."+e.name,i=this.animationToMixTime[n];return void 0===i?this.defaultMix:i},i=xe,n.AnimationStateData=i,a=Se=Se||{},be.prototype.downloadText=function(t,e,n){var i=new XMLHttpRequest;i.overrideMimeType("text/html"),this.rawDataUris[t]&&(t=this.rawDataUris[t]),i.open("GET",t,!0),i.onload=function(){200==i.status?e(i.responseText):n(i.status,i.responseText)},i.onerror=function(){n(i.status,i.responseText)},i.send()},be.prototype.downloadBinary=function(t,e,n){var i=new XMLHttpRequest;this.rawDataUris[t]&&(t=this.rawDataUris[t]),i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=function(){200==i.status?e(new Uint8Array(i.response)):n(i.status,i.responseText)},i.onerror=function(){n(i.status,i.responseText)},i.send()},be.prototype.setRawDataURI=function(t,e){this.rawDataUris[this.pathPrefix+t]=e},be.prototype.loadBinary=function(t,e,n){var i=this;void 0===e&&(e=null),void 0===n&&(n=null),t=this.pathPrefix+t,this.toLoad++,this.downloadBinary(t,(function(n){i.assets[t]=n,e&&e(t,n),i.toLoad--,i.loaded++}),(function(e,a){i.errors[t]="Couldn't load binary "+t+": status "+status+", "+a,n&&n(t,"Couldn't load binary "+t+": status "+status+", "+a),i.toLoad--,i.loaded++}))},be.prototype.loadText=function(t,e,n){var i=this;void 0===e&&(e=null),void 0===n&&(n=null),t=this.pathPrefix+t,this.toLoad++,this.downloadText(t,(function(n){i.assets[t]=n,e&&e(t,n),i.toLoad--,i.loaded++}),(function(e,a){i.errors[t]="Couldn't load text "+t+": status "+status+", "+a,n&&n(t,"Couldn't load text "+t+": status "+status+", "+a),i.toLoad--,i.loaded++}))},be.prototype.loadTexture=function(t,e,n){var i=this;void 0===e&&(e=null),void 0===n&&(n=null);var a=t=this.pathPrefix+t;this.toLoad++;var r=new Image;r.crossOrigin="anonymous",r.onload=function(n){var s=i.textureLoader(r);i.assets[a]=s,i.toLoad--,i.loaded++,e&&e(t,r)},r.onerror=function(e){i.errors[t]="Couldn't load image "+t,i.toLoad--,i.loaded++,n&&n(t,"Couldn't load image "+t)},this.rawDataUris[t]&&(t=this.rawDataUris[t]),r.src=t},be.prototype.loadTextureAtlas=function(t,e,n){var i=this;void 0===e&&(e=null),void 0===n&&(n=null);var r=0<=it()(t).call(t,"/")?t.substring(0,it()(t).call(t,"/")):"";t=this.pathPrefix+t,this.toLoad++,this.downloadText(t,(function(s){var o={count:0},h=new Array;try{new a.TextureAtlas(s,(function(t){h.push(""==r?t:r+"/"+t);var e=document.createElement("img");return e.width=16,e.height=16,new a.FakeTexture(e)}))}catch(l){var c=l;return i.errors[t]="Couldn't load texture atlas "+t+": "+c.message,n&&n(t,"Couldn't load texture atlas "+t+": "+c.message),i.toLoad--,void i.loaded++}for(var l=0,u=h;l<u.length;l++)!function(c){var l=!1;i.loadTexture(c,(function(c,u){if(o.count++,o.count==h.length)if(l)i.errors[t]="Couldn't load texture atlas page "+c+"} of atlas "+t,n&&n(t,"Couldn't load texture atlas page "+c+" of atlas "+t),i.toLoad--,i.loaded++;else try{var d=new a.TextureAtlas(s,(function(t){return i.get(""==r?t:r+"/"+t)}));i.assets[t]=d,e&&e(t,d),i.toLoad--,i.loaded++}catch(c){var p=c;i.errors[t]="Couldn't load texture atlas "+t+": "+p.message,n&&n(t,"Couldn't load texture atlas "+t+": "+p.message),i.toLoad--,i.loaded++}}),(function(e,a){l=!0,o.count++,o.count==h.length&&(i.errors[t]="Couldn't load texture atlas page "+e+"} of atlas "+t,n&&n(t,"Couldn't load texture atlas page "+e+" of atlas "+t),i.toLoad--,i.loaded++)}))}(u[l])}),(function(e,a){i.errors[t]="Couldn't load texture atlas "+t+": status "+status+", "+a,n&&n(t,"Couldn't load texture atlas "+t+": status "+status+", "+a),i.toLoad--,i.loaded++}))},be.prototype.get=function(t){return t=this.pathPrefix+t,this.assets[t]},be.prototype.remove=function(t){t=this.pathPrefix+t;var e=this.assets[t];e.dispose&&e.dispose(),this.assets[t]=null},be.prototype.removeAll=function(){for(var t in this.assets){var e=this.assets[t];e.dispose&&e.dispose()}this.assets={}},be.prototype.isLoadingComplete=function(){return 0==this.toLoad},be.prototype.getToLoad=function(){return this.toLoad},be.prototype.getLoaded=function(){return this.loaded},be.prototype.dispose=function(){this.removeAll()},be.prototype.hasErrors=function(){return 0<Y()(this.errors).length},be.prototype.getErrors=function(){return this.errors},r=be,a.AssetManager=r,s=Se=Se||{},Te.prototype.newRegionAttachment=function(t,e,n){var i=this.atlas.findRegion(n);if(null==i)throw new Error("Region not found in atlas: "+n+" (region attachment: "+e+")");i.renderObject=i;var a=new s.RegionAttachment(e);return a.setRegion(i),a},Te.prototype.newMeshAttachment=function(t,e,n){var i=this.atlas.findRegion(n);if(null==i)throw new Error("Region not found in atlas: "+n+" (mesh attachment: "+e+")");i.renderObject=i;var a=new s.MeshAttachment(e);return a.region=i,a},Te.prototype.newBoundingBoxAttachment=function(t,e){return new s.BoundingBoxAttachment(e)},Te.prototype.newPathAttachment=function(t,e){return new s.PathAttachment(e)},Te.prototype.newPointAttachment=function(t,e){return new s.PointAttachment(e)},Te.prototype.newClippingAttachment=function(t,e){return new s.ClippingAttachment(e)},o=Te,s.AtlasAttachmentLoader=o,(c=(h=Se=Se||{}).BlendMode||(h.BlendMode={}))[c.Normal=0]="Normal",c[c.Additive=1]="Additive",c[c.Multiply=2]="Multiply",c[c.Screen=3]="Screen",l=Se=Se||{},we.prototype.isActive=function(){return this.active},we.prototype.update=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},we.prototype.updateWorldTransform=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},we.prototype.updateWorldTransformWith=function(t,e,n,i,a,r,s){this.ax=t,this.ay=e,this.arotation=n,this.ascaleX=i,this.ascaleY=a,this.ashearX=r,this.ashearY=s,this.appliedValid=!0;var o=this.parent;if(null==o){var h=this.skeleton,c=n+90+s,u=h.scaleX,d=h.scaleY;return this.a=l.MathUtils.cosDeg(n+r)*i*u,this.b=l.MathUtils.cosDeg(c)*a*u,this.c=l.MathUtils.sinDeg(n+r)*i*d,this.d=l.MathUtils.sinDeg(c)*a*d,this.worldX=t*u+h.x,void(this.worldY=e*d+h.y)}var p=o.a,f=o.b,g=o.c,m=o.d;switch(this.worldX=p*t+f*e+o.worldX,this.worldY=g*t+m*e+o.worldY,this.data.transformMode){case l.TransformMode.Normal:c=n+90+s;var v=l.MathUtils.cosDeg(n+r)*i,y=l.MathUtils.cosDeg(c)*a,S=l.MathUtils.sinDeg(n+r)*i,A=l.MathUtils.sinDeg(c)*a;return this.a=p*v+f*S,this.b=p*y+f*A,this.c=g*v+m*S,void(this.d=g*y+m*A);case l.TransformMode.OnlyTranslation:c=n+90+s,this.a=l.MathUtils.cosDeg(n+r)*i,this.b=l.MathUtils.cosDeg(c)*a,this.c=l.MathUtils.sinDeg(n+r)*i,this.d=l.MathUtils.sinDeg(c)*a;break;case l.TransformMode.NoRotationOrReflection:var E,x=n+r-(E=1e-4<(T=p*p+g*g)?(T=Math.abs(p*m-f*g)/T,p/=this.skeleton.scaleX,f=(g/=this.skeleton.scaleY)*T,m=p*T,Math.atan2(g,p)*l.MathUtils.radDeg):(g=p=0,90-Math.atan2(m,f)*l.MathUtils.radDeg)),b=n+s-E+90;v=l.MathUtils.cosDeg(x)*i,y=l.MathUtils.cosDeg(b)*a,S=l.MathUtils.sinDeg(x)*i,A=l.MathUtils.sinDeg(b)*a;this.a=p*v-f*S,this.b=p*y-f*A,this.c=g*v+m*S,this.d=g*y+m*A;break;case l.TransformMode.NoScale:case l.TransformMode.NoScaleOrReflection:var T,w=l.MathUtils.cosDeg(n),C=l.MathUtils.sinDeg(n),M=(p*w+f*C)/this.skeleton.scaleX,I=(g*w+m*C)/this.skeleton.scaleY;1e-5<(T=Math.sqrt(M*M+I*I))&&(T=1/T),M*=T,I*=T,T=Math.sqrt(M*M+I*I),this.data.transformMode==l.TransformMode.NoScale&&p*m-f*g<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(T=-T);var P=Math.PI/2+Math.atan2(I,M),k=Math.cos(P)*T,R=Math.sin(P)*T;v=l.MathUtils.cosDeg(r)*i,y=l.MathUtils.cosDeg(90+s)*a,S=l.MathUtils.sinDeg(r)*i,A=l.MathUtils.sinDeg(90+s)*a;this.a=M*v+k*S,this.b=M*y+k*A,this.c=I*v+R*S,this.d=I*y+R*A}this.a*=this.skeleton.scaleX,this.b*=this.skeleton.scaleX,this.c*=this.skeleton.scaleY,this.d*=this.skeleton.scaleY},we.prototype.setToSetupPose=function(){var t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY},we.prototype.getWorldRotationX=function(){return Math.atan2(this.c,this.a)*l.MathUtils.radDeg},we.prototype.getWorldRotationY=function(){return Math.atan2(this.d,this.b)*l.MathUtils.radDeg},we.prototype.getWorldScaleX=function(){return Math.sqrt(this.a*this.a+this.c*this.c)},we.prototype.getWorldScaleY=function(){return Math.sqrt(this.b*this.b+this.d*this.d)},we.prototype.updateAppliedTransform=function(){this.appliedValid=!0;var t=this.parent;if(null==t)return this.ax=this.worldX,this.ay=this.worldY,this.arotation=Math.atan2(this.c,this.a)*l.MathUtils.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,void(this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*l.MathUtils.radDeg);var e=t.a,n=t.b,i=t.c,a=t.d,r=1/(e*a-n*i),s=this.worldX-t.worldX,o=this.worldY-t.worldY;this.ax=s*a*r-o*n*r,this.ay=o*e*r-s*i*r;var h,c=r*a,u=r*e,d=r*n,p=r*i,f=c*this.a-d*this.c,g=c*this.b-d*this.d,m=u*this.c-p*this.a,v=u*this.d-p*this.b;this.ashearX=0,this.ascaleX=Math.sqrt(f*f+m*m),1e-4<this.ascaleX?(h=f*v-g*m,this.ascaleY=h/this.ascaleX,this.ashearY=Math.atan2(f*g+m*v,h)*l.MathUtils.radDeg,this.arotation=Math.atan2(m,f)*l.MathUtils.radDeg):(this.ascaleX=0,this.ascaleY=Math.sqrt(g*g+v*v),this.ashearY=0,this.arotation=90-Math.atan2(v,g)*l.MathUtils.radDeg)},we.prototype.worldToLocal=function(t){var e=this.a,n=this.b,i=this.c,a=this.d,r=1/(e*a-n*i),s=t.x-this.worldX,o=t.y-this.worldY;return t.x=s*a*r-o*n*r,t.y=o*e*r-s*i*r,t},we.prototype.localToWorld=function(t){var e=t.x,n=t.y;return t.x=e*this.a+n*this.b+this.worldX,t.y=e*this.c+n*this.d+this.worldY,t},we.prototype.worldToLocalRotation=function(t){var e=l.MathUtils.sinDeg(t),n=l.MathUtils.cosDeg(t);return Math.atan2(this.a*e-this.c*n,this.d*n-this.b*e)*l.MathUtils.radDeg+this.rotation-this.shearX},we.prototype.localToWorldRotation=function(t){t-=this.rotation-this.shearX;var e=l.MathUtils.sinDeg(t),n=l.MathUtils.cosDeg(t);return Math.atan2(n*this.c+e*this.d,n*this.a+e*this.b)*l.MathUtils.radDeg},we.prototype.rotateWorld=function(t){var e=this.a,n=this.b,i=this.c,a=this.d,r=l.MathUtils.cosDeg(t),s=l.MathUtils.sinDeg(t);this.a=r*e-s*i,this.b=r*n-s*a,this.c=s*e+r*i,this.d=s*n+r*a,this.appliedValid=!1},u=we,l.Bone=u,(d=Se=Se||{}).BoneData=function(t,e,n){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=p.Normal,this.skinRequired=!1,this.color=new d.Color,t<0)throw new Error("index must be >= 0.");if(null==e)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=n},(f=p=d.TransformMode||(d.TransformMode={}))[f.Normal=0]="Normal",f[f.OnlyTranslation=1]="OnlyTranslation",f[f.NoRotationOrReflection=2]="NoRotationOrReflection",f[f.NoScale=3]="NoScale",f[f.NoScaleOrReflection=4]="NoScaleOrReflection",(Se||(Se={})).ConstraintData=function(t,e,n){this.name=t,this.order=e,this.skinRequired=n},(Se||(Se={})).Event=function(t,e){if(null==e)throw new Error("data cannot be null.");this.time=t,this.data=e},(Se||(Se={})).EventData=function(t){this.name=t},m=Se=Se||{},Ce.prototype.isActive=function(){return this.active},Ce.prototype.apply=function(){this.update()},Ce.prototype.update=function(){var t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.softness,this.mix)}},Ce.prototype.apply1=function(t,e,n,i,a,r,s){t.appliedValid||t.updateAppliedTransform();var o=t.parent,h=o.a,c=o.b,l=o.c,u=o.d,d=-t.ashearX-t.arotation,p=0,f=0;switch(t.data.transformMode){case m.TransformMode.OnlyTranslation:p=e-t.worldX,f=n-t.worldY;break;case m.TransformMode.NoRotationOrReflection:var g=Math.abs(h*u-c*l)/(h*h+l*l),v=h/t.skeleton.scaleX,y=l/t.skeleton.scaleY;c=-y*g*t.skeleton.scaleX,u=v*g*t.skeleton.scaleY;d+=Math.atan2(y,v)*m.MathUtils.radDeg;default:var S=e-o.worldX,A=n-o.worldY,E=h*u-c*l;p=(S*u-A*c)/E-t.ax,f=(A*h-S*l)/E-t.ay}d+=Math.atan2(f,p)*m.MathUtils.radDeg,t.ascaleX<0&&(d+=180),180<d?d-=360:d<-180&&(d+=360);var x=t.ascaleX,b=t.ascaleY;if(i||a){switch(t.data.transformMode){case m.TransformMode.NoScale:case m.TransformMode.NoScaleOrReflection:p=e-t.worldX,f=n-t.worldY}var T=t.data.length*x,w=Math.sqrt(p*p+f*f);(i&&w<T||a&&T<w&&1e-4<T)&&(x*=g=(w/T-1)*s+1,r&&(b*=g))}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+d*s,x,b,t.ashearX,t.ashearY)},Ce.prototype.apply2=function(t,e,n,i,a,r,s,o){if(0!=o){t.appliedValid||t.updateAppliedTransform(),e.appliedValid||e.updateAppliedTransform();var h,c=t.ax,l=t.ay,u=t.ascaleX,d=u,p=t.ascaleY,f=e.ascaleX,g=0,v=0;v=u<0?(u=-u,g=180,-1):(g=0,1);p<0&&(p=-p,v=-v),h=f<0?(f=-f,180):0;var y=e.ax,S=0,A=0,E=t.a,x=t.b,b=t.c,T=t.d,w=Math.abs(u-p)<=1e-4,C=w?(A=E*y+x*(S=e.ay)+t.worldX,b*y+T*S+t.worldY):(S=0,A=E*y+t.worldX,b*y+t.worldY),M=t.parent;E=M.a,x=M.b;b=M.c;var I,P=1/(E*(T=M.d)-x*b),k=A-M.worldX,R=C-M.worldY,O=(k*T-R*x)*P-c,_=(R*E-k*b)*P-l,D=Math.sqrt(O*O+_*_),L=e.data.length*f;if(D<1e-4)return this.apply1(t,n,i,!1,r,!1,o),void e.updateWorldTransformWith(y,S,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);var B,F,N,G=((k=n-M.worldX)*T-(R=i-M.worldY)*x)*P-c,U=(R*E-k*b)*P-l,V=G*G+U*U;0!=s&&(s*=u*(f+1)/2,0<(F=(B=Math.sqrt(V))-D-L*u+s)&&(V=(G-=(N=(F-s*(1-(N=Math.min(1,F/(2*s))-1)*N))/B)*G)*G+(U-=N*U)*U));t:if(w){var Y=(V-D*D-(L*=u)*L)/(2*D*L);Y<-1?Y=-1:1<Y&&(Y=1,r&&(d*=(Math.sqrt(V)/(D+L)-1)*o+1)),I=Math.acos(Y)*a,E=D+L*Y,x=L*Math.sin(I),st=Math.atan2(U*E-G*x,G*E+U*x)}else{var z=(E=u*L)*E,H=(x=p*L)*x,W=Math.atan2(U,G),X=-2*H*D,K=H-z;if(0<=(T=X*X-4*K*(b=H*D*D+z*V-z*H))){var j=Math.sqrt(T);X<0&&(j=-j);var q=(j=-(X+j)/2)/K,Z=b/j,J=Math.abs(q)<Math.abs(Z)?q:Z;if(J*J<=V){R=Math.sqrt(V-J*J)*a,st=W-Math.atan2(R,J),I=Math.atan2(R/p,(J-D)/u);break t}}var Q=m.MathUtils.PI,$=D-E,tt=$*$,et=0,nt=0,it=D+E,at=it*it,rt=0;-1<=(b=-E*D/(z-H))&&b<=1&&(b=Math.acos(b),(T=(k=E*Math.cos(b)+D)*k+(R=x*Math.sin(b))*R)<tt&&(Q=b,tt=T,$=k,et=R),at<T&&(nt=b,at=T,it=k,rt=R)),I=V<=(tt+at)/2?(st=W-Math.atan2(et*a,$),Q*a):(st=W-Math.atan2(rt*a,it),nt*a)}var st,ot=Math.atan2(S,y)*v,ht=t.arotation;180<(st=(st-ot)*m.MathUtils.radDeg+g-ht)?st-=360:st<-180&&(st+=360),t.updateWorldTransformWith(c,l,ht+st*o,d,t.ascaleY,0,0),ht=e.arotation,180<(I=((I+ot)*m.MathUtils.radDeg-e.ashearX)*v+h-ht)?I-=360:I<-180&&(I+=360),e.updateWorldTransformWith(y,S,ht+I*o,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}else e.updateWorldTransform()},v=Ce,m.IkConstraint=v,y=Se=Se||{},S=y.ConstraintData,Ee(Me,S),A=Me,y.IkConstraintData=A,E=Se=Se||{},Ie.prototype.isActive=function(){return this.active},Ie.prototype.apply=function(){this.update()},Ie.prototype.update=function(){var t=this.target.getAttachment();if(t instanceof E.PathAttachment){var e=this.rotateMix,n=this.translateMix,i=0<e;if(0<n||i){var a=this.data,r=a.spacingMode==E.SpacingMode.Percent,s=a.rotateMode,o=s==E.RotateMode.Tangent,h=s==E.RotateMode.ChainScale,c=this.bones.length,l=o?c:c+1,u=this.bones,d=E.Utils.setArraySize(this.spaces,l),p=null,f=this.spacing;if(h||!r){h&&(p=E.Utils.setArraySize(this.lengths,c));for(var g=a.spacingMode==E.SpacingMode.Length,m=0,v=l-1;m<v;){var y,S,A=(M=u[m]).data.length;A<Ie.epsilon?(h&&(p[m]=0),d[++m]=0):r?(h&&(P=A*M.a,k=A*M.c,y=Math.sqrt(P*P+k*k),p[m]=y),d[++m]=f):(P=A*M.a,k=A*M.c,S=Math.sqrt(P*P+k*k),h&&(p[m]=S),d[++m]=(g?A+f:f)*S/A)}}else for(m=1;m<l;m++)d[m]=f;var x=this.computeWorldPositions(t,l,o,a.positionMode==E.PositionMode.Percent,r),b=x[0],T=x[1],w=a.offsetRotation,C=!1;0==w?C=s==E.RotateMode.Chain:(C=!1,w*=0<(I=this.target.bone).a*I.d-I.b*I.c?E.MathUtils.degRad:-E.MathUtils.degRad);m=0;for(var M,I=3;m<c;m++,I+=3){(M=u[m]).worldX+=(b-M.worldX)*n,M.worldY+=(T-M.worldY)*n;var P,k,R,O,_,D,L,B,F,N,G,U,V=(P=x[I])-b,Y=(k=x[I+1])-T;!h||0!=(R=p[m])&&(O=(Math.sqrt(V*V+Y*Y)/R-1)*e+1,M.a*=O,M.c*=O),b=P,T=k,i&&(_=M.a,D=M.b,L=M.c,B=M.d,N=F=U=0,U=o?x[I-1]:0==d[m+1]?x[I+2]:Math.atan2(Y,V),U-=Math.atan2(L,_),C?(F=Math.cos(U),N=Math.sin(U),b+=((G=M.data.length)*(F*_-N*L)-V)*e,T+=(G*(N*_+F*L)-Y)*e):U+=w,U>E.MathUtils.PI?U-=E.MathUtils.PI2:U<-E.MathUtils.PI&&(U+=E.MathUtils.PI2),U*=e,F=Math.cos(U),N=Math.sin(U),M.a=F*_-N*L,M.b=F*D-N*B,M.c=N*_+F*L,M.d=N*D+F*B),M.appliedValid=!1}}}},Ie.prototype.computeWorldPositions=function(t,e,n,i,a){var r=this.target,s=this.position,o=this.spaces,h=E.Utils.setArraySize(this.positions,3*e+2),c=null,l=t.closed,u=t.worldVerticesLength,d=u/6,p=Ie.NONE;if(!t.constantSpeed){var f=t.lengths,g=f[d-=l?1:2];if(i&&(s*=g),a)for(var m=1;m<e;m++)o[m]*=g;c=E.Utils.setArraySize(this.world,8);m=0;for(var v=0,y=0;m<e;m++,v+=3){var S=s+=H=o[m];if(l)(S%=g)<0&&(S+=g),y=0;else{if(S<0){p!=Ie.BEFORE&&(p=Ie.BEFORE,t.computeWorldVertices(r,2,4,c,0,2)),this.addBeforePosition(S,c,0,h,v);continue}if(g<S){p!=Ie.AFTER&&(p=Ie.AFTER,t.computeWorldVertices(r,u-6,4,c,0,2)),this.addAfterPosition(S-g,c,0,h,v);continue}}for(;;y++){var A=f[y];if(!(A<S)){0==y?S/=A:S=(S-(K=f[y-1]))/(A-K);break}}y!=p&&(p=y,l&&y==d?(t.computeWorldVertices(r,u-4,4,c,0,2),t.computeWorldVertices(r,0,4,c,4,2)):t.computeWorldVertices(r,6*y+2,8,c,0,2)),this.addCurvePosition(S,c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],h,v,n||0<m&&0==H)}return h}l?(u+=2,c=E.Utils.setArraySize(this.world,u),t.computeWorldVertices(r,2,u-4,c,0,2),t.computeWorldVertices(r,0,2,c,u-4,2),c[u-2]=c[0],c[u-1]=c[1]):(d--,u-=4,c=E.Utils.setArraySize(this.world,u),t.computeWorldVertices(r,2,u,c,0,2));for(var x=E.Utils.setArraySize(this.curves,d),b=0,T=c[0],w=c[1],C=0,M=0,I=0,P=0,k=0,R=0,O=0,_=0,D=0,L=0,B=0,F=0,N=0,G=0,U=(m=0,2);m<d;m++,U+=6)C=c[U],M=c[U+1],I=c[U+2],P=c[U+3],B=2*(O=.1875*(T-2*C+I))+(D=.09375*(3*(C-I)-T+(k=c[U+4]))),F=2*(_=.1875*(w-2*M+P))+(L=.09375*(3*(M-P)-w+(R=c[U+5]))),N=.75*(C-T)+O+.16666667*D,G=.75*(M-w)+_+.16666667*L,b+=Math.sqrt(N*N+G*G),N+=B,G+=F,B+=D,F+=L,b+=Math.sqrt(N*N+G*G),N+=B,G+=F,b+=Math.sqrt(N*N+G*G),N+=B+D,G+=F+L,b+=Math.sqrt(N*N+G*G),x[m]=b,T=k,w=R;if(s*=i?b:b/t.lengths[d-1],a)for(m=1;m<e;m++)o[m]*=b;for(var V=this.segments,Y=0,z=(m=0,v=0,y=0,0);m<e;m++,v+=3){var H;S=s+=H=o[m];if(l)(S%=b)<0&&(S+=b),y=0;else{if(S<0){this.addBeforePosition(S,c,0,h,v);continue}if(b<S){this.addAfterPosition(S-b,c,u-4,h,v);continue}}for(;;y++){var W=x[y];if(!(W<S)){0==y?S/=W:S=(S-(K=x[y-1]))/(W-K);break}}if(y!=p){var X=6*(p=y);T=c[X],w=c[X+1],C=c[X+2],M=c[X+3],I=c[X+4],P=c[X+5],B=2*(O=.03*(T-2*C+I))+(D=.006*(3*(C-I)-T+(k=c[X+6]))),F=2*(_=.03*(w-2*M+P))+(L=.006*(3*(M-P)-w+(R=c[X+7]))),N=.3*(C-T)+O+.16666667*D,G=.3*(M-w)+_+.16666667*L,Y=Math.sqrt(N*N+G*G);for(V[0]=Y,X=1;X<8;X++)N+=B,G+=F,B+=D,F+=L,Y+=Math.sqrt(N*N+G*G),V[X]=Y;N+=B,G+=F,Y+=Math.sqrt(N*N+G*G),V[8]=Y,N+=B+D,G+=F+L,Y+=Math.sqrt(N*N+G*G),V[9]=Y,z=0}for(S*=Y;;z++){var K,j=V[z];if(!(j<S)){0==z?S/=j:S=z+(S-(K=V[z-1]))/(j-K);break}}this.addCurvePosition(.1*S,T,w,C,M,I,P,k,R,h,v,n||0<m&&0==H)}return h},Ie.prototype.addBeforePosition=function(t,e,n,i,a){var r=e[n],s=e[n+1],o=e[n+2]-r,h=e[n+3]-s,c=Math.atan2(h,o);i[a]=r+t*Math.cos(c),i[a+1]=s+t*Math.sin(c),i[a+2]=c},Ie.prototype.addAfterPosition=function(t,e,n,i,a){var r=e[n+2],s=e[n+3],o=r-e[n],h=s-e[n+1],c=Math.atan2(h,o);i[a]=r+t*Math.cos(c),i[a+1]=s+t*Math.sin(c),i[a+2]=c},Ie.prototype.addCurvePosition=function(t,e,n,i,a,r,s,o,h,c,l,u){if(0==t||isNaN(t))return c[l]=e,c[l+1]=n,void(c[l+2]=Math.atan2(a-n,i-e));var d=t*t,p=d*t,f=1-t,g=f*f,m=g*f,v=f*t,y=3*v,S=f*y,A=y*t,E=e*m+i*S+r*A+o*p,x=n*m+a*S+s*A+h*p;c[l]=E,c[l+1]=x,u&&(c[l+2]=t<.001?Math.atan2(a-n,i-e):Math.atan2(x-(n*g+a*v*2+s*d),E-(e*g+i*v*2+r*d)))},Ie.NONE=-1,Ie.BEFORE=-2,Ie.AFTER=-3,Ie.epsilon=1e-5,x=Ie,E.PathConstraint=x,b=Se=Se||{},T=b.ConstraintData,Ee(Pe,T),I=Pe,b.PathConstraintData=I,(w=b.PositionMode||(b.PositionMode={}))[w.Fixed=0]="Fixed",w[w.Percent=1]="Percent",(C=b.SpacingMode||(b.SpacingMode={}))[C.Length=0]="Length",C[C.Fixed=1]="Fixed",C[C.Percent=2]="Percent",(M=b.RotateMode||(b.RotateMode={}))[M.Tangent=0]="Tangent",M[M.Chain=1]="Chain",M[M.ChainScale=2]="ChainScale",P=Se=Se||{},ke.prototype.loaded=function(){var t=0;for(var e in this.assets)t++;return t},k=ke,Re.prototype.queueAsset=function(t,e,n){var i=this.clientAssets[t];return null==i&&(i=new k(t),this.clientAssets[t]=i),null!==e&&(i.textureLoader=e),i.toLoad.push(n),this.queuedAssets[n]!==n&&(this.queuedAssets[n]=n,!0)},Re.prototype.loadText=function(t,e){var n,i=this;e=this.pathPrefix+e,this.queueAsset(t,null,e)&&((n=new XMLHttpRequest).overrideMimeType("text/html"),n.onreadystatechange=function(){n.readyState==XMLHttpRequest.DONE&&(200<=n.status&&n.status<300?i.rawAssets[e]=n.responseText:i.errors[e]="Couldn't load text "+e+": status "+n.status+", "+n.responseText)},n.open("GET",e,!0),n.send())},Re.prototype.loadJson=function(t,e){var n,i=this;e=this.pathPrefix+e,this.queueAsset(t,null,e)&&((n=new XMLHttpRequest).overrideMimeType("text/html"),n.onreadystatechange=function(){n.readyState==XMLHttpRequest.DONE&&(200<=n.status&&n.status<300?i.rawAssets[e]=JSON.parse(n.responseText):i.errors[e]="Couldn't load text "+e+": status "+n.status+", "+n.responseText)},n.open("GET",e,!0),n.send())},Re.prototype.loadTexture=function(t,e,n){var i,a=this;n=this.pathPrefix+n,this.queueAsset(t,e,n)&&("undefined"!=typeof window&&"undefined"!=typeof navigator&&window.document||"undefined"==typeof importScripts?((i=new Image).crossOrigin="anonymous",i.onload=function(t){a.rawAssets[n]=i},i.onerror=function(t){a.errors[n]="Couldn't load image "+n},i.src=n):fetch(n,{mode:"cors"}).then((function(t){return t.ok||(a.errors[n]="Couldn't load image "+n),t.blob()})).then((function(t){return createImageBitmap(t,{premultiplyAlpha:"none",colorSpaceConversion:"none"})})).then((function(t){a.rawAssets[n]=t})))},Re.prototype.get=function(t,e){e=this.pathPrefix+e;var n=this.clientAssets[t];return null==n||n.assets[e]},Re.prototype.updateClientAssets=function(t){for(var e=!("undefined"!=typeof window&&"undefined"!=typeof navigator&&window.document)&&"undefined"!=typeof importScripts,n=0;n<t.toLoad.length;n++){var i=t.toLoad[n];if(null==t.assets[i]){var a=this.rawAssets[i];if(null==a)continue;e?a instanceof ImageBitmap?t.assets[i]=t.textureLoader(a):t.assets[i]=a:a instanceof HTMLImageElement?t.assets[i]=t.textureLoader(a):t.assets[i]=a}}},Re.prototype.isLoadingComplete=function(t){var e=this.clientAssets[t];return null==e||(this.updateClientAssets(e),e.toLoad.length==e.loaded())},Re.prototype.dispose=function(){},Re.prototype.hasErrors=function(){return 0<Y()(this.errors).length},Re.prototype.getErrors=function(){return this.errors},R=Re,P.SharedAssetManager=R,O=Se=Se||{},Oe.prototype.updateCache=function(){this._updateCache.length=0,this.updateCacheReset.length=0;for(var t=this.bones,e=0,n=t.length;e<n;e++)(a=t[e]).sorted=a.data.skinRequired,a.active=!a.sorted;if(null!=this.skin){var i=this.skin.bones;for(e=0,n=this.skin.bones.length;e<n;e++)for(var a=this.bones[i[e].index];a.sorted=!1,a.active=!0,null!=(a=a.parent););}var r=this.ikConstraints,s=this.transformConstraints,o=this.pathConstraints,h=r.length,c=s.length,l=o.length,u=h+c+l;t:for(e=0;e<u;e++){for(var d=0;d<h;d++)if((p=r[d]).data.order==e){this.sortIkConstraint(p);continue t}for(d=0;d<c;d++)if((p=s[d]).data.order==e){this.sortTransformConstraint(p);continue t}var p;for(d=0;d<l;d++)if((p=o[d]).data.order==e){this.sortPathConstraint(p);continue t}}for(e=0,n=t.length;e<n;e++)this.sortBone(t[e])},Oe.prototype.sortIkConstraint=function(t){var e,n,i,a,r;t.active=t.target.isActive()&&(!t.data.skinRequired||null!=this.skin&&O.Utils.contains(this.skin.constraints,t.data,!0)),t.active&&(n=t.target,this.sortBone(n),a=(i=t.bones)[0],this.sortBone(a),1<i.length&&(r=i[i.length-1],-1<g()(e=this._updateCache).call(e,r)||this.updateCacheReset.push(r)),this._updateCache.push(t),this.sortReset(a.children),i[i.length-1].sorted=!0)},Oe.prototype.sortPathConstraint=function(t){if(t.active=t.target.bone.isActive()&&(!t.data.skinRequired||null!=this.skin&&O.Utils.contains(this.skin.constraints,t.data,!0)),t.active){var e=t.target,n=e.data.index,i=e.bone;null!=this.skin&&this.sortPathConstraintAttachment(this.skin,n,i),null!=this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,n,i);for(var a=0,r=this.data.skins.length;a<r;a++)this.sortPathConstraintAttachment(this.data.skins[a],n,i);var s=e.getAttachment();s instanceof O.PathAttachment&&this.sortPathConstraintAttachmentWith(s,i);var o=t.bones,h=o.length;for(a=0;a<h;a++)this.sortBone(o[a]);for(this._updateCache.push(t),a=0;a<h;a++)this.sortReset(o[a].children);for(a=0;a<h;a++)o[a].sorted=!0}},Oe.prototype.sortTransformConstraint=function(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||null!=this.skin&&O.Utils.contains(this.skin.constraints,t.data,!0)),t.active){this.sortBone(t.target);var e=t.bones,n=e.length;if(t.data.local)for(var i=0;i<n;i++){var a,r=e[i];this.sortBone(r.parent),-1<g()(a=this._updateCache).call(a,r)||this.updateCacheReset.push(r)}else for(i=0;i<n;i++)this.sortBone(e[i]);this._updateCache.push(t);for(var s=0;s<n;s++)this.sortReset(e[s].children);for(s=0;s<n;s++)e[s].sorted=!0}},Oe.prototype.sortPathConstraintAttachment=function(t,e,n){var i=t.attachments[e];if(i)for(var a in i)this.sortPathConstraintAttachmentWith(i[a],n)},Oe.prototype.sortPathConstraintAttachmentWith=function(t,e){if(t instanceof O.PathAttachment){var n=t.bones;if(null==n)this.sortBone(e);else for(var i=this.bones,a=0;a<n.length;)for(var r=n[a++],s=a+r;a<s;a++){var o=n[a];this.sortBone(i[o])}}},Oe.prototype.sortBone=function(t){var e;t.sorted||(null!=(e=t.parent)&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t))},Oe.prototype.sortReset=function(t){for(var e=0,n=t.length;e<n;e++){var i=t[e];i.active&&(i.sorted&&this.sortReset(i.children),i.sorted=!1)}},Oe.prototype.updateWorldTransform=function(){for(var t=this.updateCacheReset,e=0,n=t.length;e<n;e++){var i=t[e];i.ax=i.x,i.ay=i.y,i.arotation=i.rotation,i.ascaleX=i.scaleX,i.ascaleY=i.scaleY,i.ashearX=i.shearX,i.ashearY=i.shearY,i.appliedValid=!0}var a=this._updateCache;for(e=0,n=a.length;e<n;e++)a[e].update()},Oe.prototype.setToSetupPose=function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},Oe.prototype.setBonesToSetupPose=function(){for(var t=this.bones,e=0,n=t.length;e<n;e++)t[e].setToSetupPose();var i=this.ikConstraints;for(e=0,n=i.length;e<n;e++)(o=i[e]).mix=o.data.mix,o.softness=o.data.softness,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch;var a=this.transformConstraints;for(e=0,n=a.length;e<n;e++){var r=(o=a[e]).data;o.rotateMix=r.rotateMix,o.translateMix=r.translateMix,o.scaleMix=r.scaleMix,o.shearMix=r.shearMix}var s=this.pathConstraints;for(e=0,n=s.length;e<n;e++){var o;r=(o=s[e]).data;o.position=r.position,o.spacing=r.spacing,o.rotateMix=r.rotateMix,o.translateMix=r.translateMix}},Oe.prototype.setSlotsToSetupPose=function(){var t=this.slots;O.Utils.arrayCopy(t,0,this.drawOrder,0,t.length);for(var e=0,n=t.length;e<n;e++)t[e].setToSetupPose()},Oe.prototype.getRootBone=function(){return 0==this.bones.length?null:this.bones[0]},Oe.prototype.findBone=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,n=0,i=e.length;n<i;n++){var a=e[n];if(a.data.name==t)return a}return null},Oe.prototype.findBoneIndex=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,n=0,i=e.length;n<i;n++)if(e[n].data.name==t)return n;return-1},Oe.prototype.findSlot=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,n=0,i=e.length;n<i;n++){var a=e[n];if(a.data.name==t)return a}return null},Oe.prototype.findSlotIndex=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,n=0,i=e.length;n<i;n++)if(e[n].data.name==t)return n;return-1},Oe.prototype.setSkinByName=function(t){var e=this.data.findSkin(t);if(null==e)throw new Error("Skin not found: "+t);this.setSkin(e)},Oe.prototype.setSkin=function(t){if(t!=this.skin){if(null!=t)if(null!=this.skin)t.attachAll(this,this.skin);else for(var e=this.slots,n=0,i=e.length;n<i;n++){var a,r=e[n],s=r.data.attachmentName;null==s||null!=(a=t.getAttachment(n,s))&&r.setAttachment(a)}this.skin=t,this.updateCache()}},Oe.prototype.getAttachmentByName=function(t,e){return this.getAttachment(this.data.findSlotIndex(t),e)},Oe.prototype.getAttachment=function(t,e){if(null==e)throw new Error("attachmentName cannot be null.");if(null!=this.skin){var n=this.skin.getAttachment(t,e);if(null!=n)return n}return null!=this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null},Oe.prototype.setAttachment=function(t,e){if(null==t)throw new Error("slotName cannot be null.");for(var n=this.slots,i=0,a=n.length;i<a;i++){var r=n[i];if(r.data.name==t){var s=null;if(null!=e&&null==(s=this.getAttachment(i,e)))throw new Error("Attachment not found: "+e+", for slot: "+t);return void r.setAttachment(s)}}throw new Error("Slot not found: "+t)},Oe.prototype.findIkConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,n=0,i=e.length;n<i;n++){var a=e[n];if(a.data.name==t)return a}return null},Oe.prototype.findTransformConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,n=0,i=e.length;n<i;n++){var a=e[n];if(a.data.name==t)return a}return null},Oe.prototype.findPathConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,n=0,i=e.length;n<i;n++){var a=e[n];if(a.data.name==t)return a}return null},Oe.prototype.getBounds=function(t,e,n){if(void 0===n&&(n=new Array(2)),null==t)throw new Error("offset cannot be null.");if(null==e)throw new Error("size cannot be null.");for(var i=this.drawOrder,a=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY,h=0,c=i.length;h<c;h++){var l=i[h];if(l.bone.active){var u,d=0,p=null,f=l.getAttachment();if(f instanceof O.RegionAttachment?(d=8,p=O.Utils.setArraySize(n,d,0),f.computeWorldVertices(l.bone,p,0,2)):f instanceof O.MeshAttachment&&(d=(u=f).worldVerticesLength,p=O.Utils.setArraySize(n,d,0),u.computeWorldVertices(l,0,d,p,0,2)),null!=p)for(var g=0,m=p.length;g<m;g+=2){var v=p[g],y=p[g+1];a=Math.min(a,v),r=Math.min(r,y),s=Math.max(s,v),o=Math.max(o,y)}}}t.set(a,r),e.set(s-a,o-r)},Oe.prototype.update=function(t){this.time+=t},_=Oe,O.Skeleton=_,function(t){var e=(n.prototype.readSkeletonData=function(e){var a=this.scale,r=new t.SkeletonData;r.name="";var s=new i(e);if(r.hash=s.readString(),r.version=s.readString(),"3.8.75"==r.version)throw new Error("Unsupported skeleton data, please export with a newer version of Spine.");r.x=s.readFloat(),r.y=s.readFloat(),r.width=s.readFloat(),r.height=s.readFloat();var o=s.readBoolean();o&&(r.fps=s.readFloat(),r.imagesPath=s.readString(),r.audioPath=s.readString());for(var h=0,c=(h=s.readInt(!0),0);c<h;c++)s.strings.push(s.readString());for(h=s.readInt(!0),c=0;c<h;c++){var l=s.readString(),u=0==c?null:r.bones[s.readInt(!0)];(f=new t.BoneData(c,l,u)).rotation=s.readFloat(),f.x=s.readFloat()*a,f.y=s.readFloat()*a,f.scaleX=s.readFloat(),f.scaleY=s.readFloat(),f.shearX=s.readFloat(),f.shearY=s.readFloat(),f.length=s.readFloat()*a,f.transformMode=n.TransformModeValues[s.readInt(!0)],f.skinRequired=s.readBoolean(),o&&t.Color.rgba8888ToColor(f.color,s.readInt32()),r.bones.push(f)}for(h=s.readInt(!0),c=0;c<h;c++){var d=s.readString(),p=r.bones[s.readInt(!0)],f=new t.SlotData(c,d,p);t.Color.rgba8888ToColor(f.color,s.readInt32());var g=s.readInt32();-1!=g&&t.Color.rgb888ToColor(f.darkColor=new t.Color,g),f.attachmentName=s.readStringRef(),f.blendMode=n.BlendModeValues[s.readInt(!0)],r.slots.push(f)}h=s.readInt(!0);c=0;for(var m=void 0;c<h;c++){(f=new t.IkConstraintData(s.readString())).order=s.readInt(!0),f.skinRequired=s.readBoolean(),m=s.readInt(!0);for(var v=0;v<m;v++)f.bones.push(r.bones[s.readInt(!0)]);f.target=r.bones[s.readInt(!0)],f.mix=s.readFloat(),f.softness=s.readFloat()*a,f.bendDirection=s.readByte(),f.compress=s.readBoolean(),f.stretch=s.readBoolean(),f.uniform=s.readBoolean(),r.ikConstraints.push(f)}for(h=s.readInt(!0),m=void(c=0);c<h;c++){for((f=new t.TransformConstraintData(s.readString())).order=s.readInt(!0),f.skinRequired=s.readBoolean(),m=s.readInt(!0),v=0;v<m;v++)f.bones.push(r.bones[s.readInt(!0)]);f.target=r.bones[s.readInt(!0)],f.local=s.readBoolean(),f.relative=s.readBoolean(),f.offsetRotation=s.readFloat(),f.offsetX=s.readFloat()*a,f.offsetY=s.readFloat()*a,f.offsetScaleX=s.readFloat(),f.offsetScaleY=s.readFloat(),f.offsetShearY=s.readFloat(),f.rotateMix=s.readFloat(),f.translateMix=s.readFloat(),f.scaleMix=s.readFloat(),f.shearMix=s.readFloat(),r.transformConstraints.push(f)}for(h=s.readInt(!0),m=void(c=0);c<h;c++){for((f=new t.PathConstraintData(s.readString())).order=s.readInt(!0),f.skinRequired=s.readBoolean(),m=s.readInt(!0),v=0;v<m;v++)f.bones.push(r.bones[s.readInt(!0)]);f.target=r.slots[s.readInt(!0)],f.positionMode=n.PositionModeValues[s.readInt(!0)],f.spacingMode=n.SpacingModeValues[s.readInt(!0)],f.rotateMode=n.RotateModeValues[s.readInt(!0)],f.offsetRotation=s.readFloat(),f.position=s.readFloat(),f.positionMode==t.PositionMode.Fixed&&(f.position*=a),f.spacing=s.readFloat(),f.spacingMode!=t.SpacingMode.Length&&f.spacingMode!=t.SpacingMode.Fixed||(f.spacing*=a),f.rotateMix=s.readFloat(),f.translateMix=s.readFloat(),r.pathConstraints.push(f)}var y=this.readSkin(s,r,!0,o);for(null!=y&&(r.defaultSkin=y,r.skins.push(y)),c=r.skins.length,t.Utils.setArraySize(r.skins,h=c+s.readInt(!0));c<h;c++)r.skins[c]=this.readSkin(s,r,!1,o);for(h=this.linkedMeshes.length,c=0;c<h;c++){var S=this.linkedMeshes[c],A=null==S.skin?r.defaultSkin:r.findSkin(S.skin);if(null==A)throw new Error("Skin not found: "+S.skin);var E=A.getAttachment(S.slotIndex,S.parent);if(null==E)throw new Error("Parent mesh not found: "+S.parent);S.mesh.deformAttachment=S.inheritDeform?E:S.mesh,S.mesh.setParentMesh(E),S.mesh.updateUVs()}for(this.linkedMeshes.length=0,h=s.readInt(!0),c=0;c<h;c++)(f=new t.EventData(s.readStringRef())).intValue=s.readInt(!1),f.floatValue=s.readFloat(),f.stringValue=s.readString(),f.audioPath=s.readString(),null!=f.audioPath&&(f.volume=s.readFloat(),f.balance=s.readFloat()),r.events.push(f);for(h=s.readInt(!0),c=0;c<h;c++)r.animations.push(this.readAnimation(s,s.readString(),r));return r},n.prototype.readSkin=function(e,n,i,a){var r=null,s=0;if(i){if(0==(s=e.readInt(!0)))return null;r=new t.Skin("default")}else{(r=new t.Skin(e.readStringRef())).bones.length=e.readInt(!0);for(var o=0,h=r.bones.length;o<h;o++)r.bones[o]=n.bones[e.readInt(!0)];for(o=0,h=e.readInt(!0);o<h;o++)r.constraints.push(n.ikConstraints[e.readInt(!0)]);for(o=0,h=e.readInt(!0);o<h;o++)r.constraints.push(n.transformConstraints[e.readInt(!0)]);for(o=0,h=e.readInt(!0);o<h;o++)r.constraints.push(n.pathConstraints[e.readInt(!0)]);s=e.readInt(!0)}for(o=0;o<s;o++)for(var c=e.readInt(!0),l=0,u=e.readInt(!0);l<u;l++){var d=e.readStringRef(),p=this.readAttachment(e,n,r,c,d,a);null!=p&&r.setAttachment(c,d,p)}return r},n.prototype.readAttachment=function(e,i,a,s,o,h){var c=this.scale,l=e.readStringRef();null==l&&(l=o);var u=e.readByte();switch(n.AttachmentTypeValues[u]){case t.AttachmentType.Region:var d=e.readStringRef(),p=e.readFloat(),f=e.readFloat(),g=e.readFloat(),m=e.readFloat(),v=e.readFloat(),y=e.readFloat(),S=e.readFloat(),A=e.readInt32();null==d&&(d=l);var E=this.attachmentLoader.newRegionAttachment(a,l,d);return null==E?null:(E.path=d,E.x=f*c,E.y=g*c,E.scaleX=m,E.scaleY=v,E.rotation=p,E.width=y*c,E.height=S*c,t.Color.rgba8888ToColor(E.color,A),E.updateOffset(),E);case t.AttachmentType.BoundingBox:var x=e.readInt(!0),b=this.readVertices(e,x),T=(A=h?e.readInt32():0,this.attachmentLoader.newBoundingBoxAttachment(a,l));return null==T?null:(T.worldVerticesLength=x<<1,T.vertices=b.vertices,T.bones=b.bones,h&&t.Color.rgba8888ToColor(T.color,A),T);case t.AttachmentType.Mesh:d=e.readStringRef(),A=e.readInt32(),x=e.readInt(!0);var w=this.readFloatArray(e,x<<1,1),C=this.readShortArray(e),M=(b=this.readVertices(e,x),e.readInt(!0)),I=null;y=0,S=0;return h&&(I=this.readShortArray(e),y=e.readFloat(),S=e.readFloat()),null==d&&(d=l),null==(P=this.attachmentLoader.newMeshAttachment(a,l,d))?null:(P.path=d,t.Color.rgba8888ToColor(P.color,A),P.bones=b.bones,P.vertices=b.vertices,P.worldVerticesLength=x<<1,P.triangles=C,P.regionUVs=w,P.updateUVs(),P.hullLength=M<<1,h&&(P.edges=I,P.width=y*c,P.height=S*c),P);case t.AttachmentType.LinkedMesh:d=e.readStringRef(),A=e.readInt32();var P,k=e.readStringRef(),R=e.readStringRef(),O=e.readBoolean();y=0,S=0;return h&&(y=e.readFloat(),S=e.readFloat()),null==d&&(d=l),null==(P=this.attachmentLoader.newMeshAttachment(a,l,d))?null:(P.path=d,t.Color.rgba8888ToColor(P.color,A),h&&(P.width=y*c,P.height=S*c),this.linkedMeshes.push(new r(P,k,s,R,O)),P);case t.AttachmentType.Path:for(var _=e.readBoolean(),D=e.readBoolean(),L=(x=e.readInt(!0),b=this.readVertices(e,x),t.Utils.newArray(x/3,0)),B=0,F=L.length;B<F;B++)L[B]=e.readFloat()*c;return A=h?e.readInt32():0,null==(d=this.attachmentLoader.newPathAttachment(a,l))?null:(d.closed=_,d.constantSpeed=D,d.worldVerticesLength=x<<1,d.vertices=b.vertices,d.bones=b.bones,d.lengths=L,h&&t.Color.rgba8888ToColor(d.color,A),d);case t.AttachmentType.Point:p=e.readFloat(),f=e.readFloat(),g=e.readFloat(),A=h?e.readInt32():0;var N=this.attachmentLoader.newPointAttachment(a,l);return null==N?null:(N.x=f*c,N.y=g*c,N.rotation=p,h&&t.Color.rgba8888ToColor(N.color,A),N);case t.AttachmentType.Clipping:var G=e.readInt(!0),U=(x=e.readInt(!0),b=this.readVertices(e,x),A=h?e.readInt32():0,this.attachmentLoader.newClippingAttachment(a,l));return null==U?null:(U.endSlot=i.slots[G],U.worldVerticesLength=x<<1,U.vertices=b.vertices,U.bones=b.bones,h&&t.Color.rgba8888ToColor(U.color,A),U)}return null},n.prototype.readVertices=function(e,n){var i=n<<1,a=new s,r=this.scale;if(!e.readBoolean())return a.vertices=this.readFloatArray(e,i,r),a;for(var o=new Array,h=new Array,c=0;c<n;c++){var l=e.readInt(!0);h.push(l);for(var u=0;u<l;u++)h.push(e.readInt(!0)),o.push(e.readFloat()*r),o.push(e.readFloat()*r),o.push(e.readFloat())}return a.vertices=t.Utils.toFloatArray(o),a.bones=h,a},n.prototype.readFloatArray=function(t,e,n){var i=new Array(e);if(1==n)for(var a=0;a<e;a++)i[a]=t.readFloat();else for(a=0;a<e;a++)i[a]=t.readFloat()*n;return i},n.prototype.readShortArray=function(t){for(var e=t.readInt(!0),n=new Array(e),i=0;i<e;i++)n[i]=t.readShort();return n},n.prototype.readAnimation=function(e,i,a){for(var r=new Array,s=this.scale,o=0,h=new t.Color,c=new t.Color,l=0,u=e.readInt(!0);l<u;l++)for(var d=e.readInt(!0),p=0,f=e.readInt(!0);p<f;p++){var g=e.readByte(),m=e.readInt(!0);switch(g){case n.SLOT_ATTACHMENT:(A=new t.AttachmentTimeline(m)).slotIndex=d;for(var v=0;v<m;v++)A.setFrame(v,e.readFloat(),e.readStringRef());r.push(A),o=Math.max(o,A.frames[m-1]);break;case n.SLOT_COLOR:for((A=new t.ColorTimeline(m)).slotIndex=d,v=0;v<m;v++){var y=e.readFloat();t.Color.rgba8888ToColor(h,e.readInt32()),A.setFrame(v,y,h.r,h.g,h.b,h.a),v<m-1&&this.readCurve(e,v,A)}r.push(A),o=Math.max(o,A.frames[(m-1)*t.ColorTimeline.ENTRIES]);break;case n.SLOT_TWO_COLOR:for((A=new t.TwoColorTimeline(m)).slotIndex=d,v=0;v<m;v++)y=e.readFloat(),t.Color.rgba8888ToColor(h,e.readInt32()),t.Color.rgb888ToColor(c,e.readInt32()),A.setFrame(v,y,h.r,h.g,h.b,h.a,c.r,c.g,c.b),v<m-1&&this.readCurve(e,v,A);r.push(A),o=Math.max(o,A.frames[(m-1)*t.TwoColorTimeline.ENTRIES])}}for(l=0,u=e.readInt(!0);l<u;l++){var S=e.readInt(!0);for(p=0,f=e.readInt(!0);p<f;p++)switch(g=e.readByte(),m=e.readInt(!0),g){case n.BONE_ROTATE:for((A=new t.RotateTimeline(m)).boneIndex=S,v=0;v<m;v++)A.setFrame(v,e.readFloat(),e.readFloat()),v<m-1&&this.readCurve(e,v,A);r.push(A),o=Math.max(o,A.frames[(m-1)*t.RotateTimeline.ENTRIES]);break;case n.BONE_TRANSLATE:case n.BONE_SCALE:case n.BONE_SHEAR:var A=void 0,E=1;for(g==n.BONE_SCALE?A=new t.ScaleTimeline(m):g==n.BONE_SHEAR?A=new t.ShearTimeline(m):(A=new t.TranslateTimeline(m),E=s),A.boneIndex=S,v=0;v<m;v++)A.setFrame(v,e.readFloat(),e.readFloat()*E,e.readFloat()*E),v<m-1&&this.readCurve(e,v,A);r.push(A),o=Math.max(o,A.frames[(m-1)*t.TranslateTimeline.ENTRIES])}}for(l=0,u=e.readInt(!0);l<u;l++){var x=e.readInt(!0);m=e.readInt(!0);for((A=new t.IkConstraintTimeline(m)).ikConstraintIndex=x,v=0;v<m;v++)A.setFrame(v,e.readFloat(),e.readFloat(),e.readFloat()*s,e.readByte(),e.readBoolean(),e.readBoolean()),v<m-1&&this.readCurve(e,v,A);r.push(A),o=Math.max(o,A.frames[(m-1)*t.IkConstraintTimeline.ENTRIES])}for(l=0,u=e.readInt(!0);l<u;l++){for(x=e.readInt(!0),m=e.readInt(!0),(A=new t.TransformConstraintTimeline(m)).transformConstraintIndex=x,v=0;v<m;v++)A.setFrame(v,e.readFloat(),e.readFloat(),e.readFloat(),e.readFloat(),e.readFloat()),v<m-1&&this.readCurve(e,v,A);r.push(A),o=Math.max(o,A.frames[(m-1)*t.TransformConstraintTimeline.ENTRIES])}for(l=0,u=e.readInt(!0);l<u;l++){x=e.readInt(!0);var b=a.pathConstraints[x];for(p=0,f=e.readInt(!0);p<f;p++)switch(g=e.readByte(),m=e.readInt(!0),g){case n.PATH_POSITION:case n.PATH_SPACING:A=void 0,E=1;for(g==n.PATH_SPACING?(A=new t.PathConstraintSpacingTimeline(m),b.spacingMode!=t.SpacingMode.Length&&b.spacingMode!=t.SpacingMode.Fixed||(E=s)):(A=new t.PathConstraintPositionTimeline(m),b.positionMode==t.PositionMode.Fixed&&(E=s)),A.pathConstraintIndex=x,v=0;v<m;v++)A.setFrame(v,e.readFloat(),e.readFloat()*E),v<m-1&&this.readCurve(e,v,A);r.push(A),o=Math.max(o,A.frames[(m-1)*t.PathConstraintPositionTimeline.ENTRIES]);break;case n.PATH_MIX:for((A=new t.PathConstraintMixTimeline(m)).pathConstraintIndex=x,v=0;v<m;v++)A.setFrame(v,e.readFloat(),e.readFloat(),e.readFloat()),v<m-1&&this.readCurve(e,v,A);r.push(A),o=Math.max(o,A.frames[(m-1)*t.PathConstraintMixTimeline.ENTRIES])}}for(l=0,u=e.readInt(!0);l<u;l++){var T=a.skins[e.readInt(!0)];for(p=0,f=e.readInt(!0);p<f;p++){d=e.readInt(!0);for(var w=0,C=e.readInt(!0);w<C;w++){var M=T.getAttachment(d,e.readStringRef()),I=null!=M.bones,P=M.vertices,k=I?P.length/3*2:P.length;m=e.readInt(!0);for((A=new t.DeformTimeline(m)).slotIndex=d,A.attachment=M,v=0;v<m;v++){y=e.readFloat();var R=void 0,O=e.readInt(!0);if(0==O)R=I?t.Utils.newFloatArray(k):P;else{R=t.Utils.newFloatArray(k);var _=e.readInt(!0);if(O+=_,1==s)for(var D=_;D<O;D++)R[D]=e.readFloat();else for(D=_;D<O;D++)R[D]=e.readFloat()*s;if(!I){D=0;for(var L=R.length;D<L;D++)R[D]+=P[D]}}A.setFrame(v,y,R),v<m-1&&this.readCurve(e,v,A)}r.push(A),o=Math.max(o,A.frames[m-1])}}}var B=e.readInt(!0);if(0<B){A=new t.DrawOrderTimeline(B);var F=a.slots.length;for(l=0;l<B;l++){y=e.readFloat();var N=e.readInt(!0),G=t.Utils.newArray(F,0);for(p=F-1;0<=p;p--)G[p]=-1;var U=t.Utils.newArray(F-N,0),V=0,Y=0;for(p=0;p<N;p++){for(d=e.readInt(!0);V!=d;)U[Y++]=V++;G[V+e.readInt(!0)]=V++}for(;V<F;)U[Y++]=V++;for(p=F-1;0<=p;p--)-1==G[p]&&(G[p]=U[--Y]);A.setFrame(l,y,G)}r.push(A),o=Math.max(o,A.frames[B-1])}var z=e.readInt(!0);if(0<z){for(A=new t.EventTimeline(z),l=0;l<z;l++){y=e.readFloat();var H=a.events[e.readInt(!0)],W=new t.Event(y,H);W.intValue=e.readInt(!1),W.floatValue=e.readFloat(),W.stringValue=e.readBoolean()?e.readString():H.stringValue,null!=W.data.audioPath&&(W.volume=e.readFloat(),W.balance=e.readFloat()),A.setFrame(l,W)}r.push(A),o=Math.max(o,A.frames[z-1])}return new t.Animation(i,r,o)},n.prototype.readCurve=function(t,e,i){switch(t.readByte()){case n.CURVE_STEPPED:i.setStepped(e);break;case n.CURVE_BEZIER:this.setCurve(i,e,t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat())}},n.prototype.setCurve=function(t,e,n,i,a,r){t.setCurve(e,n,i,a,r)},n.AttachmentTypeValues=[0,1,2,3,4,5,6],n.TransformModeValues=[t.TransformMode.Normal,t.TransformMode.OnlyTranslation,t.TransformMode.NoRotationOrReflection,t.TransformMode.NoScale,t.TransformMode.NoScaleOrReflection],n.PositionModeValues=[t.PositionMode.Fixed,t.PositionMode.Percent],n.SpacingModeValues=[t.SpacingMode.Length,t.SpacingMode.Fixed,t.SpacingMode.Percent],n.RotateModeValues=[t.RotateMode.Tangent,t.RotateMode.Chain,t.RotateMode.ChainScale],n.BlendModeValues=[t.BlendMode.Normal,t.BlendMode.Additive,t.BlendMode.Multiply,t.BlendMode.Screen],n.BONE_ROTATE=0,n.BONE_TRANSLATE=1,n.BONE_SCALE=2,n.BONE_SHEAR=3,n.SLOT_ATTACHMENT=0,n.SLOT_COLOR=1,n.SLOT_TWO_COLOR=2,n.PATH_POSITION=0,n.PATH_SPACING=1,n.PATH_MIX=2,n.CURVE_LINEAR=0,n.CURVE_STEPPED=1,n.CURVE_BEZIER=2,n);function n(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}t.SkeletonBinary=e;var i=(a.prototype.readByte=function(){return this.buffer.getInt8(this.index++)},a.prototype.readShort=function(){var t=this.buffer.getInt16(this.index);return this.index+=2,t},a.prototype.readInt32=function(){var t=this.buffer.getInt32(this.index);return this.index+=4,t},a.prototype.readInt=function(t){var e=this.readByte(),n=127&e;return 0!=(128&e)&&(n|=(127&(e=this.readByte()))<<7,0!=(128&e)&&(n|=(127&(e=this.readByte()))<<14,0!=(128&e)&&(n|=(127&(e=this.readByte()))<<21,0!=(128&e)&&(n|=(127&this.readByte())<<28)))),t?n:n>>>1^-(1&n)},a.prototype.readStringRef=function(){var t=this.readInt(!0);return 0==t?null:this.strings[t-1]},a.prototype.readString=function(){var t=this.readInt(!0);switch(t){case 0:return null;case 1:return""}t--;for(var e="",n=0;n<t;){var i=this.readByte();switch(i>>4){case 12:case 13:e+=String.fromCharCode((31&i)<<6|63&this.readByte()),n+=2;break;case 14:e+=String.fromCharCode((15&i)<<12|(63&this.readByte())<<6|63&this.readByte()),n+=3;break;default:e+=String.fromCharCode(i),n++}}return e},a.prototype.readFloat=function(){var t=this.buffer.getFloat32(this.index);return this.index+=4,t},a.prototype.readBoolean=function(){return 0!=this.readByte()},a);function a(t,e,n,i){void 0===e&&(e=new Array),void 0===n&&(n=0),void 0===i&&(i=new DataView(t.buffer)),this.strings=e,this.index=n,this.buffer=i}var r=function(t,e,n,i,a){this.mesh=t,this.skin=e,this.slotIndex=n,this.parent=i,this.inheritDeform=a},s=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.bones=t,this.vertices=e}}(Se=Se||{}),D=Se=Se||{},_e.prototype.update=function(t,e){if(null==t)throw new Error("skeleton cannot be null.");var n=this.boundingBoxes,i=this.polygons,a=this.polygonPool,r=t.slots,s=r.length;n.length=0,a.freeAll(i);for(var o=i.length=0;o<s;o++){var h,c,l,u=r[o];u.bone.active&&(h=u.getAttachment())instanceof D.BoundingBoxAttachment&&(c=h,n.push(c),(l=a.obtain()).length!=c.worldVerticesLength&&(l=D.Utils.newFloatArray(c.worldVerticesLength)),i.push(l),c.computeWorldVertices(u,0,c.worldVerticesLength,l,0,2))}e?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)},_e.prototype.aabbCompute=function(){for(var t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY,a=this.polygons,r=0,s=a.length;r<s;r++)for(var o=a[r],h=o,c=0,l=o.length;c<l;c+=2){var u=h[c],d=h[c+1];t=Math.min(t,u),e=Math.min(e,d),n=Math.max(n,u),i=Math.max(i,d)}this.minX=t,this.minY=e,this.maxX=n,this.maxY=i},_e.prototype.aabbContainsPoint=function(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY},_e.prototype.aabbIntersectsSegment=function(t,e,n,i){var a=this.minX,r=this.minY,s=this.maxX,o=this.maxY;if(t<=a&&n<=a||e<=r&&i<=r||s<=t&&s<=n||o<=e&&o<=i)return!1;var h=(i-e)/(n-t),c=h*(a-t)+e;if(r<c&&c<o)return!0;if(r<(c=h*(s-t)+e)&&c<o)return!0;var l=(r-e)/h+t;return a<l&&l<s||a<(l=(o-e)/h+t)&&l<s},_e.prototype.aabbIntersectsSkeleton=function(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY},_e.prototype.containsPoint=function(t,e){for(var n=this.polygons,i=0,a=n.length;i<a;i++)if(this.containsPointPolygon(n[i],t,e))return this.boundingBoxes[i];return null},_e.prototype.containsPointPolygon=function(t,e,n){for(var i=t,a=t.length,r=a-2,s=!1,o=0;o<a;o+=2){var h,c=i[o+1],l=i[r+1];!(c<n&&n<=l||l<n&&n<=c)||(h=i[o])+(n-c)/(l-c)*(i[r]-h)<e&&(s=!s),r=o}return s},_e.prototype.intersectsSegment=function(t,e,n,i){for(var a=this.polygons,r=0,s=a.length;r<s;r++)if(this.intersectsSegmentPolygon(a[r],t,e,n,i))return this.boundingBoxes[r];return null},_e.prototype.intersectsSegmentPolygon=function(t,e,n,i,a){for(var r=t,s=t.length,o=e-i,h=n-a,c=e*a-n*i,l=r[s-2],u=r[s-1],d=0;d<s;d+=2){var p=r[d],f=r[d+1],g=l*f-u*p,m=l-p,v=u-f,y=o*v-h*m,S=(c*m-o*g)/y;if((l<=S&&S<=p||p<=S&&S<=l)&&(e<=S&&S<=i||i<=S&&S<=e)){var A=(c*v-h*g)/y;if((u<=A&&A<=f||f<=A&&A<=u)&&(n<=A&&A<=a||a<=A&&A<=n))return!0}l=p,u=f}return!1},_e.prototype.getPolygon=function(t){var e;if(null==t)throw new Error("boundingBox cannot be null.");var n=g()(e=this.boundingBoxes).call(e,t);return-1==n?null:this.polygons[n]},_e.prototype.getWidth=function(){return this.maxX-this.minX},_e.prototype.getHeight=function(){return this.maxY-this.minY},L=_e,D.SkeletonBounds=L,B=Se=Se||{},De.prototype.clipStart=function(t,e){if(null!=this.clipAttachment)return 0;var n=(this.clipAttachment=e).worldVerticesLength,i=B.Utils.setArraySize(this.clippingPolygon,n);e.computeWorldVertices(t,0,n,i,0,2);var a=this.clippingPolygon;De.makeClockwise(a);for(var r=this.clippingPolygons=this.triangulator.decompose(a,this.triangulator.triangulate(a)),s=0,o=r.length;s<o;s++){var h=r[s];De.makeClockwise(h),h.push(h[0]),h.push(h[1])}return r.length},De.prototype.clipEndWithSlot=function(t){null!=this.clipAttachment&&this.clipAttachment.endSlot==t.data&&this.clipEnd()},De.prototype.clipEnd=function(){null!=this.clipAttachment&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)},De.prototype.isClipping=function(){return null!=this.clipAttachment},De.prototype.clipTriangles=function(t,e,n,i,a,r,s,o){var h=this.clipOutput,c=this.clippedVertices,l=this.clippedTriangles,u=this.clippingPolygons,d=this.clippingPolygons.length,p=o?12:8,f=0;c.length=0;t:for(var g=l.length=0;g<i;g+=3)for(var m=n[g]<<1,v=t[m],y=t[1+m],S=a[m],A=a[1+m],E=t[m=n[g+1]<<1],x=t[1+m],b=a[m],T=a[1+m],w=t[m=n[g+2]<<1],C=t[1+m],M=a[m],I=a[1+m],P=0;P<d;P++){var k=c.length;if(!this.clip(v,y,E,x,w,C,u[P],h)){(U=B.Utils.setArraySize(c,k+3*p))[k]=v,U[k+1]=y,U[k+2]=r.r,U[k+3]=r.g,U[k+4]=r.b,U[k+5]=r.a,o?(U[k+6]=S,U[k+7]=A,U[k+8]=s.r,U[k+9]=s.g,U[k+10]=s.b,U[k+11]=s.a,U[k+12]=E,U[k+13]=x,U[k+14]=r.r,U[k+15]=r.g,U[k+16]=r.b,U[k+17]=r.a,U[k+18]=b,U[k+19]=T,U[k+20]=s.r,U[k+21]=s.g,U[k+22]=s.b,U[k+23]=s.a,U[k+24]=w,U[k+25]=C,U[k+26]=r.r,U[k+27]=r.g,U[k+28]=r.b,U[k+29]=r.a,U[k+30]=M,U[k+31]=I,U[k+32]=s.r,U[k+33]=s.g,U[k+34]=s.b,U[k+35]=s.a):(U[k+6]=S,U[k+7]=A,U[k+8]=E,U[k+9]=x,U[k+10]=r.r,U[k+11]=r.g,U[k+12]=r.b,U[k+13]=r.a,U[k+14]=b,U[k+15]=T,U[k+16]=w,U[k+17]=C,U[k+18]=r.r,U[k+19]=r.g,U[k+20]=r.b,U[k+21]=r.a,U[k+22]=M,U[k+23]=I),k=l.length,(q=B.Utils.setArraySize(l,k+3))[k]=f,q[k+1]=f+1,q[k+2]=f+2,f+=3;continue t}var R=h.length;if(0!=R){for(var O=x-C,_=w-E,D=v-w,L=C-y,F=1/(O*D+_*(y-C)),N=R>>1,G=this.clipOutput,U=B.Utils.setArraySize(c,k+N*p),V=0;V<R;V+=2){var Y=G[V],z=G[V+1];U[k]=Y,U[k+1]=z,U[k+2]=r.r,U[k+3]=r.g,U[k+4]=r.b,U[k+5]=r.a;var H=Y-w,W=z-C,X=(O*H+_*W)*F,K=(L*H+D*W)*F,j=1-X-K;U[k+6]=S*X+b*K+M*j,U[k+7]=A*X+T*K+I*j,o&&(U[k+8]=s.r,U[k+9]=s.g,U[k+10]=s.b,U[k+11]=s.a),k+=p}k=l.length;var q=B.Utils.setArraySize(l,k+3*(N-2));for(N--,V=1;V<N;V++)q[k]=f,q[k+1]=f+V,q[k+2]=f+V+1,k+=3;f+=1+N}}},De.prototype.clip=function(t,e,n,i,a,r,s,o){var h=o,c=!1,l=null;2<=s.length%4?(l=o,o=this.scratch):l=this.scratch,l.length=0,l.push(t),l.push(e),l.push(n),l.push(i),l.push(a),l.push(r),l.push(t),l.push(e),o.length=0;for(var u=s,d=s.length-4,p=0;;p+=2){for(var f=u[p],g=u[p+1],m=u[p+2],v=u[p+3],y=f-m,S=g-v,A=l,E=l.length-2,x=o.length,b=0;b<E;b+=2){var T=A[b],w=A[b+1],C=A[b+2],M=A[b+3],I=0<y*(M-v)-S*(C-m);if(0<y*(w-v)-S*(T-m)){if(I){o.push(C),o.push(M);continue}var P,k,R,O=(P=M-w)*(m-f)-(k=C-T)*(v-g);1e-6<Math.abs(O)?(R=(k*(g-w)-P*(f-T))/O,o.push(f+(m-f)*R),o.push(g+(v-g)*R)):(o.push(f),o.push(g))}else I&&(O=(P=M-w)*(m-f)-(k=C-T)*(v-g),1e-6<Math.abs(O)?(R=(k*(g-w)-P*(f-T))/O,o.push(f+(m-f)*R),o.push(g+(v-g)*R)):(o.push(f),o.push(g)),o.push(C),o.push(M));c=!0}if(x==o.length)return!(h.length=0);if(o.push(o[0]),o.push(o[1]),p==d)break;var _=o;(o=l).length=0,l=_}if(h!=o){p=h.length=0;for(var D=o.length-2;p<D;p++)h[p]=o[p]}else h.length=h.length-2;return c},De.makeClockwise=function(t){for(var e,n,i,a=t,r=t.length,s=a[r-2]*a[1]-a[0]*a[r-1],o=0,h=r-3;o<h;o+=2)e=a[o],n=a[o+1],i=a[o+2],s+=e*a[o+3]-i*n;if(!(s<0)){o=0;var c=r-2;for(h=r>>1;o<h;o+=2){var l=a[o],u=a[o+1],d=c-o;a[o]=a[d],a[o+1]=a[1+d],a[d]=l,a[1+d]=u}}},F=De,B.SkeletonClipping=F,N=Se=Se||{},Le.prototype.findBone=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,n=0,i=e.length;n<i;n++){var a=e[n];if(a.name==t)return a}return null},Le.prototype.findBoneIndex=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,n=0,i=e.length;n<i;n++)if(e[n].name==t)return n;return-1},Le.prototype.findSlot=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,n=0,i=e.length;n<i;n++){var a=e[n];if(a.name==t)return a}return null},Le.prototype.findSlotIndex=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,n=0,i=e.length;n<i;n++)if(e[n].name==t)return n;return-1},Le.prototype.findSkin=function(t){if(null==t)throw new Error("skinName cannot be null.");for(var e=this.skins,n=0,i=e.length;n<i;n++){var a=e[n];if(a.name==t)return a}return null},Le.prototype.findEvent=function(t){if(null==t)throw new Error("eventDataName cannot be null.");for(var e=this.events,n=0,i=e.length;n<i;n++){var a=e[n];if(a.name==t)return a}return null},Le.prototype.findAnimation=function(t){if(null==t)throw new Error("animationName cannot be null.");for(var e=this.animations,n=0,i=e.length;n<i;n++){var a=e[n];if(a.name==t)return a}return null},Le.prototype.findIkConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,n=0,i=e.length;n<i;n++){var a=e[n];if(a.name==t)return a}return null},Le.prototype.findTransformConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,n=0,i=e.length;n<i;n++){var a=e[n];if(a.name==t)return a}return null},Le.prototype.findPathConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,n=0,i=e.length;n<i;n++){var a=e[n];if(a.name==t)return a}return null},Le.prototype.findPathConstraintIndex=function(t){if(null==t)throw new Error("pathConstraintName cannot be null.");for(var e=this.pathConstraints,n=0,i=e.length;n<i;n++)if(e[n].name==t)return n;return-1},G=Le,N.SkeletonData=G,function(t){var e=(n.prototype.readSkeletonData=function(e){var i=this.scale,a=new t.SkeletonData,r="string"==typeof e?JSON.parse(e):e,s=r.skeleton;if(null!=s){if(a.hash=s.hash,a.version=s.spine,"3.8.75"==a.version)throw new Error("Unsupported skeleton data, please export with a newer version of Spine.");a.x=s.x,a.y=s.y,a.width=s.width,a.height=s.height,a.fps=s.fps,a.imagesPath=s.images}if(r.bones)for(var o=0;o<r.bones.length;o++){var h=r.bones[o],c=null,l=this.getValue(h,"parent",null);if(null!=l&&null==(c=a.findBone(l)))throw new Error("Parent bone not found: "+l);(f=new t.BoneData(a.bones.length,h.name,c)).length=this.getValue(h,"length",0)*i,f.x=this.getValue(h,"x",0)*i,f.y=this.getValue(h,"y",0)*i,f.rotation=this.getValue(h,"rotation",0),f.scaleX=this.getValue(h,"scaleX",1),f.scaleY=this.getValue(h,"scaleY",1),f.shearX=this.getValue(h,"shearX",0),f.shearY=this.getValue(h,"shearY",0),f.transformMode=n.transformModeFromString(this.getValue(h,"transform","normal")),f.skinRequired=this.getValue(h,"skin",!1),a.bones.push(f)}if(r.slots)for(o=0;o<r.slots.length;o++){var u=(C=r.slots[o]).name,d=C.bone,p=a.findBone(d);if(null==p)throw new Error("Slot bone not found: "+d);var f=new t.SlotData(a.slots.length,u,p),g=this.getValue(C,"color",null);null!=g&&f.color.setFromString(g);var m=this.getValue(C,"dark",null);null!=m&&(f.darkColor=new t.Color(1,1,1,1),f.darkColor.setFromString(m)),f.attachmentName=this.getValue(C,"attachment",null),f.blendMode=n.blendModeFromString(this.getValue(C,"blend","normal")),a.slots.push(f)}if(r.ik)for(o=0;o<r.ik.length;o++){var v=r.ik[o];(f=new t.IkConstraintData(v.name)).order=this.getValue(v,"order",0),f.skinRequired=this.getValue(v,"skin",!1);for(var y=0;y<v.bones.length;y++){if(d=v.bones[y],null==(x=a.findBone(d)))throw new Error("IK bone not found: "+d);f.bones.push(x)}var S=v.target;if(f.target=a.findBone(S),null==f.target)throw new Error("IK target bone not found: "+S);f.mix=this.getValue(v,"mix",1),f.softness=this.getValue(v,"softness",0)*i,f.bendDirection=this.getValue(v,"bendPositive",!0)?1:-1,f.compress=this.getValue(v,"compress",!1),f.stretch=this.getValue(v,"stretch",!1),f.uniform=this.getValue(v,"uniform",!1),a.ikConstraints.push(f)}if(r.transform)for(o=0;o<r.transform.length;o++){for(v=r.transform[o],(f=new t.TransformConstraintData(v.name)).order=this.getValue(v,"order",0),f.skinRequired=this.getValue(v,"skin",!1),y=0;y<v.bones.length;y++){if(d=v.bones[y],null==(x=a.findBone(d)))throw new Error("Transform constraint bone not found: "+d);f.bones.push(x)}if(S=v.target,f.target=a.findBone(S),null==f.target)throw new Error("Transform constraint target bone not found: "+S);f.local=this.getValue(v,"local",!1),f.relative=this.getValue(v,"relative",!1),f.offsetRotation=this.getValue(v,"rotation",0),f.offsetX=this.getValue(v,"x",0)*i,f.offsetY=this.getValue(v,"y",0)*i,f.offsetScaleX=this.getValue(v,"scaleX",0),f.offsetScaleY=this.getValue(v,"scaleY",0),f.offsetShearY=this.getValue(v,"shearY",0),f.rotateMix=this.getValue(v,"rotateMix",1),f.translateMix=this.getValue(v,"translateMix",1),f.scaleMix=this.getValue(v,"scaleMix",1),f.shearMix=this.getValue(v,"shearMix",1),a.transformConstraints.push(f)}if(r.path)for(o=0;o<r.path.length;o++){for(v=r.path[o],(f=new t.PathConstraintData(v.name)).order=this.getValue(v,"order",0),f.skinRequired=this.getValue(v,"skin",!1),y=0;y<v.bones.length;y++){if(d=v.bones[y],null==(x=a.findBone(d)))throw new Error("Transform constraint bone not found: "+d);f.bones.push(x)}if(S=v.target,f.target=a.findSlot(S),null==f.target)throw new Error("Path target slot not found: "+S);f.positionMode=n.positionModeFromString(this.getValue(v,"positionMode","percent")),f.spacingMode=n.spacingModeFromString(this.getValue(v,"spacingMode","length")),f.rotateMode=n.rotateModeFromString(this.getValue(v,"rotateMode","tangent")),f.offsetRotation=this.getValue(v,"rotation",0),f.position=this.getValue(v,"position",0),f.positionMode==t.PositionMode.Fixed&&(f.position*=i),f.spacing=this.getValue(v,"spacing",0),f.spacingMode!=t.SpacingMode.Length&&f.spacingMode!=t.SpacingMode.Fixed||(f.spacing*=i),f.rotateMix=this.getValue(v,"rotateMix",1),f.translateMix=this.getValue(v,"translateMix",1),a.pathConstraints.push(f)}if(r.skins)for(o=0;o<r.skins.length;o++){var A=r.skins[o],E=new t.Skin(A.name);if(A.bones)for(var x,b=0;b<A.bones.length;b++){if(null==(x=a.findBone(A.bones[b])))throw new Error("Skin bone not found: "+A.bones[o]);E.bones.push(x)}if(A.ik)for(b=0;b<A.ik.length;b++){if(null==(T=a.findIkConstraint(A.ik[b])))throw new Error("Skin IK constraint not found: "+A.ik[o]);E.constraints.push(T)}if(A.transform)for(b=0;b<A.transform.length;b++){if(null==(T=a.findTransformConstraint(A.transform[b])))throw new Error("Skin transform constraint not found: "+A.transform[o]);E.constraints.push(T)}if(A.path){var T;for(b=0;b<A.path.length;b++){if(null==(T=a.findPathConstraint(A.path[b])))throw new Error("Skin path constraint not found: "+A.path[o]);E.constraints.push(T)}}for(var u in A.attachments){var w=a.findSlot(u);if(null==w)throw new Error("Slot not found: "+u);var C=A.attachments[u];for(var M in C){var I=this.readAttachment(C[M],E,w.index,M,a);null!=I&&E.setAttachment(w.index,M,I)}}a.skins.push(E),"default"==E.name&&(a.defaultSkin=E)}o=0;for(var P=this.linkedMeshes.length;o<P;o++){var k=this.linkedMeshes[o];if(null==(E=null==k.skin?a.defaultSkin:a.findSkin(k.skin)))throw new Error("Skin not found: "+k.skin);var R=E.getAttachment(k.slotIndex,k.parent);if(null==R)throw new Error("Parent mesh not found: "+k.parent);k.mesh.deformAttachment=k.inheritDeform?R:k.mesh,k.mesh.setParentMesh(R),k.mesh.updateUVs()}if(this.linkedMeshes.length=0,r.events)for(var O in r.events){var _=r.events[O];(f=new t.EventData(O)).intValue=this.getValue(_,"int",0),f.floatValue=this.getValue(_,"float",0),f.stringValue=this.getValue(_,"string",""),f.audioPath=this.getValue(_,"audio",null),null!=f.audioPath&&(f.volume=this.getValue(_,"volume",1),f.balance=this.getValue(_,"balance",0)),a.events.push(f)}if(r.animations)for(var D in r.animations){var L=r.animations[D];this.readAnimation(L,D,a)}return a},n.prototype.readAttachment=function(e,n,a,r,s){var o=this.scale;switch(r=this.getValue(e,"name",r),this.getValue(e,"type","region")){case"region":var h=this.getValue(e,"path",r),c=this.attachmentLoader.newRegionAttachment(n,r,h);return null==c?null:(c.path=h,c.x=this.getValue(e,"x",0)*o,c.y=this.getValue(e,"y",0)*o,c.scaleX=this.getValue(e,"scaleX",1),c.scaleY=this.getValue(e,"scaleY",1),c.rotation=this.getValue(e,"rotation",0),c.width=e.width*o,c.height=e.height*o,null!=(E=this.getValue(e,"color",null))&&c.color.setFromString(E),c.updateOffset(),c);case"boundingbox":var l=this.attachmentLoader.newBoundingBoxAttachment(n,r);return null==l?null:(this.readVertices(e,l,e.vertexCount<<1),null!=(E=this.getValue(e,"color",null))&&l.color.setFromString(E),l);case"mesh":case"linkedmesh":h=this.getValue(e,"path",r);var u=this.attachmentLoader.newMeshAttachment(n,r,h);if(null==u)return null;u.path=h,null!=(E=this.getValue(e,"color",null))&&u.color.setFromString(E),u.width=this.getValue(e,"width",0)*o,u.height=this.getValue(e,"height",0)*o;var d=this.getValue(e,"parent",null);if(null!=d)return this.linkedMeshes.push(new i(u,this.getValue(e,"skin",null),a,d,this.getValue(e,"deform",!0))),u;var p=e.uvs;return this.readVertices(e,u,p.length),u.triangles=e.triangles,u.regionUVs=p,u.updateUVs(),u.edges=this.getValue(e,"edges",null),u.hullLength=2*this.getValue(e,"hull",0),u;case"path":if(null==(h=this.attachmentLoader.newPathAttachment(n,r)))return null;h.closed=this.getValue(e,"closed",!1),h.constantSpeed=this.getValue(e,"constantSpeed",!0);var f=e.vertexCount;this.readVertices(e,h,f<<1);for(var g=t.Utils.newArray(f/3,0),m=0;m<e.lengths.length;m++)g[m]=e.lengths[m]*o;return h.lengths=g,null!=(E=this.getValue(e,"color",null))&&h.color.setFromString(E),h;case"point":var v=this.attachmentLoader.newPointAttachment(n,r);return null==v?null:(v.x=this.getValue(e,"x",0)*o,v.y=this.getValue(e,"y",0)*o,v.rotation=this.getValue(e,"rotation",0),null!=(E=this.getValue(e,"color",null))&&v.color.setFromString(E),v);case"clipping":var y=this.attachmentLoader.newClippingAttachment(n,r);if(null==y)return null;var S=this.getValue(e,"end",null);if(null!=S){var A=s.findSlot(S);if(null==A)throw new Error("Clipping end slot not found: "+S);y.endSlot=A}var E;f=e.vertexCount;return this.readVertices(e,y,f<<1),null!=(E=this.getValue(e,"color",null))&&y.color.setFromString(E),y}return null},n.prototype.readVertices=function(e,n,i){var a=this.scale;n.worldVerticesLength=i;var r=e.vertices;if(i!=r.length){for(var s=new Array,o=new Array,h=0,c=r.length;h<c;){var l=r[h++];o.push(l);for(var u=h+4*l;h<u;h+=4)o.push(r[h]),s.push(r[h+1]*a),s.push(r[h+2]*a),s.push(r[h+3])}n.bones=o,n.vertices=t.Utils.toFloatArray(s)}else{var d=t.Utils.toFloatArray(r);if(1!=a)for(h=0,c=r.length;h<c;h++)d[h]*=a;n.vertices=d}},n.prototype.readAnimation=function(e,n,i){var a=this.scale,r=new Array,s=0;if(e.slots)for(var o in e.slots){var h=e.slots[o];if(-1==($=i.findSlotIndex(o)))throw new Error("Slot not found: "+o);for(var c in h){var l=h[c];if("attachment"==c){(E=new t.AttachmentTimeline(l.length)).slotIndex=$;for(var u=0,d=0;d<l.length;d++){var p=l[d];E.setFrame(u++,this.getValue(p,"time",0),p.name)}r.push(E),s=Math.max(s,E.frames[E.getFrameCount()-1])}else if("color"==c){for((E=new t.ColorTimeline(l.length)).slotIndex=$,d=u=0;d<l.length;d++){p=l[d];var f=new t.Color;f.setFromString(p.color),E.setFrame(u,this.getValue(p,"time",0),f.r,f.g,f.b,f.a),this.readCurve(p,E,u),u++}r.push(E),s=Math.max(s,E.frames[(E.getFrameCount()-1)*t.ColorTimeline.ENTRIES])}else{if("twoColor"!=c)throw new Error("Invalid timeline type for a slot: "+c+" ("+o+")");for((E=new t.TwoColorTimeline(l.length)).slotIndex=$,d=u=0;d<l.length;d++){p=l[d];var m=new t.Color,v=new t.Color;m.setFromString(p.light),v.setFromString(p.dark),E.setFrame(u,this.getValue(p,"time",0),m.r,m.g,m.b,m.a,v.r,v.g,v.b),this.readCurve(p,E,u),u++}r.push(E),s=Math.max(s,E.frames[(E.getFrameCount()-1)*t.TwoColorTimeline.ENTRIES])}}}if(e.bones)for(var y in e.bones){var S=e.bones[y],A=i.findBoneIndex(y);if(-1==A)throw new Error("Bone not found: "+y);for(var c in S)if(l=S[c],"rotate"===c){for((E=new t.RotateTimeline(l.length)).boneIndex=A,d=u=0;d<l.length;d++)p=l[d],E.setFrame(u,this.getValue(p,"time",0),this.getValue(p,"angle",0)),this.readCurve(p,E,u),u++;r.push(E),s=Math.max(s,E.frames[(E.getFrameCount()-1)*t.RotateTimeline.ENTRIES])}else{if("translate"!==c&&"scale"!==c&&"shear"!==c)throw new Error("Invalid timeline type for a bone: "+c+" ("+y+")");var E=null,x=1,b=0;for("scale"===c?(E=new t.ScaleTimeline(l.length),b=1):"shear"===c?E=new t.ShearTimeline(l.length):(E=new t.TranslateTimeline(l.length),x=a),E.boneIndex=A,d=u=0;d<l.length;d++){p=l[d];var T=this.getValue(p,"x",b),w=this.getValue(p,"y",b);E.setFrame(u,this.getValue(p,"time",0),T*x,w*x),this.readCurve(p,E,u),u++}r.push(E),s=Math.max(s,E.frames[(E.getFrameCount()-1)*t.TranslateTimeline.ENTRIES])}}if(e.ik)for(var C in e.ik){var M=e.ik[C],I=i.findIkConstraint(C);for((E=new t.IkConstraintTimeline(M.length)).ikConstraintIndex=g()(P=i.ikConstraints).call(P,I),d=u=0;d<M.length;d++){var P;p=M[d],E.setFrame(u,this.getValue(p,"time",0),this.getValue(p,"mix",1),this.getValue(p,"softness",0)*a,this.getValue(p,"bendPositive",!0)?1:-1,this.getValue(p,"compress",!1),this.getValue(p,"stretch",!1)),this.readCurve(p,E,u),u++}r.push(E),s=Math.max(s,E.frames[(E.getFrameCount()-1)*t.IkConstraintTimeline.ENTRIES])}if(e.transform)for(var C in e.transform){for(M=e.transform[C],I=i.findTransformConstraint(C),(E=new t.TransformConstraintTimeline(M.length)).transformConstraintIndex=g()(k=i.transformConstraints).call(k,I),d=u=0;d<M.length;d++){var k;p=M[d],E.setFrame(u,this.getValue(p,"time",0),this.getValue(p,"rotateMix",1),this.getValue(p,"translateMix",1),this.getValue(p,"scaleMix",1),this.getValue(p,"shearMix",1)),this.readCurve(p,E,u),u++}r.push(E),s=Math.max(s,E.frames[(E.getFrameCount()-1)*t.TransformConstraintTimeline.ENTRIES])}if(e.path)for(var C in e.path){M=e.path[C];var R=i.findPathConstraintIndex(C);if(-1==R)throw new Error("Path constraint not found: "+C);var O=i.pathConstraints[R];for(var c in M)if(l=M[c],"position"===c||"spacing"===c){E=null,x=1;for("spacing"===c?(E=new t.PathConstraintSpacingTimeline(l.length),O.spacingMode!=t.SpacingMode.Length&&O.spacingMode!=t.SpacingMode.Fixed||(x=a)):(E=new t.PathConstraintPositionTimeline(l.length),O.positionMode==t.PositionMode.Fixed&&(x=a)),E.pathConstraintIndex=R,d=u=0;d<l.length;d++)p=l[d],E.setFrame(u,this.getValue(p,"time",0),this.getValue(p,c,0)*x),this.readCurve(p,E,u),u++;r.push(E),s=Math.max(s,E.frames[(E.getFrameCount()-1)*t.PathConstraintPositionTimeline.ENTRIES])}else if("mix"===c){for((E=new t.PathConstraintMixTimeline(l.length)).pathConstraintIndex=R,d=u=0;d<l.length;d++)p=l[d],E.setFrame(u,this.getValue(p,"time",0),this.getValue(p,"rotateMix",1),this.getValue(p,"translateMix",1)),this.readCurve(p,E,u),u++;r.push(E),s=Math.max(s,E.frames[(E.getFrameCount()-1)*t.PathConstraintMixTimeline.ENTRIES])}}if(e.deform)for(var _ in e.deform){var D=e.deform[_],L=i.findSkin(_);if(null==L)throw new Error("Skin not found: "+_);for(var o in D){if(h=D[o],-1==($=i.findSlotIndex(o)))throw new Error("Slot not found: "+h.name);for(var c in h){l=h[c];var B=L.getAttachment($,c);if(null==B)throw new Error("Deform attachment not found: "+l.name);var F=null!=B.bones,N=B.vertices,G=F?N.length/3*2:N.length;(E=new t.DeformTimeline(l.length)).slotIndex=$,E.attachment=B;u=0;for(var U=0;U<l.length;U++){p=l[U];var V=void 0,Y=this.getValue(p,"vertices",null);if(null==Y)V=F?t.Utils.newFloatArray(G):N;else{V=t.Utils.newFloatArray(G);var z=this.getValue(p,"offset",0);if(t.Utils.arrayCopy(Y,0,V,z,Y.length),1!=a)for(var H=(d=z)+Y.length;d<H;d++)V[d]*=a;if(!F)for(d=0;d<G;d++)V[d]+=N[d]}E.setFrame(u,this.getValue(p,"time",0),V),this.readCurve(p,E,u),u++}r.push(E),s=Math.max(s,E.frames[E.getFrameCount()-1])}}}var W=e.drawOrder;if(null==W&&(W=e.draworder),null!=W){E=new t.DrawOrderTimeline(W.length);var X=i.slots.length;for(u=0,U=0;U<W.length;U++){var K=W[U],j=null,q=this.getValue(K,"offsets",null);if(null!=q){j=t.Utils.newArray(X,-1);var Z=t.Utils.newArray(X-q.length,0),J=0,Q=0;for(d=0;d<q.length;d++){var $,tt=q[d];if(-1==($=i.findSlotIndex(tt.slot)))throw new Error("Slot not found: "+tt.slot);for(;J!=$;)Z[Q++]=J++;j[J+tt.offset]=J++}for(;J<X;)Z[Q++]=J++;for(d=X-1;0<=d;d--)-1==j[d]&&(j[d]=Z[--Q])}E.setFrame(u++,this.getValue(K,"time",0),j)}r.push(E),s=Math.max(s,E.frames[E.getFrameCount()-1])}if(e.events){for(E=new t.EventTimeline(e.events.length),d=u=0;d<e.events.length;d++){var et=e.events[d],nt=i.findEvent(et.name);if(null==nt)throw new Error("Event not found: "+et.name);var it=new t.Event(t.Utils.toSinglePrecision(this.getValue(et,"time",0)),nt);it.intValue=this.getValue(et,"int",nt.intValue),it.floatValue=this.getValue(et,"float",nt.floatValue),it.stringValue=this.getValue(et,"string",nt.stringValue),null!=it.data.audioPath&&(it.volume=this.getValue(et,"volume",1),it.balance=this.getValue(et,"balance",0)),E.setFrame(u++,it)}r.push(E),s=Math.max(s,E.frames[E.getFrameCount()-1])}if(isNaN(s))throw new Error("Error while parsing animation, duration is NaN");i.animations.push(new t.Animation(n,r,s))},n.prototype.readCurve=function(t,e,n){var i;t.hasOwnProperty("curve")&&("stepped"==t.curve?e.setStepped(n):(i=t.curve,e.setCurve(n,i,this.getValue(t,"c2",0),this.getValue(t,"c3",1),this.getValue(t,"c4",1))))},n.prototype.getValue=function(t,e,n){return void 0!==t[e]?t[e]:n},n.blendModeFromString=function(e){if("normal"==(e=e.toLowerCase()))return t.BlendMode.Normal;if("additive"==e)return t.BlendMode.Additive;if("multiply"==e)return t.BlendMode.Multiply;if("screen"==e)return t.BlendMode.Screen;throw new Error("Unknown blend mode: "+e)},n.positionModeFromString=function(e){if("fixed"==(e=e.toLowerCase()))return t.PositionMode.Fixed;if("percent"==e)return t.PositionMode.Percent;throw new Error("Unknown position mode: "+e)},n.spacingModeFromString=function(e){if("length"==(e=e.toLowerCase()))return t.SpacingMode.Length;if("fixed"==e)return t.SpacingMode.Fixed;if("percent"==e)return t.SpacingMode.Percent;throw new Error("Unknown position mode: "+e)},n.rotateModeFromString=function(e){if("tangent"==(e=e.toLowerCase()))return t.RotateMode.Tangent;if("chain"==e)return t.RotateMode.Chain;if("chainscale"==e)return t.RotateMode.ChainScale;throw new Error("Unknown rotate mode: "+e)},n.transformModeFromString=function(e){if("normal"==(e=e.toLowerCase()))return t.TransformMode.Normal;if("onlytranslation"==e)return t.TransformMode.OnlyTranslation;if("norotationorreflection"==e)return t.TransformMode.NoRotationOrReflection;if("noscale"==e)return t.TransformMode.NoScale;if("noscaleorreflection"==e)return t.TransformMode.NoScaleOrReflection;throw new Error("Unknown transform mode: "+e)},n);function n(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}t.SkeletonJson=e;var i=function(t,e,n,i,a){this.mesh=t,this.skin=e,this.slotIndex=n,this.parent=i,this.inheritDeform=a}}(Se=Se||{}),function(t){var e=function(t,e,n){this.slotIndex=t,this.name=e,this.attachment=n};t.SkinEntry=e;var n=(i.prototype.setAttachment=function(t,e,n){if(null==n)throw new Error("attachment cannot be null.");var i=this.attachments;t>=i.length&&(i.length=t+1),i[t]||(i[t]={}),i[t][e]=n},i.prototype.addSkin=function(t){for(var e=0;e<t.bones.length;e++){for(var n=t.bones[e],i=!1,a=0;a<this.bones.length;a++)if(this.bones[a]==n){i=!0;break}i||this.bones.push(n)}for(e=0;e<t.constraints.length;e++){var r=t.constraints[e];for(i=!1,a=0;a<this.constraints.length;a++)if(this.constraints[a]==r){i=!0;break}i||this.constraints.push(r)}var s=t.getAttachments();for(e=0;e<s.length;e++){var o=s[e];this.setAttachment(o.slotIndex,o.name,o.attachment)}},i.prototype.copySkin=function(e){for(var n=0;n<e.bones.length;n++){for(var i=e.bones[n],a=!1,r=0;r<this.bones.length;r++)if(this.bones[r]==i){a=!0;break}a||this.bones.push(i)}for(n=0;n<e.constraints.length;n++){var s=e.constraints[n];for(a=!1,r=0;r<this.constraints.length;r++)if(this.constraints[r]==s){a=!0;break}a||this.constraints.push(s)}var o=e.getAttachments();for(n=0;n<o.length;n++){var h=o[n];null!=h.attachment&&(h.attachment instanceof t.MeshAttachment?h.attachment=h.attachment.newLinkedMesh():h.attachment=h.attachment.copy(),this.setAttachment(h.slotIndex,h.name,h.attachment))}},i.prototype.getAttachment=function(t,e){var n=this.attachments[t];return n?n[e]:null},i.prototype.removeAttachment=function(t,e){var n=this.attachments[t];n&&(n[e]=null)},i.prototype.getAttachments=function(){for(var t=new Array,n=0;n<this.attachments.length;n++){var i=this.attachments[n];if(i)for(var a in i){var r=i[a];r&&t.push(new e(n,a,r))}}return t},i.prototype.getAttachmentsForSlot=function(t,n){var i=this.attachments[t];if(i)for(var a in i){var r=i[a];r&&n.push(new e(t,a,r))}},i.prototype.clear=function(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0},i.prototype.attachAll=function(t,e){for(var n=0,i=0;i<t.slots.length;i++){var a=t.slots[i],r=a.getAttachment();if(r&&n<e.attachments.length){var s=e.attachments[n];for(var o in s)if(r==s[o]){var h=this.getAttachment(n,o);null!=h&&a.setAttachment(h);break}}n++}},i);function i(t){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,null==t)throw new Error("name cannot be null.");this.name=t}t.Skin=n}(Se=Se||{}),U=Se=Se||{},Be.prototype.getSkeleton=function(){return this.bone.skeleton},Be.prototype.getAttachment=function(){return this.attachment},Be.prototype.setAttachment=function(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.deform.length=0)},Be.prototype.setAttachmentTime=function(t){this.attachmentTime=this.bone.skeleton.time-t},Be.prototype.getAttachmentTime=function(){return this.bone.skeleton.time-this.attachmentTime},Be.prototype.setToSetupPose=function(){this.color.setFromColor(this.data.color),null!=this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),null==this.data.attachmentName?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))},V=Be,U.Slot=V,(z=Se=Se||{}).SlotData=function(t,e,n){if(this.color=new z.Color(1,1,1,1),t<0)throw new Error("index must be >= 0.");if(null==e)throw new Error("name cannot be null.");if(null==n)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=n},function(t){var e,n,i,a,r=(s.prototype.getImage=function(){return this._image},s.filterFromString=function(t){switch(t.toLowerCase()){case"nearest":return e.Nearest;case"linear":return e.Linear;case"mipmap":return e.MipMap;case"mipmapnearestnearest":return e.MipMapNearestNearest;case"mipmaplinearnearest":return e.MipMapLinearNearest;case"mipmapnearestlinear":return e.MipMapNearestLinear;case"mipmaplinearlinear":return e.MipMapLinearLinear;default:throw new Error("Unknown texture filter "+t)}},s.wrapFromString=function(t){switch(t.toLowerCase()){case"mirroredtepeat":return i.MirroredRepeat;case"clamptoedge":return i.ClampToEdge;case"repeat":return i.Repeat;default:throw new Error("Unknown texture wrap "+t)}},s);function s(t){this._image=t}t.Texture=r,(n=e=t.TextureFilter||(t.TextureFilter={}))[n.Nearest=9728]="Nearest",n[n.Linear=9729]="Linear",n[n.MipMap=9987]="MipMap",n[n.MipMapNearestNearest=9984]="MipMapNearestNearest",n[n.MipMapLinearNearest=9985]="MipMapLinearNearest",n[n.MipMapNearestLinear=9986]="MipMapNearestLinear",n[n.MipMapLinearLinear=9987]="MipMapLinearLinear",(a=i=t.TextureWrap||(t.TextureWrap={}))[a.MirroredRepeat=33648]="MirroredRepeat",a[a.ClampToEdge=33071]="ClampToEdge",a[a.Repeat=10497]="Repeat",t.TextureRegion=function(){this.u=0,this.v=0,this.u2=0,this.v2=0,this.width=0,this.height=0,this.rotate=!1,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0};var o,h=(Ee(c,o=r),c.prototype.setFilters=function(t,e){},c.prototype.setWraps=function(t,e){},c.prototype.dispose=function(){},c);function c(){return null!==o&&o.apply(this,arguments)||this}t.FakeTexture=h}(Se=Se||{}),function(t){var e=(n.prototype.load=function(e,n){if(null==n)throw new Error("textureLoader cannot be null.");for(var a=new i(e),s=new Array(4),h=null;;){var c,l,u,d,p,f,g,m=a.readLine();if(null==m)break;0==(m=$p()(m).call(m)).length?h=null:h?((c=new o).name=m,c.page=h,"true"==(l=a.readValue()).toLocaleLowerCase()?c.degrees=90:"false"==l.toLocaleLowerCase()?c.degrees=0:c.degrees=gR()(l),c.rotate=90==c.degrees,a.readTuple(s),u=eb()(s[0]),d=eb()(s[1]),a.readTuple(s),p=eb()(s[0]),f=eb()(s[1]),c.u=u/h.width,c.v=d/h.height,c.rotate?(c.u2=(u+f)/h.width,c.v2=(d+p)/h.height):(c.u2=(u+p)/h.width,c.v2=(d+f)/h.height),c.x=u,c.y=d,c.width=Math.abs(p),c.height=Math.abs(f),4==a.readTuple(s)&&4==a.readTuple(s)&&a.readTuple(s),c.originalWidth=eb()(s[0]),c.originalHeight=eb()(s[1]),a.readTuple(s),c.offsetX=eb()(s[0]),c.offsetY=eb()(s[1]),c.index=eb()(a.readValue()),c.texture=h.texture,this.regions.push(c)):((h=new r).name=m,2==a.readTuple(s)&&(h.width=eb()(s[0]),h.height=eb()(s[1]),a.readTuple(s)),a.readTuple(s),h.minFilter=t.Texture.filterFromString(s[0]),h.magFilter=t.Texture.filterFromString(s[1]),g=a.readValue(),h.uWrap=t.TextureWrap.ClampToEdge,h.vWrap=t.TextureWrap.ClampToEdge,"x"==g?h.uWrap=t.TextureWrap.Repeat:"y"==g?h.vWrap=t.TextureWrap.Repeat:"xy"==g&&(h.uWrap=h.vWrap=t.TextureWrap.Repeat),h.texture=n(m),h.texture.setFilters(h.minFilter,h.magFilter),h.texture.setWraps(h.uWrap,h.vWrap),h.width=h.texture.getImage().width,h.height=h.texture.getImage().height,this.pages.push(h))}},n.prototype.findRegion=function(t){for(var e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null},n.prototype.dispose=function(){for(var t=0;t<this.pages.length;t++)this.pages[t].texture.dispose()},n);function n(t,e){this.pages=new Array,this.regions=new Array,this.load(t,e)}t.TextureAtlas=e;var i=(a.prototype.readLine=function(){return this.index>=this.lines.length?null:this.lines[this.index++]},a.prototype.readValue=function(){var t,e=this.readLine(),n=g()(e).call(e,":");if(-1==n)throw new Error("Invalid line: "+e);return $p()(t=e.substring(n+1)).call(t)},a.prototype.readTuple=function(t){var e,n=this.readLine(),i=g()(n).call(n,":");if(-1==i)throw new Error("Invalid line: "+n);for(var a=0,r=i+1;a<3;a++){var s,o=g()(n).call(n,",",r);if(-1==o)break;t[a]=$p()(s=n.substr(r,o-r)).call(s),r=o+1}return t[a]=$p()(e=n.substring(r)).call(e),a+1},a);function a(t){this.index=0,this.lines=t.split(/\r\n|\r|\n/)}var r=function(){};t.TextureAtlasPage=r;var s,o=(s=t.TextureRegion,Ee(h,s),h);function h(){return null!==s&&s.apply(this,arguments)||this}t.TextureAtlasRegion=o}(Se=Se||{}),H=Se=Se||{},Fe.prototype.isActive=function(){return this.active},Fe.prototype.apply=function(){this.update()},Fe.prototype.update=function(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()},Fe.prototype.applyAbsoluteWorld=function(){for(var t=this.rotateMix,e=this.translateMix,n=this.scaleMix,i=this.shearMix,a=this.target,r=a.a,s=a.b,o=a.c,h=a.d,c=0<r*h-s*o?H.MathUtils.degRad:-H.MathUtils.degRad,l=this.data.offsetRotation*c,u=this.data.offsetShearY*c,d=this.bones,p=0,f=d.length;p<f;p++){var g,m,v,y,S,A,E,x,b,T,w,C=d[p],M=!1;0!=t&&(g=C.a,E=C.b,m=C.c,x=C.d,(T=Math.atan2(o,r)-Math.atan2(m,g)+l)>H.MathUtils.PI?T-=H.MathUtils.PI2:T<-H.MathUtils.PI&&(T+=H.MathUtils.PI2),T*=t,v=Math.cos(T),y=Math.sin(T),C.a=v*g-y*m,C.b=v*E-y*x,C.c=y*g+v*m,C.d=y*E+v*x,M=!0),0!=e&&(S=this.temp,a.localToWorld(S.set(this.data.offsetX,this.data.offsetY)),C.worldX+=(S.x-C.worldX)*e,C.worldY+=(S.y-C.worldY)*e,M=!0),0<n&&(w=Math.sqrt(C.a*C.a+C.c*C.c),A=Math.sqrt(r*r+o*o),1e-5<w&&(w=(w+(A-w+this.data.offsetScaleX)*n)/w),C.a*=w,C.c*=w,w=Math.sqrt(C.b*C.b+C.d*C.d),A=Math.sqrt(s*s+h*h),1e-5<w&&(w=(w+(A-w+this.data.offsetScaleY)*n)/w),C.b*=w,C.d*=w,M=!0),0<i&&(E=C.b,x=C.d,b=Math.atan2(x,E),(T=Math.atan2(h,s)-Math.atan2(o,r)-(b-Math.atan2(C.c,C.a)))>H.MathUtils.PI?T-=H.MathUtils.PI2:T<-H.MathUtils.PI&&(T+=H.MathUtils.PI2),T=b+(T+u)*i,w=Math.sqrt(E*E+x*x),C.b=Math.cos(T)*w,C.d=Math.sin(T)*w,M=!0),M&&(C.appliedValid=!1)}},Fe.prototype.applyRelativeWorld=function(){for(var t=this.rotateMix,e=this.translateMix,n=this.scaleMix,i=this.shearMix,a=this.target,r=a.a,s=a.b,o=a.c,h=a.d,c=0<r*h-s*o?H.MathUtils.degRad:-H.MathUtils.degRad,l=this.data.offsetRotation*c,u=this.data.offsetShearY*c,d=this.bones,p=0,f=d.length;p<f;p++){var g,m,v,y,S,A,E,x,b,T=d[p],w=!1;0!=t&&(g=T.a,E=T.b,m=T.c,x=T.d,(A=Math.atan2(o,r)+l)>H.MathUtils.PI?A-=H.MathUtils.PI2:A<-H.MathUtils.PI&&(A+=H.MathUtils.PI2),A*=t,v=Math.cos(A),y=Math.sin(A),T.a=v*g-y*m,T.b=v*E-y*x,T.c=y*g+v*m,T.d=y*E+v*x,w=!0),0!=e&&(S=this.temp,a.localToWorld(S.set(this.data.offsetX,this.data.offsetY)),T.worldX+=S.x*e,T.worldY+=S.y*e,w=!0),0<n&&(b=(Math.sqrt(r*r+o*o)-1+this.data.offsetScaleX)*n+1,T.a*=b,T.c*=b,b=(Math.sqrt(s*s+h*h)-1+this.data.offsetScaleY)*n+1,T.b*=b,T.d*=b,w=!0),0<i&&((A=Math.atan2(h,s)-Math.atan2(o,r))>H.MathUtils.PI?A-=H.MathUtils.PI2:A<-H.MathUtils.PI&&(A+=H.MathUtils.PI2),E=T.b,x=T.d,A=Math.atan2(x,E)+(A-H.MathUtils.PI/2+u)*i,b=Math.sqrt(E*E+x*x),T.b=Math.cos(A)*b,T.d=Math.sin(A)*b,w=!0),w&&(T.appliedValid=!1)}},Fe.prototype.applyAbsoluteLocal=function(){var t=this.rotateMix,e=this.translateMix,n=this.scaleMix,i=this.shearMix,a=this.target;a.appliedValid||a.updateAppliedTransform();for(var r=this.bones,s=0,o=r.length;s<o;s++){var h=r[s];h.appliedValid||h.updateAppliedTransform();var c=h.arotation;0!=t&&(f=a.arotation-c+this.data.offsetRotation,c+=(f-=360*(16384-(16384.499999999996-f/360|0)))*t);var l=h.ax,u=h.ay;0!=e&&(l+=(a.ax-l+this.data.offsetX)*e,u+=(a.ay-u+this.data.offsetY)*e);var d=h.ascaleX,p=h.ascaleY;0!=n&&(1e-5<d&&(d=(d+(a.ascaleX-d+this.data.offsetScaleX)*n)/d),1e-5<p&&(p=(p+(a.ascaleY-p+this.data.offsetScaleY)*n)/p));var f,g=h.ashearY;0!=i&&(f=a.ashearY-g+this.data.offsetShearY,f-=360*(16384-(16384.499999999996-f/360|0)),h.shearY+=f*i),h.updateWorldTransformWith(l,u,c,d,p,h.ashearX,g)}},Fe.prototype.applyRelativeLocal=function(){var t=this.rotateMix,e=this.translateMix,n=this.scaleMix,i=this.shearMix,a=this.target;a.appliedValid||a.updateAppliedTransform();for(var r=this.bones,s=0,o=r.length;s<o;s++){var h=r[s];h.appliedValid||h.updateAppliedTransform();var c=h.arotation;0!=t&&(c+=(a.arotation+this.data.offsetRotation)*t);var l=h.ax,u=h.ay;0!=e&&(l+=(a.ax+this.data.offsetX)*e,u+=(a.ay+this.data.offsetY)*e);var d=h.ascaleX,p=h.ascaleY;0!=n&&(1e-5<d&&(d*=(a.ascaleX-1+this.data.offsetScaleX)*n+1),1e-5<p&&(p*=(a.ascaleY-1+this.data.offsetScaleY)*n+1));var f=h.ashearY;0!=i&&(f+=(a.ashearY+this.data.offsetShearY)*i),h.updateWorldTransformWith(l,u,c,d,p,h.ashearX,f)}},W=Fe,H.TransformConstraint=W,X=Se=Se||{},K=X.ConstraintData,Ee(Ne,K),j=Ne,X.TransformConstraintData=j,q=Se=Se||{},Ge.prototype.triangulate=function(t){for(var e=t,n=t.length>>1,i=this.indicesArray,a=i.length=0;a<n;a++)i[a]=a;for(var r=this.isConcaveArray,s=(a=r.length=0,n);a<s;++a)r[a]=Ge.isConcave(a,n,e,i);var o=this.triangles;for(o.length=0;3<n;){for(var h=n-1,c=(a=0,1);;){t:if(!r[a]){for(var l=i[h]<<1,u=i[a]<<1,d=i[c]<<1,p=e[l],f=e[1+l],g=e[u],m=e[1+u],v=e[d],y=e[1+d],S=(c+1)%n;S!=h;S=(S+1)%n)if(r[S]){var A=i[S]<<1,E=e[A],x=e[1+A];if(Ge.positiveArea(v,y,p,f,E,x)&&Ge.positiveArea(p,f,g,m,E,x)&&Ge.positiveArea(g,m,v,y,E,x))break t}break}if(0==c){do{if(!r[a])break;a--}while(0<a);break}h=a,c=((a=c)+1)%n}o.push(i[(n+a-1)%n]),o.push(i[a]),o.push(i[(a+1)%n]),ds()(i).call(i,a,1),ds()(r).call(r,a,1);var b=(--n+a-1)%n,T=a==n?0:a;r[b]=Ge.isConcave(b,n,e,i),r[T]=Ge.isConcave(T,n,e,i)}return 3==n&&(o.push(i[2]),o.push(i[0]),o.push(i[1])),o},Ge.prototype.decompose=function(t,e){var n=t,i=this.convexPolygons;this.polygonPool.freeAll(i),i.length=0;var a=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(a),a.length=0;var r=this.polygonIndicesPool.obtain();r.length=0;for(var s=this.polygonPool.obtain(),o=-1,h=s.length=0,c=0,l=e.length;c<l;c+=3){var u=e[c]<<1,d=e[c+1]<<1,p=e[c+2]<<1,f=n[u],g=n[1+u],m=n[d],v=n[1+d],y=n[p],S=n[1+p],A=!1;o==u&&(E=s.length-4,M=Ge.winding(s[E],s[E+1],s[E+2],s[E+3],y,S),I=Ge.winding(y,S,s[0],s[1],s[2],s[3]),M==h&&I==h&&(s.push(y),s.push(S),r.push(p),A=!0)),A||(0<s.length?(i.push(s),a.push(r)):(this.polygonPool.free(s),this.polygonIndicesPool.free(r)),(s=this.polygonPool.obtain()).length=0,s.push(f),s.push(g),s.push(m),s.push(v),s.push(y),s.push(S),(r=this.polygonIndicesPool.obtain()).length=0,r.push(u),r.push(d),r.push(p),h=Ge.winding(f,g,m,v,y,S),o=u)}for(0<s.length&&(i.push(s),a.push(r)),c=0,l=i.length;c<l;c++)if(0!=(r=a[c]).length)for(var E,x,b,T,w,C,M,I,P=r[0],k=r[r.length-1],R=(s=i[c])[E=s.length-4],O=s[E+1],_=s[E+2],D=s[E+3],L=s[0],B=s[1],F=s[2],N=s[3],G=Ge.winding(R,O,_,D,L,B),U=0;U<l;U++)U!=c&&3==(x=a[U]).length&&(b=x[0],T=x[1],w=x[2],y=(C=i[U])[C.length-2],S=C[C.length-1],b==P&&T==k&&(M=Ge.winding(R,O,_,D,y,S),I=Ge.winding(y,S,L,B,F,N),M==G&&I==G&&(C.length=0,x.length=0,s.push(y),s.push(S),r.push(w),R=_,O=D,_=y,D=S,U=0)));for(c=i.length-1;0<=c;c--)0==(s=i[c]).length&&(ds()(i).call(i,c,1),this.polygonPool.free(s),r=a[c],ds()(a).call(a,c,1),this.polygonIndicesPool.free(r));return i},Ge.isConcave=function(t,e,n,i){var a=i[(e+t-1)%e]<<1,r=i[t]<<1,s=i[(t+1)%e]<<1;return!this.positiveArea(n[a],n[1+a],n[r],n[1+r],n[s],n[1+s])},Ge.positiveArea=function(t,e,n,i,a,r){return 0<=t*(r-i)+n*(e-r)+a*(i-e)},Ge.winding=function(t,e,n,i,a,r){var s=n-t,o=i-e;return 0<=a*o-r*s+s*e-t*o?1:-1},Z=Ge,q.Triangulator=Z,function(t){var e=(n.prototype.add=function(t){var e=this.contains(t);return this.array[0|t]=0|t,!e},n.prototype.contains=function(t){return null!=this.array[0|t]},n.prototype.remove=function(t){this.array[0|t]=void 0},n.prototype.clear=function(){this.array.length=0},n);function n(){this.array=new Array}t.IntSet=e;var i=(a.prototype.set=function(t,e,n,i){return this.r=t,this.g=e,this.b=n,this.a=i,this.clamp(),this},a.prototype.setFromColor=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this},a.prototype.setFromString=function(t){return t="#"==t.charAt(0)?t.substr(1):t,this.r=eb()(t.substr(0,2),16)/255,this.g=eb()(t.substr(2,2),16)/255,this.b=eb()(t.substr(4,2),16)/255,this.a=(8!=t.length?255:eb()(t.substr(6,2),16))/255,this},a.prototype.add=function(t,e,n,i){return this.r+=t,this.g+=e,this.b+=n,this.a+=i,this.clamp(),this},a.prototype.clamp=function(){return this.r<0?this.r=0:1<this.r&&(this.r=1),this.g<0?this.g=0:1<this.g&&(this.g=1),this.b<0?this.b=0:1<this.b&&(this.b=1),this.a<0?this.a=0:1<this.a&&(this.a=1),this},a.rgba8888ToColor=function(t,e){t.r=((4278190080&e)>>>24)/255,t.g=((16711680&e)>>>16)/255,t.b=((65280&e)>>>8)/255,t.a=(255&e)/255},a.rgb888ToColor=function(t,e){t.r=((16711680&e)>>>16)/255,t.g=((65280&e)>>>8)/255,t.b=(255&e)/255},a.WHITE=new a(1,1,1,1),a.RED=new a(1,0,0,1),a.GREEN=new a(0,1,0,1),a.BLUE=new a(0,0,1,1),a.MAGENTA=new a(1,0,1,1),a);function a(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.r=t,this.g=e,this.b=n,this.a=i}t.Color=i;var r=(s.clamp=function(t,e,n){return t<e?e:n<t?n:t},s.cosDeg=function(t){return Math.cos(t*s.degRad)},s.sinDeg=function(t){return Math.sin(t*s.degRad)},s.signum=function(t){return 0<t?1:t<0?-1:0},s.toInt=function(t){return 0<t?Math.floor(t):Math.ceil(t)},s.cbrt=function(t){var e=Math.pow(Math.abs(t),1/3);return t<0?-e:e},s.randomTriangular=function(t,e){return s.randomTriangularWith(t,e,.5*(t+e))},s.randomTriangularWith=function(t,e,n){var i=Math.random(),a=e-t;return i<=(n-t)/a?t+Math.sqrt(i*a*(n-t)):e-Math.sqrt((1-i)*a*(e-n))},s.PI2=2*(s.PI=3.1415927),s.radDeg=s.radiansToDegrees=180/s.PI,s.degRad=s.degreesToRadians=s.PI/180,s);function s(){}t.MathUtils=r;var o=(h.prototype.apply=function(t,e,n){return t+(e-t)*this.applyInternal(n)},h);function h(){}t.Interpolation=o;var c,l=(Ee(u,c=o),u.prototype.applyInternal=function(t){return t<=.5?Math.pow(2*t,this.power)/2:Math.pow(2*(t-1),this.power)/(this.power%2==0?-2:2)+1},u);function u(t){var e=c.call(this)||this;return e.power=2,e.power=t,e}t.Pow=l;var d,p=(Ee(f,d=l),f.prototype.applyInternal=function(t){return Math.pow(t-1,this.power)*(this.power%2==0?-1:1)+1},f);function f(t){return d.call(this,t)||this}t.PowOut=p;var g=(m.arrayCopy=function(t,e,n,i,a){for(var r=e,s=i;r<e+a;r++,s++)n[s]=t[r]},m.setArraySize=function(t,e,n){void 0===n&&(n=0);var i=t.length;if(i==e)return t;if(i<(t.length=e))for(var a=i;a<e;a++)t[a]=n;return t},m.ensureArrayCapacity=function(t,e,n){return void 0===n&&(n=0),t.length>=e?t:m.setArraySize(t,e,n)},m.newArray=function(t,e){for(var n=new Array(t),i=0;i<t;i++)n[i]=e;return n},m.newFloatArray=function(t){if(m.SUPPORTS_TYPED_ARRAYS)return new Float32Array(t);for(var e=new Array(t),n=0;n<e.length;n++)e[n]=0;return e},m.newShortArray=function(t){if(m.SUPPORTS_TYPED_ARRAYS)return new Int16Array(t);for(var e=new Array(t),n=0;n<e.length;n++)e[n]=0;return e},m.toFloatArray=function(t){return m.SUPPORTS_TYPED_ARRAYS?new Float32Array(t):t},m.toSinglePrecision=function(t){return m.SUPPORTS_TYPED_ARRAYS?SR()(t):t},m.webkit602BugfixHelper=function(t,e){},m.contains=function(t,e,n){void 0===n&&(n=!0);for(var i=0;i<t.length;i++)if(t[i]==e)return!0;return!1},m.SUPPORTS_TYPED_ARRAYS="undefined"!=typeof Float32Array,m);function m(){}t.Utils=g;var v=(y.logBones=function(t){for(var e=0;e<t.bones.length;e++)t.bones[e]},y);function y(){}t.DebugUtils=v;var S=(A.prototype.obtain=function(){return 0<this.items.length?this.items.pop():this.instantiator()},A.prototype.free=function(t){t.reset&&t.reset(),this.items.push(t)},A.prototype.freeAll=function(t){for(var e=0;e<t.length;e++)this.free(t[e])},A.prototype.clear=function(){this.items.length=0},A);function A(t){this.items=new Array,this.instantiator=t}t.Pool=S;var E=(x.prototype.set=function(t,e){return this.x=t,this.y=e,this},x.prototype.length=function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},x.prototype.normalize=function(){var t=this.length();return 0!=t&&(this.x/=t,this.y/=t),this},x);function x(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}t.Vector2=E;var b=(T.prototype.update=function(){var t=Date.now()/1e3;this.delta=t-this.lastTime,this.frameTime+=this.delta,this.totalTime+=this.delta,this.delta>this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=t,this.frameCount++,1<this.frameTime&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=0)},T);function T(){this.maxDelta=.064,this.framesPerSecond=0,this.delta=0,this.totalTime=0,this.lastTime=Date.now()/1e3,this.frameCount=0,this.frameTime=0}t.TimeKeeper=b;var w=(C.prototype.hasEnoughData=function(){return this.addedValues>=ER()(this).length},C.prototype.addValue=function(t){this.addedValues<ER()(this).length&&this.addedValues++,ER()(this)[this.lastValue++]=t,this.lastValue>ER()(this).length-1&&(this.lastValue=0),this.dirty=!0},C.prototype.getMean=function(){if(this.hasEnoughData()){if(this.dirty){for(var t=0,e=0;e<ER()(this).length;e++)t+=ER()(this)[e];this.mean=t/ER()(this).length,this.dirty=!1}return this.mean}return 0},C);function C(t){void 0===t&&(t=32),this.addedValues=0,this.lastValue=0,this.mean=0,this.dirty=!0,this.values=new Array(t)}t.WindowedMean=w}(Se=Se||{}),SR()||(Math.fround=(J=new Float32Array(1),function(t){return J[0]=t,J[0]})),function(t){function e(t){if(null==t)throw new Error("name cannot be null.");this.name=t}t.Attachment=e;var n,i=(Ee(a,n=e),a.prototype.computeWorldVertices=function(t,e,n,i,a,r){n=a+(n>>1)*r;var s=t.bone.skeleton,o=t.deform,h=this.vertices,c=this.bones;if(null!=c){for(var l=0,u=0,d=0;d<e;d+=2)l+=(m=c[l])+1,u+=m;var p=s.bones;if(0==o.length)for(x=a,b=3*u;x<n;x+=r){var f=0,g=0,m=c[l++];for(m+=l;l<m;l++,b+=3){var v=p[c[l]],y=h[b],S=h[b+1],A=h[b+2];f+=(y*v.a+S*v.b+v.worldX)*A,g+=(y*v.c+S*v.d+v.worldY)*A}i[x]=f,i[x+1]=g}else for(var E=o,x=a,b=3*u,T=u<<1;x<n;x+=r){for(g=f=0,m=c[l++],m+=l;l<m;l++,b+=3,T+=2)v=p[c[l]],y=h[b]+E[T],S=h[b+1]+E[T+1],A=h[b+2],f+=(y*v.a+S*v.b+v.worldX)*A,g+=(y*v.c+S*v.d+v.worldY)*A;i[x]=f,i[x+1]=g}}else{0<o.length&&(h=o);var w=(v=t.bone).worldX,C=v.worldY,M=v.a,I=(b=v.b,v.c),P=v.d,k=e;for(x=a;x<n;k+=2,x+=r){y=h[k],S=h[k+1];i[x]=y*M+S*b+w,i[x+1]=y*I+S*P+C}}},a.prototype.copyTo=function(e){null!=this.bones?(e.bones=new Array(this.bones.length),t.Utils.arrayCopy(this.bones,0,e.bones,0,this.bones.length)):e.bones=null,null!=this.vertices?(e.vertices=t.Utils.newFloatArray(this.vertices.length),t.Utils.arrayCopy(this.vertices,0,e.vertices,0,this.vertices.length)):e.vertices=null,e.worldVerticesLength=this.worldVerticesLength,e.deformAttachment=this.deformAttachment},a.nextID=0,a);function a(t){var e=n.call(this,t)||this;return e.id=(65535&a.nextID++)<<11,e.worldVerticesLength=0,e.deformAttachment=e}t.VertexAttachment=i}(Se=Se||{}),($=(Q=Se=Se||{}).AttachmentType||(Q.AttachmentType={}))[$.Region=0]="Region",$[$.BoundingBox=1]="BoundingBox",$[$.Mesh=2]="Mesh",$[$.LinkedMesh=3]="LinkedMesh",$[$.Path=4]="Path",$[$.Point=5]="Point",$[$.Clipping=6]="Clipping",tt=Se=Se||{},et=tt.VertexAttachment,Ee(Ue,et),Ue.prototype.copy=function(){var t=new Ue(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t},nt=Ue,tt.BoundingBoxAttachment=nt,at=Se=Se||{},rt=at.VertexAttachment,Ee(Ve,rt),Ve.prototype.copy=function(){var t=new Ve(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t},st=Ve,at.ClippingAttachment=st,ot=Se=Se||{},ht=ot.VertexAttachment,Ee(Ye,ht),Ye.prototype.updateUVs=function(){var t=this.regionUVs;null!=this.uvs&&this.uvs.length==t.length||(this.uvs=ot.Utils.newFloatArray(t.length));var e=this.uvs,n=this.uvs.length,i=this.region.u,a=this.region.v,r=0,s=0;if(this.region instanceof ot.TextureAtlasRegion){var o=this.region,h=o.texture.getImage().width,c=o.texture.getImage().height;switch(o.degrees){case 90:i-=(o.originalHeight-o.offsetY-o.height)/h,a-=(o.originalWidth-o.offsetX-o.width)/c,r=o.originalHeight/h,s=o.originalWidth/c;for(var l=0;l<n;l+=2)e[l]=i+t[l+1]*r,e[l+1]=a+(1-t[l])*s;return;case 180:for(i-=(o.originalWidth-o.offsetX-o.width)/h,a-=o.offsetY/c,r=o.originalWidth/h,s=o.originalHeight/c,l=0;l<n;l+=2)e[l]=i+(1-t[l])*r,e[l+1]=a+(1-t[l+1])*s;return;case 270:for(i-=o.offsetY/h,a-=o.offsetX/c,r=o.originalHeight/h,s=o.originalWidth/c,l=0;l<n;l+=2)e[l]=i+(1-t[l+1])*r,e[l+1]=a+t[l]*s;return}i-=o.offsetX/h,a-=(o.originalHeight-o.offsetY-o.height)/c,r=o.originalWidth/h,s=o.originalHeight/c}else null==this.region?(i=a=0,r=s=1):(r=this.region.u2-i,s=this.region.v2-a);for(l=0;l<n;l+=2)e[l]=i+t[l]*r,e[l+1]=a+t[l+1]*s},Ye.prototype.getParentMesh=function(){return this.parentMesh},Ye.prototype.setParentMesh=function(t){null!=(this.parentMesh=t)&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)},Ye.prototype.copy=function(){if(null!=this.parentMesh)return this.newLinkedMesh();var t=new Ye(this.name);return t.region=this.region,t.path=this.path,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Array(this.regionUVs.length),ot.Utils.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.uvs=new Array(this.uvs.length),ot.Utils.arrayCopy(this.uvs,0,t.uvs,0,this.uvs.length),t.triangles=new Array(this.triangles.length),ot.Utils.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,null!=this.edges&&(t.edges=new Array(this.edges.length),ot.Utils.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t},Ye.prototype.newLinkedMesh=function(){var t=new Ye(this.name);return t.region=this.region,t.path=this.path,t.color.setFromColor(this.color),t.deformAttachment=this.deformAttachment,t.setParentMesh(null!=this.parentMesh?this.parentMesh:this),t.updateUVs(),t},ct=Ye,ot.MeshAttachment=ct,lt=Se=Se||{},ut=lt.VertexAttachment,Ee(ze,ut),ze.prototype.copy=function(){var t=new ze(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),lt.Utils.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t},dt=ze,lt.PathAttachment=dt,pt=Se=Se||{},ft=pt.VertexAttachment,Ee(He,ft),He.prototype.computeWorldPosition=function(t,e){return e.x=this.x*t.a+this.y*t.b+t.worldX,e.y=this.x*t.c+this.y*t.d+t.worldY,e},He.prototype.computeWorldRotation=function(t){var e=pt.MathUtils.cosDeg(this.rotation),n=pt.MathUtils.sinDeg(this.rotation),i=e*t.a+n*t.b,a=e*t.c+n*t.d;return Math.atan2(a,i)*pt.MathUtils.radDeg},He.prototype.copy=function(){var t=new He(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t},gt=He,pt.PointAttachment=gt,mt=Se=Se||{},vt=mt.Attachment,Ee(We,vt),We.prototype.updateOffset=function(){var t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,n=-this.width/2*this.scaleX+this.region.offsetX*t,i=-this.height/2*this.scaleY+this.region.offsetY*e,a=n+this.region.width*t,r=i+this.region.height*e,s=this.rotation*Math.PI/180,o=Math.cos(s),h=Math.sin(s),c=n*o+this.x,l=n*h,u=i*o+this.y,d=i*h,p=a*o+this.x,f=a*h,g=r*o+this.y,m=r*h,v=this.offset;v[We.OX1]=c-d,v[We.OY1]=u+l,v[We.OX2]=c-m,v[We.OY2]=g+l,v[We.OX3]=p-m,v[We.OY3]=g+f,v[We.OX4]=p-d,v[We.OY4]=u+f},We.prototype.setRegion=function(t){this.region=t;var e=this.uvs;t.rotate?(e[2]=t.u,e[3]=t.v2,e[4]=t.u,e[5]=t.v,e[6]=t.u2,e[7]=t.v,e[0]=t.u2,e[1]=t.v2):(e[0]=t.u,e[1]=t.v2,e[2]=t.u,e[3]=t.v,e[4]=t.u2,e[5]=t.v,e[6]=t.u2,e[7]=t.v2)},We.prototype.computeWorldVertices=function(t,e,n,i){var a=this.offset,r=t.worldX,s=t.worldY,o=t.a,h=t.b,c=t.c,l=t.d,u=a[We.OX1],d=a[We.OY1];e[n]=u*o+d*h+r,e[n+1]=u*c+d*l+s,n+=i,u=a[We.OX2],d=a[We.OY2],e[n]=u*o+d*h+r,e[n+1]=u*c+d*l+s,n+=i,u=a[We.OX3],d=a[We.OY3],e[n]=u*o+d*h+r,e[n+1]=u*c+d*l+s,n+=i,u=a[We.OX4],d=a[We.OY4],e[n]=u*o+d*h+r,e[n+1]=u*c+d*l+s},We.prototype.copy=function(){var t=new We(this.name);return t.region=this.region,t.rendererObject=this.rendererObject,t.path=this.path,t.x=this.x,t.y=this.y,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.rotation=this.rotation,t.width=this.width,t.height=this.height,mt.Utils.arrayCopy(this.uvs,0,t.uvs,0,8),mt.Utils.arrayCopy(this.offset,0,t.offset,0,8),t.color.setFromColor(this.color),t},We.OX1=0,We.OY1=1,We.OX2=2,We.OY2=3,We.OX3=4,We.OY3=5,We.OX4=6,We.OY4=7,We.X1=0,We.Y1=1,We.C1R=2,We.C1G=3,We.C1B=4,We.C1A=5,We.U1=6,We.V1=7,We.X2=8,We.Y2=9,We.C2R=10,We.C2G=11,We.C2B=12,We.C2A=13,We.U2=14,We.V2=15,We.X3=16,We.Y3=17,We.C3R=18,We.C3G=19,We.C3B=20,We.C3A=21,We.U3=22,We.V3=23,We.X4=24,We.Y4=25,We.C4R=26,We.C4G=27,We.C4B=28,We.C4A=29,We.U4=30,We.V4=31,yt=We,mt.RegionAttachment=yt,St=Se=Se||{},Xe.prototype.begin=function(t){},Xe.prototype.transform=function(t,e,n,i){t.x+=St.MathUtils.randomTriangular(-this.jitterX,this.jitterY),t.y+=St.MathUtils.randomTriangular(-this.jitterX,this.jitterY)},Xe.prototype.end=function(){},At=Xe,St.JitterEffect=At,Et=Se=Se||{},Ke.prototype.begin=function(t){this.worldX=t.x+this.centerX,this.worldY=t.y+this.centerY},Ke.prototype.transform=function(t,e,n,i){var a,r,s,o=this.angle*Et.MathUtils.degreesToRadians,h=t.x-this.worldX,c=t.y-this.worldY,l=Math.sqrt(h*h+c*c);l<this.radius&&(a=Ke.interpolation.apply(0,o,(this.radius-l)/this.radius),r=Math.cos(a),s=Math.sin(a),t.x=r*h-s*c+this.worldX,t.y=s*h+r*c+this.worldY)},Ke.prototype.end=function(){},Ke.interpolation=new Et.PowOut(2),xt=Ke,Et.SwirlEffect=xt,Tt=(bt=Se=Se||{}).canvas||(bt.canvas={}),wt=bt.AssetManager,Ee(je,wt),Ct=je,Tt.AssetManager=Ct,It=(Mt=Se=Se||{}).canvas||(Mt.canvas={}),Pt=Mt.Texture,Ee(qe,Pt),qe.prototype.setFilters=function(t,e){},qe.prototype.setWraps=function(t,e){},qe.prototype.dispose=function(){},kt=qe,It.CanvasTexture=kt,Ot=(Rt=Se=Se||{}).canvas||(Rt.canvas={}),Ze.prototype.draw=function(t){this.triangleRendering?this.drawTriangles(t):this.drawImages(t)},Ze.prototype.drawImages=function(t){var e=this.ctx,n=t.drawOrder;this.debugRendering&&(e.strokeStyle="green"),e.save();for(var i=0,a=n.length;i<a;i++){var r,s,o,h,c,l,u,d,p,f,g,m,v,y,S,A=n[i];A.bone.active&&(h=o=s=null,(r=A.getAttachment())instanceof Rt.RegionAttachment&&(h=(o=(s=r).region).texture.getImage(),c=A.bone.skeleton.color,l=A.color,u=s.color,d=c.a*l.a*u.a,(p=this.tempColor).set(c.r*l.r*u.r,c.g*l.g*u.g,c.b*l.b*u.b,d),f=r,g=A.bone,y=o.width,S=o.height,e.save(),e.transform(g.a,g.c,g.b,g.d,g.worldX,g.worldY),e.translate(r.offset[0],r.offset[1]),e.rotate(r.rotation*Math.PI/180),m=f.width/y,e.scale(m*r.scaleX,m*r.scaleY),e.translate(y/2,S/2),r.region.rotate&&(v=y,y=S,S=v,e.rotate(-Math.PI/2)),e.scale(1,-1),e.translate(-y/2,-S/2),1==p.r&&1==p.g&&1==p.b&&1==p.a||(e.globalAlpha=p.a),e.drawImage(h,o.x,o.y,y,S,0,0,y,S),this.debugRendering&&e.strokeRect(0,0,y,S),e.restore()))}e.restore()},Ze.prototype.drawTriangles=function(t){for(var e=null,n=this.vertices,i=null,a=t.drawOrder,r=0,s=a.length;r<s;r++){var o=a[r],h=o.getAttachment(),c=null;if(h instanceof Rt.RegionAttachment){var l=h;n=this.computeRegionVertices(o,l,!1),i=Ze.QUAD_TRIANGLES,c=l.region.texture.getImage()}else{if(!(h instanceof Rt.MeshAttachment))continue;var u=h;n=this.computeMeshVertices(o,u,!1),i=u.triangles,c=u.region.renderObject.texture.getImage()}if(null!=c){var d=o.data.blendMode;d!=e&&(e=d);var p=o.bone.skeleton.color,f=o.color,g=h.color,m=p.a*f.a*g.a,v=this.tempColor;v.set(p.r*f.r*g.r,p.g*f.g*g.g,p.b*f.b*g.b,m);var y=this.ctx;1==v.r&&1==v.g&&1==v.b&&1==v.a||(y.globalAlpha=v.a);for(var S=0;S<i.length;S+=3){var A=8*i[S],E=8*i[S+1],x=8*i[S+2],b=n[A],T=n[1+A],w=n[6+A],C=n[7+A],M=n[E],I=n[1+E],P=n[6+E],k=n[7+E],R=n[x],O=n[1+x],_=n[6+x],D=n[7+x];this.drawTriangle(c,b,T,w,C,M,I,P,k,R,O,_,D),this.debugRendering&&(y.strokeStyle="green",y.beginPath(),y.moveTo(b,T),y.lineTo(M,I),y.lineTo(R,O),y.lineTo(b,T),y.stroke())}}}this.ctx.globalAlpha=1},Ze.prototype.drawTriangle=function(t,e,n,i,a,r,s,o,h,c,l,u,d){var p=this.ctx;i*=t.width,a*=t.height,o*=t.width,h*=t.height,u*=t.width,d*=t.height,p.beginPath(),p.moveTo(e,n),p.lineTo(r,s),p.lineTo(c,l),p.closePath();var f=1/((o-=i)*(d-=a)-(u-=i)*(h-=a)),g=(d*(r-=e)-h*(c-=e))*f,m=(d*(s-=n)-h*(l-=n))*f,v=(o*c-u*r)*f,y=(o*l-u*s)*f,S=e-g*i-v*a,A=n-m*i-y*a;p.save(),p.transform(g,m,v,y,S,A),p.clip(),p.drawImage(t,0,0),p.restore()},Ze.prototype.computeRegionVertices=function(t,e,n){var i=t.bone.skeleton.color,a=t.color,r=e.color,s=i.a*a.a*r.a,o=n?s:1,h=this.tempColor;h.set(i.r*a.r*r.r*o,i.g*a.g*r.g*o,i.b*a.b*r.b*o,s),e.computeWorldVertices(t.bone,this.vertices,0,Ze.VERTEX_SIZE);var c=this.vertices,l=e.uvs;return c[Rt.RegionAttachment.C1R]=h.r,c[Rt.RegionAttachment.C1G]=h.g,c[Rt.RegionAttachment.C1B]=h.b,c[Rt.RegionAttachment.C1A]=h.a,c[Rt.RegionAttachment.U1]=l[0],c[Rt.RegionAttachment.V1]=l[1],c[Rt.RegionAttachment.C2R]=h.r,c[Rt.RegionAttachment.C2G]=h.g,c[Rt.RegionAttachment.C2B]=h.b,c[Rt.RegionAttachment.C2A]=h.a,c[Rt.RegionAttachment.U2]=l[2],c[Rt.RegionAttachment.V2]=l[3],c[Rt.RegionAttachment.C3R]=h.r,c[Rt.RegionAttachment.C3G]=h.g,c[Rt.RegionAttachment.C3B]=h.b,c[Rt.RegionAttachment.C3A]=h.a,c[Rt.RegionAttachment.U3]=l[4],c[Rt.RegionAttachment.V3]=l[5],c[Rt.RegionAttachment.C4R]=h.r,c[Rt.RegionAttachment.C4G]=h.g,c[Rt.RegionAttachment.C4B]=h.b,c[Rt.RegionAttachment.C4A]=h.a,c[Rt.RegionAttachment.U4]=l[6],c[Rt.RegionAttachment.V4]=l[7],c},Ze.prototype.computeMeshVertices=function(t,e,n){var i=t.bone.skeleton.color,a=t.color,r=e.color,s=i.a*a.a*r.a,o=n?s:1,h=this.tempColor;h.set(i.r*a.r*r.r*o,i.g*a.g*r.g*o,i.b*a.b*r.b*o,s);var c=e.worldVerticesLength/2;this.vertices.length<e.worldVerticesLength&&(this.vertices=Rt.Utils.newFloatArray(e.worldVerticesLength));var l=this.vertices;e.computeWorldVertices(t,0,e.worldVerticesLength,l,0,Ze.VERTEX_SIZE);for(var u=e.uvs,d=0,p=c,f=0,g=2;d<p;d++)l[g++]=h.r,l[g++]=h.g,l[g++]=h.b,l[g++]=h.a,l[g++]=u[f++],l[g++]=u[f++],g+=2;return l},Ze.QUAD_TRIANGLES=[0,1,2,2,3,0],Ze.VERTEX_SIZE=8,_t=Ze,Ot.SkeletonRenderer=_t,Lt=(Dt=Se=Se||{}).webgl||(Dt.webgl={}),Bt=Dt.AssetManager,Ee(Je,Bt),Ft=Je,Lt.AssetManager=Ft,Nt=Se=Se||{},Gt=Nt.webgl||(Nt.webgl={}),Qe.prototype.update=function(){var t=this.projection,e=this.view,n=this.projectionView,i=this.inverseProjectionView,a=this.zoom,r=this.viewportWidth,s=this.viewportHeight;t.ortho(a*(-r/2),a*(r/2),a*(-s/2),a*(s/2),this.near,this.far),e.lookAt(this.position,this.direction,this.up),n.set(ER()(t)),n.multiply(e),i.set(ER()(n)).invert()},Qe.prototype.screenToWorld=function(t,e,n){var i=t.x,a=n-t.y-1,r=this.tmp;return r.x=2*i/e-1,r.y=2*a/n-1,r.z=2*t.z-1,r.project(this.inverseProjectionView),t.set(r.x,r.y,r.z),t},Qe.prototype.setViewport=function(t,e){this.viewportWidth=t,this.viewportHeight=e},Ut=Qe,Gt.OrthoCamera=Ut,Vt=Se=Se||{},Yt=Vt.webgl||(Vt.webgl={}),zt=Vt.Texture,Ee($e,zt),$e.prototype.setFilters=function(t,e){var n=this.context.gl;this.bind(),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,$e.validateMagFilter(e))},$e.validateMagFilter=function(t){switch(t){case Vt.TextureFilter.MipMap:case Vt.TextureFilter.MipMapLinearLinear:case Vt.TextureFilter.MipMapLinearNearest:case Vt.TextureFilter.MipMapNearestLinear:case Vt.TextureFilter.MipMapNearestNearest:return Vt.TextureFilter.Linear;default:return t}},$e.prototype.setWraps=function(t,e){var n=this.context.gl;this.bind(),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,e)},$e.prototype.update=function(t){var e=this.context.gl;this.texture||(this.texture=this.context.gl.createTexture()),this.bind(),$e.DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL&&e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._image),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t?e.LINEAR_MIPMAP_LINEAR:e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),t&&e.generateMipmap(e.TEXTURE_2D)},$e.prototype.restore=function(){this.texture=null,this.update(this.useMipMaps)},$e.prototype.bind=function(t){void 0===t&&(t=0);var e=this.context.gl;this.boundUnit=t,e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,this.texture)},$e.prototype.unbind=function(){var t=this.context.gl;t.activeTexture(t.TEXTURE0+this.boundUnit),t.bindTexture(t.TEXTURE_2D,null)},$e.prototype.dispose=function(){this.context.removeRestorable(this),this.context.gl.deleteTexture(this.texture)},$e.DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL=!1,Ht=$e,Yt.GLTexture=Ht,function(t){t.M00=0,t.M01=4,t.M02=8,t.M03=12,t.M10=1,t.M11=5,t.M12=9,t.M13=13,t.M20=2,t.M21=6,t.M22=10,t.M23=14,t.M30=3,t.M31=7,t.M32=11,t.M33=15;var e=(n.prototype.set=function(t){return ER()(this).set(t),this},n.prototype.transpose=function(){var e=this.temp,n=ER()(this);return e[t.M00]=n[t.M00],e[t.M01]=n[t.M10],e[t.M02]=n[t.M20],e[t.M03]=n[t.M30],e[t.M10]=n[t.M01],e[t.M11]=n[t.M11],e[t.M12]=n[t.M21],e[t.M13]=n[t.M31],e[t.M20]=n[t.M02],e[t.M21]=n[t.M12],e[t.M22]=n[t.M22],e[t.M23]=n[t.M32],e[t.M30]=n[t.M03],e[t.M31]=n[t.M13],e[t.M32]=n[t.M23],e[t.M33]=n[t.M33],this.set(e)},n.prototype.identity=function(){var e=ER()(this);return e[t.M00]=1,e[t.M01]=0,e[t.M02]=0,e[t.M03]=0,e[t.M10]=0,e[t.M11]=1,e[t.M12]=0,e[t.M13]=0,e[t.M20]=0,e[t.M21]=0,e[t.M22]=1,e[t.M23]=0,e[t.M30]=0,e[t.M31]=0,e[t.M32]=0,e[t.M33]=1,this},n.prototype.invert=function(){var e=ER()(this),n=this.temp,i=e[t.M30]*e[t.M21]*e[t.M12]*e[t.M03]-e[t.M20]*e[t.M31]*e[t.M12]*e[t.M03]-e[t.M30]*e[t.M11]*e[t.M22]*e[t.M03]+e[t.M10]*e[t.M31]*e[t.M22]*e[t.M03]+e[t.M20]*e[t.M11]*e[t.M32]*e[t.M03]-e[t.M10]*e[t.M21]*e[t.M32]*e[t.M03]-e[t.M30]*e[t.M21]*e[t.M02]*e[t.M13]+e[t.M20]*e[t.M31]*e[t.M02]*e[t.M13]+e[t.M30]*e[t.M01]*e[t.M22]*e[t.M13]-e[t.M00]*e[t.M31]*e[t.M22]*e[t.M13]-e[t.M20]*e[t.M01]*e[t.M32]*e[t.M13]+e[t.M00]*e[t.M21]*e[t.M32]*e[t.M13]+e[t.M30]*e[t.M11]*e[t.M02]*e[t.M23]-e[t.M10]*e[t.M31]*e[t.M02]*e[t.M23]-e[t.M30]*e[t.M01]*e[t.M12]*e[t.M23]+e[t.M00]*e[t.M31]*e[t.M12]*e[t.M23]+e[t.M10]*e[t.M01]*e[t.M32]*e[t.M23]-e[t.M00]*e[t.M11]*e[t.M32]*e[t.M23]-e[t.M20]*e[t.M11]*e[t.M02]*e[t.M33]+e[t.M10]*e[t.M21]*e[t.M02]*e[t.M33]+e[t.M20]*e[t.M01]*e[t.M12]*e[t.M33]-e[t.M00]*e[t.M21]*e[t.M12]*e[t.M33]-e[t.M10]*e[t.M01]*e[t.M22]*e[t.M33]+e[t.M00]*e[t.M11]*e[t.M22]*e[t.M33];if(0==i)throw new Error("non-invertible matrix");var a=1/i;return n[t.M00]=e[t.M12]*e[t.M23]*e[t.M31]-e[t.M13]*e[t.M22]*e[t.M31]+e[t.M13]*e[t.M21]*e[t.M32]-e[t.M11]*e[t.M23]*e[t.M32]-e[t.M12]*e[t.M21]*e[t.M33]+e[t.M11]*e[t.M22]*e[t.M33],n[t.M01]=e[t.M03]*e[t.M22]*e[t.M31]-e[t.M02]*e[t.M23]*e[t.M31]-e[t.M03]*e[t.M21]*e[t.M32]+e[t.M01]*e[t.M23]*e[t.M32]+e[t.M02]*e[t.M21]*e[t.M33]-e[t.M01]*e[t.M22]*e[t.M33],n[t.M02]=e[t.M02]*e[t.M13]*e[t.M31]-e[t.M03]*e[t.M12]*e[t.M31]+e[t.M03]*e[t.M11]*e[t.M32]-e[t.M01]*e[t.M13]*e[t.M32]-e[t.M02]*e[t.M11]*e[t.M33]+e[t.M01]*e[t.M12]*e[t.M33],n[t.M03]=e[t.M03]*e[t.M12]*e[t.M21]-e[t.M02]*e[t.M13]*e[t.M21]-e[t.M03]*e[t.M11]*e[t.M22]+e[t.M01]*e[t.M13]*e[t.M22]+e[t.M02]*e[t.M11]*e[t.M23]-e[t.M01]*e[t.M12]*e[t.M23],n[t.M10]=e[t.M13]*e[t.M22]*e[t.M30]-e[t.M12]*e[t.M23]*e[t.M30]-e[t.M13]*e[t.M20]*e[t.M32]+e[t.M10]*e[t.M23]*e[t.M32]+e[t.M12]*e[t.M20]*e[t.M33]-e[t.M10]*e[t.M22]*e[t.M33],n[t.M11]=e[t.M02]*e[t.M23]*e[t.M30]-e[t.M03]*e[t.M22]*e[t.M30]+e[t.M03]*e[t.M20]*e[t.M32]-e[t.M00]*e[t.M23]*e[t.M32]-e[t.M02]*e[t.M20]*e[t.M33]+e[t.M00]*e[t.M22]*e[t.M33],n[t.M12]=e[t.M03]*e[t.M12]*e[t.M30]-e[t.M02]*e[t.M13]*e[t.M30]-e[t.M03]*e[t.M10]*e[t.M32]+e[t.M00]*e[t.M13]*e[t.M32]+e[t.M02]*e[t.M10]*e[t.M33]-e[t.M00]*e[t.M12]*e[t.M33],n[t.M13]=e[t.M02]*e[t.M13]*e[t.M20]-e[t.M03]*e[t.M12]*e[t.M20]+e[t.M03]*e[t.M10]*e[t.M22]-e[t.M00]*e[t.M13]*e[t.M22]-e[t.M02]*e[t.M10]*e[t.M23]+e[t.M00]*e[t.M12]*e[t.M23],n[t.M20]=e[t.M11]*e[t.M23]*e[t.M30]-e[t.M13]*e[t.M21]*e[t.M30]+e[t.M13]*e[t.M20]*e[t.M31]-e[t.M10]*e[t.M23]*e[t.M31]-e[t.M11]*e[t.M20]*e[t.M33]+e[t.M10]*e[t.M21]*e[t.M33],n[t.M21]=e[t.M03]*e[t.M21]*e[t.M30]-e[t.M01]*e[t.M23]*e[t.M30]-e[t.M03]*e[t.M20]*e[t.M31]+e[t.M00]*e[t.M23]*e[t.M31]+e[t.M01]*e[t.M20]*e[t.M33]-e[t.M00]*e[t.M21]*e[t.M33],n[t.M22]=e[t.M01]*e[t.M13]*e[t.M30]-e[t.M03]*e[t.M11]*e[t.M30]+e[t.M03]*e[t.M10]*e[t.M31]-e[t.M00]*e[t.M13]*e[t.M31]-e[t.M01]*e[t.M10]*e[t.M33]+e[t.M00]*e[t.M11]*e[t.M33],n[t.M23]=e[t.M03]*e[t.M11]*e[t.M20]-e[t.M01]*e[t.M13]*e[t.M20]-e[t.M03]*e[t.M10]*e[t.M21]+e[t.M00]*e[t.M13]*e[t.M21]+e[t.M01]*e[t.M10]*e[t.M23]-e[t.M00]*e[t.M11]*e[t.M23],n[t.M30]=e[t.M12]*e[t.M21]*e[t.M30]-e[t.M11]*e[t.M22]*e[t.M30]-e[t.M12]*e[t.M20]*e[t.M31]+e[t.M10]*e[t.M22]*e[t.M31]+e[t.M11]*e[t.M20]*e[t.M32]-e[t.M10]*e[t.M21]*e[t.M32],n[t.M31]=e[t.M01]*e[t.M22]*e[t.M30]-e[t.M02]*e[t.M21]*e[t.M30]+e[t.M02]*e[t.M20]*e[t.M31]-e[t.M00]*e[t.M22]*e[t.M31]-e[t.M01]*e[t.M20]*e[t.M32]+e[t.M00]*e[t.M21]*e[t.M32],n[t.M32]=e[t.M02]*e[t.M11]*e[t.M30]-e[t.M01]*e[t.M12]*e[t.M30]-e[t.M02]*e[t.M10]*e[t.M31]+e[t.M00]*e[t.M12]*e[t.M31]+e[t.M01]*e[t.M10]*e[t.M32]-e[t.M00]*e[t.M11]*e[t.M32],n[t.M33]=e[t.M01]*e[t.M12]*e[t.M20]-e[t.M02]*e[t.M11]*e[t.M20]+e[t.M02]*e[t.M10]*e[t.M21]-e[t.M00]*e[t.M12]*e[t.M21]-e[t.M01]*e[t.M10]*e[t.M22]+e[t.M00]*e[t.M11]*e[t.M22],e[t.M00]=n[t.M00]*a,e[t.M01]=n[t.M01]*a,e[t.M02]=n[t.M02]*a,e[t.M03]=n[t.M03]*a,e[t.M10]=n[t.M10]*a,e[t.M11]=n[t.M11]*a,e[t.M12]=n[t.M12]*a,e[t.M13]=n[t.M13]*a,e[t.M20]=n[t.M20]*a,e[t.M21]=n[t.M21]*a,e[t.M22]=n[t.M22]*a,e[t.M23]=n[t.M23]*a,e[t.M30]=n[t.M30]*a,e[t.M31]=n[t.M31]*a,e[t.M32]=n[t.M32]*a,e[t.M33]=n[t.M33]*a,this},n.prototype.determinant=function(){var e=ER()(this);return e[t.M30]*e[t.M21]*e[t.M12]*e[t.M03]-e[t.M20]*e[t.M31]*e[t.M12]*e[t.M03]-e[t.M30]*e[t.M11]*e[t.M22]*e[t.M03]+e[t.M10]*e[t.M31]*e[t.M22]*e[t.M03]+e[t.M20]*e[t.M11]*e[t.M32]*e[t.M03]-e[t.M10]*e[t.M21]*e[t.M32]*e[t.M03]-e[t.M30]*e[t.M21]*e[t.M02]*e[t.M13]+e[t.M20]*e[t.M31]*e[t.M02]*e[t.M13]+e[t.M30]*e[t.M01]*e[t.M22]*e[t.M13]-e[t.M00]*e[t.M31]*e[t.M22]*e[t.M13]-e[t.M20]*e[t.M01]*e[t.M32]*e[t.M13]+e[t.M00]*e[t.M21]*e[t.M32]*e[t.M13]+e[t.M30]*e[t.M11]*e[t.M02]*e[t.M23]-e[t.M10]*e[t.M31]*e[t.M02]*e[t.M23]-e[t.M30]*e[t.M01]*e[t.M12]*e[t.M23]+e[t.M00]*e[t.M31]*e[t.M12]*e[t.M23]+e[t.M10]*e[t.M01]*e[t.M32]*e[t.M23]-e[t.M00]*e[t.M11]*e[t.M32]*e[t.M23]-e[t.M20]*e[t.M11]*e[t.M02]*e[t.M33]+e[t.M10]*e[t.M21]*e[t.M02]*e[t.M33]+e[t.M20]*e[t.M01]*e[t.M12]*e[t.M33]-e[t.M00]*e[t.M21]*e[t.M12]*e[t.M33]-e[t.M10]*e[t.M01]*e[t.M22]*e[t.M33]+e[t.M00]*e[t.M11]*e[t.M22]*e[t.M33]},n.prototype.translate=function(e,n,i){var a=ER()(this);return a[t.M03]+=e,a[t.M13]+=n,a[t.M23]+=i,this},n.prototype.copy=function(){return(new n).set(ER()(this))},n.prototype.projection=function(e,n,i,a){this.identity();var r=1/Math.tan(i*(Math.PI/180)/2),s=(n+e)/(e-n),o=2*n*e/(e-n),h=ER()(this);return h[t.M00]=r/a,h[t.M10]=0,h[t.M20]=0,h[t.M30]=0,h[t.M01]=0,h[t.M11]=r,h[t.M21]=0,h[t.M31]=0,h[t.M02]=0,h[t.M12]=0,h[t.M22]=s,h[t.M32]=-1,h[t.M03]=0,h[t.M13]=0,h[t.M23]=o,h[t.M33]=0,this},n.prototype.ortho2d=function(t,e,n,i){return this.ortho(t,t+n,e,e+i,0,1)},n.prototype.ortho=function(e,n,i,a,r,s){this.identity();var o=2/(n-e),h=2/(a-i),c=-2/(s-r),l=-(n+e)/(n-e),u=-(a+i)/(a-i),d=-(s+r)/(s-r),p=ER()(this);return p[t.M00]=o,p[t.M10]=0,p[t.M20]=0,p[t.M30]=0,p[t.M01]=0,p[t.M11]=h,p[t.M21]=0,p[t.M31]=0,p[t.M02]=0,p[t.M12]=0,p[t.M22]=c,p[t.M32]=0,p[t.M03]=l,p[t.M13]=u,p[t.M23]=d,p[t.M33]=1,this},n.prototype.multiply=function(e){var n=this.temp,i=ER()(this),a=ER()(e);return n[t.M00]=i[t.M00]*a[t.M00]+i[t.M01]*a[t.M10]+i[t.M02]*a[t.M20]+i[t.M03]*a[t.M30],n[t.M01]=i[t.M00]*a[t.M01]+i[t.M01]*a[t.M11]+i[t.M02]*a[t.M21]+i[t.M03]*a[t.M31],n[t.M02]=i[t.M00]*a[t.M02]+i[t.M01]*a[t.M12]+i[t.M02]*a[t.M22]+i[t.M03]*a[t.M32],n[t.M03]=i[t.M00]*a[t.M03]+i[t.M01]*a[t.M13]+i[t.M02]*a[t.M23]+i[t.M03]*a[t.M33],n[t.M10]=i[t.M10]*a[t.M00]+i[t.M11]*a[t.M10]+i[t.M12]*a[t.M20]+i[t.M13]*a[t.M30],n[t.M11]=i[t.M10]*a[t.M01]+i[t.M11]*a[t.M11]+i[t.M12]*a[t.M21]+i[t.M13]*a[t.M31],n[t.M12]=i[t.M10]*a[t.M02]+i[t.M11]*a[t.M12]+i[t.M12]*a[t.M22]+i[t.M13]*a[t.M32],n[t.M13]=i[t.M10]*a[t.M03]+i[t.M11]*a[t.M13]+i[t.M12]*a[t.M23]+i[t.M13]*a[t.M33],n[t.M20]=i[t.M20]*a[t.M00]+i[t.M21]*a[t.M10]+i[t.M22]*a[t.M20]+i[t.M23]*a[t.M30],n[t.M21]=i[t.M20]*a[t.M01]+i[t.M21]*a[t.M11]+i[t.M22]*a[t.M21]+i[t.M23]*a[t.M31],n[t.M22]=i[t.M20]*a[t.M02]+i[t.M21]*a[t.M12]+i[t.M22]*a[t.M22]+i[t.M23]*a[t.M32],n[t.M23]=i[t.M20]*a[t.M03]+i[t.M21]*a[t.M13]+i[t.M22]*a[t.M23]+i[t.M23]*a[t.M33],n[t.M30]=i[t.M30]*a[t.M00]+i[t.M31]*a[t.M10]+i[t.M32]*a[t.M20]+i[t.M33]*a[t.M30],n[t.M31]=i[t.M30]*a[t.M01]+i[t.M31]*a[t.M11]+i[t.M32]*a[t.M21]+i[t.M33]*a[t.M31],n[t.M32]=i[t.M30]*a[t.M02]+i[t.M31]*a[t.M12]+i[t.M32]*a[t.M22]+i[t.M33]*a[t.M32],n[t.M33]=i[t.M30]*a[t.M03]+i[t.M31]*a[t.M13]+i[t.M32]*a[t.M23]+i[t.M33]*a[t.M33],this.set(this.temp)},n.prototype.multiplyLeft=function(e){var n=this.temp,i=ER()(this),a=ER()(e);return n[t.M00]=a[t.M00]*i[t.M00]+a[t.M01]*i[t.M10]+a[t.M02]*i[t.M20]+a[t.M03]*i[t.M30],n[t.M01]=a[t.M00]*i[t.M01]+a[t.M01]*i[t.M11]+a[t.M02]*i[t.M21]+a[t.M03]*i[t.M31],n[t.M02]=a[t.M00]*i[t.M02]+a[t.M01]*i[t.M12]+a[t.M02]*i[t.M22]+a[t.M03]*i[t.M32],n[t.M03]=a[t.M00]*i[t.M03]+a[t.M01]*i[t.M13]+a[t.M02]*i[t.M23]+a[t.M03]*i[t.M33],n[t.M10]=a[t.M10]*i[t.M00]+a[t.M11]*i[t.M10]+a[t.M12]*i[t.M20]+a[t.M13]*i[t.M30],n[t.M11]=a[t.M10]*i[t.M01]+a[t.M11]*i[t.M11]+a[t.M12]*i[t.M21]+a[t.M13]*i[t.M31],n[t.M12]=a[t.M10]*i[t.M02]+a[t.M11]*i[t.M12]+a[t.M12]*i[t.M22]+a[t.M13]*i[t.M32],n[t.M13]=a[t.M10]*i[t.M03]+a[t.M11]*i[t.M13]+a[t.M12]*i[t.M23]+a[t.M13]*i[t.M33],n[t.M20]=a[t.M20]*i[t.M00]+a[t.M21]*i[t.M10]+a[t.M22]*i[t.M20]+a[t.M23]*i[t.M30],n[t.M21]=a[t.M20]*i[t.M01]+a[t.M21]*i[t.M11]+a[t.M22]*i[t.M21]+a[t.M23]*i[t.M31],n[t.M22]=a[t.M20]*i[t.M02]+a[t.M21]*i[t.M12]+a[t.M22]*i[t.M22]+a[t.M23]*i[t.M32],n[t.M23]=a[t.M20]*i[t.M03]+a[t.M21]*i[t.M13]+a[t.M22]*i[t.M23]+a[t.M23]*i[t.M33],n[t.M30]=a[t.M30]*i[t.M00]+a[t.M31]*i[t.M10]+a[t.M32]*i[t.M20]+a[t.M33]*i[t.M30],n[t.M31]=a[t.M30]*i[t.M01]+a[t.M31]*i[t.M11]+a[t.M32]*i[t.M21]+a[t.M33]*i[t.M31],n[t.M32]=a[t.M30]*i[t.M02]+a[t.M31]*i[t.M12]+a[t.M32]*i[t.M22]+a[t.M33]*i[t.M32],n[t.M33]=a[t.M30]*i[t.M03]+a[t.M31]*i[t.M13]+a[t.M32]*i[t.M23]+a[t.M33]*i[t.M33],this.set(this.temp)},n.prototype.lookAt=function(e,i,a){n.initTemps();var r=n.xAxis,s=n.yAxis,o=n.zAxis;o.setFrom(i).normalize(),r.setFrom(i).normalize(),r.cross(a).normalize(),s.setFrom(r).cross(o).normalize(),this.identity();var h=ER()(this);return h[t.M00]=r.x,h[t.M01]=r.y,h[t.M02]=r.z,h[t.M10]=s.x,h[t.M11]=s.y,h[t.M12]=s.z,h[t.M20]=-o.x,h[t.M21]=-o.y,h[t.M22]=-o.z,n.tmpMatrix.identity(),ER()(n.tmpMatrix)[t.M03]=-e.x,ER()(n.tmpMatrix)[t.M13]=-e.y,ER()(n.tmpMatrix)[t.M23]=-e.z,this.multiply(n.tmpMatrix),this},n.initTemps=function(){null===n.xAxis&&(n.xAxis=new t.Vector3),null===n.yAxis&&(n.yAxis=new t.Vector3),null===n.zAxis&&(n.zAxis=new t.Vector3)},n.xAxis=null,n.yAxis=null,n.zAxis=null,n.tmpMatrix=new n,n);function n(){this.temp=new Float32Array(16),this.values=new Float32Array(16);var e=ER()(this);e[t.M00]=1,e[t.M11]=1,e[t.M22]=1,e[t.M33]=1}t.Matrix4=e}((Wt=Se=Se||{}).webgl||(Wt.webgl={})),function(t){var e=(n.prototype.getAttributes=function(){return this.attributes},n.prototype.maxVertices=function(){return this.vertices.length/this.elementsPerVertex},n.prototype.numVertices=function(){return this.verticesLength/this.elementsPerVertex},n.prototype.setVerticesLength=function(t){this.dirtyVertices=!0,this.verticesLength=t},n.prototype.getVertices=function(){return this.vertices},n.prototype.maxIndices=function(){return this.indices.length},n.prototype.numIndices=function(){return this.indicesLength},n.prototype.setIndicesLength=function(t){this.dirtyIndices=!0,this.indicesLength=t},n.prototype.getIndices=function(){return this.indices},n.prototype.getVertexSizeInFloats=function(){for(var t=0,e=0;e<this.attributes.length;e++)t+=this.attributes[e].numElements;return t},n.prototype.setVertices=function(t){if(this.dirtyVertices=!0,t.length>this.vertices.length)throw Error("Mesh can't store more than "+this.maxVertices()+" vertices");this.vertices.set(t,0),this.verticesLength=t.length},n.prototype.setIndices=function(t){if(this.dirtyIndices=!0,t.length>this.indices.length)throw Error("Mesh can't store more than "+this.maxIndices()+" indices");this.indices.set(t,0),this.indicesLength=t.length},n.prototype.draw=function(t,e){this.drawWithOffset(t,e,0,0<this.indicesLength?this.indicesLength:this.verticesLength/this.elementsPerVertex)},n.prototype.drawWithOffset=function(t,e,n,i){var a=this.context.gl;(this.dirtyVertices||this.dirtyIndices)&&this.update(),this.bind(t),0<this.indicesLength?a.drawElements(e,i,a.UNSIGNED_SHORT,2*n):a.drawArrays(e,n,i),this.unbind(t)},n.prototype.bind=function(t){var e=this.context.gl;e.bindBuffer(e.ARRAY_BUFFER,this.verticesBuffer);for(var n=0,i=0;i<this.attributes.length;i++){var a=this.attributes[i],r=t.getAttributeLocation(a.name);e.enableVertexAttribArray(r),e.vertexAttribPointer(r,a.numElements,e.FLOAT,!1,4*this.elementsPerVertex,4*n),n+=a.numElements}0<this.indicesLength&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indicesBuffer)},n.prototype.unbind=function(t){for(var e=this.context.gl,n=0;n<this.attributes.length;n++){var i=this.attributes[n],a=t.getAttributeLocation(i.name);e.disableVertexAttribArray(a)}e.bindBuffer(e.ARRAY_BUFFER,null),0<this.indicesLength&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)},n.prototype.update=function(){var t=this.context.gl;this.dirtyVertices&&(this.verticesBuffer||(this.verticesBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.verticesBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices.subarray(0,this.verticesLength),t.DYNAMIC_DRAW),this.dirtyVertices=!1),this.dirtyIndices&&(this.indicesBuffer||(this.indicesBuffer=t.createBuffer()),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices.subarray(0,this.indicesLength),t.DYNAMIC_DRAW),this.dirtyIndices=!1)},n.prototype.restore=function(){this.verticesBuffer=null,this.indicesBuffer=null,this.update()},n.prototype.dispose=function(){this.context.removeRestorable(this);var t=this.context.gl;t.deleteBuffer(this.verticesBuffer),t.deleteBuffer(this.indicesBuffer)},n);function n(e,n,i,a){this.attributes=n,this.verticesLength=0,this.dirtyVertices=!1,this.indicesLength=0,this.dirtyIndices=!1,this.elementsPerVertex=0,this.context=e instanceof t.ManagedWebGLRenderingContext?e:new t.ManagedWebGLRenderingContext(e);for(var r=this.elementsPerVertex=0;r<n.length;r++)this.elementsPerVertex+=n[r].numElements;this.vertices=new Float32Array(i*this.elementsPerVertex),this.indices=new Uint16Array(a),this.context.addRestorable(this)}function i(t,e,n){this.name=t,this.type=e,this.numElements=n}t.Mesh=e,t.VertexAttribute=i;var a,r=(Ee(s,a=i),s);function s(){return a.call(this,t.Shader.POSITION,v.Float,2)||this}t.Position2Attribute=r;var o,h=(Ee(c,o=i),c);function c(){return o.call(this,t.Shader.POSITION,v.Float,3)||this}t.Position3Attribute=h;var l,u=(Ee(d,l=i),d);function d(e){return void 0===e&&(e=0),l.call(this,t.Shader.TEXCOORDS+(0==e?"":e),v.Float,2)||this}t.TexCoordAttribute=u;var p,f=(Ee(g,p=i),g);function g(){return p.call(this,t.Shader.COLOR,v.Float,4)||this}t.ColorAttribute=f;var m,v,y,S=(Ee(A,m=i),A);function A(){return m.call(this,t.Shader.COLOR2,v.Float,4)||this}t.Color2Attribute=S,(y=v=t.VertexAttributeType||(t.VertexAttributeType={}))[y.Float=0]="Float"}((Xt=Se=Se||{}).webgl||(Xt.webgl={})),Kt=Se=Se||{},jt=Kt.webgl||(Kt.webgl={}),tn.prototype.begin=function(t){var e=this.context.gl;if(this.isDrawing)throw new Error("PolygonBatch is already drawing. Call PolygonBatch.end() before calling PolygonBatch.begin()");this.drawCalls=0,this.shader=t,this.lastTexture=null,this.isDrawing=!0,e.enable(e.BLEND),e.blendFunc(this.srcBlend,this.dstBlend)},tn.prototype.setBlendMode=function(t,e){var n=this.context.gl;this.srcBlend=t,this.dstBlend=e,this.isDrawing&&(this.flush(),n.blendFunc(this.srcBlend,this.dstBlend))},tn.prototype.draw=function(t,e,n){t!=this.lastTexture?(this.flush(),this.lastTexture=t):(this.verticesLength+e.length>this.mesh.getVertices().length||this.indicesLength+n.length>this.mesh.getIndices().length)&&this.flush();var i=this.mesh.numVertices();this.mesh.getVertices().set(e,this.verticesLength),this.verticesLength+=e.length,this.mesh.setVerticesLength(this.verticesLength);for(var a=this.mesh.getIndices(),r=this.indicesLength,s=0;s<n.length;r++,s++)a[r]=n[s]+i;this.indicesLength+=n.length,this.mesh.setIndicesLength(this.indicesLength)},tn.prototype.flush=function(){var t=this.context.gl;0!=this.verticesLength&&(this.lastTexture.bind(),this.mesh.draw(this.shader,t.TRIANGLES),this.verticesLength=0,this.indicesLength=0,this.mesh.setVerticesLength(0),this.mesh.setIndicesLength(0),this.drawCalls++)},tn.prototype.end=function(){var t=this.context.gl;if(!this.isDrawing)throw new Error("PolygonBatch is not drawing. Call PolygonBatch.begin() before calling PolygonBatch.end()");(0<this.verticesLength||0<this.indicesLength)&&this.flush(),this.shader=null,this.lastTexture=null,this.isDrawing=!1,t.disable(t.BLEND)},tn.prototype.getDrawCalls=function(){return this.drawCalls},tn.prototype.dispose=function(){this.mesh.dispose()},qt=tn,jt.PolygonBatcher=qt,Zt=Se=Se||{},Jt=Zt.webgl||(Zt.webgl={}),en.prototype.begin=function(){this.camera.update(),this.enableRenderer(this.batcher)},en.prototype.drawSkeleton=function(t,e,n,i){void 0===e&&(e=!1),void 0===n&&(n=-1),void 0===i&&(i=-1),this.enableRenderer(this.batcher),this.skeletonRenderer.premultipliedAlpha=e,this.skeletonRenderer.draw(this.batcher,t,n,i)},en.prototype.drawSkeletonDebug=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=null),this.enableRenderer(this.shapes),this.skeletonDebugRenderer.premultipliedAlpha=e,this.skeletonDebugRenderer.draw(this.shapes,t,n)},en.prototype.drawTexture=function(t,e,n,i,a,r){void 0===r&&(r=null),this.enableRenderer(this.batcher),null===r&&(r=this.WHITE);var s=this.QUAD,o=0;s[o++]=e,s[o++]=n,s[o++]=r.r,s[o++]=r.g,s[o++]=r.b,s[o++]=r.a,s[o++]=0,s[o++]=1,this.twoColorTint&&(s[o++]=0,s[o++]=0,s[o++]=0,s[o++]=0),s[o++]=e+i,s[o++]=n,s[o++]=r.r,s[o++]=r.g,s[o++]=r.b,s[o++]=r.a,s[o++]=1,s[o++]=1,this.twoColorTint&&(s[o++]=0,s[o++]=0,s[o++]=0,s[o++]=0),s[o++]=e+i,s[o++]=n+a,s[o++]=r.r,s[o++]=r.g,s[o++]=r.b,s[o++]=r.a,s[o++]=1,s[o++]=0,this.twoColorTint&&(s[o++]=0,s[o++]=0,s[o++]=0,s[o++]=0),s[o++]=e,s[o++]=n+a,s[o++]=r.r,s[o++]=r.g,s[o++]=r.b,s[o++]=r.a,s[o++]=0,s[o++]=0,this.twoColorTint&&(s[o++]=0,s[o++]=0,s[o++]=0,s[o++]=0),this.batcher.draw(t,s,this.QUAD_TRIANGLES)},en.prototype.drawTextureUV=function(t,e,n,i,a,r,s,o,h,c){void 0===c&&(c=null),this.enableRenderer(this.batcher),null===c&&(c=this.WHITE);var l=this.QUAD,u=0;l[u++]=e,l[u++]=n,l[u++]=c.r,l[u++]=c.g,l[u++]=c.b,l[u++]=c.a,l[u++]=r,l[u++]=s,this.twoColorTint&&(l[u++]=0,l[u++]=0,l[u++]=0,l[u++]=0),l[u++]=e+i,l[u++]=n,l[u++]=c.r,l[u++]=c.g,l[u++]=c.b,l[u++]=c.a,l[u++]=o,l[u++]=s,this.twoColorTint&&(l[u++]=0,l[u++]=0,l[u++]=0,l[u++]=0),l[u++]=e+i,l[u++]=n+a,l[u++]=c.r,l[u++]=c.g,l[u++]=c.b,l[u++]=c.a,l[u++]=o,l[u++]=h,this.twoColorTint&&(l[u++]=0,l[u++]=0,l[u++]=0,l[u++]=0),l[u++]=e,l[u++]=n+a,l[u++]=c.r,l[u++]=c.g,l[u++]=c.b,l[u++]=c.a,l[u++]=r,l[u++]=h,this.twoColorTint&&(l[u++]=0,l[u++]=0,l[u++]=0,l[u++]=0),this.batcher.draw(t,l,this.QUAD_TRIANGLES)},en.prototype.drawTextureRotated=function(t,e,n,i,a,r,s,o,h,c){void 0===h&&(h=null),void 0===c&&(c=!1),this.enableRenderer(this.batcher),null===h&&(h=this.WHITE);var l,u,d=this.QUAD,p=e+r,f=n+s,g=-r,m=-s,v=i-r,y=a-s,S=g,A=m,E=g,x=y,b=v,T=y,w=v,C=m,M=0,I=0,P=0,k=0,R=0,O=0,_=0,D=0;k=0!=o?(P=(R=(l=Zt.MathUtils.cosDeg(o))*b-(u=Zt.MathUtils.sinDeg(o))*T)+((M=l*S-u*A)-(_=l*E-u*x)),(O=u*b+l*T)+((I=u*S+l*A)-(D=u*E+l*x))):(M=S,I=A,_=E,D=x,R=b,O=T,P=w,C),M+=p,I+=f,P+=p,k+=f,R+=p,O+=f,_+=p,D+=f;var L=0;d[L++]=M,d[L++]=I,d[L++]=h.r,d[L++]=h.g,d[L++]=h.b,d[L++]=h.a,d[L++]=0,d[L++]=1,this.twoColorTint&&(d[L++]=0,d[L++]=0,d[L++]=0,d[L++]=0),d[L++]=P,d[L++]=k,d[L++]=h.r,d[L++]=h.g,d[L++]=h.b,d[L++]=h.a,d[L++]=1,d[L++]=1,this.twoColorTint&&(d[L++]=0,d[L++]=0,d[L++]=0,d[L++]=0),d[L++]=R,d[L++]=O,d[L++]=h.r,d[L++]=h.g,d[L++]=h.b,d[L++]=h.a,d[L++]=1,d[L++]=0,this.twoColorTint&&(d[L++]=0,d[L++]=0,d[L++]=0,d[L++]=0),d[L++]=_,d[L++]=D,d[L++]=h.r,d[L++]=h.g,d[L++]=h.b,d[L++]=h.a,d[L++]=0,d[L++]=0,this.twoColorTint&&(d[L++]=0,d[L++]=0,d[L++]=0,d[L++]=0),this.batcher.draw(t,d,this.QUAD_TRIANGLES)},en.prototype.drawRegion=function(t,e,n,i,a,r,s){void 0===r&&(r=null),void 0===s&&(s=!1),this.enableRenderer(this.batcher),null===r&&(r=this.WHITE);var o=this.QUAD,h=0;o[h++]=e,o[h++]=n,o[h++]=r.r,o[h++]=r.g,o[h++]=r.b,o[h++]=r.a,o[h++]=t.u,o[h++]=t.v2,this.twoColorTint&&(o[h++]=0,o[h++]=0,o[h++]=0,o[h++]=0),o[h++]=e+i,o[h++]=n,o[h++]=r.r,o[h++]=r.g,o[h++]=r.b,o[h++]=r.a,o[h++]=t.u2,o[h++]=t.v2,this.twoColorTint&&(o[h++]=0,o[h++]=0,o[h++]=0,o[h++]=0),o[h++]=e+i,o[h++]=n+a,o[h++]=r.r,o[h++]=r.g,o[h++]=r.b,o[h++]=r.a,o[h++]=t.u2,o[h++]=t.v,this.twoColorTint&&(o[h++]=0,o[h++]=0,o[h++]=0,o[h++]=0),o[h++]=e,o[h++]=n+a,o[h++]=r.r,o[h++]=r.g,o[h++]=r.b,o[h++]=r.a,o[h++]=t.u,o[h++]=t.v,this.twoColorTint&&(o[h++]=0,o[h++]=0,o[h++]=0,o[h++]=0),this.batcher.draw(t.texture,o,this.QUAD_TRIANGLES)},en.prototype.line=function(t,e,n,i,a,r){void 0===a&&(a=null),void 0===r&&(r=null),this.enableRenderer(this.shapes),this.shapes.line(t,e,n,i,a)},en.prototype.triangle=function(t,e,n,i,a,r,s,o,h,c){void 0===o&&(o=null),void 0===h&&(h=null),void 0===c&&(c=null),this.enableRenderer(this.shapes),this.shapes.triangle(t,e,n,i,a,r,s,o,h,c)},en.prototype.quad=function(t,e,n,i,a,r,s,o,h,c,l,u,d){void 0===c&&(c=null),void 0===l&&(l=null),void 0===u&&(u=null),void 0===d&&(d=null),this.enableRenderer(this.shapes),this.shapes.quad(t,e,n,i,a,r,s,o,h,c,l,u,d)},en.prototype.rect=function(t,e,n,i,a,r){void 0===r&&(r=null),this.enableRenderer(this.shapes),this.shapes.rect(t,e,n,i,a,r)},en.prototype.rectLine=function(t,e,n,i,a,r,s){void 0===s&&(s=null),this.enableRenderer(this.shapes),this.shapes.rectLine(t,e,n,i,a,r,s)},en.prototype.polygon=function(t,e,n,i){void 0===i&&(i=null),this.enableRenderer(this.shapes),this.shapes.polygon(t,e,n,i)},en.prototype.circle=function(t,e,n,i,a,r){void 0===a&&(a=null),void 0===r&&(r=0),this.enableRenderer(this.shapes),this.shapes.circle(t,e,n,i,a,r)},en.prototype.curve=function(t,e,n,i,a,r,s,o,h,c){void 0===c&&(c=null),this.enableRenderer(this.shapes),this.shapes.curve(t,e,n,i,a,r,s,o,h,c)},en.prototype.end=function(){this.activeRenderer===this.batcher?this.batcher.end():this.activeRenderer===this.shapes&&this.shapes.end(),this.activeRenderer=null},en.prototype.resize=function(t){var e,n,i,a,r,s=this.canvas,o=s.clientWidth,h=s.clientHeight;s.width==o&&s.height==h||(s.width=o,s.height=h),this.context.gl.viewport(0,0,s.width,s.height),t===Qt.Stretch||(t===Qt.Expand?this.camera.setViewport(o,h):t===Qt.Fit&&(e=s.width,n=s.height,i=this.camera.viewportWidth,r=(a=this.camera.viewportHeight)/i<n/e?i/e:a/n,this.camera.viewportWidth=e*r,this.camera.viewportHeight=n*r)),this.camera.update()},en.prototype.enableRenderer=function(t){this.activeRenderer!==t&&(this.end(),t instanceof Jt.PolygonBatcher?(this.batcherShader.bind(),this.batcherShader.setUniform4x4f(Jt.Shader.MVP_MATRIX,ER()(this.camera.projectionView)),this.batcherShader.setUniformi("u_texture",0),this.batcher.begin(this.batcherShader),this.activeRenderer=this.batcher):t instanceof Jt.ShapeRenderer?(this.shapesShader.bind(),this.shapesShader.setUniform4x4f(Jt.Shader.MVP_MATRIX,ER()(this.camera.projectionView)),this.shapes.begin(this.shapesShader),this.activeRenderer=this.shapes):this.activeRenderer=this.skeletonDebugRenderer)},en.prototype.dispose=function(){this.batcher.dispose(),this.batcherShader.dispose(),this.shapes.dispose(),this.shapesShader.dispose(),this.skeletonDebugRenderer.dispose()},te=en,Jt.SceneRenderer=te,($t=Qt=Jt.ResizeMode||(Jt.ResizeMode={}))[$t.Stretch=0]="Stretch",$t[$t.Expand=1]="Expand",$t[$t.Fit=2]="Fit",ee=Se=Se||{},ne=ee.webgl||(ee.webgl={}),nn.prototype.getProgram=function(){return this.program},nn.prototype.getVertexShader=function(){return this.vertexShader},nn.prototype.getFragmentShader=function(){return this.fragmentShader},nn.prototype.getVertexShaderSource=function(){return this.vsSource},nn.prototype.getFragmentSource=function(){return this.fsSource},nn.prototype.compile=function(){var t=this.context.gl;try{this.vs=this.compileShader(t.VERTEX_SHADER,this.vertexShader),this.fs=this.compileShader(t.FRAGMENT_SHADER,this.fragmentShader),this.program=this.compileProgram(this.vs,this.fs)}catch(t){throw this.dispose(),t}},nn.prototype.compileShader=function(t,e){var n=this.context.gl,i=n.createShader(t);if(n.shaderSource(i,e),n.compileShader(i),!n.getShaderParameter(i,n.COMPILE_STATUS)){var a="Couldn't compile shader: "+n.getShaderInfoLog(i);if(n.deleteShader(i),!n.isContextLost())throw new Error(a)}return i},nn.prototype.compileProgram=function(t,e){var n=this.context.gl,i=n.createProgram();if(n.attachShader(i,t),n.attachShader(i,e),n.linkProgram(i),!n.getProgramParameter(i,n.LINK_STATUS)){var a="Couldn't compile shader program: "+n.getProgramInfoLog(i);if(n.deleteProgram(i),!n.isContextLost())throw new Error(a)}return i},nn.prototype.restore=function(){this.compile()},nn.prototype.bind=function(){this.context.gl.useProgram(this.program)},nn.prototype.unbind=function(){this.context.gl.useProgram(null)},nn.prototype.setUniformi=function(t,e){this.context.gl.uniform1i(this.getUniformLocation(t),e)},nn.prototype.setUniformf=function(t,e){this.context.gl.uniform1f(this.getUniformLocation(t),e)},nn.prototype.setUniform2f=function(t,e,n){this.context.gl.uniform2f(this.getUniformLocation(t),e,n)},nn.prototype.setUniform3f=function(t,e,n,i){this.context.gl.uniform3f(this.getUniformLocation(t),e,n,i)},nn.prototype.setUniform4f=function(t,e,n,i,a){this.context.gl.uniform4f(this.getUniformLocation(t),e,n,i,a)},nn.prototype.setUniform2x2f=function(t,e){var n=this.context.gl;this.tmp2x2.set(e),n.uniformMatrix2fv(this.getUniformLocation(t),!1,this.tmp2x2)},nn.prototype.setUniform3x3f=function(t,e){var n=this.context.gl;this.tmp3x3.set(e),n.uniformMatrix3fv(this.getUniformLocation(t),!1,this.tmp3x3)},nn.prototype.setUniform4x4f=function(t,e){var n=this.context.gl;this.tmp4x4.set(e),n.uniformMatrix4fv(this.getUniformLocation(t),!1,this.tmp4x4)},nn.prototype.getUniformLocation=function(t){var e=this.context.gl,n=e.getUniformLocation(this.program,t);if(!n&&!e.isContextLost())throw new Error("Couldn't find location for uniform "+t);return n},nn.prototype.getAttributeLocation=function(t){var e=this.context.gl,n=e.getAttribLocation(this.program,t);if(-1==n&&!e.isContextLost())throw new Error("Couldn't find location for attribute "+t);return n},nn.prototype.dispose=function(){this.context.removeRestorable(this);var t=this.context.gl;this.vs&&(t.deleteShader(this.vs),this.vs=null),this.fs&&(t.deleteShader(this.fs),this.fs=null),this.program&&(t.deleteProgram(this.program),this.program=null)},nn.newColoredTextured=function(t){return new nn(t,"\n\t\t\t\tattribute vec4 "+nn.POSITION+";\n\t\t\t\tattribute vec4 "+nn.COLOR+";\n\t\t\t\tattribute vec2 "+nn.TEXCOORDS+";\n\t\t\t\tuniform mat4 "+nn.MVP_MATRIX+";\n\t\t\t\tvarying vec4 v_color;\n\t\t\t\tvarying vec2 v_texCoords;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tv_color = "+nn.COLOR+";\n\t\t\t\t\tv_texCoords = "+nn.TEXCOORDS+";\n\t\t\t\t\tgl_Position = "+nn.MVP_MATRIX+" * "+nn.POSITION+";\n\t\t\t\t}\n\t\t\t","\n\t\t\t\t#ifdef GL_ES\n\t\t\t\t\t#define LOWP lowp\n\t\t\t\t\tprecision mediump float;\n\t\t\t\t#else\n\t\t\t\t\t#define LOWP\n\t\t\t\t#endif\n\t\t\t\tvarying LOWP vec4 v_color;\n\t\t\t\tvarying vec2 v_texCoords;\n\t\t\t\tuniform sampler2D u_texture;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tgl_FragColor = v_color * texture2D(u_texture, v_texCoords);\n\t\t\t\t}\n\t\t\t")},nn.newTwoColoredTextured=function(t){return new nn(t,"\n\t\t\t\tattribute vec4 "+nn.POSITION+";\n\t\t\t\tattribute vec4 "+nn.COLOR+";\n\t\t\t\tattribute vec4 "+nn.COLOR2+";\n\t\t\t\tattribute vec2 "+nn.TEXCOORDS+";\n\t\t\t\tuniform mat4 "+nn.MVP_MATRIX+";\n\t\t\t\tvarying vec4 v_light;\n\t\t\t\tvarying vec4 v_dark;\n\t\t\t\tvarying vec2 v_texCoords;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tv_light = "+nn.COLOR+";\n\t\t\t\t\tv_dark = "+nn.COLOR2+";\n\t\t\t\t\tv_texCoords = "+nn.TEXCOORDS+";\n\t\t\t\t\tgl_Position = "+nn.MVP_MATRIX+" * "+nn.POSITION+";\n\t\t\t\t}\n\t\t\t","\n\t\t\t\t#ifdef GL_ES\n\t\t\t\t\t#define LOWP lowp\n\t\t\t\t\tprecision mediump float;\n\t\t\t\t#else\n\t\t\t\t\t#define LOWP\n\t\t\t\t#endif\n\t\t\t\tvarying LOWP vec4 v_light;\n\t\t\t\tvarying LOWP vec4 v_dark;\n\t\t\t\tvarying vec2 v_texCoords;\n\t\t\t\tuniform sampler2D u_texture;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tvec4 texColor = texture2D(u_texture, v_texCoords);\n\t\t\t\t\tgl_FragColor.a = texColor.a * v_light.a;\n\t\t\t\t\tgl_FragColor.rgb = ((texColor.a - 1.0) * v_dark.a + 1.0 - texColor.rgb) * v_dark.rgb + texColor.rgb * v_light.rgb;\n\t\t\t\t}\n\t\t\t")},nn.newColored=function(t){return new nn(t,"\n\t\t\t\tattribute vec4 "+nn.POSITION+";\n\t\t\t\tattribute vec4 "+nn.COLOR+";\n\t\t\t\tuniform mat4 "+nn.MVP_MATRIX+";\n\t\t\t\tvarying vec4 v_color;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tv_color = "+nn.COLOR+";\n\t\t\t\t\tgl_Position = "+nn.MVP_MATRIX+" * "+nn.POSITION+";\n\t\t\t\t}\n\t\t\t","\n\t\t\t\t#ifdef GL_ES\n\t\t\t\t\t#define LOWP lowp\n\t\t\t\t\tprecision mediump float;\n\t\t\t\t#else\n\t\t\t\t\t#define LOWP\n\t\t\t\t#endif\n\t\t\t\tvarying LOWP vec4 v_color;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tgl_FragColor = v_color;\n\t\t\t\t}\n\t\t\t")},nn.MVP_MATRIX="u_projTrans",nn.POSITION="a_position",nn.COLOR="a_color",nn.COLOR2="a_color2",nn.TEXCOORDS="a_texCoords",nn.SAMPLER="u_texture",ie=nn,ne.Shader=ie,ae=Se=Se||{},re=ae.webgl||(ae.webgl={}),an.prototype.begin=function(t){if(this.isDrawing)throw new Error("ShapeRenderer.begin() has already been called");this.shader=t,this.vertexIndex=0,this.isDrawing=!0;var e=this.context.gl;e.enable(e.BLEND),e.blendFunc(this.srcBlend,this.dstBlend)},an.prototype.setBlendMode=function(t,e){var n=this.context.gl;this.srcBlend=t,this.dstBlend=e,this.isDrawing&&(this.flush(),n.blendFunc(this.srcBlend,this.dstBlend))},an.prototype.setColor=function(t){this.color.setFromColor(t)},an.prototype.setColorWith=function(t,e,n,i){this.color.set(t,e,n,i)},an.prototype.point=function(t,e,n){void 0===n&&(n=null),this.check(se.Point,1),null===n&&(n=this.color),this.vertex(t,e,n)},an.prototype.line=function(t,e,n,i,a){void 0===a&&(a=null),this.check(se.Line,2),this.mesh.getVertices(),this.vertexIndex,null===a&&(a=this.color),this.vertex(t,e,a),this.vertex(n,i,a)},an.prototype.triangle=function(t,e,n,i,a,r,s,o,h,c){void 0===o&&(o=null),void 0===h&&(h=null),void 0===c&&(c=null),this.check(t?se.Filled:se.Line,3),this.mesh.getVertices(),this.vertexIndex,null===o&&(o=this.color),null===h&&(h=this.color),null===c&&(c=this.color),t?(this.vertex(e,n,o),this.vertex(i,a,h),this.vertex(r,s,c)):(this.vertex(e,n,o),this.vertex(i,a,h),this.vertex(i,a,o),this.vertex(r,s,h),this.vertex(r,s,o),this.vertex(e,n,h))},an.prototype.quad=function(t,e,n,i,a,r,s,o,h,c,l,u,d){void 0===c&&(c=null),void 0===l&&(l=null),void 0===u&&(u=null),void 0===d&&(d=null),this.check(t?se.Filled:se.Line,3),this.mesh.getVertices(),this.vertexIndex,null===c&&(c=this.color),null===l&&(l=this.color),null===u&&(u=this.color),null===d&&(d=this.color),t?(this.vertex(e,n,c),this.vertex(i,a,l),this.vertex(r,s,u),this.vertex(r,s,u)):(this.vertex(e,n,c),this.vertex(i,a,l),this.vertex(i,a,l),this.vertex(r,s,u),this.vertex(r,s,u),this.vertex(o,h,d)),this.vertex(o,h,d),this.vertex(e,n,c)},an.prototype.rect=function(t,e,n,i,a,r){void 0===r&&(r=null),this.quad(t,e,n,e+i,n,e+i,n+a,e,n+a,r,r,r,r)},an.prototype.rectLine=function(t,e,n,i,a,r,s){void 0===s&&(s=null),this.check(t?se.Filled:se.Line,8),null===s&&(s=this.color);var o=this.tmp.set(a-n,e-i);o.normalize(),r*=.5;var h=o.x*r,c=o.y*r;t?(this.vertex(e+h,n+c,s),this.vertex(e-h,n-c,s),this.vertex(i+h,a+c,s),this.vertex(i-h,a-c,s),this.vertex(i+h,a+c,s)):(this.vertex(e+h,n+c,s),this.vertex(e-h,n-c,s),this.vertex(i+h,a+c,s),this.vertex(i-h,a-c,s),this.vertex(i+h,a+c,s),this.vertex(e+h,n+c,s),this.vertex(i-h,a-c,s)),this.vertex(e-h,n-c,s)},an.prototype.x=function(t,e,n){this.line(t-n,e-n,t+n,e+n),this.line(t-n,e+n,t+n,e-n)},an.prototype.polygon=function(t,e,n,i){if(void 0===i&&(i=null),n<3)throw new Error("Polygon must contain at least 3 vertices");this.check(se.Line,2*n),null===i&&(i=this.color),this.mesh.getVertices(),this.vertexIndex,n<<=1;for(var a=t[e<<=1],r=t[e+1],s=e+n,o=e,h=e+n-2;o<h;o+=2){var c=t[o],l=t[o+1],u=0,d=s<=o+2?(u=a,r):(u=t[o+2],t[o+3]);this.vertex(c,l,i),this.vertex(u,d,i)}},an.prototype.circle=function(t,e,n,i,a,r){if(void 0===a&&(a=null),void 0===r&&(r=0),0===r&&(r=Math.max(1,6*ae.MathUtils.cbrt(i)|0)),r<=0)throw new Error("segments must be > 0.");null===a&&(a=this.color);var s=2*ae.MathUtils.PI/r,o=Math.cos(s),h=Math.sin(s),c=i,l=0;if(t){for(this.check(se.Filled,3*r+3),r--,d=0;d<r;d++){this.vertex(e,n,a),this.vertex(e+c,n+l,a);var u=c;c=o*c-h*l,l=h*u+o*l,this.vertex(e+c,n+l,a)}this.vertex(e,n,a),this.vertex(e+c,n+l,a)}else{this.check(se.Line,2*r+2);for(var d=0;d<r;d++){this.vertex(e+c,n+l,a);var p=c;c=o*c-h*l,l=h*p+o*l;this.vertex(e+c,n+l,a)}this.vertex(e+c,n+l,a)}c=i,l=0,this.vertex(e+c,n+l,a)},an.prototype.curve=function(t,e,n,i,a,r,s,o,h,c){void 0===c&&(c=null),this.check(se.Line,2*h+2),null===c&&(c=this.color);for(var l=1/h,u=l*l,d=l*l*l,p=3*l,f=3*u,g=6*u,m=6*d,v=t-2*n+a,y=e-2*i+r,S=3*(n-a)-t+s,A=3*(i-r)-e+o,E=t,x=e,b=(n-t)*p+v*f+S*d,T=(i-e)*p+y*f+A*d,w=v*g+S*m,C=y*g+A*m,M=S*m,I=A*m;0<h--;)this.vertex(E,x,c),E+=b,x+=T,b+=w,T+=C,w+=M,C+=I,this.vertex(E,x,c);this.vertex(E,x,c),this.vertex(s,o,c)},an.prototype.vertex=function(t,e,n){var i=this.vertexIndex,a=this.mesh.getVertices();a[i++]=t,a[i++]=e,a[i++]=n.r,a[i++]=n.g,a[i++]=n.b,a[i++]=n.a,this.vertexIndex=i},an.prototype.end=function(){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");this.flush(),this.context.gl.disable(this.context.gl.BLEND),this.isDrawing=!1},an.prototype.flush=function(){0!=this.vertexIndex&&(this.mesh.setVerticesLength(this.vertexIndex),this.mesh.draw(this.shader,this.shapeType),this.vertexIndex=0)},an.prototype.check=function(t,e){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");if(this.shapeType==t){if(!(this.mesh.maxVertices()-this.mesh.numVertices()<e))return;this.flush()}else this.flush(),this.shapeType=t},an.prototype.dispose=function(){this.mesh.dispose()},he=an,re.ShapeRenderer=he,(oe=se=re.ShapeType||(re.ShapeType={}))[oe.Point=0]="Point",oe[oe.Line=1]="Line",oe[oe.Filled=4]="Filled",ce=Se=Se||{},le=ce.webgl||(ce.webgl={}),rn.prototype.draw=function(t,e,n){void 0===n&&(n=null);var i=e.x,a=e.y,r=this.context.gl,s=this.premultipliedAlpha?r.ONE:r.SRC_ALPHA;t.setBlendMode(s,r.ONE_MINUS_SRC_ALPHA);var o=e.bones;if(this.drawBones){t.setColor(this.boneLineColor);for(var h=0,c=o.length;h<c;h++){var l=o[h];n&&-1<g()(n).call(n,l.data.name)||null!=l.parent&&(b=i+l.data.length*l.a+l.worldX,T=a+l.data.length*l.c+l.worldY,t.rectLine(!0,i+l.worldX,a+l.worldY,b,T,this.boneWidth*this.scale))}this.drawSkeletonXY&&t.x(i,a,4*this.scale)}if(this.drawRegionAttachments)for(t.setColor(this.attachmentLineColor),h=0,c=(U=e.slots).length;h<c;h++)(Y=(V=U[h]).getAttachment())instanceof ce.RegionAttachment&&(d=this.vertices,Y.computeWorldVertices(V.bone,d,0,2),t.line(d[0],d[1],d[2],d[3]),t.line(d[2],d[3],d[4],d[5]),t.line(d[4],d[5],d[6],d[7]),t.line(d[6],d[7],d[0],d[1]));if(this.drawMeshHull||this.drawMeshTriangles)for(h=0,c=(U=e.slots).length;h<c;h++)if((V=U[h]).bone.active&&(Y=V.getAttachment())instanceof ce.MeshAttachment){var u=Y,d=this.vertices;u.computeWorldVertices(V,0,u.worldVerticesLength,d,0,2);var p=u.triangles,f=u.hullLength;if(this.drawMeshTriangles){t.setColor(this.triangleLineColor);for(var m=0,v=p.length;m<v;m+=3){var y=2*p[m],S=2*p[m+1],A=2*p[m+2];t.triangle(!1,d[y],d[1+y],d[S],d[1+S],d[A],d[1+A])}}if(this.drawMeshHull&&0<f){t.setColor(this.attachmentLineColor);var E=d[(f=2*(f>>1))-2],x=d[f-1];for(m=0,v=f;m<v;m+=2){var b=d[m],T=d[m+1];t.line(b,T,E,x),E=b,x=T}}}if(this.drawBoundingBoxes){var w=this.bounds;w.update(e,!0),t.setColor(this.aabbColor),t.rect(!1,w.minX,w.minY,w.getWidth(),w.getHeight());var C=w.polygons,M=w.boundingBoxes;for(h=0,c=C.length;h<c;h++){var I=C[h];t.setColor(M[h].color),t.polygon(I,0,I.length)}}if(this.drawPaths)for(h=0,c=(U=e.slots).length;h<c;h++)if((V=U[h]).bone.active&&(Y=V.getAttachment())instanceof ce.PathAttachment){var P=Y,k=(v=P.worldVerticesLength,this.temp=ce.Utils.setArraySize(this.temp,v,0));P.computeWorldVertices(V,0,v,k,0,2);var R=this.pathColor,O=k[2],_=k[3],D=0,L=0;for(P.closed&&(t.setColor(R),B=k[0],F=k[1],N=k[v-2],G=k[v-1],D=k[v-4],L=k[v-3],t.curve(O,_,B,F,N,G,D,L,32),t.setColor(rn.LIGHT_GRAY),t.line(O,_,B,F),t.line(D,L,N,G)),v-=4,m=4;m<v;m+=6){var B=k[m],F=k[m+1],N=k[m+2],G=k[m+3];D=k[m+4],L=k[m+5],t.setColor(R),t.curve(O,_,B,F,N,G,D,L,32),t.setColor(rn.LIGHT_GRAY),t.line(O,_,B,F),t.line(D,L,N,G),O=D,_=L}}if(this.drawBones)for(t.setColor(this.boneOriginColor),h=0,c=o.length;h<c;h++)l=o[h],n&&-1<g()(n).call(n,l.data.name)||t.circle(!0,i+l.worldX,a+l.worldY,3*this.scale,rn.GREEN,8);if(this.drawClipping){var U=e.slots;t.setColor(this.clipColor);var V,Y;for(h=0,c=U.length;h<c;h++)if((V=U[h]).bone.active&&(Y=V.getAttachment())instanceof ce.ClippingAttachment){var z=Y;v=z.worldVerticesLength,k=this.temp=ce.Utils.setArraySize(this.temp,v,0);z.computeWorldVertices(V,0,v,k,0,2);for(var H=0,W=k.length;H<W;H+=2)b=k[H],T=k[H+1],D=k[(H+2)%k.length],L=k[(H+3)%k.length],t.line(b,T,D,L)}}},rn.prototype.dispose=function(){},rn.LIGHT_GRAY=new ce.Color(192/255,192/255,192/255,1),rn.GREEN=new ce.Color(0,1,0,1),ue=rn,le.SkeletonDebugRenderer=ue,de=Se=Se||{},pe=de.webgl||(de.webgl={}),fe=function(t,e,n){this.vertices=t,this.numVertices=e,this.numFloats=n},sn.prototype.draw=function(t,e,n,i){void 0===n&&(n=-1),void 0===i&&(i=-1);var a=this.clipper,r=this.premultipliedAlpha,s=this.twoColorTint,o=null,h=this.temp,c=this.temp2,l=this.temp3,u=this.temp4,d=this.renderable,p=null,f=null,g=e.drawOrder,m=null,v=e.color,y=s?12:8,S=!1;-1==n&&(S=!0);for(var A=0,E=g.length;A<E;A++){var x=a.isClipping()?2:y,b=g[A];if(b.bone.active)if(0<=n&&n==b.data.index&&(S=!0),S){0<=i&&i==b.data.index&&(S=!1);var T=b.getAttachment(),w=null;if(T instanceof de.RegionAttachment){var C=T;d.vertices=this.vertices,d.numVertices=4,d.numFloats=x<<2,C.computeWorldVertices(b.bone,d.vertices,0,x),f=sn.QUAD_TRIANGLES,p=C.uvs,w=C.region.renderObject.texture,m=C.color}else{if(!(T instanceof de.MeshAttachment)){if(T instanceof de.ClippingAttachment){a.clipStart(b,T);continue}a.clipEndWithSlot(b);continue}var M=T;d.vertices=this.vertices,d.numVertices=M.worldVerticesLength>>1,d.numFloats=d.numVertices*x,d.numFloats>d.vertices.length&&(d.vertices=this.vertices=de.Utils.newFloatArray(d.numFloats)),M.computeWorldVertices(b,0,M.worldVerticesLength,d.vertices,0,x),f=M.triangles,w=M.region.renderObject.texture,p=M.uvs,m=M.color}if(null!=w){var I=b.color,P=this.tempColor;P.r=v.r*I.r*m.r,P.g=v.g*I.g*m.g,P.b=v.b*I.b*m.b,P.a=v.a*I.a*m.a,r&&(P.r*=P.a,P.g*=P.a,P.b*=P.a);var k=this.tempColor2;null==b.darkColor?k.set(0,0,0,1):(r?(k.r=b.darkColor.r*P.a,k.g=b.darkColor.g*P.a,k.b=b.darkColor.b*P.a):k.setFromColor(b.darkColor),k.a=r?1:0);var R=b.data.blendMode;if(R!=o&&(o=R,t.setBlendMode(pe.WebGLBlendModeConverter.getSourceGLBlendMode(o,r),pe.WebGLBlendModeConverter.getDestGLBlendMode(o))),a.isClipping()){a.clipTriangles(d.vertices,d.numFloats,f,f.length,p,P,k,s);var O=new Float32Array(a.clippedVertices),_=a.clippedTriangles;if(null!=this.vertexEffect){var D=this.vertexEffect,L=O;if(s)for(var B=0,F=O.length;B<F;B+=y)h.x=L[B],h.y=L[B+1],l.set(L[B+2],L[B+3],L[B+4],L[B+5]),c.x=L[B+6],c.y=L[B+7],u.set(L[B+8],L[B+9],L[B+10],L[B+11]),D.transform(h,c,l,u),L[B]=h.x,L[B+1]=h.y,L[B+2]=l.r,L[B+3]=l.g,L[B+4]=l.b,L[B+5]=l.a,L[B+6]=c.x,L[B+7]=c.y,L[B+8]=u.r,L[B+9]=u.g,L[B+10]=u.b,L[B+11]=u.a;else{B=0;for(var N=O.length;B<N;B+=y)h.x=L[B],h.y=L[B+1],l.set(L[B+2],L[B+3],L[B+4],L[B+5]),c.x=L[B+6],c.y=L[B+7],u.set(0,0,0,0),D.transform(h,c,l,u),L[B]=h.x,L[B+1]=h.y,L[B+2]=l.r,L[B+3]=l.g,L[B+4]=l.b,L[B+5]=l.a,L[B+6]=c.x,L[B+7]=c.y}}t.draw(w,O,_)}else{if(L=d.vertices,null!=this.vertexEffect)if(D=this.vertexEffect,s){B=0;for(var G=0,U=d.numFloats;B<U;B+=y,G+=2)h.x=L[B],h.y=L[B+1],c.x=p[G],c.y=p[G+1],l.setFromColor(P),u.setFromColor(k),D.transform(h,c,l,u),L[B]=h.x,L[B+1]=h.y,L[B+2]=l.r,L[B+3]=l.g,L[B+4]=l.b,L[B+5]=l.a,L[B+6]=c.x,L[B+7]=c.y,L[B+8]=u.r,L[B+9]=u.g,L[B+10]=u.b,L[B+11]=u.a}else{B=0,G=0;for(var V=d.numFloats;B<V;B+=y,G+=2)h.x=L[B],h.y=L[B+1],c.x=p[G],c.y=p[G+1],l.setFromColor(P),u.set(0,0,0,0),D.transform(h,c,l,u),L[B]=h.x,L[B+1]=h.y,L[B+2]=l.r,L[B+3]=l.g,L[B+4]=l.b,L[B+5]=l.a,L[B+6]=c.x,L[B+7]=c.y}else if(s){B=2,G=0;for(var Y=d.numFloats;B<Y;B+=y,G+=2)L[B]=P.r,L[B+1]=P.g,L[B+2]=P.b,L[B+3]=P.a,L[B+4]=p[G],L[B+5]=p[G+1],L[B+6]=k.r,L[B+7]=k.g,L[B+8]=k.b,L[B+9]=k.a}else{B=2,G=0;for(var z=d.numFloats;B<z;B+=y,G+=2)L[B]=P.r,L[B+1]=P.g,L[B+2]=P.b,L[B+3]=P.a,L[B+4]=p[G],L[B+5]=p[G+1]}var H=d.vertices.subarray(0,d.numFloats);t.draw(w,H,f)}}a.clipEndWithSlot(b)}else a.clipEndWithSlot(b);else a.clipEndWithSlot(b)}a.clipEnd()},sn.QUAD_TRIANGLES=[0,1,2,2,3,0],ge=sn,pe.SkeletonRenderer=ge,me=Se=Se||{},ve=me.webgl||(me.webgl={}),on.prototype.setFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},on.prototype.set=function(t,e,n){return this.x=t,this.y=e,this.z=n,this},on.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},on.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},on.prototype.scale=function(t){return this.x*=t,this.y*=t,this.z*=t,this},on.prototype.normalize=function(){var t=this.length();return 0==t||(t=1/t,this.x*=t,this.y*=t,this.z*=t),this},on.prototype.cross=function(t){return this.set(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},on.prototype.multiply=function(t){var e=ER()(t);return this.set(this.x*e[ve.M00]+this.y*e[ve.M01]+this.z*e[ve.M02]+e[ve.M03],this.x*e[ve.M10]+this.y*e[ve.M11]+this.z*e[ve.M12]+e[ve.M13],this.x*e[ve.M20]+this.y*e[ve.M21]+this.z*e[ve.M22]+e[ve.M23])},on.prototype.project=function(t){var e=ER()(t),n=1/(this.x*e[ve.M30]+this.y*e[ve.M31]+this.z*e[ve.M32]+e[ve.M33]);return this.set((this.x*e[ve.M00]+this.y*e[ve.M01]+this.z*e[ve.M02]+e[ve.M03])*n,(this.x*e[ve.M10]+this.y*e[ve.M11]+this.z*e[ve.M12]+e[ve.M13])*n,(this.x*e[ve.M20]+this.y*e[ve.M21]+this.z*e[ve.M22]+e[ve.M23])*n)},on.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},on.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},on.prototype.distance=function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z;return Math.sqrt(e*e+n*n+i*i)},ye=on,ve.Vector3=ye,function(t){var e=(n.prototype.setupCanvas=function(t,e){var n=this;this.gl=t.getContext("webgl2",e)||t.getContext("webgl",e),(this.canvas=t).addEventListener("webglcontextlost",(function(t){t&&t.preventDefault()})),t.addEventListener("webglcontextrestored",(function(t){for(var e=0,i=n.restorables.length;e<i;e++)n.restorables[e].restore()}))},n.prototype.addRestorable=function(t){this.restorables.push(t)},n.prototype.removeRestorable=function(t){var e,n,i=g()(e=this.restorables).call(e,t);-1<i&&ds()(n=this.restorables).call(n,i,1)},n);function n(t,e){void 0===e&&(e={alpha:"true"}),this.restorables=new Array,t instanceof HTMLCanvasElement||t instanceof EventTarget?this.setupCanvas(t,e):(this.gl=t,this.canvas=this.gl.canvas)}t.ManagedWebGLRenderingContext=e;var i=(a.getDestGLBlendMode=function(t){switch(t){case Ae.BlendMode.Normal:return a.ONE_MINUS_SRC_ALPHA;case Ae.BlendMode.Additive:return a.ONE;case Ae.BlendMode.Multiply:case Ae.BlendMode.Screen:return a.ONE_MINUS_SRC_ALPHA;default:throw new Error("Unknown blend mode: "+t)}},a.getSourceGLBlendMode=function(t,e){switch(void 0===e&&(e=!1),t){case Ae.BlendMode.Normal:case Ae.BlendMode.Additive:return e?a.ONE:a.SRC_ALPHA;case Ae.BlendMode.Multiply:return a.DST_COLOR;case Ae.BlendMode.Screen:return a.ONE;default:throw new Error("Unknown blend mode: "+t)}},a.ZERO=0,a.ONE=1,a.SRC_COLOR=768,a.ONE_MINUS_SRC_COLOR=769,a.SRC_ALPHA=770,a.ONE_MINUS_SRC_ALPHA=771,a.DST_ALPHA=772,a.ONE_MINUS_DST_ALPHA=773,a.DST_COLOR=774,a);function a(){}t.WebGLBlendModeConverter=i}((Ae=Se=Se||{}).webgl||(Ae.webgl={})),t.exports=Se}).call(window)},function(t,e,n){var i=n(0),a=n(11),r=n(204),s=n(7),o=n(218),h=n(219),c=n(220),l=new i({Extends:h,initialize:function(t,e,n,i,r,l,u){var d,p,f,g=[],m=t.cacheManager.custom.spine;if(s(e)){var v=e;for(e=a(v,"key"),p=new o(t,{key:e,url:a(v,"jsonURL"),extension:a(v,"jsonExtension","json"),xhrSettings:a(v,"jsonXhrSettings")}),i=a(v,"atlasURL"),r=a(v,"preMultipliedAlpha"),Array.isArray(i)||(i=[i]),d=0;d<i.length;d++)(f=new c(t,{key:e+"!"+d,url:i[d],extension:a(v,"atlasExtension","atlas"),xhrSettings:a(v,"atlasXhrSettings")})).cache=m,g.push(f)}else for(p=new o(t,e,n,l),Array.isArray(i)||(i=[i]),d=0;d<i.length;d++)(f=new c(t,e+"!"+d,i[d],u)).cache=m,g.push(f);g.unshift(p),h.call(this,t,"spine",e,g),this.config.preMultipliedAlpha=r},onFileComplete:function(t){var e;if(-1!==g()(e=this.files).call(e,t)&&(this.pending--,"text"===t.type)){for(var n=t.data.split("\n"),i=[],s=0;s<n.length;s++){var o=n[s];""===$p()(o).call(o)&&s<n.length-1&&(o=n[s+1],i.push(o))}var h=this.config,c=this.loader,l=c.baseURL,u=c.path,d=c.prefix,p=a(h,"baseURL",this.baseURL),f=a(h,"path",t.src.match(/^.*\//))[0],m=a(h,"prefix",this.prefix),v=a(h,"textureXhrSettings");c.setBaseURL(p),c.setPath(f),c.setPrefix(m);for(var y=0;y<i.length;y++){var S=i[y],A=new r(c,S,S,v);c.keyExists(A)||(this.addToMultiFile(A),c.addFile(A))}c.setBaseURL(l),c.setPath(u),c.setPrefix(d)}},addToCache:function(){if(this.isReadyToProcess()){var t;this.files[0].addToCache();for(var e="",n="",i=!!this.config.preMultipliedAlpha,a=this.loader.textureManager,r=1;r<this.files.length;r++){var s,o,h,c,l,u=this.files[r];"text"===u.type?(e=u.key.replace(/![\d]$/,""),t=u.cache,n=et()(n).call(n,u.data)):(c=g()(s=h=$p()(o=u.key).call(o)).call(s,"!"),l=h.substr(c+1),a.exists(l)||a.addImage(l,u.data)),u.pendingDestroy()}t.add(e,{preMultipliedAlpha:i,data:n,prefix:this.prefix}),this.complete=!0}}});t.exports=l},function(t,e,n){var i=n(0),a=n(15),r=n(21),s=n(22),o=n(11),h=n(7),c=new i({Extends:r,initialize:function t(e,n,i,a,s){var c,l,u="png";h(n)&&(n=o(l=n,"key"),i=o(l,"url"),c=o(l,"normalMap"),a=o(l,"xhrSettings"),u=o(l,"extension",u),s=o(l,"frameConfig")),Array.isArray(i)&&(c=i[1],i=i[0]);var d,p={type:"image",cache:e.textureManager,extension:u,responseType:"blob",key:n,url:i,xhrSettings:a,config:s};r.call(this,e,p),c&&((d=new t(e,this.key,c,a,s)).type="normalMap",this.setLink(d),e.addFile(d))},onProcess:function(){this.state=a.FILE_PROCESSING,this.data=new Image,this.data.crossOrigin=this.crossOrigin;var t=this;this.data.onload=function(){r.revokeObjectURL(t.data),t.onProcessComplete()},this.data.onerror=function(){r.revokeObjectURL(t.data),t.onProcessError()},r.createObjectURL(this.data,this.xhrLoader.response,"image/png")},addToCache:function(){var t,e=this.linkFile;e&&e.state===a.FILE_COMPLETE?(t="image"===this.type?this.cache.addImage(this.key,this.data,e.data):this.cache.addImage(e.key,e.data,this.data),this.pendingDestroy(t),e.pendingDestroy(t)):e||(t=this.cache.addImage(this.key,this.data),this.pendingDestroy(t))}});s.register("image",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new c(this,t[i]));else this.addFile(new c(this,t,e,n));return this})),t.exports=c},function(t,e,n){t.exports={ADD:n(206),COMPLETE:n(207),FILE_COMPLETE:n(208),FILE_KEY_COMPLETE:n(209),FILE_LOAD_ERROR:n(210),FILE_LOAD:n(211),FILE_PROGRESS:n(212),POST_PROCESS:n(213),PROGRESS:n(214),START:n(215)}},function(t,e){t.exports="addfile"},function(t,e){t.exports="complete"},function(t,e){t.exports="filecomplete"},function(t,e){t.exports="filecomplete-"},function(t,e){t.exports="loaderror"},function(t,e){t.exports="load"},function(t,e){t.exports="fileprogress"},function(t,e){t.exports="postprocess"},function(t,e){t.exports="progress"},function(t,e){t.exports="start"},function(t,e){t.exports=function(t,e){return!!t.url&&(t.url.match(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/)?t.url:e+t.url)}},function(t,e,n){var i=n(45);t.exports=function(t,e){var n=i(e,t.xhrSettings),a=new XMLHttpRequest;if(a.open("GET",t.src,n.async,n.user,n.password),a.responseType=t.xhrSettings.responseType,a.timeout=n.timeout,n.headers)for(var r in n.headers)a.setRequestHeader(r,n.headers[r]);return n.header&&n.headerValue&&a.setRequestHeader(n.header,n.headerValue),n.requestedWith&&a.setRequestHeader("X-Requested-With",n.requestedWith),n.overrideMimeType&&a.overrideMimeType(n.overrideMimeType),n.withCredentials&&(a.withCredentials=!0),a.onload=t.onLoad.bind(t,a),a.onerror=t.onError.bind(t,a),a.onprogress=t.onProgress.bind(t),a.send(),a}},function(t,e,n){var i=n(0),a=n(15),r=n(21),s=n(22),o=n(11),h=n(10),c=n(7),l=new i({Extends:r,initialize:function(t,e,n,i,s){var l,u="json";c(e)&&(e=o(l=e,"key"),n=o(l,"url"),i=o(l,"xhrSettings"),u=o(l,"extension",u),s=o(l,"dataKey",s));var d={type:"json",cache:t.cacheManager.json,extension:u,responseType:"text",key:e,url:n,xhrSettings:i,config:s};r.call(this,t,d),c(n)&&(this.data=s?h(n,s):n,this.state=a.FILE_POPULATED)},onProcess:function(){if(this.state!==a.FILE_POPULATED){this.state=a.FILE_PROCESSING;try{var t=JSON.parse(this.xhrLoader.responseText)}catch(t){throw this.onProcessError(),t}var e=this.config;this.data="string"==typeof e?h(t,e,t):t}this.onProcessComplete()}});s.register("json",(function(t,e,n,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)this.addFile(new l(this,t[a]));else this.addFile(new l(this,t,e,i,n));return this})),t.exports=l},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n,i){var a=[];i.forEach((function(t){t&&a.push(t)})),this.loader=t,this.type=e,this.key=n,this.multiKeyIndex=t.multiKeyIndex++,this.files=a,this.complete=!1,this.pending=a.length,this.failed=0,this.config={},this.baseURL=t.baseURL,this.path=t.path,this.prefix=t.prefix;for(var r=0;r<a.length;r++)a[r].multiFile=this},isReadyToProcess:function(){return 0===this.pending&&0===this.failed&&!this.complete},addToMultiFile:function(t){return this.files.push(t),(t.multiFile=this).pending++,this.complete=!1,this},onFileComplete:function(t){var e;-1!==g()(e=this.files).call(e,t)&&this.pending--},onFileFailed:function(t){var e;-1!==g()(e=this.files).call(e,t)&&this.failed++}});t.exports=i},function(t,e,n){var i=n(0),a=n(15),r=n(21),s=n(22),o=n(11),h=n(7),c=new i({Extends:r,initialize:function(t,e,n,i){var a,s="text",c="txt",l=t.cacheManager.text;h(e)&&(e=o(a=e,"key"),n=o(a,"url"),i=o(a,"xhrSettings"),c=o(a,"extension",c),s=o(a,"type",s),l=o(a,"cache",l));var u={type:s,cache:l,extension:c,responseType:"text",key:e,url:n,xhrSettings:i};r.call(this,t,u)},onProcess:function(){this.state=a.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()}});s.register("text",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new c(this,t[i]));else this.addFile(new c(this,t,e,n));return this})),t.exports=c},function(t,e,n){var i=n(28),a=n(3),r=n(0),s=n(47),o=n(48),h=n(49),c=n(50),l=n(51),u=n(52),d=n(8),p=n(19),f=n(53),g=n(9),m=n(243),v=n(250),y=new r({Extends:f,Mixins:[s,o,h,c,l,u,v],initialize:function(t,e,n,i,a,r,s){f.call(this,t,"Spine"),this.plugin=e,this.skeleton=null,this.skeletonData=null,this.state=null,this.stateData=null,this.root=null,this.bounds=null,this.drawDebug=!1,this.timeScale=1,this.displayOriginX=0,this.displayOriginY=0,this.preMultipliedAlpha=!1,this.blendMode=-1,this.setPosition(n,i),a&&this.setSkeleton(a,r,s)},willRender:function(t,e){var n,i,a=!this.skeleton||!(15!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&t.id);return e||a||!this.parentContainer||(i=(n=this.plugin).sceneRenderer,n.gl&&i.batcher.isDrawing&&(i.end(),n.renderer.pipelines.rebind())),a},setAlpha:function(t,e){var n;return void 0===t&&(t=1),e?(n=this.findSlot(e))&&(n.color.a=a(t,0,1)):this.alpha=t,this},alpha:{get:function(){return this.skeleton.color.a},set:function(t){var e=a(t,0,1);this.skeleton&&(this.skeleton.color.a=e),0===e?this.renderFlags&=-3:this.renderFlags|=2}},red:{get:function(){return this.skeleton.color.r},set:function(t){var e=a(t,0,1);this.skeleton&&(this.skeleton.color.r=e)}},green:{get:function(){return this.skeleton.color.g},set:function(t){var e=a(t,0,1);this.skeleton&&(this.skeleton.color.g=e)}},blue:{get:function(){return this.skeleton.color.b},set:function(t){var e=a(t,0,1);this.skeleton&&(this.skeleton.color.b=e)}},setColor:function(t,e){void 0===t&&(t=16777215);var n,i=(t>>16&255)/255,a=(t>>8&255)/255,r=(255&t)/255,s=16777215<t?(t>>>24)/255:null,o=this.skeleton;return!e||(n=this.findSlot(e))&&(o=n),o.color.r=i,o.color.g=a,o.color.b=r,null!==s&&(o.color.a=s),this},setSkeletonFromJSON:function(t,e,n,i){return this.setSkeleton(t,e,n,i)},setSkeleton:function(t,e,n,i){this.state&&(this.state.clearListeners(),this.state.clearListenerNotifications());var a=this.plugin.createSkeleton(t,i);this.skeletonData=a.skeletonData,this.preMultipliedAlpha=a.preMultipliedAlpha;var r=a.skeleton;return r.setSkin(),r.setToSetupPose(),this.skeleton=r,a=this.plugin.createAnimationState(r),this.state&&(this.state.clearListeners(),this.state.clearListenerNotifications()),this.state=a.state,this.stateData=a.stateData,this.state.addListener({event:this.onEvent.bind(this),complete:this.onComplete.bind(this),start:this.onStart.bind(this),end:this.onEnd.bind(this),dispose:this.onDispose.bind(this),interrupted:this.onInterrupted.bind(this)}),e&&this.setAnimation(0,e,n),this.root=this.getRootBone(),this.root&&(this.root.rotation=g(d(this.rotation))+90),this.state.apply(r),r.updateCache(),this.updateSize()},onComplete:function(t){this.emit(m.COMPLETE,t)},onDispose:function(t){this.emit(m.DISPOSE,t)},onEnd:function(t){this.emit(m.END,t)},onEvent:function(t,e){this.emit(m.EVENT,t,e)},onInterrupted:function(t){this.emit(m.INTERRUPTED,t)},onStart:function(t){this.emit(m.START,t)},refresh:function(){return this.root&&(this.root.rotation=g(d(this.rotation))+90),this.updateSize(),this.skeleton.updateCache(),this},setSize:function(t,e,n,i){var a=this.skeleton;return void 0===t&&(t=a.data.width),void 0===e&&(e=a.data.height),void 0===n&&(n=0),void 0===i&&(i=0),this.width=t,this.height=e,this.displayOriginX=a.x-n,this.displayOriginY=a.y-i,this},setOffset:function(t,e){var n=this.skeleton;return void 0===t&&(t=0),void 0===e&&(e=0),this.displayOriginX=n.x-t,this.displayOriginY=n.y-e,this},updateSize:function(){var t=this.skeleton,e=this.plugin.renderer.height,n=this.scaleX,i=this.scaleY;t.x=this.x,t.y=e-this.y,t.scaleX=1,t.scaleY=1,t.updateWorldTransform();var a=this.getBounds();return this.width=a.size.x,this.height=a.size.y,this.displayOriginX=this.x-a.offset.x,this.displayOriginY=this.y-(e-(this.height+a.offset.y)),t.scaleX=n,t.scaleY=i,t.updateWorldTransform(),this},scaleX:{get:function(){return this._scaleX},set:function(t){this._scaleX=t,this.refresh()}},scaleY:{get:function(){return this._scaleY},set:function(t){this._scaleY=t,this.refresh()}},getBoneList:function(){var t=[],e=this.skeletonData;if(e)for(var n=0;n<e.bones.length;n++)t.push(e.bones[n].name);return t},getSkinList:function(){var t=[],e=this.skeletonData;if(e)for(var n=0;n<e.skins.length;n++)t.push(e.skins[n].name);return t},getSlotList:function(){for(var t=[],e=this.skeleton,n=0;n<e.slots.length;n++)t.push(e.slots[n].data.name);return t},getAnimationList:function(){var t=[],e=this.skeletonData;if(e)for(var n=0;n<e.animations.length;n++)t.push(e.animations[n].name);return t},getCurrentAnimation:function(t){void 0===t&&(t=0);var e=this.state.getCurrent(t);if(e)return e.animation},play:function(t,e,n){return this.setAnimation(0,t,e,n),this},setAnimation:function(t,e,n,i){if(void 0===n&&(n=!1),void 0===i&&(i=!1),i&&this.state){var a=this.state.getCurrent(t);if(a&&a.animation.name===e&&!a.isComplete())return}if(this.findAnimation(e))return this.state.setAnimation(t,e,n)},addAnimation:function(t,e,n,i){return void 0===n&&(n=!1),void 0===i&&(i=0),this.state.addAnimation(t,e,n,i)},setEmptyAnimation:function(t,e){return this.state.setEmptyAnimation(t,e)},clearTrack:function(t){return this.state.clearTrack(t),this},clearTracks:function(){return this.state.clearTracks(),this},setSkinByName:function(t){var e=this.skeleton;return e.setSkinByName(t),e.setSlotsToSetupPose(),this.state.apply(e),this},setSkin:function(t){var e=this.skeleton;return e.setSkin(t),e.setSlotsToSetupPose(),this.state.apply(e),this},setMix:function(t,e,n){return this.stateData.setMix(t,e,n),this},getAttachment:function(t,e){return this.skeleton.getAttachment(t,e)},getAttachmentByName:function(t,e){return this.skeleton.getAttachmentByName(t,e)},setAttachment:function(t,e){if(Array.isArray(t)&&Array.isArray(e)&&t.length===e.length)for(var n=0;n<t.length;n++)this.skeleton.setAttachment(t[n],e[n]);else this.skeleton.setAttachment(t,e);return this},setToSetupPose:function(){return this.skeleton.setToSetupPose(),this},setSlotsToSetupPose:function(){return this.skeleton.setSlotsToSetupPose(),this},setBonesToSetupPose:function(){return this.skeleton.setBonesToSetupPose(),this},getRootBone:function(){return this.skeleton.getRootBone()},angleBoneToXY:function(t,e,n,r,s,o){void 0===r&&(r=0),void 0===s&&(s=0),void 0===o&&(o=360);var h=this.plugin.renderer.height,c=d(i(t.worldX,h-t.worldY,e,n)+p(r));return t.rotation=a(g(c),s,o),this},findBone:function(t){return this.skeleton.findBone(t)},findBoneIndex:function(t){return this.skeleton.findBoneIndex(t)},findSlot:function(t){return this.skeleton.findSlot(t)},findSlotIndex:function(t){return this.skeleton.findSlotIndex(t)},findSkin:function(t){return this.skeletonData.findSkin(t)},findEvent:function(t){return this.skeletonData.findEvent(t)},findAnimation:function(t){return this.skeletonData.findAnimation(t)},findIkConstraint:function(t){return this.skeletonData.findIkConstraint(t)},findTransformConstraint:function(t){return this.skeletonData.findTransformConstraint(t)},findPathConstraint:function(t){return this.skeletonData.findPathConstraint(t)},findPathConstraintIndex:function(t){return this.skeletonData.findPathConstraintIndex(t)},getBounds:function(){return this.plugin.getBounds(this.skeleton)},preUpdate:function(t,e){var n=this.skeleton;this.state.update(e/1e3*this.timeScale),this.state.apply(n)},preDestroy:function(){this.state&&(this.state.clearListeners(),this.state.clearListenerNotifications()),this.plugin=null,this.skeleton=null,this.skeletonData=null,this.state=null,this.stateData=null}});t.exports=y},function(t,e,n){var i=n(0),a=n(223),r=new i({initialize:function(t,e){this.parent=t,(this.events=e)||(this.events=t.events?t.events:t),this.list={},this.values={},this._frozen=!1,!t.hasOwnProperty("sys")&&this.events&&this.events.once(a.DESTROY,this.destroy,this)},get:function(t){var e=this.list;if(Array.isArray(t)){for(var n=[],i=0;i<t.length;i++)n.push(e[t[i]]);return n}return e[t]},getAll:function(){var t={};for(var e in this.list)this.list.hasOwnProperty(e)&&(t[e]=this.list[e]);return t},query:function(t){var e={};for(var n in this.list)this.list.hasOwnProperty(n)&&n.match(t)&&(e[n]=this.list[n]);return e},set:function(t,e){if(this._frozen)return this;if("string"==typeof t)return this.setValue(t,e);for(var n in t)this.setValue(n,t[n]);return this},inc:function(t,e){if(this._frozen)return this;void 0===e&&(e=1);var n=this.get(t);return void 0===n&&(n=0),this.set(t,n+e),this},toggle:function(t){return this._frozen||this.set(t,!this.get(t)),this},setValue:function(t,e){return this._frozen||(this.has(t)?ER()(this)[t]=e:(i=(n=this).list,r=this.events,s=this.parent,eR()(ER()(this),t,{enumerable:!0,configurable:!0,get:function(){return i[t]},set:function(e){var o;n._frozen||(o=i[t],i[t]=e,r.emit(a.CHANGE_DATA,s,t,e,o),r.emit(a.CHANGE_DATA_KEY+t,s,e,o))}}),i[t]=e,r.emit(a.SET_DATA,s,t,e))),this;var n,i,r,s},each:function(t,e){for(var n=[this.parent,null,void 0],i=1;i<arguments.length;i++)n.push(arguments[i]);for(var a in this.list)n[1]=a,n[2]=this.list[a],t.apply(e,n);return this},merge:function(t,e){for(var n in void 0===e&&(e=!0),t)t.hasOwnProperty(n)&&(e||!e&&!this.has(n))&&this.setValue(n,t[n]);return this},remove:function(t){if(this._frozen)return this;if(!Array.isArray(t))return this.removeValue(t);for(var e=0;e<t.length;e++)this.removeValue(t[e]);return this},removeValue:function(t){var e;return this.has(t)&&(e=this.list[t],delete this.list[t],delete ER()(this)[t],this.events.emit(a.REMOVE_DATA,this.parent,t,e)),this},pop:function(t){var e=void 0;return!this._frozen&&this.has(t)&&(e=this.list[t],delete this.list[t],delete ER()(this)[t],this.events.emit(a.REMOVE_DATA,this.parent,t,e)),e},has:function(t){return this.list.hasOwnProperty(t)},setFreeze:function(t){return this._frozen=t,this},reset:function(){for(var t in this.list)delete this.list[t],delete ER()(this)[t];return this._frozen=!1,this},destroy:function(){this.reset(),this.events.off(a.CHANGE_DATA),this.events.off(a.SET_DATA),this.events.off(a.REMOVE_DATA),this.parent=null},freeze:{get:function(){return this._frozen},set:function(t){this._frozen=!!t}},count:{get:function(){var t=0;for(var e in this.list)void 0!==this.list[e]&&t++;return t}}});t.exports=r},function(t,e,n){t.exports={CHANGE_DATA:n(224),CHANGE_DATA_KEY:n(225),DESTROY:n(226),REMOVE_DATA:n(227),SET_DATA:n(228)}},function(t,e){t.exports="changedata"},function(t,e){t.exports="changedata-"},function(t,e){t.exports="destroy"},function(t,e){t.exports="removedata"},function(t,e){t.exports="setdata"},function(t,e,n){var i=Object.prototype.hasOwnProperty,a="~";function r(){}function o(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function h(t,e,n,i,r){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new o(n,i||t,r),h=a?a+e:e;return t._events[h]?t._events[h].fn?t._events[h]=[t._events[h],s]:t._events[h].push(s):(t._events[h]=s,t._eventsCount++),t}function c(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function l(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(a=!1)),l.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)i.call(t,e)&&n.push(a?s()(e).call(e,1):e);return bR()?et()(n).call(n,bR()(t)):n},l.prototype.listeners=function(t){var e=a?a+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,r=n.length,s=new Array(r);i<r;i++)s[i]=n[i].fn;return s},l.prototype.listenerCount=function(t){var e=a?a+t:t,n=this._events[e];return n?n.fn?1:n.length:0},l.prototype.emit=function(t,e,n,i,r,s){var o=a?a+t:t;if(!this._events[o])return!1;var h,c=this._events[o],l=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),l){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,n),!0;case 4:return c.fn.call(c.context,e,n,i),!0;case 5:return c.fn.call(c.context,e,n,i,r),!0;case 6:return c.fn.call(c.context,e,n,i,r,s),!0}for(p=1,h=new Array(l-1);p<l;p++)h[p-1]=arguments[p];c.fn.apply(c.context,h)}else for(var u,d=c.length,p=0;p<d;p++)switch(c[p].once&&this.removeListener(t,c[p].fn,void 0,!0),l){case 1:c[p].fn.call(c[p].context);break;case 2:c[p].fn.call(c[p].context,e);break;case 3:c[p].fn.call(c[p].context,e,n);break;case 4:c[p].fn.call(c[p].context,e,n,i);break;default:if(!h)for(u=1,h=new Array(l-1);u<l;u++)h[u-1]=arguments[u];c[p].fn.apply(c[p].context,h)}return!0},l.prototype.on=function(t,e,n){return h(this,t,e,n,!1)},l.prototype.once=function(t,e,n){return h(this,t,e,n,!0)},l.prototype.removeListener=function(t,e,n,i){var r=a?a+t:t;if(!this._events[r])return this;if(!e)return c(this,r),this;var s=this._events[r];if(s.fn)s.fn!==e||i&&!s.once||n&&s.context!==n||c(this,r);else{for(var o=0,h=[],l=s.length;o<l;o++)(s[o].fn!==e||i&&!s[o].once||n&&s[o].context!==n)&&h.push(s[o]);h.length?this._events[r]=1===h.length?h[0]:h:c(this,r)}return this},l.prototype.removeAllListeners=function(t){var e;return t?(e=a?a+t:t,this._events[e]&&c(this,e)):(this._events=new r,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=a,l.EventEmitter=l,t.exports=l},function(t,e){t.exports="addedtoscene"},function(t,e){t.exports="destroy"},function(t,e){t.exports="removedfromscene"},function(t,e){t.exports="complete"},function(t,e){t.exports="created"},function(t,e){t.exports="error"},function(t,e){t.exports="loop"},function(t,e){t.exports="play"},function(t,e){t.exports="seeked"},function(t,e){t.exports="seeking"},function(t,e){t.exports="stop"},function(t,e){t.exports="timeout"},function(t,e){t.exports="unlocked"},function(t,e,n){t.exports={COMPLETE:n(244),DISPOSE:n(245),END:n(246),EVENT:n(247),INTERRUPTED:n(248),START:n(249)}},function(t,e){t.exports="complete"},function(t,e){t.exports="dispose"},function(t,e){t.exports="end"},function(t,e){t.exports="event"},function(t,e){t.exports="interrupted"},function(t,e){t.exports="start"},function(t,e,n){var i=n(1),a=n(1),r=n(1);i=n(251),r=n(252),a=n(253);t.exports={renderWebGL:i,renderCanvas:a,renderDirect:r}},function(t,e,n){var i=n(3),a=n(8),r=n(56),s=n(9),o=n(6);t.exports=function(t,e,n,h,c){var l=e.plugin,u=e.skeleton,d=l.sceneRenderer;t.newType&&(t.pipelines.clear(),d.begin());var p=e.scrollFactorX,f=e.scrollFactorY,g=u.color.a;c&&(e.scrollFactorX=c.scrollFactorX,e.scrollFactorY=c.scrollFactorY,u.color.a=i(g*c.alpha,0,1)),n.addToRenderList(e);var m,v,y=r(e,n,h).calc,S=t.height;u.x=y.tx,u.y=S-y.ty,u.scaleX=y.scaleX,u.scaleY=y.scaleY,e.scaleX<0?(u.scaleX*=-1,e.root.rotation=o(s(y.rotationNormalized)-180,0,360)):e.root.rotation=o(s(a(y.rotationNormalized))+90,0,360),e.scaleY<0&&(u.scaleY*=-1,e.scaleX<0?e.root.rotation-=2*s(y.rotationNormalized):e.root.rotation+=2*s(y.rotationNormalized)),u.updateWorldTransform(),d.drawSkeleton(u,e.preMultipliedAlpha),c&&(e.scrollFactorX=p,e.scrollFactorY=f,u.color.a=g),(l.drawDebug||e.drawDebug)&&(m=u.x,v=u.y,u.x=0,u.y=0,d.drawSkeletonDebug(u,e.preMultipliedAlpha),u.x=m,u.y=v),t.nextTypeMatch||(d.end(),t.pipelines.rebind())}},function(t,e,n){var i=n(3),a=n(8),r=n(56),s=n(9),o=n(6);t.exports=function(t,e,n,h,c){var l=e.plugin,u=e.skeleton,d=l.sceneRenderer;t.pipelines.clear(),d.begin();var p=e.scrollFactorX,f=e.scrollFactorY,g=u.color.a;c&&(e.scrollFactorX=c.scrollFactorX,e.scrollFactorY=c.scrollFactorY,u.color.a=i(g*c.alpha,0,1)),n.addToRenderList(e);var m,v,y=r(e,n,h).calc,S=t.height;u.x=y.tx,u.y=S-y.ty,u.scaleX=y.scaleX,u.scaleY=y.scaleY,e.scaleX<0?(u.scaleX*=-1,e.root.rotation=o(s(y.rotationNormalized)-180,0,360)):e.root.rotation=o(s(a(y.rotationNormalized))+90,0,360),e.scaleY<0&&(u.scaleY*=-1,e.scaleX<0?e.root.rotation-=2*s(y.rotationNormalized):e.root.rotation+=2*s(y.rotationNormalized)),u.updateWorldTransform(),d.drawSkeleton(u,e.preMultipliedAlpha),c&&(e.scrollFactorX=p,e.scrollFactorY=f,u.color.a=g),(l.drawDebug||e.drawDebug)&&(m=u.x,v=u.y,u.x=0,u.y=0,d.drawSkeletonDebug(u,e.preMultipliedAlpha),u.x=m,u.y=v),d.end(),t.pipelines.rebind()}},function(t,e,n){var i=n(8),a=n(9),r=n(6);t.exports=function(t,e,n,s){var o=t.currentContext,h=e.plugin,c=e.skeleton,l=h.skeletonRenderer,u=t._tempMatrix1,d=t._tempMatrix2,p=t._tempMatrix3;n.addToRenderList(e),d.applyITRS(e.x,e.y,e.rotation,Math.abs(e.scaleX),Math.abs(e.scaleY)),u.copyFrom(n.matrix),s?(u.multiplyWithOffset(s,-n.scrollX*e.scrollFactorX,-n.scrollY*e.scrollFactorY),d.e=e.x,d.f=e.y):(d.e-=n.scrollX*e.scrollFactorX,d.f-=n.scrollY*e.scrollFactorY),u.multiply(d,p),c.x=p.tx,c.y=p.ty,c.scaleX=p.scaleX,c.scaleY=-1*p.scaleY,e.scaleX<0?(c.scaleX*=-1,e.root.rotation=a(p.rotationNormalized)):e.root.rotation=r(a(i(p.rotationNormalized))+90,0,360),e.scaleY<0&&(c.scaleY*=-1,e.scaleX<0?e.root.rotation-=2*a(p.rotationNormalized):e.root.rotation+=2*a(p.rotationNormalized)),n.renderToTexture&&(c.y=p.ty,c.scaleY*=-1),c.updateWorldTransform(),l.ctx=o,l.debugRendering=h.drawDebug||e.drawDebug,o.save(),l.draw(c),o.restore()}},function(t,e,n){var i=n(0),a=n(255),r=n(347),s=new i({Extends:a,Mixins:[r],initialize:function(t,e,n,i,r){a.call(this,t,n,i,r),this.type="Spine",this.plugin=e},preDestroy:function(){this.removeAll(!!this.exclusive),this.localTransform.destroy(),this.tempTransformMatrix.destroy(),this.list=[],this._displayList=null,this.plugin=null}});t.exports=s},function(t,e,n){var i=n(256),a=n(17),r=n(0),o=n(293),h=n(55),c=n(53),l=n(25),u=n(343),d=n(346),p=n(2),f=new r({Extends:c,Mixins:[o.AlphaSingle,o.BlendMode,o.ComputedSize,o.Depth,o.Mask,o.Pipeline,o.Transform,o.Visible,u],initialize:function(t,e,n,i){c.call(this,t,"Container"),this.list=[],this.exclusive=!0,this.maxSize=-1,this.position=0,this.localTransform=new o.TransformMatrix,this.tempTransformMatrix=new o.TransformMatrix,this._sortKey="",this._sysEvents=t.sys.events,this.scrollFactorX=1,this.scrollFactorY=1,this.initPipeline(),this.setPosition(e,n),this.clearAlpha(),this.setBlendMode(a.SKIP_CHECK),i&&this.add(i)},originX:{get:function(){return.5}},originY:{get:function(){return.5}},displayOriginX:{get:function(){return.5*this.width}},displayOriginY:{get:function(){return.5*this.height}},setExclusive:function(t){return void 0===t&&(t=!0),this.exclusive=t,this},getBounds:function(t){var e;if(void 0===t&&(t=new l),t.setTo(this.x,this.y,0,0),this.parentContainer&&(e=this.parentContainer.getBoundsTransformMatrix().transformPoint(this.x,this.y),t.setTo(e.x,e.y,0,0)),0<this.list.length){var n=this.list,i=new l,a=!1;t.setEmpty();for(var r=0;r<n.length;r++){var s=n[r];s.getBounds&&(s.getBounds(i),a?d(i,t,t):(t.setTo(i.x,i.y,i.width,i.height),a=!0))}}return t},addHandler:function(t){t.once(h.DESTROY,this.remove,this),this.exclusive&&(t.parentContainer&&t.parentContainer.remove(t),t.removeFromDisplayList(),t.parentContainer=this)},removeHandler:function(t){t.off(h.DESTROY,this.remove),this.exclusive&&(t.parentContainer=null,t.addToDisplayList())},pointToContainer:function(t,e){void 0===e&&(e=new p),this.parentContainer?this.parentContainer.pointToContainer(t,e):e=new p(t.x,t.y);var n=this.tempTransformMatrix;return n.applyITRS(this.x,this.y,this.rotation,this.scaleX,this.scaleY),n.invert(),n.transformPoint(t.x,t.y,e),e},getBoundsTransformMatrix:function(){return this.getWorldTransformMatrix(this.tempTransformMatrix,this.localTransform)},add:function(t){return i.Add(this.list,t,this.maxSize,this.addHandler,this),this},addAt:function(t,e){return i.AddAt(this.list,t,e,this.maxSize,this.addHandler,this),this},getAt:function(t){return this.list[t]},getIndex:function(t){var e;return g()(e=this.list).call(e,t)},sort:function(t,e){return t&&(void 0===e&&(e=function(e,n){return e[t]-n[t]}),i.StableSort(this.list,e)),this},getByName:function(t){return i.GetFirst(this.list,"name",t)},getRandom:function(t,e){return i.GetRandom(this.list,t,e)},getFirst:function(t,e,n,a){return i.GetFirst(this.list,t,e,n,a)},getAll:function(t,e,n,a){return i.GetAll(this.list,t,e,n,a)},count:function(t,e,n,a){return i.CountAllMatching(this.list,t,e,n,a)},swap:function(t,e){return i.Swap(this.list,t,e),this},moveTo:function(t,e){return i.MoveTo(this.list,t,e),this},remove:function(t,e){var n=i.Remove(this.list,t,this.removeHandler,this);if(e&&n){Array.isArray(n)||(n=[n]);for(var a=0;a<n.length;a++)n[a].destroy()}return this},removeAt:function(t,e){var n=i.RemoveAt(this.list,t,this.removeHandler,this);return e&&n&&n.destroy(),this},removeBetween:function(t,e,n){var a=i.RemoveBetween(this.list,t,e,this.removeHandler,this);if(n)for(var r=0;r<a.length;r++)a[r].destroy();return this},removeAll:function(t){var e=i.RemoveBetween(this.list,0,this.list.length,this.removeHandler,this);if(t)for(var n=0;n<e.length;n++)e[n].destroy();return this},bringToTop:function(t){return i.BringToTop(this.list,t),this},sendToBack:function(t){return i.SendToBack(this.list,t),this},moveUp:function(t){return i.MoveUp(this.list,t),this},moveDown:function(t){return i.MoveDown(this.list,t),this},reverse:function(){var t;return uR()(t=this.list).call(t),this},shuffle:function(){return i.Shuffle(this.list),this},replace:function(t,e,n){return i.Replace(this.list,t,e)&&(this.addHandler(e),this.removeHandler(t),n&&t.destroy()),this},exists:function(t){var e;return-1<g()(e=this.list).call(e,t)},setAll:function(t,e,n,a){return i.SetAll(this.list,t,e,n,a),this},each:function(t,e){for(var n=[null],i=s()(o=this.list).call(o),a=i.length,r=2;r<arguments.length;r++){var o;n.push(arguments[r])}for(r=0;r<a;r++)n[0]=i[r],t.apply(e,n);return this},iterate:function(t,e){for(var n=[null],i=2;i<arguments.length;i++)n.push(arguments[i]);for(i=0;i<this.list.length;i++)n[0]=this.list[i],t.apply(e,n);return this},setScrollFactor:function(t,e,n){return void 0===e&&(e=t),void 0===n&&(n=!1),this.scrollFactorX=t,this.scrollFactorY=e,n&&(i.SetAll(this.list,"scrollFactorX",t),i.SetAll(this.list,"scrollFactorY",e)),this},length:{get:function(){return this.list.length}},first:{get:function(){return(this.position=0)<this.list.length?this.list[0]:null}},last:{get:function(){return 0<this.list.length?(this.position=this.list.length-1,this.list[this.position]):null}},next:{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}},previous:{get:function(){return 0<this.position?(this.position--,this.list[this.position]):null}},preDestroy:function(){this.removeAll(!!this.exclusive),this.localTransform.destroy(),this.tempTransformMatrix.destroy(),this.list=[]}});t.exports=f},function(t,e,n){t.exports={Matrix:n(257),Add:n(266),AddAt:n(267),BringToTop:n(268),CountAllMatching:n(269),Each:n(270),EachInRange:n(271),FindClosestInSorted:n(272),GetAll:n(273),GetFirst:n(274),GetRandom:n(275),MoveDown:n(276),MoveTo:n(277),MoveUp:n(278),NumberArray:n(279),NumberArrayStep:n(280),QuickSelect:n(281),Range:n(282),Remove:n(283),RemoveAt:n(284),RemoveBetween:n(285),RemoveRandomElement:n(286),Replace:n(287),RotateLeft:n(58),RotateRight:n(59),SafeRange:n(5),SendToBack:n(288),SetAll:n(289),Shuffle:n(60),SortByDigits:n(290),SpliceOne:n(12),StableSort:n(291),Swap:n(292)}},function(t,e,n){t.exports={CheckMatrix:n(24),MatrixToString:n(258),ReverseColumns:n(260),ReverseRows:n(261),Rotate180:n(262),RotateLeft:n(263),RotateMatrix:n(16),RotateRight:n(264),Translate:n(265),TransposeMatrix:n(57)}},function(t,e,n){var i=n(259),a=n(24);t.exports=function(t){var e="";if(!a(t))return e;for(var n=0;n<t.length;n++){for(var r=0;r<t[n].length;r++){var s=t[n][r].toString();e+="undefined"!==s?i(s,2):"?",r<t[n].length-1&&(e+=" |")}if(n<t.length-1){e+="\n";for(var o=0;o<t[n].length;o++)e+="---",o<t[n].length-1&&(e+="+");e+="\n"}}return e}},function(t,e){t.exports=function(t,e,n,i){var a;if(void 0===e&&(e=0),void 0===n&&(n=" "),void 0===i&&(i=3),e+1>=(t=t.toString()).length)switch(i){case 1:t=new Array(e+1-t.length).join(n)+t;break;case 3:var r=Math.ceil((a=e-t.length)/2);t=new Array(a-r+1).join(n)+t+new Array(r+1).join(n);break;default:t+=new Array(e+1-t.length).join(n)}return t}},function(t,e){t.exports=function(t){return uR()(t).call(t)}},function(t,e){t.exports=function(t){for(var e=0;e<t.length;e++){var n;uR()(n=t[e]).call(n)}return t}},function(t,e,n){var i=n(16);t.exports=function(t){return i(t,180)}},function(t,e,n){var i=n(16);t.exports=function(t){return i(t,90)}},function(t,e,n){var i=n(16);t.exports=function(t){return i(t,-90)}},function(t,e,n){var i=n(58),a=n(59);t.exports=function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=0),0!==n&&(n<0?i(t,Math.abs(n)):a(t,n)),0!==e)for(var r=0;r<t.length;r++){var s=t[r];e<0?i(s,Math.abs(e)):a(s,e)}return t}},function(t,e){t.exports=function(t,e,n,i,a){if(void 0===a&&(a=t),0<n){var r=n-t.length;if(r<=0)return null}if(!Array.isArray(e))return-1===g()(t).call(t,e)?(t.push(e),i&&i.call(a,e),e):null;for(var s=e.length-1;0<=s;)-1!==g()(t).call(t,e[s])&&ds()(e).call(e,s,1),s--;if(0===(s=e.length))return null;0<n&&r<s&&(ds()(e).call(e,r),s=r);for(var o=0;o<s;o++){var h=e[o];t.push(h),i&&i.call(a,h)}return e}},function(t,e){t.exports=function(t,e,n,i,a,r){if(void 0===n&&(n=0),void 0===r&&(r=t),0<i){var s=i-t.length;if(s<=0)return null}if(!Array.isArray(e))return-1===g()(t).call(t,e)?(ds()(t).call(t,n,0,e),a&&a.call(r,e),e):null;for(var o=e.length-1;0<=o;)-1!==g()(t).call(t,e[o])&&e.pop(),o--;if(0===(o=e.length))return null;0<i&&s<o&&(ds()(e).call(e,s),o=s);for(var h=o-1;0<=h;h--){var c=e[h];ds()(t).call(t,n,0,c),a&&a.call(r,c)}return e}},function(t,e){t.exports=function(t,e){var n=g()(t).call(t,e);return-1!==n&&n<t.length&&(ds()(t).call(t,n,1),t.push(e)),e}},function(t,e,n){var i=n(5);t.exports=function(t,e,n,a,r){void 0===a&&(a=0),void 0===r&&(r=t.length);var s=0;if(i(t,a,r))for(var o=a;o<r;o++)t[o][e]===n&&s++;return s}},function(t,e){t.exports=function(t,e,n){for(var i=[null],a=3;a<arguments.length;a++)i.push(arguments[a]);for(a=0;a<t.length;a++)i[0]=t[a],e.apply(n,i);return t}},function(t,e,n){var i=n(5);t.exports=function(t,e,n,a,r){if(void 0===a&&(a=0),void 0===r&&(r=t.length),i(t,a,r)){for(var s=[null],o=5;o<arguments.length;o++)s.push(arguments[o]);for(o=a;o<r;o++)s[0]=t[o],e.apply(n,s)}return t}},function(t,e){t.exports=function(t,e,n){if(!e.length)return NaN;if(1===e.length)return e[0];var i,a,r=1;if(n){if(t<e[0][n])return e[0];for(;e[r][n]<t;)r++}else for(;e[r]<t;)r++;return r>e.length&&(r=e.length),n?(i=e[r-1][n],(a=e[r][n])-t<=t-i?e[r]:e[r-1]):(i=e[r-1],(a=e[r])-t<=t-i?a:i)}},function(t,e,n){var i=n(5);t.exports=function(t,e,n,a,r){void 0===a&&(a=0),void 0===r&&(r=t.length);var s=[];if(i(t,a,r))for(var o=a;o<r;o++){var h=t[o];(!e||e&&void 0===n&&h.hasOwnProperty(e)||e&&void 0!==n&&h[e]===n)&&s.push(h)}return s}},function(t,e,n){var i=n(5);t.exports=function(t,e,n,a,r){if(void 0===a&&(a=0),void 0===r&&(r=t.length),i(t,a,r))for(var s=a;s<r;s++){var o=t[s];if(!e||e&&void 0===n&&o.hasOwnProperty(e)||e&&void 0!==n&&o[e]===n)return o}return null}},function(t,e){t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.length);var i=e+Math.floor(Math.random()*n);return void 0===t[i]?null:t[i]}},function(t,e){t.exports=function(t,e){var n,i,a=g()(t).call(t,e);return 0<a&&(n=t[a-1],i=g()(t).call(t,n),t[a]=n,t[i]=e),t}},function(t,e){t.exports=function(t,e,n){var i=g()(t).call(t,e);if(-1===i||n<0||n>=t.length)throw new Error("Supplied index out of bounds");return i!==n&&(ds()(t).call(t,i,1),ds()(t).call(t,n,0,e)),e}},function(t,e){t.exports=function(t,e){var n,i,a=g()(t).call(t,e);return-1!==a&&a<t.length-1&&(n=t[a+1],i=g()(t).call(t,n),t[a]=n,t[i]=e),t}},function(t,e){t.exports=function(t,e,n,i){var a,r=[],s=!1;if((n||i)&&(s=!0,n=n||"",i=i||""),e<t)for(a=t;e<=a;a--)s?r.push(n+a.toString()+i):r.push(a);else for(a=t;a<=e;a++)s?r.push(n+a.toString()+i):r.push(a);return r}},function(t,e,n){var i=n(40);t.exports=function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=null),void 0===n&&(n=1),null===e&&(e=t,t=0);for(var a=[],r=Math.max(i((e-t)/(n||1)),0),s=0;s<r;s++)a.push(t),t+=n;return a}},function(t,e){function n(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function i(t,e){return t<e?-1:e<t?1:0}t.exports=function t(e,a,r,s,o){for(void 0===r&&(r=0),void 0===s&&(s=e.length-1),void 0===o&&(o=i);r<s;){var h,c,l,u,d;600<s-r&&(h=s-r+1,c=a-r+1,l=Math.log(h),u=.5*Math.exp(2*l/3),d=.5*Math.sqrt(l*u*(h-u)/h)*(c-h/2<0?-1:1),t(e,a,Math.max(r,Math.floor(a-c*u/h+d)),Math.min(s,Math.floor(a+(h-c)*u/h+d)),o));var p=e[a],f=r,g=s;for(n(e,r,a),0<o(e[s],p)&&n(e,r,s);f<g;){for(n(e,f,g),f++,g--;o(e[f],p)<0;)f++;for(;0<o(e[g],p);)g--}0===o(e[r],p)?n(e,r,g):n(e,++g,s),g<=a&&(r=g+1),a<=g&&(s=g-1)}}},function(t,e,n){var i=n(10),a=n(60);t.exports=function(t,e,n){var r,s=i(n,"max",0),o=i(n,"qty",1),h=i(n,"random",!1),c=i(n,"randomB",!1),l=i(n,"repeat",0),u=i(n,"yoyo",!1),d=[];c&&a(e),-1===l&&(l=0===s?0:(r=t.length*e.length*o,u&&(r*=2),Math.ceil(s/r)));for(var p=0;p<=l;p++){var f=function(t,e,n){for(var i=[],a=0;a<t.length;a++)for(var r=0;r<e.length;r++)for(var s=0;s<n;s++)i.push({a:t[a],b:e[r]});return i}(t,e,o);h&&a(f),d=et()(d).call(d,f),u&&(uR()(f).call(f),d=et()(d).call(d,f))}return s&&ds()(d).call(d,s),d}},function(t,e,n){var i=n(12);t.exports=function(t,e,n,a){if(void 0===a&&(a=t),!Array.isArray(e))return-1!==(o=g()(t).call(t,e))?(i(t,o),n&&n.call(a,e),e):null;for(var r=e.length-1,s=[];0<=r;){var o,h=e[r];-1!==(o=g()(t).call(t,h))&&(i(t,o),s.push(h),n&&n.call(a,h)),r--}return s}},function(t,e,n){var i=n(12);t.exports=function(t,e,n,a){if(void 0===a&&(a=t),e<0||e>t.length-1)throw new Error("Index out of bounds");var r=i(t,e);return n&&n.call(a,r),r}},function(t,e,n){var i=n(5);t.exports=function(t,e,n,a,r){if(void 0===e&&(e=0),void 0===n&&(n=t.length),void 0===r&&(r=t),i(t,e,n)){var s=n-e,o=ds()(t).call(t,e,s);if(a)for(var h=0;h<o.length;h++){var c=o[h];a.call(r,c)}return o}return[]}},function(t,e,n){var i=n(12);t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.length);var a=e+Math.floor(Math.random()*n);return i(t,a)}},function(t,e){t.exports=function(t,e,n){var i=g()(t).call(t,e),a=g()(t).call(t,n);return-1!==i&&-1===a&&(t[i]=n,!0)}},function(t,e){t.exports=function(t,e){var n=g()(t).call(t,e);return-1!==n&&0<n&&(ds()(t).call(t,n,1),t.unshift(e)),e}},function(t,e,n){var i=n(5);t.exports=function(t,e,n,a,r){if(void 0===a&&(a=0),void 0===r&&(r=t.length),i(t,a,r))for(var s=a;s<r;s++){var o=t[s];o.hasOwnProperty(e)&&(o[e]=n)}return t}},function(t,e){t.exports=function(t){var e=/\D/g;return Na()(t).call(t,(function(t,n){return eb()(t.replace(e,""),10)-eb()(n.replace(e,""),10)})),t}},function(t,e){function n(t,e){return String(t).localeCompare(e)}function i(t,e,n,i){for(var a,r,s,o,h=t.length,c=0,l=2*n,u=0;u<h;u+=l)for(r=(a=u+n)+n,h<a&&(a=h),h<r&&(r=h),s=u,o=a;;)if(s<a&&o<r)e(t[s],t[o])<=0?i[c++]=t[s++]:i[c++]=t[o++];else if(s<a)i[c++]=t[s++];else{if(!(o<r))break;i[c++]=t[o++]}}t.exports=function(t,e){void 0===e&&(e=n);var a=function(t,e){var n=t.length;if(n<=1)return t;for(var a=new Array(n),r=1;r<n;r*=2){i(t,e,r,a);var s=t;t=a,a=s}return t}(t,e);return a!==t&&i(a,null,t.length,t),t}},function(t,e){t.exports=function(t,e,n){if(e!==n){var i=g()(t).call(t,e),a=g()(t).call(t,n);if(i<0||a<0)throw new Error("Supplied items must be elements of the same array");return t[i]=n,t[a]=e,t}}},function(t,e,n){t.exports={Alpha:n(294),AlphaSingle:n(295),BlendMode:n(296),ComputedSize:n(47),Crop:n(297),Depth:n(48),Flip:n(49),GetBounds:n(298),Mask:n(307),Origin:n(332),PathFollower:n(333),Pipeline:n(336),ScrollFactor:n(50),Size:n(339),Texture:n(340),TextureCrop:n(341),Tint:n(342),ToJSON:n(54),Transform:n(51),TransformMatrix:n(23),Visible:n(52)}},function(t,e,n){var i=n(3),a={_alpha:1,_alphaTL:1,_alphaTR:1,_alphaBL:1,_alphaBR:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(t,e,n,a){return void 0===t&&(t=1),void 0===e?this.alpha=t:(this._alphaTL=i(t,0,1),this._alphaTR=i(e,0,1),this._alphaBL=i(n,0,1),this._alphaBR=i(a,0,1)),this},alpha:{get:function(){return this._alpha},set:function(t){var e=i(t,0,1);this._alpha=e,this._alphaTL=e,this._alphaTR=e,this._alphaBL=e,0===(this._alphaBR=e)?this.renderFlags&=-3:this.renderFlags|=2}},alphaTopLeft:{get:function(){return this._alphaTL},set:function(t){var e=i(t,0,1);0!==(this._alphaTL=e)&&(this.renderFlags|=2)}},alphaTopRight:{get:function(){return this._alphaTR},set:function(t){var e=i(t,0,1);0!==(this._alphaTR=e)&&(this.renderFlags|=2)}},alphaBottomLeft:{get:function(){return this._alphaBL},set:function(t){var e=i(t,0,1);0!==(this._alphaBL=e)&&(this.renderFlags|=2)}},alphaBottomRight:{get:function(){return this._alphaBR},set:function(t){var e=i(t,0,1);0!==(this._alphaBR=e)&&(this.renderFlags|=2)}}};t.exports=a},function(t,e,n){var i=n(3),a={_alpha:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(t){return void 0===t&&(t=1),this.alpha=t,this},alpha:{get:function(){return this._alpha},set:function(t){var e=i(t,0,1);0===(this._alpha=e)?this.renderFlags&=-3:this.renderFlags|=2}}};t.exports=a},function(t,e,n){var i=n(17),a={_blendMode:i.NORMAL,blendMode:{get:function(){return this._blendMode},set:function(t){"string"==typeof t&&(t=i[t]),-1<=(t|=0)&&(this._blendMode=t)}},setBlendMode:function(t){return this.blendMode=t,this}};t.exports=a},function(t,e){t.exports={texture:null,frame:null,isCropped:!1,setCrop:function(t,e,n,i){return void 0===t?this.isCropped=!1:this.frame&&("number"==typeof t?this.frame.setCropUVs(this._crop,t,e,n,i,this.flipX,this.flipY):this.frame.setCropUVs(this._crop,t.x,t.y,t.width,t.height,this.flipX,this.flipY),this.isCropped=!0),this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}}},function(t,e,n){var i=n(25),a=n(39),r=n(2),s={prepareBoundsOutput:function(t,e){return void 0===e&&(e=!1),0!==this.rotation&&a(t,this.x,this.y,this.rotation),e&&this.parentContainer&&this.parentContainer.getBoundsTransformMatrix().transformPoint(t.x,t.y,t),t},getCenter:function(t){return void 0===t&&(t=new r),t.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,t},getTopLeft:function(t,e){return(t=t||new r).x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getTopCenter:function(t,e){return(t=t||new r).x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getTopRight:function(t,e){return(t=t||new r).x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getLeftCenter:function(t,e){return(t=t||new r).x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(t,e)},getRightCenter:function(t,e){return(t=t||new r).x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(t,e)},getBottomLeft:function(t,e){return(t=t||new r).x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBottomCenter:function(t,e){return(t=t||new r).x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBottomRight:function(t,e){return(t=t||new r).x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBounds:function(t){var e,n,a,r,s,o,h,c,l;return void 0===t&&(t=new i),this.parentContainer?(l=this.parentContainer.getBoundsTransformMatrix(),this.getTopLeft(t),l.transformPoint(t.x,t.y,t),e=t.x,n=t.y,this.getTopRight(t),l.transformPoint(t.x,t.y,t),a=t.x,r=t.y,this.getBottomLeft(t),l.transformPoint(t.x,t.y,t),s=t.x,o=t.y,this.getBottomRight(t),l.transformPoint(t.x,t.y,t)):(this.getTopLeft(t),e=t.x,n=t.y,this.getTopRight(t),a=t.x,r=t.y,this.getBottomLeft(t),s=t.x,o=t.y,this.getBottomRight(t)),h=t.x,c=t.y,t.x=Math.min(e,a,s,h),t.y=Math.min(n,r,o,c),t.width=Math.max(e,a,s,h)-t.x,t.height=Math.max(n,r,o,c)-t.y,t}};t.exports=s},function(t,e){t.exports=function(t,e,n){return!(t.width<=0||t.height<=0)&&t.x<=e&&t.x+t.width>=e&&t.y<=n&&t.y+t.height>=n}},function(t,e,n){var i=n(61),a=n(62);t.exports=function(t,e,n,r){void 0===r&&(r=[]),!e&&0<n&&(e=a(t)/n);for(var s=0;s<e;s++){var o=s/e;r.push(i(t,o))}return r}},function(t,e,n){var i=n(0),a=n(302),r=n(303),s=n(26),o=n(305),h=n(2),c=new i({initialize:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.type=s.LINE,this.x1=t,this.y1=e,this.x2=n,this.y2=i},getPoint:function(t,e){return a(this,t,e)},getPoints:function(t,e,n){return r(this,t,e,n)},getRandomPoint:function(t){return o(this,t)},setTo:function(t,e,n,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.x1=t,this.y1=e,this.x2=n,this.y2=i,this},getPointA:function(t){return void 0===t&&(t=new h),t.set(this.x1,this.y1),t},getPointB:function(t){return void 0===t&&(t=new h),t.set(this.x2,this.y2),t},left:{get:function(){return Math.min(this.x1,this.x2)},set:function(t){this.x1<=this.x2?this.x1=t:this.x2=t}},right:{get:function(){return Math.max(this.x1,this.x2)},set:function(t){this.x1>this.x2?this.x1=t:this.x2=t}},top:{get:function(){return Math.min(this.y1,this.y2)},set:function(t){this.y1<=this.y2?this.y1=t:this.y2=t}},bottom:{get:function(){return Math.max(this.y1,this.y2)},set:function(t){this.y1>this.y2?this.y1=t:this.y2=t}}});t.exports=c},function(t,e,n){var i=n(13);t.exports=function(t,e,n){return void 0===n&&(n=new i),n.x=t.x1+(t.x2-t.x1)*e,n.y=t.y1+(t.y2-t.y1)*e,n}},function(t,e,n){var i=n(304),a=n(13);t.exports=function(t,e,n,r){void 0===r&&(r=[]),!e&&0<n&&(e=i(t)/n);for(var s=t.x1,o=t.y1,h=t.x2,c=t.y2,l=0;l<e;l++){var u=l/e,d=s+(h-s)*u,p=o+(c-o)*u;r.push(new a(d,p))}return r}},function(t,e){t.exports=function(t){return Math.sqrt((t.x2-t.x1)*(t.x2-t.x1)+(t.y2-t.y1)*(t.y2-t.y1))}},function(t,e,n){var i=n(13);t.exports=function(t,e){void 0===e&&(e=new i);var n=Math.random();return e.x=t.x1+n*(t.x2-t.x1),e.y=t.y1+n*(t.y2-t.y1),e}},function(t,e,n){var i=n(13);t.exports=function(t,e){return void 0===e&&(e=new i),e.x=t.x+Math.random()*t.width,e.y=t.y+Math.random()*t.height,e}},function(t,e,n){var i=n(308),a=n(331),r={mask:null,setMask:function(t){return this.mask=t,this},clearMask:function(t){return void 0===t&&(t=!1),t&&this.mask&&this.mask.destroy(),this.mask=null,this},createBitmapMask:function(t){return void 0===t&&(this.texture||this.shader)&&(t=this),new i(this.scene,t)},createGeometryMask:function(t){return void 0===t&&"Graphics"===this.type&&(t=this),new a(this.scene,t)}};t.exports=r},function(t,e,n){var i=n(0),a=n(309),r=n(326),s=new i({initialize:function(t,e){var n=t.sys.renderer;this.renderer=n,this.bitmapMask=e,this.maskTexture=null,this.mainTexture=null,this.dirty=!0,this.mainFramebuffer=null,this.maskFramebuffer=null,this.invertAlpha=!1,this.isStencil=!1,this.createMask(),t.sys.game.events.on(a.CONTEXT_RESTORED,this.createMask,this),n&&n.on(r.RESIZE,this.createMask,this)},createMask:function(){var t,e,n,i,a,r,s=this.renderer;s&&s.gl&&(this.mainTexture&&this.clearMask(),t=s.width,e=s.height,n=0==(t&t-1)&&0==(e&e-1),i=s.gl,a=n?i.REPEAT:i.CLAMP_TO_EDGE,r=i.LINEAR,this.mainTexture=s.createTexture2D(0,r,r,a,a,i.RGBA,null,t,e),this.maskTexture=s.createTexture2D(0,r,r,a,a,i.RGBA,null,t,e),this.mainFramebuffer=s.createFramebuffer(t,e,this.mainTexture,!0),this.maskFramebuffer=s.createFramebuffer(t,e,this.maskTexture,!0))},clearMask:function(){var t=this.renderer;t&&t.gl&&this.mainTexture&&(t.deleteTexture(this.mainTexture),t.deleteTexture(this.maskTexture),t.deleteFramebuffer(this.mainFramebuffer),t.deleteFramebuffer(this.maskFramebuffer),this.mainTexture=null,this.maskTexture=null,this.mainFramebuffer=null,this.maskFramebuffer=null)},setBitmap:function(t){this.bitmapMask=t},preRenderWebGL:function(t,e,n){t.pipelines.BITMAPMASK_PIPELINE.beginMask(this,e,n)},postRenderWebGL:function(t,e){t.pipelines.BITMAPMASK_PIPELINE.endMask(this,e)},preRenderCanvas:function(){},postRenderCanvas:function(){},destroy:function(){this.clearMask(),this.renderer&&this.renderer.off(r.RESIZE,this.createMask,this),this.bitmapMask=null,this.prevFramebuffer=null,this.renderer=null}});t.exports=s},function(t,e,n){t.exports={BLUR:n(310),BOOT:n(311),CONTEXT_LOST:n(312),CONTEXT_RESTORED:n(313),DESTROY:n(314),FOCUS:n(315),HIDDEN:n(316),PAUSE:n(317),POST_RENDER:n(318),POST_STEP:n(319),PRE_RENDER:n(320),PRE_STEP:n(321),READY:n(322),RESUME:n(323),STEP:n(324),VISIBLE:n(325)}},function(t,e){t.exports="blur"},function(t,e){t.exports="boot"},function(t,e){t.exports="contextlost"},function(t,e){t.exports="contextrestored"},function(t,e){t.exports="destroy"},function(t,e){t.exports="focus"},function(t,e){t.exports="hidden"},function(t,e){t.exports="pause"},function(t,e){t.exports="postrender"},function(t,e){t.exports="poststep"},function(t,e){t.exports="prerender"},function(t,e){t.exports="prestep"},function(t,e){t.exports="ready"},function(t,e){t.exports="resume"},function(t,e){t.exports="step"},function(t,e){t.exports="visible"},function(t,e,n){t.exports={POST_RENDER:n(327),PRE_RENDER:n(328),RENDER:n(329),RESIZE:n(330)}},function(t,e){t.exports="postrender"},function(t,e){t.exports="prerender"},function(t,e){t.exports="render"},function(t,e){t.exports="resize"},function(t,e,n){var i=new(n(0))({initialize:function(t,e){this.geometryMask=e,this.invertAlpha=!1,this.isStencil=!0,this.level=0},setShape:function(t){return this.geometryMask=t,this},setInvertAlpha:function(t){return void 0===t&&(t=!0),this.invertAlpha=t,this},preRenderWebGL:function(t,e,n){var i=t.gl;t.flush(),0===t.maskStack.length&&(i.enable(i.STENCIL_TEST),i.clear(i.STENCIL_BUFFER_BIT),t.maskCount=0),t.currentCameraMask.mask!==this&&(t.currentMask.mask=this),t.maskStack.push({mask:this,camera:n}),this.applyStencil(t,n,!0),t.maskCount++},applyStencil:function(t,e,n){var i=t.gl,a=this.geometryMask,r=t.maskCount;i.colorMask(!1,!1,!1,!1),n?(i.stencilFunc(i.EQUAL,r,255),i.stencilOp(i.KEEP,i.KEEP,i.INCR)):(i.stencilFunc(i.EQUAL,r+1,255),i.stencilOp(i.KEEP,i.KEEP,i.DECR)),a.renderWebGL(t,a,e),t.flush(),i.colorMask(!0,!0,!0,!0),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),n?this.invertAlpha?i.stencilFunc(i.NOTEQUAL,r+1,255):i.stencilFunc(i.EQUAL,r+1,255):this.invertAlpha?i.stencilFunc(i.NOTEQUAL,r,255):i.stencilFunc(i.EQUAL,r,255)},postRenderWebGL:function(t){var e=t.gl;t.maskStack.pop(),t.maskCount--,t.flush();var n,i=t.currentMask;0===t.maskStack.length?(i.mask=null,e.disable(e.STENCIL_TEST)):((n=t.maskStack[t.maskStack.length-1]).mask.applyStencil(t,n.camera,!1),t.currentCameraMask.mask!==n.mask?(i.mask=n.mask,i.camera=n.camera):i.mask=null)},preRenderCanvas:function(t,e,n){var i=this.geometryMask;t.currentContext.save(),i.renderCanvas(t,i,n,null,null,!0),t.currentContext.clip()},postRenderCanvas:function(t){t.currentContext.restore()},destroy:function(){this.geometryMask=null}});t.exports=i},function(t,e){t.exports={_originComponent:!0,originX:.5,originY:.5,_displayOriginX:0,_displayOriginY:0,displayOriginX:{get:function(){return this._displayOriginX},set:function(t){this._displayOriginX=t,this.originX=t/this.width}},displayOriginY:{get:function(){return this._displayOriginY},set:function(t){this._displayOriginY=t,this.originY=t/this.height}},setOrigin:function(t,e){return void 0===t&&(t=.5),void 0===e&&(e=t),this.originX=t,this.originY=e,this.updateDisplayOrigin()},setOriginFromFrame:function(){return this.frame&&this.frame.customPivot?(this.originX=this.frame.pivotX,this.originY=this.frame.pivotY,this.updateDisplayOrigin()):this.setOrigin()},setDisplayOrigin:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.displayOriginX=t,this.displayOriginY=e,this},updateDisplayOrigin:function(){return this._displayOriginX=this.originX*this.width,this._displayOriginY=this.originY*this.height,this}}},function(t,e,n){var i=n(19),a=n(334),r=n(10),s=n(335),o=n(2),h={path:null,rotateToPath:!1,pathRotationOffset:0,pathOffset:null,pathVector:null,pathDelta:null,pathTween:null,pathConfig:null,_prevDirection:s.PLAYING_FORWARD,setPath:function(t,e){void 0===e&&(e=this.pathConfig);var n=this.pathTween;return n&&n.isPlaying()&&n.stop(),this.path=t,e&&this.startFollow(e),this},setRotateToPath:function(t,e){return void 0===e&&(e=0),this.rotateToPath=t,this.pathRotationOffset=e,this},isFollowing:function(){var t=this.pathTween;return t&&t.isPlaying()},startFollow:function(t,e){void 0===t&&(t={}),void 0===e&&(e=0);var n=this.pathTween;n&&n.isPlaying()&&n.stop(),"number"==typeof t&&(t={duration:t}),t.from=r(t,"from",0),t.to=r(t,"to",1);var h=a(t,"positionOnPath",!1);this.rotateToPath=a(t,"rotateToPath",!1),this.pathRotationOffset=r(t,"rotationOffset",0);var c,l=r(t,"startAt",e);return l&&(t.onStart=function(t){var e=t.data[0];e.progress=l,e.elapsed=e.duration*l;var n=e.ease(e.progress);e.current=e.start+(e.end-e.start)*n,e.target[e.key]=e.current}),this.pathOffset||(this.pathOffset=new o(this.x,this.y)),this.pathVector||(this.pathVector=new o),this.pathDelta||(this.pathDelta=new o),this.pathDelta.reset(),this.pathTween=this.scene.sys.tweens.addCounter(t),this.path.getStartPoint(this.pathOffset),h&&(this.x=this.pathOffset.x,this.y=this.pathOffset.y),this.pathOffset.x=this.x-this.pathOffset.x,this.pathOffset.y=this.y-this.pathOffset.y,this._prevDirection=s.PLAYING_FORWARD,this.rotateToPath&&(c=this.path.getPoint(.1),this.rotation=Math.atan2(c.y-this.y,c.x-this.x)+i(this.pathRotationOffset)),this.pathConfig=t,this},pauseFollow:function(){var t=this.pathTween;return t&&t.isPlaying()&&t.pause(),this},resumeFollow:function(){var t=this.pathTween;return t&&t.isPaused()&&t.resume(),this},stopFollow:function(){var t=this.pathTween;return t&&t.isPlaying()&&t.stop(),this},pathUpdate:function(){var t=this.pathTween;if(t){var e=t.data[0],n=this.pathDelta,a=this.pathVector;if(n.copy(a).negate(),e.state===s.COMPLETE)return this.path.getPoint(1,a),n.add(a),a.add(this.pathOffset),void this.setPosition(a.x,a.y);if(e.state!==s.PLAYING_FORWARD&&e.state!==s.PLAYING_BACKWARD)return;this.path.getPoint(t.getValue(),a),n.add(a),a.add(this.pathOffset);var r=this.x,o=this.y;this.setPosition(a.x,a.y);var h=this.x-r,c=this.y-o;if(0==h&&0==c)return;if(e.state!==this._prevDirection)return void(this._prevDirection=e.state);this.rotateToPath&&(this.rotation=Math.atan2(c,h)+i(this.pathRotationOffset))}}};t.exports=h},function(t,e){t.exports=function(t,e,n){return t&&t.hasOwnProperty(e)?t[e]:n}},function(t,e){t.exports={CREATED:0,INIT:1,DELAY:2,OFFSET_DELAY:3,PENDING_RENDER:4,PLAYING_FORWARD:5,PLAYING_BACKWARD:6,HOLD_DELAY:7,REPEAT_DELAY:8,COMPLETE:9,PENDING_ADD:20,PAUSED:21,LOOP_DELAY:22,ACTIVE:23,COMPLETE_DELAY:24,PENDING_REMOVE:25,REMOVED:26}},function(t,e,n){var i=n(337),a=n(338),r=n(12),s={defaultPipeline:null,pipeline:null,hasPostPipeline:!1,postPipelines:null,pipelineData:null,initPipeline:function(t){void 0===t&&(t=a.MULTI_PIPELINE);var e=this.scene.sys.renderer;if(!e)return!1;var n=e.pipelines;if(this.postPipelines=[],this.pipelineData={},n){var i=n.get(t);if(i)return this.defaultPipeline=i,this.pipeline=i,!0}return!1},setPipeline:function(t,e,n){var a=this.scene.sys.renderer;if(!a)return this;var r,s=a.pipelines;return s&&((r=s.get(t))&&(this.pipeline=r),e&&(this.pipelineData=n?i(e):e)),this},setPostPipeline:function(t,e,n){var a=this.scene.sys.renderer;if(!a)return this;var r=a.pipelines;if(r){Array.isArray(t)||(t=[t]);for(var s=0;s<t.length;s++){var o=r.getPostPipeline(t[s],this);o&&this.postPipelines.push(o)}e&&(this.pipelineData=n?i(e):e)}return this.hasPostPipeline=0<this.postPipelines.length,this},setPipelineData:function(t,e){var n=this.pipelineData;return void 0===e?delete n[t]:n[t]=e,this},getPostPipeline:function(t){for(var e=this.postPipelines,n=[],i=0;i<e.length;i++){var a=e[i];("string"==typeof t&&a.name===t||a instanceof t)&&n.push(a)}return 1===n.length?n[0]:n},resetPipeline:function(t,e){return void 0===t&&(t=!1),void 0===e&&(e=!1),this.pipeline=this.defaultPipeline,t&&(this.postPipelines=[],this.hasPostPipeline=!1),e&&(this.pipelineData={}),null!==this.pipeline},resetPostPipeline:function(t){void 0===t&&(t=!1);for(var e=this.postPipelines,n=0;n<e.length;n++)e[n].destroy();this.postPipelines=[],this.hasPostPipeline=!1,t&&(this.pipelineData={})},removePostPipeline:function(t){for(var e=this.postPipelines,n=e.length-1;0<=n;n--){var i=e[n];("string"==typeof t&&i.name===t||"string"!=typeof t&&i instanceof t)&&(i.destroy(),r(e,n))}return this.hasPostPipeline=0<this.postPipelines.length,this},getPipelineName:function(){return this.pipeline.name}};t.exports=s},function(t,e){t.exports=function t(e){var n,i,a;if("object"!=typeof e||null===e)return e;for(a in n=Array.isArray(e)?[]:{},e)i=e[a],n[a]=t(i);return n}},function(t,e){t.exports={BITMAPMASK_PIPELINE:"BitmapMaskPipeline",LIGHT_PIPELINE:"Light2D",POINTLIGHT_PIPELINE:"PointLightPipeline",SINGLE_PIPELINE:"SinglePipeline",MULTI_PIPELINE:"MultiPipeline",ROPE_PIPELINE:"RopePipeline",GRAPHICS_PIPELINE:"GraphicsPipeline",POSTFX_PIPELINE:"PostFXPipeline",UTILITY_PIPELINE:"UtilityPipeline"}},function(t,e){var n={_sizeComponent:!0,width:0,height:0,displayWidth:{get:function(){return Math.abs(this.scaleX*this.frame.realWidth)},set:function(t){this.scaleX=t/this.frame.realWidth}},displayHeight:{get:function(){return Math.abs(this.scaleY*this.frame.realHeight)},set:function(t){this.scaleY=t/this.frame.realHeight}},setSizeToFrame:function(t){return void 0===t&&(t=this.frame),this.width=t.realWidth,this.height=t.realHeight,this},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this}};t.exports=n},function(t,e){t.exports={texture:null,frame:null,isCropped:!1,setTexture:function(t,e){return this.texture=this.scene.sys.textures.get(t),this.setFrame(e)},setFrame:function(t,e,n){return void 0===e&&(e=!0),void 0===n&&(n=!0),this.frame=this.texture.get(t),this.frame.cutWidth&&this.frame.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this._sizeComponent&&e&&this.setSizeToFrame(),this._originComponent&&n&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this}}},function(t,e){t.exports={texture:null,frame:null,isCropped:!1,setCrop:function(t,e,n,i){return void 0===t?this.isCropped=!1:this.frame&&("number"==typeof t?this.frame.setCropUVs(this._crop,t,e,n,i,this.flipX,this.flipY):this.frame.setCropUVs(this._crop,t.x,t.y,t.width,t.height,this.flipX,this.flipY),this.isCropped=!0),this},setTexture:function(t,e){return this.texture=this.scene.sys.textures.get(t),this.setFrame(e)},setFrame:function(t,e,n){return void 0===e&&(e=!0),void 0===n&&(n=!0),this.frame=this.texture.get(t),this.frame.cutWidth&&this.frame.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this._sizeComponent&&e&&this.setSizeToFrame(),this._originComponent&&n&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this.isCropped&&this.frame.updateCropUVs(this._crop,this.flipX,this.flipY),this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}}},function(t,e){t.exports={tintTopLeft:16777215,tintTopRight:16777215,tintBottomLeft:16777215,tintBottomRight:16777215,tintFill:!1,clearTint:function(){return this.setTint(16777215),this},setTint:function(t,e,n,i){return void 0===t&&(t=16777215),void 0===e&&(i=n=e=t),this.tintTopLeft=t,this.tintTopRight=e,this.tintBottomLeft=n,this.tintBottomRight=i,this.tintFill=!1,this},setTintFill:function(t,e,n,i){return this.setTint(t,e,n,i),this.tintFill=!0,this},tint:{set:function(t){this.setTint(t,t,t,t)}},isTinted:{get:function(){var t=16777215;return this.tintFill||this.tintTopLeft!==t||this.tintTopRight!==t||this.tintBottomLeft!==t||this.tintBottomRight!==t}}}},function(t,e,n){var i=n(1),a=n(1);i=n(344),a=n(345);t.exports={renderWebGL:i,renderCanvas:a}},function(t,e){t.exports=function(t,e,n,i){var a=e.list,r=a.length;if(0!==r){n.addToRenderList(e);var s=e.localTransform;i?(s.loadIdentity(),s.multiply(i),s.translate(e.x,e.y),s.rotate(e.rotation),s.scale(e.scaleX,e.scaleY)):s.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),t.pipelines.preBatch(e);var o=-1!==e.blendMode;o||t.setBlendMode(0);for(var h=e.alpha,c=e.scrollFactorX,l=e.scrollFactorY,u=0;u<r;u++){var d,p,f,g,m,v,y,S,A=a[u];A.willRender(n)&&(g=void 0!==A.alphaTopLeft?(d=A.alphaTopLeft,p=A.alphaTopRight,f=A.alphaBottomLeft,A.alphaBottomRight):f=p=d=A.alpha,m=A.scrollFactorX,v=A.scrollFactorY,o||A.blendMode===t.currentBlendMode||t.setBlendMode(A.blendMode),(y=A.mask)&&y.preRenderWebGL(t,A,n),(S=A.type)!==t.currentType&&(t.newType=!0,t.currentType=S),t.nextTypeMatch=u<r-1&&a[u+1].type===t.currentType,A.setScrollFactor(m*c,v*l),A.setAlpha(d*h,p*h,f*h,g*h),A.renderWebGL(t,A,n,s),A.setAlpha(d,p,f,g),A.setScrollFactor(m,v),y&&y.postRenderWebGL(t,n),t.newType=!1)}t.pipelines.postBatch(e)}}},function(t,e){t.exports=function(t,e,n,i){var a=e.list;if(0!==a.length){n.addToRenderList(e);var r=e.localTransform;i?(r.loadIdentity(),r.multiply(i),r.translate(e.x,e.y),r.rotate(e.rotation),r.scale(e.scaleX,e.scaleY)):r.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY);var s=-1!==e.blendMode;s||t.setBlendMode(0);var o=e._alpha,h=e.scrollFactorX,c=e.scrollFactorY;e.mask&&e.mask.preRenderCanvas(t,null,n);for(var l=0;l<a.length;l++){var u,d,p,f=a[l];f.willRender(n)&&(u=f.alpha,d=f.scrollFactorX,p=f.scrollFactorY,s||f.blendMode===t.currentBlendMode||t.setBlendMode(f.blendMode),f.setScrollFactor(d*h,p*c),f.setAlpha(u*o),f.renderCanvas(t,f,n,r),f.setAlpha(u),f.setScrollFactor(d,p))}e.mask&&e.mask.postRenderCanvas(t)}}},function(t,e,n){var i=n(25);t.exports=function(t,e,n){void 0===n&&(n=new i);var a=Math.min(t.x,e.x),r=Math.min(t.y,e.y),s=Math.max(t.right,e.right)-a,o=Math.max(t.bottom,e.bottom)-r;return n.setTo(a,r,s,o)}},function(t,e,n){var i=n(1),a=n(1);i=n(348),a=n(349);t.exports={renderWebGL:i,renderCanvas:a}},function(t,e){t.exports=function(t,e,n,i){var a=e.plugin.sceneRenderer,r=e.list;if(0!==r.length){n.addToRenderList(e);var s=e.localTransform;i?(s.loadIdentity(),s.multiply(i),s.translate(e.x,e.y),s.rotate(e.rotation),s.scale(e.scaleX,e.scaleY)):s.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),t.newType&&(t.pipelines.clear(),a.begin());var o=t.nextTypeMatch;t.nextTypeMatch=!0,t.newType=!1;for(var h=0;h<r.length;h++){var c,l=r[h];l.willRender(n,e)&&((c=l.mask)&&(a.end(),t.pipelines.rebind(),c.preRenderWebGL(t,l,n),t.pipelines.clear(),a.begin()),l.renderWebGL(t,l,n,s,e),c&&(a.end(),t.pipelines.rebind(),c.postRenderWebGL(t,n),t.pipelines.clear(),a.begin()))}(t.nextTypeMatch=o)||(a.end(),t.pipelines.rebind())}else a.batcher.isDrawing&&t.finalType&&(a.end(),t.pipelines.rebind())}},function(t,e){t.exports=function(t,e,n,i){var a=e.list;if(0!==a.length){n.addToRenderList(e);var r=e.localTransform;i?(r.loadIdentity(),r.multiply(i),r.translate(e.x,e.y),r.rotate(e.rotation),r.scale(e.scaleX,e.scaleY)):r.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY);var s=-1!==e.blendMode;s||t.setBlendMode(0);var o=e._alpha,h=e.scrollFactorX,c=e.scrollFactorY;e.mask&&e.mask.preRenderCanvas(t,null,n);for(var l=0;l<a.length;l++){var u,d,p,f=a[l];f.willRender(n)&&(u=f.alpha,d=f.scrollFactorX,p=f.scrollFactorY,s||f.blendMode===t.currentBlendMode||t.setBlendMode(f.blendMode),f.setScrollFactor(d*h,p*c),f.setAlpha(u*o),f.renderCanvas(t,f,n,r),f.setAlpha(u),f.setScrollFactor(d,p))}e.mask&&e.mask.postRenderCanvas(t)}}}]);var TR=["Enable"],wR=function(t){function e(e){return t.call(this,e)||this}(0,Kt.default)(e,t);var i=e.prototype;return i.boot=function(){var e=(0,Xt.default)(qt().mark((function e(){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.prototype.boot.call(this),this.addExtraGameObjectMethods(),this.addExtraFBInstantFunctions(),this.addPlugins(),e.next=6,this.addDevPlugins();case 6:this.addScenes(),this.addDevScenes(),this.initAds(),this.initWorld(),this.initStorage(),this.initLanguage(),this.initUtils(),this.initConsole(),this.initDebugger(),this.initStatistics(),this.initParticleEditor(),this.handleShowAdWhenStartGame(),this.initAdaptivePerformance();case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.start=function(){t.prototype.start.call(this)},i.updateFps=function(t){void 0===t&&(t=60),this.getFps()!==t&&this.setFps(t)},i.getFps=function(){return this.scene.game&&this.scene.game.loop&&this.scene.game.loop.raf?this.scene.game.loop.raf.fps:5},i.setFps=function(t){this.scene.game&&this.scene.game.loop&&this.scene.game.loop.raf&&"function"===typeof this.scene.game.loop.raf.updateFps&&this.scene.game.loop.raf.updateFps(t)},i.addExtraGameObjectMethods=function(){var t=new Qt(this);t.addKillRevive(),t.addDrawDebugBox(),t.addSetWorldSize(),t.addSetWorldSizeForContainer(),t.addGetWorldPosition(),t.addHighQuality()},i.addExtraFBInstantFunctions=function(){var t=new Zt.default(this.facebook);this.facebook.shareAsync=t.shareAsync,this.facebook.inviteAsync=t.inviteAsync,this.facebook.switchAsync=t.switchAsync,this.facebook.chooseAsync=t.chooseAsync,this.facebook.createAsync=t.createAsync,this.facebook.sendMessage=t.sendMessage,this.facebook.getContextID=t.getContextID,this.facebook.getPlayerToken=t.getPlayerToken,this.facebook.matchPlayerAsync=t.matchPlayerAsync,this.facebook.getContextPlayers=t.getContextPlayers,this.facebook.setLoadingProgress=t.setLoadingProgress,this.facebook.attemptToAddShortcut=t.attemptToAddShortcut,this.facebook.attemptToSubscribeBot=t.attemptToSubscribeBot,this.facebook.postSessionScoreAsync=t.postSessionScoreAsync,this.facebook.getRewardedVideoAsync=t.getRewardedVideoAsync,this.facebook.getInterstitialAdAsync=t.getInterstitialAdAsync,this.facebook.setLoadingProgress=t.setLoadingProgress,this.facebook.getLocale=t.getLocale,this.facebook.postSessionScoreAsync=t.postSessionScoreAsync,t.injectTournament(),this.facebook.progressLoading=new $k(this)},i.addPlugins=function(){this.plugins.install("Storage",wr,!0,"storage"),this.plugins.install("AdsManager",ue,!0,"ads"),this.plugins.install("AuthManager",Ie,!0,"auth"),this.plugins.install("AudioManager",ye,!0,"audio"),this.plugins.install("WorldManager",_r,!0,"world"),this.plugins.install("PlayerManager",Wn,!0,"player"),this.plugins.install("ProfileManager",$n,!0,"profile"),this.plugins.install("AnalyticsManager",fe,!0,"analytics"),this.plugins.install("LanguageManager",qk,!0,"lang"),this.plugins.install("AdaptivePerformance",_k,!0,"performance"),this.plugins.installScenePlugin("textStyler",Rr,"textStyler"),this.plugins.installScenePlugin("ScreenManager",oi,"screen"),this.plugins.installScenePlugin("FrameCapture",Re,"frameCapture"),this.plugins.installScenePlugin("SpinePlugin",SpinePlugin,"spine"),window.SpinePlugin&&this.plugins.installScenePlugin("SpinePlugin",SpinePlugin,"spine"),this.storage=this.plugins.get("Storage"),this.ads=this.plugins.get("AdsManager"),this.auth=this.plugins.get("AuthManager"),this.audio=this.plugins.get("AudioManager"),this.world=this.plugins.get("WorldManager"),this.player=this.plugins.get("PlayerManager"),this.profile=this.plugins.get("ProfileManager"),this.analytics=this.plugins.get("AnalyticsManager"),this.lang=this.plugins.get("LanguageManager"),this.performance=this.plugins.get("AdaptivePerformance")},i.addDevPlugins=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,i,a,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(GameCore.Utils.Valid.isDebugger()){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,Promise.all([n.e(7),n.e(716)]).then(n.bind(n,562));case 4:return e=t.sent.default,t.next=7,Promise.all([n.e(498),n.e(114),n.e(227)]).then(n.bind(n,563));case 7:return i=t.sent.default,t.next=10,n.e(315).then(n.bind(n,564));case 10:return a=t.sent.default,t.next=13,Promise.all([n.e(498),n.e(516)]).then(n.bind(n,565));case 13:r=t.sent.default,this.plugins.install("Console",e,!0,"console"),this.plugins.install("Debugger",i,!0,"debugger"),this.plugins.install("Statistics",a,!0,"statistics"),this.plugins.install("ParticleEditor",r,!0,"particle-editor"),this.eruda=this.plugins.get("Console"),this.debugger=this.plugins.get("Debugger"),this.statistics=this.plugins.get("Statistics"),this.particleEditor=this.plugins.get("ParticleEditor");case 22:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),i.addScenes=function(){this.scene.add(is.SceneKeys.BOOT_SCENE,cs,!0),this.scene.add(is.SceneKeys.LOAD_SCENE,$x,!1),this.scene.add(is.SceneKeys.GAME_SCENE,ME,!1),this.scene.add(is.SceneKeys.LEVEL_SCENE,Ik,!1),this.scene.add(is.SceneKeys.JOURNEY_SCENE,DP,!1),this.scene.add(is.SceneKeys.DASHBOARD_SCENE,nw,!1),this.scene.add(is.SceneKeys.GLOBAL_SCENE,jE,!1)},i.addDevScenes=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(GameCore.Utils.Valid.isDebugger()){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,n.e(817).then(n.bind(n,567));case 4:return e=t.sent.default,t.next=7,n.e(161).then(n.bind(n,568));case 7:i=t.sent.default,this.scene.add(is.SceneKeys.TEST_SCENE,e,!1),this.scene.add(is.SceneKeys.ANIMATIONS_SCENE,i,!1);case 10:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),i.initAds=function(){var t=GameCore.Configs.Ads;Lk.setGame(this);var e=t.Mockup.Enable?Wk:Lk,n=(0,wt.default)({},t.InterstitialAdOptions);n.showWhenStartGame&&(n.secondsFirstTime=0),this.ads.configure(e,{enabled:t.Enabled,interstitialPID:t.InterstitialPlacementId,rewardedVideoPID:t.VideoRewardsPlacementId,interstitialAdOptions:n,bannerAdOptions:t.BannerAdOptions})},i.initWorld=function(){var t=GameCore.Configs.Game;this.world.configure({width:375,height:667,ratio:320/518}),this.world.resize(t.ForcePixelRatio)},i.initStorage=function(){var t=new ns(this);this.storage.setInitiator(t)},i.initLanguage=function(){var t=this.facebook.getLocale();this.lang.configure({locale:t,upperCaseText:!0})},i.initUtils=function(){this.handlePauseAudio()},i.initConsole=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.Debugger.ShowConsole&&this.eruda.configure({tool:["console","info"],defaults:{theme:"Dark"}}))},i.initDebugger=function(){if(GameCore.Utils.Valid.isDebugger()){var t=GameCore.Configs.Debugger,e=t.ShowInspector,n=t.ShowMonitoring;(e||n)&&this.debugger.configure(GameCore.Configs.Debugger)}},i.initStatistics=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.Statistics.Enable&&this.statistics.configure(GameCore.Configs.Statistics))},i.initParticleEditor=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.ParticleEditor.Enable&&this.particleEditor.configure(GameCore.Configs.ParticleEditor))},i.initAdaptivePerformance=function(){var t=GameCore.Configs.Performance,e=t.Enable,n=(0,Wt.default)(t,TR);if(e){var i=this.world.getPixelRatio();this.performance.configure((0,wt.default)({pixelRatio:i},n)),this.performance.active()}},i.handlePauseAudio=function(){var t=this;this.sound.pauseOnBlur=!1,document.addEventListener("visibilitychange",(function(){document.hidden?t.audio.pauseMusic():t.audio.playMusic()}))},i.removeUnusedPipelines=function(){var t=this.renderer;if(t instanceof Phaser.Renderer.WebGL.WebGLRenderer){var e=t.pipelines,n=Phaser.Renderer.WebGL.Pipelines;if(n)[n.ROPE_PIPELINE,n.LIGHT_PIPELINE,n.POSTFX_PIPELINE,n.POINTLIGHT_PIPELINE,n.BITMAPMASK_PIPELINE].forEach((function(t){var n;null==(n=e.get(t))||n.destroy(),e.remove(t)}))}},i.handleShowAdWhenStartGame=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.ads.showBannerAdAsync().catch(Ht.sendException),GameCore.Configs.Ads.InterstitialAdOptions.showWhenStartGame){t.next=4;break}return t.abrupt("return");case 4:return t.prev=4,this.audio.stopMusic(),this.audio.muteAll(),t.next=9,this.ads.preloadInterstitialAdAsync();case 9:return t.next=11,this.ads.showInterstitialAdAsync();case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(4),(0,Ht.sendException)(t.t0);case 16:return t.prev=16,this.audio.unmuteAll(),this.audio.playMusic(),t.finish(16);case 20:case"end":return t.stop()}}),t,this,[[4,13,16,20]])})));return function(){return t.apply(this,arguments)}}(),e}(Phaser.Game),CR=wR,MR=GameCore.Configs.Debugger.ShowInspector,IR={parent:"app",type:Phaser.AUTO,width:0,height:0,scale:{autoRound:!0},dom:{createContainer:!1},loader:{maxParallelDownloads:6,crossOrigin:"no-cros"},audio:{noAudio:!1,disableWebAudio:!1},input:{gamepad:!1,keyboard:MR,touch:{capture:!0},smoothFactor:1,activePointers:1,windowEvents:!1},disableContextMenu:!0,fps:{},render:{pixelArt:!1,antialias:!0,antialiasGL:!0,transparent:!0,desynchronized:!1,powerPreference:"low-power",clearBeforeRender:!1,roundPixels:!1},plugins:{global:[]}};window.GameCore=zt,(0,Ht.initSentry)();var PR=setInterval((function(){window.__analyticsInitiated&&(window.__fbGameReady=!1,clearInterval(PR),clearInterval(window.__fbInstantLoadingTimer),GameSDK.setLoadingProgress(30),gtag("event","app_initialize",{send_to:["GA"]}),function(){try{var t=new CR(IR);window.game=t}catch(e){(0,Ht.sendException)(e)}}())}),50)},254:function(t,e,n){"use strict";n.r(e);var i=n(122),a=function(){function t(t,e,n,a){this.playerId=void 0,this.name=void 0,this.photo=void 0,this.locale=void 0,this.playerId=t,this.name=e,this.photo=n||i.default.AVATAR.FILE,this.locale=a||"en_US"}return t.prototype.toObject=function(){return{playerId:this.playerId,name:this.name,photo:this.photo,locale:this.locale}},t}();e.default=a},111:function(t,e,n){"use strict";n.r(e),n.d(e,{sleepAsync:function(){return o},checkIsToday:function(){return h},formatDateHMS:function(){return c},getDateDMY:function(){return l},convertHMS:function(){return u}});var i=n(46),a=n.n(i),r=n(38),s=n.n(r),o=function(t){return new(a())((function(e){return setTimeout(e,t)}))},h=function(t){var e=new Date(t),n=new Date;return e.getDate()===n.getDate()&&e.getMonth()===n.getMonth()&&e.getFullYear()===n.getFullYear()},c=function(t,e){void 0===e&&(e=!0);var n=new Date(t).toISOString();return e?s()(n).call(n,11,-5):s()(n).call(n,14,-5)},l=function(){var t=new Date,e=t.getDate(),n=t.getMonth()+1,i=""+e,a=""+n;return e<10&&(i="0"+e),n<10&&(a="0"+n),i+"/"+a+"/"+t.getFullYear()},u=function(t){var e=t/1e3,n=Math.floor(e/3600),i=Math.floor((e-3600*n)/60);return{hours:n,minutes:i,seconds:Math.floor(e-3600*n-60*i)}}},28:function(t,e,n){"use strict";n.r(e),n.d(e,{initSentry:function(){return i},addBreadcrumbSentry:function(){return a},setSentryUser:function(){return r},sendExceptionWithScope:function(){return s},sendException:function(){return o}});n(325),n(164),n(96),n(32);var i=function(){var t=setInterval((function(){window.Sentry&&clearInterval(t)}),100)},a=function(t,e){window.Sentry&&window.Sentry.addBreadcrumb({category:t,message:e})},r=function(t){window.Sentry&&window.Sentry.setUser(t)},s=function(t,e){t&&window.Sentry.withScope((function(t){t.setExtras(e)}))},o=function(t){}},445:function(t,e,n){"use strict";n.r(e),n.d(e,{getImageScale:function(){return i}});var i=function(){return GameCore.Utils.Device.isDesktop()||GameCore.Utils.Device.pixelRatio()>1?2:1}}},function(t){var e=function(e){return t(t.s=e)};t.O(0,[216],(function(){return e(573),e(572),e(556),e(531)}));t.O()}]);